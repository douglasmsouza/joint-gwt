function RGBColor(e){this.ok=!1,"#"==e.charAt(0)&&(e=e.substr(1,6)),e=e.replace(/ /g,""),e=e.toLowerCase();var t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(var n in t)e==n&&(e=t[n]);for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(e){return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}}],i=0;i<r.length;i++){var s=r[i].re,o=r[i].process,u=s.exec(e);u&&(channels=o(u),this.r=channels[0],this.g=channels[1],this.b=channels[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var e=this.r.toString(16),t=this.g.toString(16),n=this.b.toString(16);return 1==e.length&&(e="0"+e),1==t.length&&(t="0"+t),1==n.length&&(n="0"+n),"#"+e+t+n},this.getHelpXML=function(){for(var e=new Array,n=0;n<r.length;n++)for(var i=r[n].example,s=0;s<i.length;s++)e[e.length]=i[s];for(var o in t)e[e.length]=o;var u=document.createElement("ul");u.setAttribute("id","rgbcolor-examples");for(var n=0;n<e.length;n++)try{var a=document.createElement("li"),f=new RGBColor(e[n]),l=document.createElement("div");l.style.cssText="margin: 3px; border: 1px solid black; background:"+f.toHex()+"; color:"+f.toHex(),l.appendChild(document.createTextNode("test"));var c=document.createTextNode(" "+e[n]+" -> "+f.toRGB()+" -> "+f.toHex());a.appendChild(l),a.appendChild(c),u.appendChild(a)}catch(h){}return u}}function stackBlurImage(e,t,n,r){var i=document.getElementById(e),s=i.naturalWidth,o=i.naturalHeight,u=document.getElementById(t);u.style.width=s+"px",u.style.height=o+"px",u.width=s,u.height=o;var a=u.getContext("2d");a.clearRect(0,0,s,o),a.drawImage(i,0,0),isNaN(n)||1>n||(r?stackBlurCanvasRGBA(t,0,0,s,o,n):stackBlurCanvasRGB(t,0,0,s,o,n))}function stackBlurCanvasRGBA(e,t,n,r,i,s){if(!(isNaN(s)||1>s)){s|=0;var o,u=document.getElementById(e),a=u.getContext("2d");try{try{o=a.getImageData(t,n,r,i)}catch(f){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),o=a.getImageData(t,n,r,i)}catch(f){throw alert("Cannot access local image"),new Error("unable to access local image data: "+f)}}}catch(f){throw alert("Cannot access image"),new Error("unable to access image data: "+f)}var l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P=o.data,H=s+s+1,B=r-1,j=i-1,F=s+1,I=F*(F+1)/2,q=new BlurStack,R=q;for(h=1;H>h;h++)if(R=R.next=new BlurStack,h==F)var U=R;R.next=q;var z=null,W=null;m=v=0;var X=mul_table[s],V=shg_table[s];for(c=0;i>c;c++){for(N=C=k=L=g=y=b=w=0,E=F*(A=P[v]),S=F*(O=P[v+1]),x=F*(M=P[v+2]),T=F*(_=P[v+3]),g+=I*A,y+=I*O,b+=I*M,w+=I*_,R=q,h=0;F>h;h++)R.r=A,R.g=O,R.b=M,R.a=_,R=R.next;for(h=1;F>h;h++)p=v+((h>B?B:h)<<2),g+=(R.r=A=P[p])*(D=F-h),y+=(R.g=O=P[p+1])*D,b+=(R.b=M=P[p+2])*D,w+=(R.a=_=P[p+3])*D,N+=A,C+=O,k+=M,L+=_,R=R.next;for(z=q,W=U,l=0;r>l;l++)P[v+3]=_=w*X>>V,0!=_?(_=255/_,P[v]=(g*X>>V)*_,P[v+1]=(y*X>>V)*_,P[v+2]=(b*X>>V)*_):P[v]=P[v+1]=P[v+2]=0,g-=E,y-=S,b-=x,w-=T,E-=z.r,S-=z.g,x-=z.b,T-=z.a,p=m+((p=l+s+1)<B?p:B)<<2,N+=z.r=P[p],C+=z.g=P[p+1],k+=z.b=P[p+2],L+=z.a=P[p+3],g+=N,y+=C,b+=k,w+=L,z=z.next,E+=A=W.r,S+=O=W.g,x+=M=W.b,T+=_=W.a,N-=A,C-=O,k-=M,L-=_,W=W.next,v+=4;m+=r}for(l=0;r>l;l++){for(C=k=L=N=y=b=w=g=0,v=l<<2,E=F*(A=P[v]),S=F*(O=P[v+1]),x=F*(M=P[v+2]),T=F*(_=P[v+3]),g+=I*A,y+=I*O,b+=I*M,w+=I*_,R=q,h=0;F>h;h++)R.r=A,R.g=O,R.b=M,R.a=_,R=R.next;for(d=r,h=1;s>=h;h++)v=d+l<<2,g+=(R.r=A=P[v])*(D=F-h),y+=(R.g=O=P[v+1])*D,b+=(R.b=M=P[v+2])*D,w+=(R.a=_=P[v+3])*D,N+=A,C+=O,k+=M,L+=_,R=R.next,j>h&&(d+=r);for(v=l,z=q,W=U,c=0;i>c;c++)p=v<<2,P[p+3]=_=w*X>>V,_>0?(_=255/_,P[p]=(g*X>>V)*_,P[p+1]=(y*X>>V)*_,P[p+2]=(b*X>>V)*_):P[p]=P[p+1]=P[p+2]=0,g-=E,y-=S,b-=x,w-=T,E-=z.r,S-=z.g,x-=z.b,T-=z.a,p=l+((p=c+F)<j?p:j)*r<<2,g+=N+=z.r=P[p],y+=C+=z.g=P[p+1],b+=k+=z.b=P[p+2],w+=L+=z.a=P[p+3],z=z.next,E+=A=W.r,S+=O=W.g,x+=M=W.b,T+=_=W.a,N-=A,C-=O,k-=M,L-=_,W=W.next,v+=r}a.putImageData(o,t,n)}}function stackBlurCanvasRGB(e,t,n,r,i,s){if(!(isNaN(s)||1>s)){s|=0;var o,u=document.getElementById(e),a=u.getContext("2d");try{try{o=a.getImageData(t,n,r,i)}catch(f){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),o=a.getImageData(t,n,r,i)}catch(f){throw alert("Cannot access local image"),new Error("unable to access local image data: "+f)}}}catch(f){throw alert("Cannot access image"),new Error("unable to access image data: "+f)}var l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O=o.data,M=s+s+1,_=r-1,D=i-1,P=s+1,H=P*(P+1)/2,B=new BlurStack,j=B;for(h=1;M>h;h++)if(j=j.next=new BlurStack,h==P)var F=j;j.next=B;var I=null,q=null;m=v=0;var R=mul_table[s],U=shg_table[s];for(c=0;i>c;c++){for(x=T=N=g=y=b=0,w=P*(C=O[v]),E=P*(k=O[v+1]),S=P*(L=O[v+2]),g+=H*C,y+=H*k,b+=H*L,j=B,h=0;P>h;h++)j.r=C,j.g=k,j.b=L,j=j.next;for(h=1;P>h;h++)p=v+((h>_?_:h)<<2),g+=(j.r=C=O[p])*(A=P-h),y+=(j.g=k=O[p+1])*A,b+=(j.b=L=O[p+2])*A,x+=C,T+=k,N+=L,j=j.next;for(I=B,q=F,l=0;r>l;l++)O[v]=g*R>>U,O[v+1]=y*R>>U,O[v+2]=b*R>>U,g-=w,y-=E,b-=S,w-=I.r,E-=I.g,S-=I.b,p=m+((p=l+s+1)<_?p:_)<<2,x+=I.r=O[p],T+=I.g=O[p+1],N+=I.b=O[p+2],g+=x,y+=T,b+=N,I=I.next,w+=C=q.r,E+=k=q.g,S+=L=q.b,x-=C,T-=k,N-=L,q=q.next,v+=4;m+=r}for(l=0;r>l;l++){for(T=N=x=y=b=g=0,v=l<<2,w=P*(C=O[v]),E=P*(k=O[v+1]),S=P*(L=O[v+2]),g+=H*C,y+=H*k,b+=H*L,j=B,h=0;P>h;h++)j.r=C,j.g=k,j.b=L,j=j.next;for(d=r,h=1;s>=h;h++)v=d+l<<2,g+=(j.r=C=O[v])*(A=P-h),y+=(j.g=k=O[v+1])*A,b+=(j.b=L=O[v+2])*A,x+=C,T+=k,N+=L,j=j.next,D>h&&(d+=r);for(v=l,I=B,q=F,c=0;i>c;c++)p=v<<2,O[p]=g*R>>U,O[p+1]=y*R>>U,O[p+2]=b*R>>U,g-=w,y-=E,b-=S,w-=I.r,E-=I.g,S-=I.b,p=l+((p=c+P)<D?p:D)*r<<2,g+=x+=I.r=O[p],y+=T+=I.g=O[p+1],b+=N+=I.b=O[p+2],I=I.next,w+=C=q.r,E+=k=q.g,S+=L=q.b,x-=C,T-=k,N-=L,q=q.next,v+=r}a.putImageData(o,t,n)}}function BlurStack(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}if(function(a,b){function c(e){var t=e.length,n=fb.type(e);return fb.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}function d(e){var t=ob[e]={};return fb.each(e.match(hb)||[],function(e,n){t[n]=!0}),t}function e(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=fb.expando+Math.random()}function f(e,t,n){var r;if(n===b&&1===e.nodeType)if(r="data-"+t.replace(sb,"-$1").toLowerCase(),n=e.getAttribute(r),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:rb.test(n)?JSON.parse(n):n}catch(i){}pb.set(e,t,n)}else n=b;return n}function g(){return!0}function h(){return!1}function i(){try{return T.activeElement}catch(e){}}function j(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function k(e,t,n){if(fb.isFunction(t))return fb.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return fb.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(Cb.test(t))return fb.filter(t,e,n);t=fb.filter(t,e)}return fb.grep(e,function(e){return bb.call(t,e)>=0!==n})}function l(e,t){return fb.nodeName(e,"table")&&fb.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function m(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function n(e){var t=Nb.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function o(e,t){for(var n=e.length,r=0;n>r;r++)qb.set(e[r],"globalEval",!t||qb.get(t[r],"globalEval"))}function p(e,t){var n,r,i,s,o,u,a,f;if(1===t.nodeType){if(qb.hasData(e)&&(s=qb.access(e),o=qb.set(t,s),f=s.events)){delete o.handle,o.events={};for(i in f)for(n=0,r=f[i].length;r>n;n++)fb.event.add(t,i,f[i][n])}pb.hasData(e)&&(u=pb.access(e),a=fb.extend({},u),pb.set(t,a))}}function q(e,t){var n=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return t===b||t&&fb.nodeName(e,t)?fb.merge([e],n):n}function r(e,t){var n=t.nodeName.toLowerCase();"input"===n&&Kb.test(e.type)?t.checked=e.checked:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}function s(e,t){if(t in e)return t;for(var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=_b.length;i--;)if(t=_b[i]+n,t in e)return t;return r}function t(e,t){return e=t||e,"none"===fb.css(e,"display")||!fb.contains(e.ownerDocument,e)}function u(e){return a.getComputedStyle(e,null)}function v(e,n){for(var r,i,s,o=[],u=0,a=e.length;a>u;u++)i=e[u],i.style&&(o[u]=qb.get(i,"olddisplay"),r=i.style.display,n?(o[u]||"none"!==r||(i.style.display=""),""===i.style.display&&t(i)&&(o[u]=qb.access(i,"olddisplay",z(i.nodeName)))):o[u]||(s=t(i),(r&&"none"!==r||!s)&&qb.set(i,"olddisplay",s?r:fb.css(i,"display"))));for(u=0;a>u;u++)i=e[u],i.style&&(n&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=n?o[u]||"":"none"));return e}function w(e,t,n){var r=Ub.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function x(e,t,n,r,i){for(var s=n===(r?"border":"content")?4:"width"===t?1:0,o=0;4>s;s+=2)"margin"===n&&(o+=fb.css(e,n+$b[s],!0,i)),r?("content"===n&&(o-=fb.css(e,"padding"+$b[s],!0,i)),"margin"!==n&&(o-=fb.css(e,"border"+$b[s]+"Width",!0,i))):(o+=fb.css(e,"padding"+$b[s],!0,i),"padding"!==n&&(o+=fb.css(e,"border"+$b[s]+"Width",!0,i)));return o}function y(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,s=u(e),o=fb.support.boxSizing&&"border-box"===fb.css(e,"boxSizing",!1,s);if(0>=i||null==i){if(i=Qb(e,t,s),(0>i||null==i)&&(i=e.style[t]),Vb.test(i))return i;r=o&&(fb.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+x(e,t,n||(o?"border":"content"),r,s)+"px"}function z(e){var t=T,n=Xb[e];return n||(n=A(e,t),"none"!==n&&n||(Rb=(Rb||fb("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(Rb[0].contentWindow||Rb[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=A(e,t),Rb.detach()),Xb[e]=n),n}function A(e,t){var n=fb(t.createElement(e)).appendTo(t.body),r=fb.css(n[0],"display");return n.remove(),r}function B(e,t,n,r){var i;if(fb.isArray(t))fb.each(t,function(t,i){n||bc.test(e)?r(e,i):B(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(n||"object"!==fb.type(t))r(e,t);else for(i in t)B(e+"["+i+"]",t[i],n,r)}function C(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,s=t.toLowerCase().match(hb)||[];if(fb.isFunction(n))for(;r=s[i++];)"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function D(e,t,n,r){function i(u){var l;return s[u]=!0,fb.each(e[u]||[],function(e,u){var a=u(t,n,r);return"string"!=typeof a||o||s[a]?o?!(l=a):void 0:(t.dataTypes.unshift(a),i(a),!1)}),l}var s={},o=e===sc;return i(t.dataTypes[0])||!s["*"]&&i("*")}function E(e,t){var n,r,i=fb.ajaxSettings.flatOptions||{};for(n in t)t[n]!==b&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&fb.extend(!0,e,r),e}function F(e,t,n){for(var r,i,s,o,u=e.contents,a=e.dataTypes;"*"===a[0];)a.shift(),r===b&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in u)if(u[i]&&u[i].test(r)){a.unshift(i);break}if(a[0]in n)s=a[0];else{for(i in n){if(!a[0]||e.converters[i+" "+a[0]]){s=i;break}o||(o=i)}s=s||o}return s?(s!==a[0]&&a.unshift(s),n[s]):void 0}function G(e,t,n,r){var i,s,o,u,a,f={},l=e.dataTypes.slice();if(l[1])for(o in e.converters)f[o.toLowerCase()]=e.converters[o];for(s=l.shift();s;)if(e.responseFields[s]&&(n[e.responseFields[s]]=t),!a&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),a=s,s=l.shift())if("*"===s)s=a;else if("*"!==a&&a!==s){if(o=f[a+" "+s]||f["* "+s],!o)for(i in f)if(u=i.split(" "),u[1]===s&&(o=f[a+" "+u[0]]||f["* "+u[0]])){o===!0?o=f[i]:f[i]!==!0&&(s=u[0],l.unshift(u[1]));break}if(o!==!0)if(o&&e["throws"])t=o(t);else try{t=o(t)}catch(c){return{state:"parsererror",error:o?c:"No conversion from "+a+" to "+s}}}return{state:"success",data:t}}function H(){return setTimeout(function(){Bc=b}),Bc=fb.now()}function I(e,t,n){for(var r,i=(Hc[t]||[]).concat(Hc["*"]),s=0,o=i.length;o>s;s++)if(r=i[s].call(n,t,e))return r}function J(e,t,n){var r,i,s=0,o=Gc.length,u=fb.Deferred().always(function(){delete a.elem}),a=function(){if(i)return!1;for(var t=Bc||H(),n=Math.max(0,f.startTime+f.duration-t),r=n/f.duration||0,s=1-r,o=0,a=f.tweens.length;a>o;o++)f.tweens[o].run(s);return u.notifyWith(e,[f,s,n]),1>s&&a?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:fb.extend({},t),opts:fb.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Bc||H(),duration:n.duration,tweens:[],createTween:function(t,n){var r=fb.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(r),r},stop:function(t){var n=0,r=t?f.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;for(K(l,f.opts.specialEasing);o>s;s++)if(r=Gc[s].call(f,e,l,f.opts))return r;return fb.map(l,I,f),fb.isFunction(f.opts.start)&&f.opts.start.call(e,f),fb.fx.timer(fb.extend(a,{elem:e,anim:f,queue:f.opts.queue})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function K(e,t){var n,r,i,s,o;for(n in e)if(r=fb.camelCase(n),i=t[r],s=e[n],fb.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=fb.cssHooks[r],o&&"expand"in o){s=o.expand(s),delete e[r];for(n in s)n in e||(e[n]=s[n],t[n]=i)}else t[r]=i}function L(e,n,r){var i,s,o,u,a,f,l=this,c={},h=e.style,p=e.nodeType&&t(e),d=qb.get(e,"fxshow");r.queue||(a=fb._queueHooks(e,"fx"),null==a.unqueued&&(a.unqueued=0,f=a.empty.fire,a.empty.fire=function(){a.unqueued||f()}),a.unqueued++,l.always(function(){l.always(function(){a.unqueued--,fb.queue(e,"fx").length||a.empty.fire()})})),1===e.nodeType&&("height"in n||"width"in n)&&(r.overflow=[h.overflow,h.overflowX,h.overflowY],"inline"===fb.css(e,"display")&&"none"===fb.css(e,"float")&&(h.display="inline-block")),r.overflow&&(h.overflow="hidden",l.always(function(){h.overflow=r.overflow[0],h.overflowX=r.overflow[1],h.overflowY=r.overflow[2]}));for(i in n)if(s=n[i],Dc.exec(s)){if(delete n[i],o=o||"toggle"===s,s===(p?"hide":"show")){if("show"!==s||!d||d[i]===b)continue;p=!0}c[i]=d&&d[i]||fb.style(e,i)}if(!fb.isEmptyObject(c)){d?"hidden"in d&&(p=d.hidden):d=qb.access(e,"fxshow",{}),o&&(d.hidden=!p),p?fb(e).show():l.done(function(){fb(e).hide()}),l.done(function(){var t;qb.remove(e,"fxshow");for(t in c)fb.style(e,t,c[t])});for(i in c)u=I(p?d[i]:0,i,l),i in d||(d[i]=u.start,p&&(u.end=u.start,u.start="width"===i||"height"===i?1:0))}}function M(e,t,n,r,i){return new M.prototype.init(e,t,n,r,i)}function N(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=$b[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function O(e){return fb.isWindow(e)?e:9===e.nodeType&&e.defaultView}var P,Q,R=typeof b,S=a.location,T=a.document,U=T.documentElement,V=a.jQuery,W=a.$,X={},Y=[],Z="2.0.3",$=Y.concat,_=Y.push,ab=Y.slice,bb=Y.indexOf,cb=X.toString,db=X.hasOwnProperty,eb=Z.trim,fb=function(e,t){return new fb.fn.init(e,t,P)},gb=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,hb=/\S+/g,ib=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,jb=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,kb=/^-ms-/,lb=/-([\da-z])/gi,mb=function(e,t){return t.toUpperCase()},nb=function(){T.removeEventListener("DOMContentLoaded",nb,!1),a.removeEventListener("load",nb,!1),fb.ready()};fb.fn=fb.prototype={jquery:Z,constructor:fb,init:function(e,t,n){var r,i;if(!e)return this;if("string"==typeof e){if(r="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:ib.exec(e),!r||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof fb?t[0]:t,fb.merge(this,fb.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:T,!0)),jb.test(r[1])&&fb.isPlainObject(t))for(r in t)fb.isFunction(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return i=T.getElementById(r[2]),i&&i.parentNode&&(this.length=1,this[0]=i),this.context=T,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):fb.isFunction(e)?n.ready(e):(e.selector!==b&&(this.selector=e.selector,this.context=e.context),fb.makeArray(e,this))},selector:"",length:0,toArray:function(){return ab.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=fb.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return fb.each(this,e,t)},ready:function(e){return fb.ready.promise().done(e),this},slice:function(){return this.pushStack(ab.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(fb.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:_,sort:[].sort,splice:[].splice},fb.fn.init.prototype=fb.fn,fb.extend=fb.fn.extend=function(){var e,t,n,r,i,s,o=arguments[0]||{},u=1,a=arguments.length,f=!1;for("boolean"==typeof o&&(f=o,o=arguments[1]||{},u=2),"object"==typeof o||fb.isFunction(o)||(o={}),a===u&&(o=this,--u);a>u;u++)if(null!=(e=arguments[u]))for(t in e)n=o[t],r=e[t],o!==r&&(f&&r&&(fb.isPlainObject(r)||(i=fb.isArray(r)))?(i?(i=!1,s=n&&fb.isArray(n)?n:[]):s=n&&fb.isPlainObject(n)?n:{},o[t]=fb.extend(f,s,r)):r!==b&&(o[t]=r));return o},fb.extend({expando:"jQuery"+(Z+Math.random()).replace(/\D/g,""),noConflict:function(e){return a.$===fb&&(a.$=W),e&&a.jQuery===fb&&(a.jQuery=V),fb},isReady:!1,readyWait:1,holdReady:function(e){e?fb.readyWait++:fb.ready(!0)},ready:function(e){(e===!0?--fb.readyWait:fb.isReady)||(fb.isReady=!0,e!==!0&&--fb.readyWait>0||(Q.resolveWith(T,[fb]),fb.fn.trigger&&fb(T).trigger("ready").off("ready")))},isFunction:function(e){return"function"===fb.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?String(e):"object"==typeof e||"function"==typeof e?X[cb.call(e)]||"object":typeof e},isPlainObject:function(e){if("object"!==fb.type(e)||e.nodeType||fb.isWindow(e))return!1;try{if(e.constructor&&!db.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||T;var r=jb.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=fb.buildFragment([e],t,i),i&&fb(i).remove(),fb.merge([],r.childNodes))},parseJSON:JSON.parse,parseXML:function(e){var t,n;if(!e||"string"!=typeof e)return null;try{n=new DOMParser,t=n.parseFromString(e,"text/xml")}catch(r){t=b}return(!t||t.getElementsByTagName("parsererror").length)&&fb.error("Invalid XML: "+e),t},noop:function(){},globalEval:function(a){var b,c=eval;a=fb.trim(a),a&&(1===a.indexOf("use strict")?(b=T.createElement("script"),b.text=a,T.head.appendChild(b).parentNode.removeChild(b)):c(a))},camelCase:function(e){return e.replace(kb,"ms-").replace(lb,mb)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,s=e.length,o=c(e);if(n){if(o)for(;s>i&&(r=t.apply(e[i],n),r!==!1);i++);else for(i in e)if(r=t.apply(e[i],n),r===!1)break}else if(o)for(;s>i&&(r=t.call(e[i],i,e[i]),r!==!1);i++);else for(i in e)if(r=t.call(e[i],i,e[i]),r===!1)break;return e},trim:function(e){return null==e?"":eb.call(e)},makeArray:function(e,t){var n=t||[];return null!=e&&(c(Object(e))?fb.merge(n,"string"==typeof e?[e]:e):_.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:bb.call(t,e,n)},merge:function(e,t){var n=t.length,r=e.length,i=0;if("number"==typeof n)for(;n>i;i++)e[r++]=t[i];else for(;t[i]!==b;)e[r++]=t[i++];return e.length=r,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length;for(n=!!n;o>s;s++)r=!!t(e[s],s),n!==r&&i.push(e[s]);return i},map:function(e,t,n){var r,i=0,s=e.length,o=c(e),u=[];if(o)for(;s>i;i++)r=t(e[i],i,n),null!=r&&(u[u.length]=r);else for(i in e)r=t(e[i],i,n),null!=r&&(u[u.length]=r);return $.apply([],u)},guid:1,proxy:function(e,t){var n,r,i;return"string"==typeof t&&(n=e[t],t=e,e=n),fb.isFunction(e)?(r=ab.call(arguments,2),i=function(){return e.apply(t||this,r.concat(ab.call(arguments)))},i.guid=e.guid=e.guid||fb.guid++,i):b},access:function(e,t,n,r,i,s,o){var u=0,a=e.length,f=null==n;if("object"===fb.type(n)){i=!0;for(u in n)fb.access(e,t,u,n[u],!0,s,o)}else if(r!==b&&(i=!0,fb.isFunction(r)||(o=!0),f&&(o?(t.call(e,r),t=null):(f=t,t=function(e,t,n){return f.call(fb(e),n)})),t))for(;a>u;u++)t(e[u],n,o?r:r.call(e[u],u,t(e[u],n)));return i?e:f?t.call(e):a?t(e[0],n):s},now:Date.now,swap:function(e,t,n,r){var i,s,o={};for(s in t)o[s]=e.style[s],e.style[s]=t[s];i=n.apply(e,r||[]);for(s in t)e.style[s]=o[s];return i}}),fb.ready.promise=function(e){return Q||(Q=fb.Deferred(),"complete"===T.readyState?setTimeout(fb.ready):(T.addEventListener("DOMContentLoaded",nb,!1),a.addEventListener("load",nb,!1))),Q.promise(e)},fb.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){X["[object "+t+"]"]=t.toLowerCase()}),P=fb(T),function(e,t){function n(e,t,n,r){var i,s,o,u,a,f,l,c,d,v;if((t?t.ownerDocument||t:q)!==_&&M(t),t=t||_,n=n||[],!e||"string"!=typeof e)return n;if(1!==(u=t.nodeType)&&9!==u)return[];if(P&&!r){if(i=yt.exec(e))if(o=i[1]){if(9===u){if(s=t.getElementById(o),!s||!s.parentNode)return n;if(s.id===o)return n.push(s),n}else if(t.ownerDocument&&(s=t.ownerDocument.getElementById(o))&&F(t,s)&&s.id===o)return n.push(s),n}else{if(i[2])return et.apply(n,t.getElementsByTagName(e)),n;if((o=i[3])&&x.getElementsByClassName&&t.getElementsByClassName)return et.apply(n,t.getElementsByClassName(o)),n}if(x.qsa&&(!H||!H.test(e))){if(c=l=I,d=t,v=9===u&&e,1===u&&"object"!==t.nodeName.toLowerCase()){for(f=h(e),(l=t.getAttribute("id"))?c=l.replace(Et,"\\$&"):t.setAttribute("id",c),c="[id='"+c+"'] ",a=f.length;a--;)f[a]=c+p(f[a]);d=ht.test(e)&&t.parentNode||t,v=f.join(",")}if(v)try{return et.apply(n,d.querySelectorAll(v)),n}catch(m){}finally{l||t.removeAttribute("id")}}}return E(e.replace(ft,"$1"),t,n,r)}function r(){function e(n,r){return t.push(n+=" ")>N.cacheLength&&delete e[t.shift()],e[n]=r}var t=[];return e}function i(e){return e[I]=!0,e}function s(e){var t=_.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function o(e,t){for(var n=e.split("|"),r=e.length;r--;)N.attrHandle[n[r]]=t}function u(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||K)-(~e.sourceIndex||K);if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function a(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function f(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function l(e){return i(function(t){return t=+t,i(function(n,r){for(var i,s=e([],n.length,t),o=s.length;o--;)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function c(){}function h(e,t){var r,i,s,o,u,a,f,l=W[e+" "];if(l)return t?0:l.slice(0);for(u=e,a=[],f=N.preFilter;u;){(!r||(i=lt.exec(u)))&&(i&&(u=u.slice(i[0].length)||u),a.push(s=[])),r=!1,(i=ct.exec(u))&&(r=i.shift(),s.push({value:r,type:i[0].replace(ft," ")}),u=u.slice(r.length));for(o in N.filter)!(i=mt[o].exec(u))||f[o]&&!(i=f[o](i))||(r=i.shift(),s.push({value:r,type:o,matches:i}),u=u.slice(r.length));if(!r)break}return t?u.length:u?n.error(e):W(e,a).slice(0)}function p(e){for(var t=0,n=e.length,r="";n>t;t++)r+=e[t].value;return r}function d(e,t,n){var r=t.dir,i=n&&"parentNode"===r,s=U++;return t.first?function(t,n,s){for(;t=t[r];)if(1===t.nodeType||i)return e(t,n,s)}:function(t,n,o){var u,a,f,l=R+" "+s;if(o){for(;t=t[r];)if((1===t.nodeType||i)&&e(t,n,o))return!0}else for(;t=t[r];)if(1===t.nodeType||i)if(f=t[I]||(t[I]={}),(a=f[r])&&a[0]===l){if((u=a[1])===!0||u===T)return u===!0}else if(a=f[r]=[l],a[1]=e(t,n,o)||T,a[1]===!0)return!0}}function v(e){return e.length>1?function(t,n,r){for(var i=e.length;i--;)if(!e[i](t,n,r))return!1;return!0}:e[0]}function m(e,t,n,r,i){for(var s,o=[],u=0,a=e.length,f=null!=t;a>u;u++)(s=e[u])&&(!n||n(s,r,i))&&(o.push(s),f&&t.push(u));return o}function g(e,t,n,r,s,o){return r&&!r[I]&&(r=g(r)),s&&!s[I]&&(s=g(s,o)),i(function(i,o,u,a){var f,l,c,h=[],p=[],d=o.length,v=i||w(t||"*",u.nodeType?[u]:u,[]),g=!e||!i&&t?v:m(v,h,e,u,a),y=n?s||(i?e:d||r)?[]:o:g;if(n&&n(g,y,u,a),r)for(f=m(y,p),r(f,[],u,a),l=f.length;l--;)(c=f[l])&&(y[p[l]]=!(g[p[l]]=c));if(i){if(s||e){if(s){for(f=[],l=y.length;l--;)(c=y[l])&&f.push(g[l]=c);s(null,y=[],f,a)}for(l=y.length;l--;)(c=y[l])&&(f=s?nt.call(i,c):h[l])>-1&&(i[f]=!(o[f]=c))}}else y=m(y===o?y.splice(d,y.length):y),s?s(null,o,y,a):et.apply(o,y)})}function y(e){for(var t,n,r,i=e.length,s=N.relative[e[0].type],o=s||N.relative[" "],u=s?1:0,a=d(function(e){return e===t},o,!0),f=d(function(e){return nt.call(t,e)>-1},o,!0),l=[function(e,n,r){return!s&&(r||n!==A)||((t=n).nodeType?a(e,n,r):f(e,n,r))}];i>u;u++)if(n=N.relative[e[u].type])l=[d(v(l),n)];else{if(n=N.filter[e[u].type].apply(null,e[u].matches),n[I]){for(r=++u;i>r&&!N.relative[e[r].type];r++);return g(u>1&&v(l),u>1&&p(e.slice(0,u-1).concat({value:" "===e[u-2].type?"*":""})).replace(ft,"$1"),n,r>u&&y(e.slice(u,r)),i>r&&y(e=e.slice(r)),i>r&&p(e))}l.push(n)}return v(l)}function b(e,t){var r=0,s=t.length>0,o=e.length>0,u=function(i,u,a,f,l){var c,h,p,d=[],v=0,g="0",y=i&&[],b=null!=l,w=A,E=i||o&&N.find.TAG("*",l&&u.parentNode||u),S=R+=null==w?1:Math.random()||.1;for(b&&(A=u!==_&&u,T=r);null!=(c=E[g]);g++){if(o&&c){for(h=0;p=e[h++];)if(p(c,u,a)){f.push(c);break}b&&(R=S,T=++r)}s&&((c=!p&&c)&&v--,i&&y.push(c))}if(v+=g,s&&g!==v){for(h=0;p=t[h++];)p(y,d,u,a);if(i){if(v>0)for(;g--;)y[g]||d[g]||(d[g]=Y.call(f));d=m(d)}et.apply(f,d),b&&!i&&d.length>0&&v+t.length>1&&n.uniqueSort(f)}return b&&(R=S,A=w),y};return s?i(u):u}function w(e,t,r){for(var i=0,s=t.length;s>i;i++)n(e,t[i],r);return r}function E(e,t,n,r){var i,s,o,u,a,f=h(e);if(!r&&1===f.length){if(s=f[0]=f[0].slice(0),s.length>2&&"ID"===(o=s[0]).type&&x.getById&&9===t.nodeType&&P&&N.relative[s[1].type]){if(t=(N.find.ID(o.matches[0].replace(St,xt),t)||[])[0],!t)return n;e=e.slice(s.shift().value.length)}for(i=mt.needsContext.test(e)?0:s.length;i--&&(o=s[i],!N.relative[u=o.type]);)if((a=N.find[u])&&(r=a(o.matches[0].replace(St,xt),ht.test(s[0].type)&&t.parentNode||t))){if(s.splice(i,1),e=r.length&&p(s),!e)return et.apply(n,r),n;break}}return L(e,f)(r,t,!P,n,ht.test(e)),n}var S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I="sizzle"+ -(new Date),q=e.document,R=0,U=0,z=r(),W=r(),X=r(),V=!1,$=function(e,t){return e===t?(V=!0,0):0},J=typeof t,K=1<<31,Q={}.hasOwnProperty,G=[],Y=G.pop,Z=G.push,et=G.push,tt=G.slice,nt=G.indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(this[t]===e)return t;return-1},rt="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",it="[\\x20\\t\\r\\n\\f]",st="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ot=st.replace("w","w#"),ut="\\["+it+"*("+st+")"+it+"*(?:([*^$|!~]?=)"+it+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+ot+")|)|)"+it+"*\\]",at=":("+st+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+ut.replace(3,8)+")*)|.*)\\)|)",ft=new RegExp("^"+it+"+|((?:^|[^\\\\])(?:\\\\.)*)"+it+"+$","g"),lt=new RegExp("^"+it+"*,"+it+"*"),ct=new RegExp("^"+it+"*([>+~]|"+it+")"+it+"*"),ht=new RegExp(it+"*[+~]"),pt=new RegExp("="+it+"*([^\\]'\"]*)"+it+"*\\]","g"),dt=new RegExp(at),vt=new RegExp("^"+ot+"$"),mt={ID:new RegExp("^#("+st+")"),CLASS:new RegExp("^\\.("+st+")"),TAG:new RegExp("^("+st.replace("w","w*")+")"),ATTR:new RegExp("^"+ut),PSEUDO:new RegExp("^"+at),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+it+"*(even|odd|(([+-]|)(\\d*)n|)"+it+"*(?:([+-]|)"+it+"*(\\d+)|))"+it+"*\\)|)","i"),bool:new RegExp("^(?:"+rt+")$","i"),needsContext:new RegExp("^"+it+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+it+"*((?:-\\d)?\\d*)"+it+"*\\)|)(?=[^-]|$)","i")},gt=/^[^{]+\{\s*\[native \w/,yt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,bt=/^(?:input|select|textarea|button)$/i,wt=/^h\d$/i,Et=/'|\\/g,St=new RegExp("\\\\([\\da-f]{1,6}"+it+"?|("+it+")|.)","ig"),xt=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:0>r?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)};try{et.apply(G=tt.call(q.childNodes),q.childNodes),G[q.childNodes.length].nodeType}catch(Tt){et={apply:G.length?function(e,t){Z.apply(e,tt.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}k=n.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},x=n.support={},M=n.setDocument=function(e){var t=e?e.ownerDocument||e:q,n=t.defaultView;return t!==_&&9===t.nodeType&&t.documentElement?(_=t,D=t.documentElement,P=!k(t),n&&n.attachEvent&&n!==n.top&&n.attachEvent("onbeforeunload",function(){M()}),x.attributes=s(function(e){return e.className="i",!e.getAttribute("className")}),x.getElementsByTagName=s(function(e){return e.appendChild(t.createComment("")),!e.getElementsByTagName("*").length}),x.getElementsByClassName=s(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),x.getById=s(function(e){return D.appendChild(e).id=I,!t.getElementsByName||!t.getElementsByName(I).length}),x.getById?(N.find.ID=function(e,t){if(typeof t.getElementById!==J&&P){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},N.filter.ID=function(e){var t=e.replace(St,xt);return function(e){return e.getAttribute("id")===t}}):(delete N.find.ID,N.filter.ID=function(e){var t=e.replace(St,xt);return function(e){var n=typeof e.getAttributeNode!==J&&e.getAttributeNode("id");return n&&n.value===t}}),N.find.TAG=x.getElementsByTagName?function(e,t){return typeof t.getElementsByTagName!==J?t.getElementsByTagName(e):void 0}:function(e,t){var n,r=[],i=0,s=t.getElementsByTagName(e);if("*"===e){for(;n=s[i++];)1===n.nodeType&&r.push(n);return r}return s},N.find.CLASS=x.getElementsByClassName&&function(e,t){return typeof t.getElementsByClassName!==J&&P?t.getElementsByClassName(e):void 0},B=[],H=[],(x.qsa=gt.test(t.querySelectorAll))&&(s(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||H.push("\\["+it+"*(?:value|"+rt+")"),e.querySelectorAll(":checked").length||H.push(":checked")}),s(function(e){var n=t.createElement("input");n.setAttribute("type","hidden"),e.appendChild(n).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&H.push("[*^$]="+it+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||H.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),H.push(",.*:")})),(x.matchesSelector=gt.test(j=D.webkitMatchesSelector||D.mozMatchesSelector||D.oMatchesSelector||D.msMatchesSelector))&&s(function(e){x.disconnectedMatch=j.call(e,"div"),j.call(e,"[s!='']:x"),B.push("!=",at)}),H=H.length&&new RegExp(H.join("|")),B=B.length&&new RegExp(B.join("|")),F=gt.test(D.contains)||D.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},$=D.compareDocumentPosition?function(e,n){if(e===n)return V=!0,0;var r=n.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(n);return r?1&r||!x.sortDetached&&n.compareDocumentPosition(e)===r?e===t||F(q,e)?-1:n===t||F(q,n)?1:O?nt.call(O,e)-nt.call(O,n):0:4&r?-1:1:e.compareDocumentPosition?-1:1}:function(e,n){var r,i=0,s=e.parentNode,o=n.parentNode,a=[e],f=[n];if(e===n)return V=!0,0;if(!s||!o)return e===t?-1:n===t?1:s?-1:o?1:O?nt.call(O,e)-nt.call(O,n):0;if(s===o)return u(e,n);for(r=e;r=r.parentNode;)a.unshift(r);for(r=n;r=r.parentNode;)f.unshift(r);for(;a[i]===f[i];)i++;return i?u(a[i],f[i]):a[i]===q?-1:f[i]===q?1:0},t):_},n.matches=function(e,t){return n(e,null,null,t)},n.matchesSelector=function(e,t){if((e.ownerDocument||e)!==_&&M(e),t=t.replace(pt,"='$1']"),!(!x.matchesSelector||!P||B&&B.test(t)||H&&H.test(t)))try{var r=j.call(e,t);if(r||x.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(i){}return n(t,_,null,[e]).length>0},n.contains=function(e,t){return(e.ownerDocument||e)!==_&&M(e),F(e,t)},n.attr=function(e,n){(e.ownerDocument||e)!==_&&M(e);var r=N.attrHandle[n.toLowerCase()],i=r&&Q.call(N.attrHandle,n.toLowerCase())?r(e,n,!P):t;return i===t?x.attributes||!P?e.getAttribute(n):(i=e.getAttributeNode(n))&&i.specified?i.value:null:i},n.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},n.uniqueSort=function(e){var t,n=[],r=0,i=0;if(V=!x.detectDuplicates,O=!x.sortStable&&e.slice(0),e.sort($),V){for(;t=e[i++];)t===e[i]&&(r=n.push(i));for(;r--;)e.splice(n[r],1)}return e},C=n.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=C(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=C(t);return n},N=n.selectors={cacheLength:50,createPseudo:i,match:mt,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(St,xt),e[3]=(e[4]||e[5]||"").replace(St,xt),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||n.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&n.error(e[0]),e},PSEUDO:function(e){var n,r=!e[5]&&e[2];return mt.CHILD.test(e[0])?null:(e[3]&&e[4]!==t?e[2]=e[4]:r&&dt.test(r)&&(n=h(r,!0))&&(n=r.indexOf(")",r.length-n)-r.length)&&(e[0]=e[0].slice(0,n),e[2]=r.slice(0,n)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(St,xt).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=z[e+" "];return t||(t=new RegExp("(^|"+it+")"+e+"("+it+"|$)"))&&z(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==J&&e.getAttribute("class")||"")})},ATTR:function(e,t,r){return function(i){var s=n.attr(i,e);return null==s?"!="===t:t?(s+="","="===t?s===r:"!="===t?s!==r:"^="===t?r&&0===s.indexOf(r):"*="===t?r&&s.indexOf(r)>-1:"$="===t?r&&s.slice(-r.length)===r:"~="===t?(" "+s+" ").indexOf(r)>-1:"|="===t?s===r||s.slice(0,r.length+1)===r+"-":!1):!0}},CHILD:function(e,t,n,r,i){var s="nth"!==e.slice(0,3),o="last"!==e.slice(-4),u="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,a){var f,l,c,h,p,d,v=s!==o?"nextSibling":"previousSibling",m=t.parentNode,g=u&&t.nodeName.toLowerCase(),y=!a&&!u;if(m){if(s){for(;v;){for(c=t;c=c[v];)if(u?c.nodeName.toLowerCase()===g:1===c.nodeType)return!1;d=v="only"===e&&!d&&"nextSibling"}return!0}if(d=[o?m.firstChild:m.lastChild],o&&y){for(l=m[I]||(m[I]={}),f=l[e]||[],p=f[0]===R&&f[1],h=f[0]===R&&f[2],c=p&&m.childNodes[p];c=++p&&c&&c[v]||(h=p=0)||d.pop();)if(1===c.nodeType&&++h&&c===t){l[e]=[R,p,h];break}}else if(y&&(f=(t[I]||(t[I]={}))[e])&&f[0]===R)h=f[1];else for(;(c=++p&&c&&c[v]||(h=p=0)||d.pop())&&((u?c.nodeName.toLowerCase()!==g:1!==c.nodeType)||!++h||(y&&((c[I]||(c[I]={}))[e]=[R,h]),c!==t)););return h-=i,h===r||h%r===0&&h/r>=0}}},PSEUDO:function(e,t){var r,s=N.pseudos[e]||N.setFilters[e.toLowerCase()]||n.error("unsupported pseudo: "+e);return s[I]?s(t):s.length>1?(r=[e,e,"",t],N.setFilters.hasOwnProperty(e.toLowerCase())?i(function(e,n){for(var r,i=s(e,t),o=i.length;o--;)r=nt.call(e,i[o]),e[r]=!(n[r]=i[o])}):function(e){return s(e,0,r)}):s}},pseudos:{not:i(function(e){var t=[],n=[],r=L(e.replace(ft,"$1"));return r[I]?i(function(e,t,n,i){for(var s,o=r(e,null,i,[]),u=e.length;u--;)(s=o[u])&&(e[u]=!(t[u]=s))}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:i(function(e){return function(t){return n(e,t).length>0}}),contains:i(function(e){return function(t){return(t.textContent||t.innerText||C(t)).indexOf(e)>-1}}),lang:i(function(e){return vt.test(e||"")||n.error("unsupported lang: "+e),e=e.replace(St,xt).toLowerCase(),function(t){var n;do if(n=P?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===D},focus:function(e){return e===_.activeElement&&(!_.hasFocus||_.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!N.pseudos.empty(e)},header:function(e){return wt.test(e.nodeName)},input:function(e){return bt.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:l(function(){return[0]}),last:l(function(e,t){return[t-1]}),eq:l(function(e,t,n){return[0>n?n+t:n]}),even:l(function(e,t){for(var n=0;t>n;n+=2)e.push(n);return e}),odd:l(function(e,t){for(var n=1;t>n;n+=2)e.push(n);return e}),lt:l(function(e,t,n){for(var r=0>n?n+t:n;--r>=0;)e.push(r);return e}),gt:l(function(e,t,n){for(var r=0>n?n+t:n;++r<t;)e.push(r);return e})}},N.pseudos.nth=N.pseudos.eq;for(S in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})N.pseudos[S]=a(S);for(S in{submit:!0,reset:!0})N.pseudos[S]=f(S);c.prototype=N.filters=N.pseudos,N.setFilters=new c,L=n.compile=function(e,t){var n,r=[],i=[],s=X[e+" "];if(!s){for(t||(t=h(e)),n=t.length;n--;)s=y(t[n]),s[I]?r.push(s):i.push(s);s=X(e,b(i,r))}return s},x.sortStable=I.split("").sort($).join("")===I,x.detectDuplicates=V,M(),x.sortDetached=s(function(e){return 1&e.compareDocumentPosition(_.createElement("div"))}),s(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||o("type|href|height|width",function(e,t,n){return n?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),x.attributes&&s(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||o("value",function(e,t,n){return n||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),s(function(e){return null==e.getAttribute("disabled")})||o(rt,function(e,t,n){var r;return n?void 0:(r=e.getAttributeNode(t))&&r.specified?r.value:e[t]===!0?t.toLowerCase():null}),fb.find=n,fb.expr=n.selectors,fb.expr[":"]=fb.expr.pseudos,fb.unique=n.uniqueSort,fb.text=n.getText,fb.isXMLDoc=n.isXML,fb.contains=n.contains}(a);var ob={};fb.Callbacks=function(e){e="string"==typeof e?ob[e]||d(e):fb.extend({},e);var t,n,r,i,s,o,u=[],a=!e.once&&[],f=function(p){for(t=e.memory&&p,n=!0,o=i||0,i=0,s=u.length,r=!0;u&&s>o;o++)if(u[o].apply(p[0],p[1])===!1&&e.stopOnFalse){t=!1;break}r=!1,u&&(a?a.length&&f(a.shift()):t?u=[]:l.disable())},l={add:function(){if(u){var n=u.length;!function o(t){fb.each(t,function(t,n){var r=fb.type(n);"function"===r?e.unique&&l.has(n)||u.push(n):n&&n.length&&"string"!==r&&o(n)})}(arguments),r?s=u.length:t&&(i=n,f(t))}return this},remove:function(){return u&&fb.each(arguments,function(e,t){for(var n;(n=fb.inArray(t,u,n))>-1;)u.splice(n,1),r&&(s>=n&&s--,o>=n&&o--)}),this},has:function(e){return e?fb.inArray(e,u)>-1:!(!u||!u.length)},empty:function(){return u=[],s=0,this},disable:function(){return u=a=t=b,this},disabled:function(){return!u},lock:function(){return a=b,t||l.disable(),this},locked:function(){return!a},fireWith:function(e,t){return!u||n&&!a||(t=t||[],t=[e,t.slice?t.slice():t],r?a.push(t):f(t)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!n}};return l},fb.extend({Deferred:function(e){var t=[["resolve","done",fb.Callbacks("once memory"),"resolved"],["reject","fail",fb.Callbacks("once memory"),"rejected"],["notify","progress",fb.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return fb.Deferred(function(n){fb.each(t,function(t,s){var o=s[0],u=fb.isFunction(e[t])&&e[t];i[s[1]](function(){var e=u&&u.apply(this,arguments);e&&fb.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[o+"With"](this===r?n.promise():this,u?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?fb.extend(e,r):r}},i={};return r.pipe=r.then,fb.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[1^e][2].disable,t[2][2].lock),i[s[0]]=function(){return i[s[0]+"With"](this===i?r:this,arguments),this},i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t,n,r,i=0,s=ab.call(arguments),o=s.length,u=1!==o||e&&fb.isFunction(e.promise)?o:0,a=1===u?e:fb.Deferred(),f=function(e,n,r){return function(i){n[e]=this,r[e]=arguments.length>1?ab.call(arguments):i,r===t?a.notifyWith(n,r):--u||a.resolveWith(n,r)}};if(o>1)for(t=new Array(o),n=new Array(o),r=new Array(o);o>i;i++)s[i]&&fb.isFunction(s[i].promise)?s[i].promise().done(f(i,r,s)).fail(a.reject).progress(f(i,n,t)):--u;return u||a.resolveWith(r,s),a.promise()}}),fb.support=function(e){var t=T.createElement("input"),n=T.createDocumentFragment(),r=T.createElement("div"),i=T.createElement("select"),s=i.appendChild(T.createElement("option"));return t.type?(t.type="checkbox",e.checkOn=""!==t.value,e.optSelected=s.selected,e.reliableMarginRight=!0,e.boxSizingReliable=!0,e.pixelPosition=!1,t.checked=!0,e.noCloneChecked=t.cloneNode(!0).checked,i.disabled=!0,e.optDisabled=!s.disabled,t=T.createElement("input"),t.value="t",t.type="radio",e.radioValue="t"===t.value,t.setAttribute("checked","t"),t.setAttribute("name","t"),n.appendChild(t),e.checkClone=n.cloneNode(!0).cloneNode(!0).lastChild.checked,e.focusinBubbles="onfocusin"in a,r.style.backgroundClip="content-box",r.cloneNode(!0).style.backgroundClip="",e.clearCloneStyle="content-box"===r.style.backgroundClip,fb(function(){var t,n,i="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",s=T.getElementsByTagName("body")[0];s&&(t=T.createElement("div"),t.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",s.appendChild(t).appendChild(r),r.innerHTML="",r.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",fb.swap(s,null!=s.style.zoom?{zoom:1}:{},function(){e.boxSizing=4===r.offsetWidth}),a.getComputedStyle&&(e.pixelPosition="1%"!==(a.getComputedStyle(r,null)||{}).top,e.boxSizingReliable="4px"===(a.getComputedStyle(r,null)||{width:"4px"}).width,n=r.appendChild(T.createElement("div")),n.style.cssText=r.style.cssText=i,n.style.marginRight=n.style.width="0",r.style.width="1px",e.reliableMarginRight=!parseFloat((a.getComputedStyle(n,null)||{}).marginRight)),s.removeChild(t))}),e):e}({});var pb,qb,rb=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,sb=/([A-Z])/g;e.uid=1,e.accepts=function(e){return e.nodeType?1===e.nodeType||9===e.nodeType:!0},e.prototype={key:function(t){if(!e.accepts(t))return 0;var n={},r=t[this.expando];if(!r){r=e.uid++;try{n[this.expando]={value:r},Object.defineProperties(t,n)}catch(i){n[this.expando]=r,fb.extend(t,n)}}return this.cache[r]||(this.cache[r]={}),r},set:function(e,t,n){var r,i=this.key(e),s=this.cache[i];if("string"==typeof t)s[t]=n;else if(fb.isEmptyObject(s))fb.extend(this.cache[i],t);else for(r in t)s[r]=t[r];return s},get:function(e,t){var n=this.cache[this.key(e)];return t===b?n:n[t]},access:function(e,t,n){var r;return t===b||t&&"string"==typeof t&&n===b?(r=this.get(e,t),r!==b?r:this.get(e,fb.camelCase(t))):(this.set(e,t,n),n!==b?n:t)},remove:function(e,t){var n,r,i,s=this.key(e),o=this.cache[s];if(t===b)this.cache[s]={};else{fb.isArray(t)?r=t.concat(t.map(fb.camelCase)):(i=fb.camelCase(t),t in o?r=[t,i]:(r=i,r=r in o?[r]:r.match(hb)||[])),n=r.length;for(;n--;)delete o[r[n]]}},hasData:function(e){return!fb.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}},pb=new e,qb=new e,fb.extend({acceptData:e.accepts,hasData:function(e){return pb.hasData(e)||qb.hasData(e)},data:function(e,t,n){return pb.access(e,t,n)},removeData:function(e,t){pb.remove(e,t)},_data:function(e,t,n){return qb.access(e,t,n)},_removeData:function(e,t){qb.remove(e,t)}}),fb.fn.extend({data:function(e,t){var n,r,i=this[0],s=0,o=null;if(e===b){if(this.length&&(o=pb.get(i),1===i.nodeType&&!qb.get(i,"hasDataAttrs"))){for(n=i.attributes;s<n.length;s++)r=n[s].name,0===r.indexOf("data-")&&(r=fb.camelCase(r.slice(5)),f(i,r,o[r]));qb.set(i,"hasDataAttrs",!0)}return o}return"object"==typeof e?this.each(function(){pb.set(this,e)}):fb.access(this,function(t){var n,r=fb.camelCase(e);if(i&&t===b){if(n=pb.get(i,e),n!==b)return n;if(n=pb.get(i,r),n!==b)return n;if(n=f(i,r,b),n!==b)return n}else this.each(function(){var n=pb.get(this,r);pb.set(this,r,t),-1!==e.indexOf("-")&&n!==b&&pb.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){pb.remove(this,e)})}}),fb.extend({queue:function(e,t,n){var r;return e?(t=(t||"fx")+"queue",r=qb.get(e,t),n&&(!r||fb.isArray(n)?r=qb.access(e,t,fb.makeArray(n)):r.push(n)),r||[]):void 0},dequeue:function(e,t){t=t||"fx";var n=fb.queue(e,t),r=n.length,i=n.shift(),s=fb._queueHooks(e,t),o=function(){fb.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return qb.get(e,n)||qb.access(e,n,{empty:fb.Callbacks("once memory").add(function(){qb.remove(e,[t+"queue",n])})})}}),fb.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?fb.queue(this[0],e):t===b?this:this.each(function(){var n=fb.queue(this,e,t);fb._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&fb.dequeue(this,e)})},dequeue:function(e){return this.each(function(){fb.dequeue(this,e)})},delay:function(e,t){return e=fb.fx?fb.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=fb.Deferred(),s=this,o=this.length,u=function(){--r||i.resolveWith(s,[s])};for("string"!=typeof e&&(t=e,e=b),e=e||"fx";o--;)n=qb.get(s[o],e+"queueHooks"),n&&n.empty&&(r++,n.empty.add(u));return u(),i.promise(t)}});var tb,ub,vb=/[\t\r\n\f]/g,wb=/\r/g,xb=/^(?:input|select|textarea|button)$/i;fb.fn.extend({attr:function(e,t){return fb.access(this,fb.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){fb.removeAttr(this,e)})},prop:function(e,t){return fb.access(this,fb.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[fb.propFix[e]||e]})},addClass:function(e){var t,n,r,i,s,o=0,u=this.length,a="string"==typeof e&&e;if(fb.isFunction(e))return this.each(function(t){fb(this).addClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(hb)||[];u>o;o++)if(n=this[o],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(vb," "):" ")){for(s=0;i=t[s++];)r.indexOf(" "+i+" ")<0&&(r+=i+" ");n.className=fb.trim(r)}return this},removeClass:function(e){var t,n,r,i,s,o=0,u=this.length,a=0===arguments.length||"string"==typeof e&&e;if(fb.isFunction(e))return this.each(function(t){fb(this).removeClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(hb)||[];u>o;o++)if(n=this[o],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(vb," "):"")){for(s=0;i=t[s++];)for(;r.indexOf(" "+i+" ")>=0;)r=r.replace(" "+i+" "," ");n.className=e?fb.trim(r):""}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):fb.isFunction(e)?this.each(function(n){fb(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n)for(var t,r=0,i=fb(this),s=e.match(hb)||[];t=s[r++];)i.hasClass(t)?i.removeClass(t):i.addClass(t);else(n===R||"boolean"===n)&&(this.className&&qb.set(this,"__className__",this.className),this.className=this.className||e===!1?"":qb.get(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",n=0,r=this.length;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(vb," ").indexOf(t)>=0)return!0;return!1},val:function(e){var t,n,r,i=this[0];{if(arguments.length)return r=fb.isFunction(e),this.each(function(n){var i;1===this.nodeType&&(i=r?e.call(this,n,fb(this).val()):e,null==i?i="":"number"==typeof i?i+="":fb.isArray(i)&&(i=fb.map(i,function(e){return null==e?"":e+""})),t=fb.valHooks[this.type]||fb.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&t.set(this,i,"value")!==b||(this.value=i))});if(i)return t=fb.valHooks[i.type]||fb.valHooks[i.nodeName.toLowerCase()],t&&"get"in t&&(n=t.get(i,"value"))!==b?n:(n=i.value,"string"==typeof n?n.replace(wb,""):null==n?"":n)}}}),fb.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){for(var t,n,r=e.options,i=e.selectedIndex,s="select-one"===e.type||0>i,o=s?null:[],u=s?i+1:r.length,a=0>i?u:s?i:0;u>a;a++)if(n=r[a],!(!n.selected&&a!==i||(fb.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&fb.nodeName(n.parentNode,"optgroup"))){if(t=fb(n).val(),s)return t;o.push(t)}return o},set:function(e,t){for(var n,r,i=e.options,s=fb.makeArray(t),o=i.length;o--;)r=i[o],(r.selected=fb.inArray(fb(r).val(),s)>=0)&&(n=!0);return n||(e.selectedIndex=-1),s}}},attr:function(e,t,n){var r,i,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return typeof e.getAttribute===R?fb.prop(e,t,n):(1===s&&fb.isXMLDoc(e)||(t=t.toLowerCase(),r=fb.attrHooks[t]||(fb.expr.match.bool.test(t)?ub:tb)),n===b?r&&"get"in r&&null!==(i=r.get(e,t))?i:(i=fb.find.attr(e,t),null==i?b:i):null!==n?r&&"set"in r&&(i=r.set(e,n,t))!==b?i:(e.setAttribute(t,n+""),n):(fb.removeAttr(e,t),void 0))},removeAttr:function(e,t){var n,r,i=0,s=t&&t.match(hb);if(s&&1===e.nodeType)for(;n=s[i++];)r=fb.propFix[n]||n,fb.expr.match.bool.test(n)&&(e[r]=!1),e.removeAttribute(n)},attrHooks:{type:{set:function(e,t){if(!fb.support.radioValue&&"radio"===t&&fb.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,n){var r,i,s,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return s=1!==o||!fb.isXMLDoc(e),s&&(t=fb.propFix[t]||t,i=fb.propHooks[t]),n!==b?i&&"set"in i&&(r=i.set(e,n,t))!==b?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||xb.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),ub={set:function(e,t,n){return t===!1?fb.removeAttr(e,n):e.setAttribute(n,n),n}},fb.each(fb.expr.match.bool.source.match(/\w+/g),function(e,t){var n=fb.expr.attrHandle[t]||fb.find.attr;fb.expr.attrHandle[t]=function(e,t,r){var i=fb.expr.attrHandle[t],s=r?b:(fb.expr.attrHandle[t]=b)!=n(e,t,r)?t.toLowerCase():null;return fb.expr.attrHandle[t]=i,s}}),fb.support.optSelected||(fb.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),fb.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){fb.propFix[this.toLowerCase()]=this}),fb.each(["radio","checkbox"],function(){fb.valHooks[this]={set:function(e,t){return fb.isArray(t)?e.checked=fb.inArray(fb(e).val(),t)>=0:void 0}},fb.support.checkOn||(fb.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var yb=/^key/,zb=/^(?:mouse|contextmenu)|click/,Ab=/^(?:focusinfocus|focusoutblur)$/,Bb=/^([^.]*)(?:\.(.+)|)$/;fb.event={global:{},add:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m=qb.get(e);if(m){for(n.handler&&(s=n,n=s.handler,i=s.selector),n.guid||(n.guid=fb.guid++),(a=m.events)||(a=m.events={}),(o=m.handle)||(o=m.handle=function(e){return typeof fb===R||e&&fb.event.triggered===e.type?b:fb.event.dispatch.apply(o.elem,arguments)},o.elem=e),t=(t||"").match(hb)||[""],f=t.length;f--;)u=Bb.exec(t[f])||[],p=v=u[1],d=(u[2]||"").split(".").sort(),p&&(c=fb.event.special[p]||{},p=(i?c.delegateType:c.bindType)||p,c=fb.event.special[p]||{},l=fb.extend({type:p,origType:v,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&fb.expr.match.needsContext.test(i),namespace:d.join(".")},s),(h=a[p])||(h=a[p]=[],h.delegateCount=0,c.setup&&c.setup.call(e,r,d,o)!==!1||e.addEventListener&&e.addEventListener(p,o,!1)),c.add&&(c.add.call(e,l),l.handler.guid||(l.handler.guid=n.guid)),i?h.splice(h.delegateCount++,0,l):h.push(l),fb.event.global[p]=!0);e=null}},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m=qb.hasData(e)&&qb.get(e);if(m&&(a=m.events)){for(t=(t||"").match(hb)||[""],f=t.length;f--;)if(u=Bb.exec(t[f])||[],p=v=u[1],d=(u[2]||"").split(".").sort(),p){for(c=fb.event.special[p]||{},p=(r?c.delegateType:c.bindType)||p,h=a[p]||[],u=u[2]&&new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=s=h.length;s--;)l=h[s],!i&&v!==l.origType||n&&n.guid!==l.guid||u&&!u.test(l.namespace)||r&&r!==l.selector&&("**"!==r||!l.selector)||(h.splice(s,1),l.selector&&h.delegateCount--,c.remove&&c.remove.call(e,l));o&&!h.length&&(c.teardown&&c.teardown.call(e,d,m.handle)!==!1||fb.removeEvent(e,p,m.handle),delete a[p])}else for(p in a)fb.event.remove(e,p+t[f],n,r,!0);fb.isEmptyObject(a)&&(delete m.handle,qb.remove(e,"events"))}},trigger:function(e,t,n,r){var i,s,o,u,f,l,c,h=[n||T],p=db.call(e,"type")?e.type:e,d=db.call(e,"namespace")?e.namespace.split("."):[];if(s=o=n=n||T,3!==n.nodeType&&8!==n.nodeType&&!Ab.test(p+fb.event.triggered)&&(p.indexOf(".")>=0&&(d=p.split("."),p=d.shift(),d.sort()),f=p.indexOf(":")<0&&"on"+p,e=e[fb.expando]?e:new fb.Event(p,"object"==typeof e&&e),e.isTrigger=r?2:3,e.namespace=d.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=b,e.target||(e.target=n),t=null==t?[e]:fb.makeArray(t,[e]),c=fb.event.special[p]||{},r||!c.trigger||c.trigger.apply(n,t)!==!1)){if(!r&&!c.noBubble&&!fb.isWindow(n)){for(u=c.delegateType||p,Ab.test(u+p)||(s=s.parentNode);s;s=s.parentNode)h.push(s),o=s;o===(n.ownerDocument||T)&&h.push(o.defaultView||o.parentWindow||a)}for(i=0;(s=h[i++])&&!e.isPropagationStopped();)e.type=i>1?u:c.bindType||p,l=(qb.get(s,"events")||{})[e.type]&&qb.get(s,"handle"),l&&l.apply(s,t),l=f&&s[f],l&&fb.acceptData(s)&&l.apply&&l.apply(s,t)===!1&&e.preventDefault();return e.type=p,r||e.isDefaultPrevented()||c._default&&c._default.apply(h.pop(),t)!==!1||!fb.acceptData(n)||f&&fb.isFunction(n[p])&&!fb.isWindow(n)&&(o=n[f],o&&(n[f]=null),fb.event.triggered=p,n[p](),fb.event.triggered=b,o&&(n[f]=o)),e.result}},dispatch:function(e){e=fb.event.fix(e);var t,n,r,i,s,o=[],u=ab.call(arguments),a=(qb.get(this,"events")||{})[e.type]||[],f=fb.event.special[e.type]||{};if(u[0]=e,e.delegateTarget=this,!f.preDispatch||f.preDispatch.call(this,e)!==!1){for(o=fb.event.handlers.call(this,e,a),t=0;(i=o[t++])&&!e.isPropagationStopped();)for(e.currentTarget=i.elem,n=0;(s=i.handlers[n++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(s.namespace))&&(e.handleObj=s,e.data=s.data,r=((fb.event.special[s.origType]||{}).handle||s.handler).apply(i.elem,u),r!==b&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()));return f.postDispatch&&f.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,r,i,s,o=[],u=t.delegateCount,a=e.target;if(u&&a.nodeType&&(!e.button||"click"!==e.type))for(;a!==this;a=a.parentNode||this)if(a.disabled!==!0||"click"!==e.type){for(r=[],n=0;u>n;n++)s=t[n],i=s.selector+" ",r[i]===b&&(r[i]=s.needsContext?fb(i,this).index(a)>=0:fb.find(i,this,null,[a]).length),r[i]&&r.push(s);r.length&&o.push({elem:a,handlers:r})}return u<t.length&&o.push({elem:this,handlers:t.slice(u)}),o},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,i,s=t.button;return null==e.pageX&&null!=t.clientX&&(n=e.target.ownerDocument||T,r=n.documentElement,i=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),e.which||s===b||(e.which=1&s?1:2&s?3:4&s?2:0),e}},fix:function(e){if(e[fb.expando])return e;var t,n,r,i=e.type,s=e,o=this.fixHooks[i];for(o||(this.fixHooks[i]=o=zb.test(i)?this.mouseHooks:yb.test(i)?this.keyHooks:{}),r=o.props?this.props.concat(o.props):this.props,e=new fb.Event(s),t=r.length;t--;)n=r[t],e[n]=s[n];return e.target||(e.target=T),3===e.target.nodeType&&(e.target=e.target.parentNode),o.filter?o.filter(e,s):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==i()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===i()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&fb.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(e){return fb.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==b&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=fb.extend(new fb.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?fb.event.trigger(i,null,t):fb.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},fb.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},fb.Event=function(e,t){return this instanceof fb.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.getPreventDefault&&e.getPreventDefault()?g:h):this.type=e,t&&fb.extend(this,t),this.timeStamp=e&&e.timeStamp||fb.now(),this[fb.expando]=!0,void 0):new fb.Event(e,t)},fb.Event.prototype={isDefaultPrevented:h,isPropagationStopped:h,isImmediatePropagationStopped:h,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=g,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=g,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=g,this.stopPropagation()}},fb.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){fb.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj;return(!i||i!==r&&!fb.contains(r,i))&&(e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t),n}}}),fb.support.focusinBubbles||fb.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){fb.event.simulate(t,e.target,fb.event.fix(e),!0)};fb.event.special[t]={setup:function(){0===n++&&T.addEventListener(e,r,!0)},teardown:function(){0===--n&&T.removeEventListener(e,r,!0)}}}),fb.fn.extend({on:function(e,t,n,r,i){var s,o;if("object"==typeof e){"string"!=typeof t&&(n=n||t,t=b);for(o in e)this.on(o,t,n,e[o],i);return this}if(null==n&&null==r?(r=t,n=t=b):null==r&&("string"==typeof t?(r=n,n=b):(r=n,n=t,t=b)),r===!1)r=h;else if(!r)return this;return 1===i&&(s=r,r=function(e){return fb().off(e),s.apply(this,arguments)},r.guid=s.guid||(s.guid=fb.guid++)),this.each(function(){fb.event.add(this,e,r,n,t)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,fb(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return(t===!1||"function"==typeof t)&&(n=t,t=b),n===!1&&(n=h),this.each(function(){fb.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){fb.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?fb.event.trigger(e,t,n,!0):void 0}});var Cb=/^.[^:#\[\.,]*$/,Db=/^(?:parents|prev(?:Until|All))/,Eb=fb.expr.match.needsContext,Fb={children:!0,contents:!0,next:!0,prev:!0};fb.fn.extend({find:function(e){var t,n=[],r=this,i=r.length;if("string"!=typeof e)return this.pushStack(fb(e).filter(function(){for(t=0;i>t;t++)if(fb.contains(r[t],this))return!0}));for(t=0;i>t;t++)fb.find(e,r[t],n);return n=this.pushStack(i>1?fb.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},has:function(e){var t=fb(e,this),n=t.length;return this.filter(function(){for(var e=0;n>e;e++)if(fb.contains(this,t[e]))return!0})},not:function(e){return this.pushStack(k(this,e||[],!0))},filter:function(e){return this.pushStack(k(this,e||[],!1))},is:function(e){return!!k(this,"string"==typeof e&&Eb.test(e)?fb(e):e||[],!1).length},closest:function(e,t){for(var n,r=0,i=this.length,s=[],o=Eb.test(e)||"string"!=typeof e?fb(e,t||this.context):0;i>r;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(o?o.index(n)>-1:1===n.nodeType&&fb.find.matchesSelector(n,e))){n=s.push(n);break}return this.pushStack(s.length>1?fb.unique(s):s)},index:function(e){return e?"string"==typeof e?bb.call(fb(e),this[0]):bb.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?fb(e,t):fb.makeArray(e&&e.nodeType?[e]:e),r=fb.merge(this.get(),n);return this.pushStack(fb.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),fb.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return fb.dir(e,"parentNode")},parentsUntil:function(e,t,n){return fb.dir(e,"parentNode",n)},next:function(e){return j(e,"nextSibling")},prev:function(e){return j(e,"previousSibling")},nextAll:function(e){return fb.dir(e,"nextSibling")},prevAll:function(e){return fb.dir(e,"previousSibling")},nextUntil:function(e,t,n){return fb.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return fb.dir(e,"previousSibling",n)},siblings:function(e){return fb.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return fb.sibling(e.firstChild)},contents:function(e){return e.contentDocument||fb.merge([],e.childNodes)}},function(e,t){fb.fn[e]=function(n,r){var i=fb.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=fb.filter(r,i)),this.length>1&&(Fb[e]||fb.unique(i),Db.test(e)&&i.reverse()),this.pushStack(i)}}),fb.extend({filter:function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?fb.find.matchesSelector(r,e)?[r]:[]:fb.find.matches(e,fb.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,t,n){for(var r=[],i=n!==b;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(i&&fb(e).is(n))break;r.push(e)}return r},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});var Gb=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Hb=/<([\w:]+)/,Ib=/<|&#?\w+;/,Jb=/<(?:script|style|link)/i,Kb=/^(?:checkbox|radio)$/i,Lb=/checked\s*(?:[^=]|=\s*.checked.)/i,Mb=/^$|\/(?:java|ecma)script/i,Nb=/^true\/(.*)/,Ob=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Pb={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Pb.optgroup=Pb.option,Pb.tbody=Pb.tfoot=Pb.colgroup=Pb.caption=Pb.thead,Pb.th=Pb.td,fb.fn.extend({text:function(e){return fb.access(this,function(e){return e===b?fb.text(this):this.empty().append((this[0]&&this[0].ownerDocument||T).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=l(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=l(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var n,r=e?fb.filter(e,this):this,i=0;null!=(n=r[i]);i++)t||1!==n.nodeType||fb.cleanData(q(n)),n.parentNode&&(t&&fb.contains(n.ownerDocument,n)&&o(q(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(fb.cleanData(q(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return fb.clone(this,e,t)})},html:function(e){return fb.access(this,function(e){var t=this[0]||{},n=0,r=this.length;if(e===b&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Jb.test(e)&&!Pb[(Hb.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(Gb,"<$1></$2>");try{for(;r>n;n++)t=this[n]||{},1===t.nodeType&&(fb.cleanData(q(t,!1)),t.innerHTML=e);t=0}catch(i){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=fb.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(n){var r=e[t++],i=e[t++];i&&(r&&r.parentNode!==i&&(r=this.nextSibling),fb(this).remove(),i.insertBefore(n,r))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,r){e=$.apply([],e);var i,s,o,u,a,f,l=0,c=this.length,h=this,p=c-1,d=e[0],v=fb.isFunction(d);if(v||!(1>=c||"string"!=typeof d||fb.support.checkClone)&&Lb.test(d))return this.each(function(n){var i=h.eq(n);v&&(e[0]=d.call(this,n,i.html())),i.domManip(e,t,r)});if(c&&(i=fb.buildFragment(e,this[0].ownerDocument,!1,!r&&this),s=i.firstChild,1===i.childNodes.length&&(i=s),s)){for(o=fb.map(q(i,"script"),m),u=o.length;c>l;l++)a=i,l!==p&&(a=fb.clone(a,!0,!0),u&&fb.merge(o,q(a,"script"))),t.call(this[l],a,l);if(u)for(f=o[o.length-1].ownerDocument,fb.map(o,n),l=0;u>l;l++)a=o[l],Mb.test(a.type||"")&&!qb.access(a,"globalEval")&&fb.contains(f,a)&&(a.src?fb._evalUrl(a.src):fb.globalEval(a.textContent.replace(Ob,"")))}return this}}),fb.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){fb.fn[e]=function(e){for(var n,r=[],i=fb(e),s=i.length-1,o=0;s>=o;o++)n=o===s?this:this.clone(!0),fb(i[o])[t](n),_.apply(r,n.get());return this.pushStack(r)}}),fb.extend({clone:function(e,t,n){var i,s,u,a,f=e.cloneNode(!0),l=fb.contains(e.ownerDocument,e);if(!(fb.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||fb.isXMLDoc(e)))for(a=q(f),u=q(e),i=0,s=u.length;s>i;i++)r(u[i],a[i]);if(t)if(n)for(u=u||q(e),a=a||q(f),i=0,s=u.length;s>i;i++)p(u[i],a[i]);else p(e,f);return a=q(f,"script"),a.length>0&&o(a,!l&&q(e,"script")),f},buildFragment:function(e,t,n,r){for(var i,s,u,a,f,l,c=0,h=e.length,p=t.createDocumentFragment(),d=[];h>c;c++)if(i=e[c],i||0===i)if("object"===fb.type(i))fb.merge(d,i.nodeType?[i]:i);else if(Ib.test(i)){for(s=s||p.appendChild(t.createElement("div")),u=(Hb.exec(i)||["",""])[1].toLowerCase(),a=Pb[u]||Pb._default,s.innerHTML=a[1]+i.replace(Gb,"<$1></$2>")+a[2],l=a[0];l--;)s=s.lastChild;fb.merge(d,s.childNodes),s=p.firstChild,s.textContent=""}else d.push(t.createTextNode(i));for(p.textContent="",c=0;i=d[c++];)if((!r||-1===fb.inArray(i,r))&&(f=fb.contains(i.ownerDocument,i),s=q(p.appendChild(i),"script"),f&&o(s),n))for(l=0;i=s[l++];)Mb.test(i.type||"")&&n.push(i);return p},cleanData:function(t){for(var n,r,i,s,o,u,a=fb.event.special,f=0;(r=t[f])!==b;f++){if(e.accepts(r)&&(o=r[qb.expando],o&&(n=qb.cache[o]))){if(i=Object.keys(n.events||{}),i.length)for(u=0;(s=i[u])!==b;u++)a[s]?fb.event.remove(r,s):fb.removeEvent(r,s,n.handle);qb.cache[o]&&delete qb.cache[o]}delete pb.cache[r[pb.expando]]}},_evalUrl:function(e){return fb.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),fb.fn.extend({wrapAll:function(e){var t;return fb.isFunction(e)?this.each(function(t){fb(this).wrapAll(e.call(this,t))}):(this[0]&&(t=fb(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return fb.isFunction(e)?this.each(function(t){fb(this).wrapInner(e.call(this,t))}):this.each(function(){var t=fb(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=fb.isFunction(e);return this.each(function(n){fb(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){fb.nodeName(this,"body")||fb(this).replaceWith(this.childNodes)}).end()}});var Qb,Rb,Sb=/^(none|table(?!-c[ea]).+)/,Tb=/^margin/,Ub=new RegExp("^("+gb+")(.*)$","i"),Vb=new RegExp("^("+gb+")(?!px)[a-z%]+$","i"),Wb=new RegExp("^([+-])=("+gb+")","i"),Xb={BODY:"block"},Yb={position:"absolute",visibility:"hidden",display:"block"},Zb={letterSpacing:0,fontWeight:400},$b=["Top","Right","Bottom","Left"],_b=["Webkit","O","Moz","ms"];fb.fn.extend({css:function(e,t){return fb.access(this,function(e,t,n){var r,i,s={},o=0;if(fb.isArray(t)){for(r=u(e),i=t.length;i>o;o++)s[t[o]]=fb.css(e,t[o],!1,r);return s}return n!==b?fb.style(e,t,n):fb.css(e,t)},e,t,arguments.length>1)},show:function(){return v(this,!0)},hide:function(){return v(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){t(this)?fb(this).show():fb(this).hide()})}}),fb.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Qb(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,u,a=fb.camelCase(t),f=e.style;return t=fb.cssProps[a]||(fb.cssProps[a]=s(f,a)),u=fb.cssHooks[t]||fb.cssHooks[a],n===b?u&&"get"in u&&(i=u.get(e,!1,r))!==b?i:f[t]:(o=typeof n,"string"===o&&(i=Wb.exec(n))&&(n=(i[1]+1)*i[2]+parseFloat(fb.css(e,t)),o="number"),null==n||"number"===o&&isNaN(n)||("number"!==o||fb.cssNumber[a]||(n+="px"),fb.support.clearCloneStyle||""!==n||0!==t.indexOf("background")||(f[t]="inherit"),u&&"set"in u&&(n=u.set(e,n,r))===b||(f[t]=n)),void 0)}},css:function(e,t,n,r){var i,o,u,a=fb.camelCase(t);return t=fb.cssProps[a]||(fb.cssProps[a]=s(e.style,a)),u=fb.cssHooks[t]||fb.cssHooks[a],u&&"get"in u&&(i=u.get(e,!0,n)),i===b&&(i=Qb(e,t,r)),"normal"===i&&t in Zb&&(i=Zb[t]),""===n||n?(o=parseFloat(i),n===!0||fb.isNumeric(o)?o||0:i):i}}),Qb=function(e,t,n){var r,i,s,o=n||u(e),a=o?o.getPropertyValue(t)||o[t]:b,f=e.style;return o&&(""!==a||fb.contains(e.ownerDocument,e)||(a=fb.style(e,t)),Vb.test(a)&&Tb.test(t)&&(r=f.width,i=f.minWidth,s=f.maxWidth,f.minWidth=f.maxWidth=f.width=a,a=o.width,f.width=r,f.minWidth=i,f.maxWidth=s)),a},fb.each(["height","width"],function(e,t){fb.cssHooks[t]={get:function(e,n,r){return n?0===e.offsetWidth&&Sb.test(fb.css(e,"display"))?fb.swap(e,Yb,function(){return y(e,t,r)}):y(e,t,r):void 0},set:function(e,n,r){var i=r&&u(e);return w(e,n,r?x(e,t,r,fb.support.boxSizing&&"border-box"===fb.css(e,"boxSizing",!1,i),i):0)}}}),fb(function(){fb.support.reliableMarginRight||(fb.cssHooks.marginRight={get:function(e,t){return t?fb.swap(e,{display:"inline-block"},Qb,[e,"marginRight"]):void 0}}),!fb.support.pixelPosition&&fb.fn.position&&fb.each(["top","left"],function(e,t){fb.cssHooks[t]={get:function(e,n){return n?(n=Qb(e,t),Vb.test(n)?fb(e).position()[t]+"px":n):void 0}}})}),fb.expr&&fb.expr.filters&&(fb.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0},fb.expr.filters.visible=function(e){return!fb.expr.filters.hidden(e)}),fb.each({margin:"",padding:"",border:"Width"},function(e,t){fb.cssHooks[e+t]={expand:function(n){for(var r=0,i={},s="string"==typeof n?n.split(" "):[n];4>r;r++)i[e+$b[r]+t]=s[r]||s[r-2]||s[0];return i}},Tb.test(e)||(fb.cssHooks[e+t].set=w)});var ac=/%20/g,bc=/\[\]$/,cc=/\r?\n/g,dc=/^(?:submit|button|image|reset|file)$/i,ec=/^(?:input|select|textarea|keygen)/i;fb.fn.extend({serialize:function(){return fb.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=fb.prop(this,"elements");return e?fb.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!fb(this).is(":disabled")&&ec.test(this.nodeName)&&!dc.test(e)&&(this.checked||!Kb.test(e))}).map(function(e,t){var n=fb(this).val();return null==n?null:fb.isArray(n)?fb.map(n,function(e){return{name:t.name,value:e.replace(cc,"\r\n")}}):{name:t.name,value:n.replace(cc,"\r\n")}}).get()}}),fb.param=function(e,t){var n,r=[],i=function(e,t){t=fb.isFunction(t)?t():null==t?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(t===b&&(t=fb.ajaxSettings&&fb.ajaxSettings.traditional),fb.isArray(e)||e.jquery&&!fb.isPlainObject(e))fb.each(e,function(){i(this.name,this.value)});else for(n in e)B(n,e[n],t,i);return r.join("&").replace(ac,"+")},fb.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){fb.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),fb.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var fc,gc,hc=fb.now(),ic=/\?/,jc=/#.*$/,kc=/([?&])_=[^&]*/,lc=/^(.*?):[ \t]*([^\r\n]*)$/gm,mc=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,nc=/^(?:GET|HEAD)$/,oc=/^\/\//,pc=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,qc=fb.fn.load,rc={},sc={},tc="*/".concat("*");try{gc=S.href}catch(uc){gc=T.createElement("a"),gc.href="",gc=gc.href}fc=pc.exec(gc.toLowerCase())||[],fb.fn.load=function(e,t,n){if("string"!=typeof e&&qc)return qc.apply(this,arguments);var r,i,s,o=this,u=e.indexOf(" ");return u>=0&&(r=e.slice(u),e=e.slice(0,u)),fb.isFunction(t)?(n=t,t=b):t&&"object"==typeof t&&(i="POST"),o.length>0&&fb.ajax({url:e,type:i,dataType:"html",data:t}).done(function(e){s=arguments,o.html(r?fb("<div>").append(fb.parseHTML(e)).find(r):e)}).complete(n&&function(e,t){o.each(n,s||[e.responseText,t,e])}),this},fb.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){fb.fn[t]=function(e){return this.on(t,e)}}),fb.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:gc,type:"GET",isLocal:mc.test(fc[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":tc,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":fb.parseJSON,"text xml":fb.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?E(E(e,fb.ajaxSettings),t):E(fb.ajaxSettings,e)},ajaxPrefilter:C(rc),ajaxTransport:C(sc),ajax:function(e,t){function n(e,t,n,o){var a,l,g,y,E,x=t;2!==w&&(w=2,u&&clearTimeout(u),r=b,s=o||"",S.readyState=e>0?4:0,a=e>=200&&300>e||304===e,n&&(y=F(c,S,n)),y=G(c,y,S,a),a?(c.ifModified&&(E=S.getResponseHeader("Last-Modified"),E&&(fb.lastModified[i]=E),E=S.getResponseHeader("etag"),E&&(fb.etag[i]=E)),204===e||"HEAD"===c.type?x="nocontent":304===e?x="notmodified":(x=y.state,l=y.data,g=y.error,a=!g)):(g=x,(e||!x)&&(x="error",0>e&&(e=0))),S.status=e,S.statusText=(t||x)+"",a?d.resolveWith(h,[l,x,S]):d.rejectWith(h,[S,x,g]),S.statusCode(m),m=b,f&&p.trigger(a?"ajaxSuccess":"ajaxError",[S,c,a?l:g]),v.fireWith(h,[S,x]),f&&(p.trigger("ajaxComplete",[S,c]),--fb.active||fb.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=b),t=t||{};var r,i,s,o,u,a,f,l,c=fb.ajaxSetup({},t),h=c.context||c,p=c.context&&(h.nodeType||h.jquery)?fb(h):fb.event,d=fb.Deferred(),v=fb.Callbacks("once memory"),m=c.statusCode||{},g={},y={},w=0,E="canceled",S={readyState:0,getResponseHeader:function(e){var t;if(2===w){if(!o)for(o={};t=lc.exec(s);)o[t[1].toLowerCase()]=t[2];t=o[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===w?s:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return w||(e=y[n]=y[n]||e,g[e]=t),this},overrideMimeType:function(e){return w||(c.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>w)for(t in e)m[t]=[m[t],e[t]];else S.always(e[S.status]);return this},abort:function(e){var t=e||E;return r&&r.abort(t),n(0,t),this}};if(d.promise(S).complete=v.add,S.success=S.done,S.error=S.fail,c.url=((e||c.url||gc)+"").replace(jc,"").replace(oc,fc[1]+"//"),c.type=t.method||t.type||c.method||c.type,c.dataTypes=fb.trim(c.dataType||"*").toLowerCase().match(hb)||[""],null==c.crossDomain&&(a=pc.exec(c.url.toLowerCase()),c.crossDomain=!(!a||a[1]===fc[1]&&a[2]===fc[2]&&(a[3]||("http:"===a[1]?"80":"443"))===(fc[3]||("http:"===fc[1]?"80":"443")))),c.data&&c.processData&&"string"!=typeof c.data&&(c.data=fb.param(c.data,c.traditional)),D(rc,c,t,S),2===w)return S;f=c.global,f&&0===fb.active++&&fb.event.trigger("ajaxStart"),c.type=c.type.toUpperCase(),c.hasContent=!nc.test(c.type),i=c.url,c.hasContent||(c.data&&(i=c.url+=(ic.test(i)?"&":"?")+c.data,delete c.data),c.cache===!1&&(c.url=kc.test(i)?i.replace(kc,"$1_="+hc++):i+(ic.test(i)?"&":"?")+"_="+hc++)),c.ifModified&&(fb.lastModified[i]&&S.setRequestHeader("If-Modified-Since",fb.lastModified[i]),fb.etag[i]&&S.setRequestHeader("If-None-Match",fb.etag[i])),(c.data&&c.hasContent&&c.contentType!==!1||t.contentType)&&S.setRequestHeader("Content-Type",c.contentType),S.setRequestHeader("Accept",c.dataTypes[0]&&c.accepts[c.dataTypes[0]]?c.accepts[c.dataTypes[0]]+("*"!==c.dataTypes[0]?", "+tc+"; q=0.01":""):c.accepts["*"]);for(l in c.headers)S.setRequestHeader(l,c.headers[l]);if(c.beforeSend&&(c.beforeSend.call(h,S,c)===!1||2===w))return S.abort();E="abort";for(l in{success:1,error:1,complete:1})S[l](c[l]);if(r=D(sc,c,t,S)){S.readyState=1,f&&p.trigger("ajaxSend",[S,c]),c.async&&c.timeout>0&&(u=setTimeout(function(){S.abort("timeout")},c.timeout));try{w=1,r.send(g,n)}catch(x){if(!(2>w))throw x;n(-1,x)}}else n(-1,"No Transport");return S},getJSON:function(e,t,n){return fb.get(e,t,n,"json")},getScript:function(e,t){return fb.get(e,b,t,"script")}}),fb.each(["get","post"],function(e,t){fb[t]=function(e,n,r,i){return fb.isFunction(n)&&(i=i||r,r=n,n=b),fb.ajax({url:e,type:t,dataType:i,data:n,success:r})}}),fb.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return fb.globalEval(e),e}}}),fb.ajaxPrefilter("script",function(e){e.cache===b&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),fb.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(r,i){t=fb("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i("error"===e.type?404:200,e.type)}),T.head.appendChild(t[0])},abort:function(){n&&n()}}}});var vc=[],wc=/(=)\?(?=&|$)|\?\?/;fb.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=vc.pop()||fb.expando+"_"+hc++;return this[e]=!0,e}}),fb.ajaxPrefilter("json jsonp",function(e,t,n){var r,i,s,o=e.jsonp!==!1&&(wc.test(e.url)?"url":"string"==typeof e.data&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&wc.test(e.data)&&"data");return o||"jsonp"===e.dataTypes[0]?(r=e.jsonpCallback=fb.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,o?e[o]=e[o].replace(wc,"$1"+r):e.jsonp!==!1&&(e.url+=(ic.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return s||fb.error(r+" was not called"),s[0]},e.dataTypes[0]="json",i=a[r],a[r]=function(){s=arguments},n.always(function(){a[r]=i,e[r]&&(e.jsonpCallback=t.jsonpCallback,vc.push(r)),s&&fb.isFunction(i)&&i(s[0]),s=i=b}),"script"):void 0}),fb.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var xc=fb.ajaxSettings.xhr(),yc={0:200,1223:204},zc=0,Ac={};a.ActiveXObject&&fb(a).on("unload",function(){for(var e in Ac)Ac[e]();Ac=b}),fb.support.cors=!!xc&&"withCredentials"in xc,fb.support.ajax=xc=!!xc,fb.ajaxTransport(function(e){var t;return fb.support.cors||xc&&!e.crossDomain?{send:function(n,r){var i,s,o=e.xhr();if(o.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(i in e.xhrFields)o[i]=e.xhrFields[i];e.mimeType&&o.overrideMimeType&&o.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");for(i in n)o.setRequestHeader(i,n[i]);t=function(e){return function(){t&&(delete Ac[s],t=o.onload=o.onerror=null,"abort"===e?o.abort():"error"===e?r(o.status||404,o.statusText):r(yc[o.status]||o.status,o.statusText,"string"==typeof o.responseText?{text:o.responseText}:b,o.getAllResponseHeaders()))}},o.onload=t(),o.onerror=t("error"),t=Ac[s=zc++]=t("abort"),o.send(e.hasContent&&e.data||null)},abort:function(){t&&t()}}:void 0});var Bc,Cc,Dc=/^(?:toggle|show|hide)$/,Ec=new RegExp("^(?:([+-])=|)("+gb+")([a-z%]*)$","i"),Fc=/queueHooks$/,Gc=[L],Hc={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=Ec.exec(t),s=i&&i[3]||(fb.cssNumber[e]?"":"px"),o=(fb.cssNumber[e]||"px"!==s&&+r)&&Ec.exec(fb.css(n.elem,e)),u=1,a=20;if(o&&o[3]!==s){s=s||o[3],i=i||[],o=+r||1;do u=u||".5",o/=u,fb.style(n.elem,e,o+s);while(u!==(u=n.cur()/r)&&1!==u&&--a)}return i&&(o=n.start=+o||+r||0,n.unit=s,n.end=i[1]?o+(i[1]+1)*i[2]:+i[2]),n}]};fb.Animation=fb.extend(J,{tweener:function(e,t){fb.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var n,r=0,i=e.length;i>r;r++)n=e[r],Hc[n]=Hc[n]||[],Hc[n].unshift(t)},prefilter:function(e,t){t?Gc.unshift(e):Gc.push(e)}}),fb.Tween=M,M.prototype={constructor:M,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(fb.cssNumber[n]?"":"px")},cur:function(){var e=M.propHooks[this.prop];return e&&e.get?e.get(this):M.propHooks._default.get(this)},run:function(e){var t,n=M.propHooks[this.prop];return this.pos=t=this.options.duration?fb.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):M.propHooks._default.set(this),this}},M.prototype.init.prototype=M.prototype,M.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=fb.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){fb.fx.step[e.prop]?fb.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[fb.cssProps[e.prop]]||fb.cssHooks[e.prop])?fb.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},M.propHooks.scrollTop=M.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},fb.each(["toggle","show","hide"],function(e,t){var n=fb.fn[t];fb.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(N(t,!0),e,r,i)}}),fb.fn.extend({fadeTo:function(e,n,r,i){return this.filter(t).css("opacity",0).show().end().animate({opacity:n},e,r,i)},animate:function(e,t,n,r){var i=fb.isEmptyObject(e),s=fb.speed(t,n,r),o=function(){var t=J(this,fb.extend({},e),s);(i||qb.get(this,"finish"))&&t.stop(!0)};return o.finish=o,i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=b),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",s=fb.timers,o=qb.get(this);if(i)o[i]&&o[i].stop&&r(o[i]);else for(i in o)o[i]&&o[i].stop&&Fc.test(i)&&r(o[i]);for(i=s.length;i--;)s[i].elem!==this||null!=e&&s[i].queue!==e||(s[i].anim.stop(n),t=!1,s.splice(i,1));(t||!n)&&fb.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=qb.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],s=fb.timers,o=r?r.length:0;for(n.finish=!0,fb.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;o>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),fb.each({slideDown:N("show"),slideUp:N("hide"),slideToggle:N("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){fb.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),fb.speed=function(e,t,n){var r=e&&"object"==typeof e?fb.extend({},e):{complete:n||!n&&t||fb.isFunction(e)&&e,duration:e,easing:n&&t||t&&!fb.isFunction(t)&&t};return r.duration=fb.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in fb.fx.speeds?fb.fx.speeds[r.duration]:fb.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){fb.isFunction(r.old)&&r.old.call(this),r.queue&&fb.dequeue(this,r.queue)},r},fb.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},fb.timers=[],fb.fx=M.prototype.init,fb.fx.tick=function(){var e,t=fb.timers,n=0;for(Bc=fb.now();n<t.length;n++)e=t[n],e()||t[n]!==e||t.splice(n--,1);t.length||fb.fx.stop(),Bc=b},fb.fx.timer=function(e){e()&&fb.timers.push(e)&&fb.fx.start()},fb.fx.interval=13,fb.fx.start=function(){Cc||(Cc=setInterval(fb.fx.tick,fb.fx.interval))},fb.fx.stop=function(){clearInterval(Cc),Cc=null},fb.fx.speeds={slow:600,fast:200,_default:400},fb.fx.step={},fb.expr&&fb.expr.filters&&(fb.expr.filters.animated=function(e){return fb.grep(fb.timers,function(t){return e===t.elem}).length}),fb.fn.offset=function(e){if(arguments.length)return e===b?this:this.each(function(t){fb.offset.setOffset(this,e,t)});var t,n,r=this[0],i={top:0,left:0},s=r&&r.ownerDocument;if(s)return t=s.documentElement,fb.contains(t,r)?(typeof r.getBoundingClientRect!==R&&(i=r.getBoundingClientRect()),n=O(s),{top:i.top+n.pageYOffset-t.clientTop,left:i.left+n.pageXOffset-t.clientLeft}):i},fb.offset={setOffset:function(e,t,n){var r,i,s,o,u,a,f,l=fb.css(e,"position"),c=fb(e),h={};"static"===l&&(e.style.position="relative"),u=c.offset(),s=fb.css(e,"top"),a=fb.css(e,"left"),f=("absolute"===l||"fixed"===l)&&(s+a).indexOf("auto")>-1,f?(r=c.position(),o=r.top,i=r.left):(o=parseFloat(s)||0,i=parseFloat(a)||0),fb.isFunction(t)&&(t=t.call(e,n,u)),null!=t.top&&(h.top=t.top-u.top+o),null!=t.left&&(h.left=t.left-u.left+i),"using"in t?t.using.call(e,h):c.css(h)}},fb.fn.extend({position:function(){if(this[0]){var e,t,n=this[0],r={top:0,left:0};return"fixed"===fb.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),fb.nodeName(e[0],"html")||(r=e.offset()),r.top+=fb.css(e[0],"borderTopWidth",!0),r.left+=fb.css(e[0],"borderLeftWidth",!0)),{top:t.top-r.top-fb.css(n,"marginTop",!0),left:t.left-r.left-fb.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||U;e&&!fb.nodeName(e,"html")&&"static"===fb.css(e,"position");)e=e.offsetParent;return e||U})}}),fb.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n="pageYOffset"===t;fb.fn[e]=function(r){return fb.access(this,function(e,r,i){var s=O(e);return i===b?s?s[t]:e[r]:(s?s.scrollTo(n?a.pageXOffset:i,n?i:a.pageYOffset):e[r]=i,void 0)},e,r,arguments.length,null)}}),fb.each({Height:"height",Width:"width"},function(e,t){fb.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){fb.fn[r]=function(r,i){var s=arguments.length&&(n||"boolean"!=typeof r),o=n||(r===!0||i===!0?"margin":"border");return fb.access(this,function(t,n,r){var i;return fb.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):r===b?fb.css(t,n,o):fb.style(t,n,r,o)},t,s?r:b,s,null)}})}),fb.fn.size=function(){return this.length},fb.fn.andSelf=fb.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=fb:"function"==typeof define&&define.amd&&define("jquery",[],function(){return fb}),"object"==typeof a&&"object"==typeof a.document&&(a.jQuery=a.$=fb)}(window),function(){function e(e,t,n){for(var r=(n||0)-1,i=e?e.length:0;++r<i;)if(e[r]===t)return r;return-1}function t(t,n){var r=typeof n;if(t=t.cache,"boolean"==r||null==n)return t[n]?0:-1;"number"!=r&&"string"!=r&&(r="object");var i="number"==r?n:y+n;return t=(t=t[r])&&t[i],"object"==r?t&&e(t,n)>-1?0:-1:t?0:-1}function n(e){var t=this.cache,n=typeof e;if("boolean"==n||null==e)t[e]=!0;else{"number"!=n&&"string"!=n&&(n="object");var r="number"==n?e:y+e,i=t[n]||(t[n]={});"object"==n?(i[r]||(i[r]=[])).push(e):i[r]=!0}}function r(e){return e.charCodeAt(0)}function i(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||"undefined"==typeof n)return 1;if(r>n||"undefined"==typeof r)return-1}return e.index-t.index}function s(e){var t=-1,r=e.length,i=e[0],s=e[r/2|0],o=e[r-1];if(i&&"object"==typeof i&&s&&"object"==typeof s&&o&&"object"==typeof o)return!1;var u=a();u["false"]=u["null"]=u["true"]=u.undefined=!1;var f=a();for(f.array=e,f.cache=u,f.push=n;++t<r;)f.push(e[t]);return f}function o(e){return"\\"+J[e]}function u(){return v.pop()||[]}function a(){return m.pop()||{array:null,cache:null,criteria:null,"false":!1,index:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,"undefined":!1,value:null}}function f(){}function l(e){e.length=0,v.length<w&&v.push(e)}function c(e){var t=e.cache;t&&c(t),e.array=e.cache=e.criteria=e.object=e.number=e.string=e.value=null,m.length<w&&m.push(e)}function h(e,t,n){t||(t=0),"undefined"==typeof n&&(n=e?e.length:0);for(var r=-1,i=n-t||0,s=Array(0>i?0:i);++r<i;)s[r]=e[t+r];return s}function p(n){function v(e){return e&&"object"==typeof e&&!Qr(e)&&Nr.call(e,"__wrapped__")?e:new m(e)}function m(e,t){this.__chain__=!!t,this.__wrapped__=e}function w(e,t,n,r,i){if(n){var s=n(e);if("undefined"!=typeof s)return s}var o=Ct(e);if(!o)return e;var a=Mr.call(e);if(!W[a])return e;var f=$r[a];switch(a){case j:case F:return new f(+e);case q:case z:return new f(e);case U:return s=f(e.source,C.exec(e)),s.lastIndex=e.lastIndex,s}var c=Qr(e);if(t){var p=!r;r||(r=u()),i||(i=u());for(var d=r.length;d--;)if(r[d]==e)return i[d];s=c?f(e.length):{}}else s=c?h(e):ri({},e);return c&&(Nr.call(e,"index")&&(s.index=e.index),Nr.call(e,"input")&&(s.input=e.input)),t?(r.push(e),i.push(s),(c?Xt:oi)(e,function(e,o){s[o]=w(e,t,n,r,i)}),p&&(l(r),l(i)),s):s}function J(e,t,n){if("function"!=typeof e)return Vn;if("undefined"==typeof t)return e;var r=e.__bindData__||Jr.funcNames&&!e.name;if("undefined"==typeof r){var i=M&&xr.call(e);Jr.funcNames||!i||k.test(i)||(r=!0),(Jr.funcNames||!r)&&(r=!Jr.funcDecomp||M.test(i),Kr(e,r))}if(r!==!0&&r&&1&r[1])return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)};case 4:return function(n,r,i,s){return e.call(t,n,r,i,s)}}return On(e,t)}function Q(e,t,n,r){for(var i=(r||0)-1,s=e?e.length:0,o=[];++i<s;){var u=e[i];if(u&&"object"==typeof u&&"number"==typeof u.length&&(Qr(u)||ft(u))){t||(u=Q(u,t,n));var a=-1,f=u.length,l=o.length;for(o.length+=f;++a<f;)o[l++]=u[a]}else n||o.push(u)}return o}function G(e,t,n,r,i,s){if(n){var o=n(e,t);if("undefined"!=typeof o)return!!o}if(e===t)return 0!==e||1/e==1/t;var a=typeof e,f=typeof t;if(!(e!==e||e&&$[a]||t&&$[f]))return!1;if(null==e||null==t)return e===t;var c=Mr.call(e),h=Mr.call(t);if(c==H&&(c=R),h==H&&(h=R),c!=h)return!1;switch(c){case j:case F:return+e==+t;case q:return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case U:case z:return e==dr(t)}var p=c==B;if(!p){if(Nr.call(e,"__wrapped__ ")||Nr.call(t,"__wrapped__"))return G(e.__wrapped__||e,t.__wrapped__||t,n,r,i,s);if(c!=R)return!1;var d=e.constructor,v=t.constructor;if(d!=v&&!(Nt(d)&&d instanceof d&&Nt(v)&&v instanceof v))return!1}var m=!i;i||(i=u()),s||(s=u());for(var g=i.length;g--;)if(i[g]==e)return s[g]==t;var y=0;if(o=!0,i.push(e),s.push(t),p){if(g=e.length,y=t.length,o=y==e.length,!o&&!r)return o;for(;y--;){var b=g,w=t[y];if(r)for(;b--&&!(o=G(e[b],w,n,r,i,s)););else if(!(o=G(e[y],w,n,r,i,s)))break}return o}return si(t,function(t,u,a){return Nr.call(a,u)?(y++,o=Nr.call(e,u)&&G(e[u],t,n,r,i,s)):void 0}),o&&!r&&si(e,function(e,t,n){return Nr.call(n,t)?o=--y>-1:void 0}),m&&(l(i),l(s)),o}function Z(e,t,n,r,i){(Qr(t)?Xt:oi)(t,function(t,s){var o,u,a=t,f=e[s];if(t&&((u=Qr(t))||ui(t))){for(var l=r.length;l--;)if(o=r[l]==t){f=i[l];break}if(!o){var c;n&&(a=n(f,t),(c="undefined"!=typeof a)&&(f=a)),c||(f=u?Qr(f)?f:[]:ui(f)?f:{}),r.push(t),i.push(f),c||Z(f,t,n,r,i)}}else n&&(a=n(f,t),"undefined"==typeof a&&(a=t)),"undefined"!=typeof a&&(f=a);e[s]=f})}function tt(n,r,i){var o=-1,a=ot(),f=n?n.length:0,h=[],p=!r&&f>=b&&a===e,d=i||p?u():h;if(p){var v=s(d);v?(a=t,d=v):(p=!1,d=i?d:(l(d),h))}for(;++o<f;){var m=n[o],g=i?i(m,o,n):m;(r?!o||d[d.length-1]!==g:a(d,g)<0)&&((i||p)&&d.push(g),h.push(m))}return p?(l(d.array),c(d)):i&&l(d),h}function nt(e){return function(t,n,r){var i={};n=v.createCallback(n,r,3);var s=-1,o=t?t.length:0;if("number"==typeof o)for(;++s<o;){var u=t[s];e(i,u,n(u,s,t),t)}else oi(t,function(t,r,s){e(i,t,n(t,r,s),s)});return i}}function rt(e,t,n,r,i,s){var o=1&t,u=2&t,a=4&t,f=8&t,l=16&t,c=32&t,h=e;if(!u&&!Nt(e))throw new vr;l&&!n.length&&(t&=-17,l=n=!1),c&&!r.length&&(t&=-33,c=r=!1);var p=e&&e.__bindData__;if(p)return!o||1&p[1]||(p[4]=i),!o&&1&p[1]&&(t|=8),!a||4&p[1]||(p[5]=s),l&&kr.apply(p[2]||(p[2]=[]),n),c&&kr.apply(p[3]||(p[3]=[]),r),p[1]|=t,rt.apply(null,p);if(o&&!(u||a||c)&&(Jr.fastBind||Pr&&l)){if(l){var d=[i];kr.apply(d,n)}var v=l?Pr.apply(e,d):Pr.call(e,i)}else v=function(){var p=arguments,d=o?i:this;if((a||l||c)&&(p=Wr.call(p),l&&_r.apply(p,n),c&&kr.apply(p,r),a&&p.length<s))return t|=16,rt(e,f?t:-4&t,p,null,i,s);if(u&&(e=d[h]),this instanceof v){d=it(e.prototype);var m=e.apply(d,p);return Ct(m)?m:d}return e.apply(d,p)};return Kr(v,Wr.call(arguments)),v}function it(e){return Ct(e)?Hr(e):{}}function st(e){return Zr[e]}function ot(){var t=(t=v.indexOf)===dn?e:t;return t}function ut(e){var t,n;return e&&Mr.call(e)==R&&(t=e.constructor,!Nt(t)||t instanceof t)?(si(e,function(e,t){n=t}),"undefined"==typeof n||Nr.call(e,n)):!1}function at(e){return ei[e]}function ft(e){return e&&"object"==typeof e&&"number"==typeof e.length&&Mr.call(e)==H||!1}function lt(e,t,n,r){return"boolean"!=typeof t&&null!=t&&(r=n,n=t,t=!1),w(e,t,"function"==typeof n&&J(n,r,1))}function ct(e,t,n){return w(e,!0,"function"==typeof t&&J(t,n,1))}function ht(e,t,n){var r;return t=v.createCallback(t,n,3),oi(e,function(e,n,i){return t(e,n,i)?(r=n,!1):void 0}),r}function pt(e,t,n){var r;return t=v.createCallback(t,n,3),vt(e,function(e,n,i){return t(e,n,i)?(r=n,!1):void 0}),r}function dt(e,t,n){var r=[];si(e,function(e,t){r.push(t,e)});var i=r.length;for(t=J(t,n,3);i--&&t(r[i--],r[i],e)!==!1;);return e}function vt(e,t,n){var r=Yr(e),i=r.length;for(t=J(t,n,3);i--;){var s=r[i];if(t(e[s],s,e)===!1)break}return e}function mt(e){var t=[];return si(e,function(e,n){Nt(e)&&t.push(n)}),t.sort()}function gt(e,t){return e?Nr.call(e,t):!1}function yt(e){for(var t=-1,n=Yr(e),r=n.length,i={};++t<r;){var s=n[t];i[e[s]]=s}return i}function bt(e){return e===!0||e===!1||Mr.call(e)==j}function wt(e){return e?"object"==typeof e&&Mr.call(e)==F:!1}function Et(e){return e?1===e.nodeType:!1}function St(e){var t=!0;if(!e)return t;var n=Mr.call(e),r=e.length;return n==B||n==z||n==H||n==R&&"number"==typeof r&&Nt(e.splice)?!r:(oi(e,function(){return t=!1}),t)}function xt(e,t,n,r){return G(e,t,"function"==typeof n&&J(n,r,2))}function Tt(e){return jr(e)&&!Fr(parseFloat(e))}function Nt(e){return"function"==typeof e}function Ct(e){return!(!e||!$[typeof e])}function kt(e){return At(e)&&e!=+e}function Lt(e){return null===e}function At(e){return"number"==typeof e||Mr.call(e)==q}function Ot(e){return e?"object"==typeof e&&Mr.call(e)==U:!1}function Mt(e){return"string"==typeof e||Mr.call(e)==z}function _t(e){return"undefined"==typeof e}function Dt(e){var t=arguments,n=2;if(!Ct(e))return e;if("number"!=typeof t[2]&&(n=t.length),n>3&&"function"==typeof t[n-2])var r=J(t[--n-1],t[n--],2);else n>2&&"function"==typeof t[n-1]&&(r=t[--n]);for(var i=Wr.call(arguments,1,n),s=-1,o=u(),a=u();++s<n;)Z(e,i[s],r,o,a);return l(o),l(a),e}function Pt(e,t,n){var r=ot(),i="function"==typeof t,s={};if(i)t=v.createCallback(t,n,3);else var o=Q(arguments,!0,!1,1);return si(e,function(e,n,u){(i?!t(e,n,u):r(o,n)<0)&&(s[n]=e)}),s}function Ht(e){for(var t=-1,n=Yr(e),r=n.length,i=or(r);++t<r;){var s=n[t];i[t]=[s,e[s]]}return i}function Bt(e,t,n){var r={};if("function"!=typeof t)for(var i=-1,s=Q(arguments,!0,!1,1),o=Ct(e)?s.length:0;++i<o;){var u=s[i];u in e&&(r[u]=e[u])}else t=v.createCallback(t,n,3),si(e,function(e,n,i){t(e,n,i)&&(r[n]=e)});return r}function jt(e,t,n,r){var i=Qr(e);if(t=J(t,r,4),null==n)if(i)n=[];else{var s=e&&e.constructor,o=s&&s.prototype;n=it(o)}return(i?Xt:oi)(e,function(e,r,i){return t(n,e,r,i)}),n}function Ft(e){for(var t=-1,n=Yr(e),r=n.length,i=or(r);++t<r;)i[t]=e[n[t]];return i}function It(e){for(var t=arguments,n=-1,r=Q(t,!0,!1,1),i=t[2]&&t[2][t[1]]===e?1:r.length,s=or(i);++n<i;)s[n]=e[r[n]];return s}function qt(e,t,n){var r=-1,i=ot(),s=e?e.length:0,o=!1;return n=(0>n?qr(0,s+n):n)||0,Qr(e)?o=i(e,t,n)>-1:"number"==typeof s?o=(Mt(e)?e.indexOf(t,n):i(e,t,n))>-1:oi(e,function(e){return++r>=n?!(o=e===t):void 0}),o}function Rt(e,t,n){var r=!0;t=v.createCallback(t,n,3);var i=-1,s=e?e.length:0;if("number"==typeof s)for(;++i<s&&(r=!!t(e[i],i,e)););else oi(e,function(e,n,i){return r=!!t(e,n,i)});return r}function Ut(e,t,n){var r=[];t=v.createCallback(t,n,3);var i=-1,s=e?e.length:0;if("number"==typeof s)for(;++i<s;){var o=e[i];t(o,i,e)&&r.push(o)}else oi(e,function(e,n,i){t(e,n,i)&&r.push(e)});return r}function zt(e,t,n){t=v.createCallback(t,n,3);var r=-1,i=e?e.length:0;if("number"!=typeof i){var s;return oi(e,function(e,n,r){return t(e,n,r)?(s=e,!1):void 0}),s}for(;++r<i;){var o=e[r];if(t(o,r,e))return o}}function Wt(e,t,n){var r;return t=v.createCallback(t,n,3),Vt(e,function(e,n,i){return t(e,n,i)?(r=e,!1):void 0}),r}function Xt(e,t,n){var r=-1,i=e?e.length:0;if(t=t&&"undefined"==typeof n?t:J(t,n,3),"number"==typeof i)for(;++r<i&&t(e[r],r,e)!==!1;);else oi(e,t);return e}function Vt(e,t,n){var r=e?e.length:0;if(t=t&&"undefined"==typeof n?t:J(t,n,3),"number"==typeof r)for(;r--&&t(e[r],r,e)!==!1;);else{var i=Yr(e);r=i.length,oi(e,function(e,n,s){return n=i?i[--r]:--r,t(s[n],n,s)})}return e}function $t(e,t){var n=Wr.call(arguments,2),r=-1,i="function"==typeof t,s=e?e.length:0,o=or("number"==typeof s?s:0);return Xt(e,function(e){o[++r]=(i?t:e[t]).apply(e,n)}),o}function Jt(e,t,n){var r=-1,i=e?e.length:0;if(t=v.createCallback(t,n,3),"number"==typeof i)for(var s=or(i);++r<i;)s[r]=t(e[r],r,e);else s=[],oi(e,function(e,n,i){s[++r]=t(e,n,i)});return s}function Kt(e,t,n){var i=-1/0,s=i;if(!t&&Qr(e))for(var o=-1,u=e.length;++o<u;){var a=e[o];a>s&&(s=a)}else t=!t&&Mt(e)?r:v.createCallback(t,n,3),Xt(e,function(e,n,r){var o=t(e,n,r);o>i&&(i=o,s=e)});return s}function Qt(e,t,n){var i=1/0,s=i;if(!t&&Qr(e))for(var o=-1,u=e.length;++o<u;){var a=e[o];s>a&&(s=a)}else t=!t&&Mt(e)?r:v.createCallback(t,n,3),Xt(e,function(e,n,r){var o=t(e,n,r);i>o&&(i=o,s=e)});return s}function Gt(e,t){var n=-1,r=e?e.length:0;if("number"==typeof r)for(var i=or(r);++n<r;)i[n]=e[n][t];return i||Jt(e,t)}function Yt(e,t,n,r){if(!e)return n;var i=arguments.length<3;t=J(t,r,4);var s=-1,o=e.length;if("number"==typeof o)for(i&&(n=e[++s]);++s<o;)n=t(n,e[s],s,e);else oi(e,function(e,r,s){n=i?(i=!1,e):t(n,e,r,s)});return n}function Zt(e,t,n,r){var i=arguments.length<3;return t=J(t,r,4),Vt(e,function(e,r,s){n=i?(i=!1,e):t(n,e,r,s)}),n}function en(e,t,n){return t=v.createCallback(t,n,3),Ut(e,function(e,n,r){return!t(e,n,r)})}function tn(e,t,n){var r=e?e.length:0;if("number"!=typeof r&&(e=Ft(e)),null==t||n)return e?e[Kn(r-1)]:d;var i=nn(e);return i.length=Rr(qr(0,t),i.length),i}function nn(e){var t=-1,n=e?e.length:0,r=or("number"==typeof n?n:0);return Xt(e,function(e){var n=Kn(++t);r[t]=r[n],r[n]=e}),r}function rn(e){var t=e?e.length:0;return"number"==typeof t?t:Yr(e).length}function sn(e,t,n){var r;t=v.createCallback(t,n,3);var i=-1,s=e?e.length:0;if("number"==typeof s)for(;++i<s&&!(r=t(e[i],i,e)););else oi(e,function(e,n,i){return!(r=t(e,n,i))});return!!r}function on(e,t,n){var r=-1,s=e?e.length:0,o=or("number"==typeof s?s:0);for(t=v.createCallback(t,n,3),Xt(e,function(e,n,i){var s=o[++r]=a();s.criteria=t(e,n,i),s.index=r,s.value=e}),s=o.length,o.sort(i);s--;){var u=o[s];o[s]=u.value,c(u)}return o}function un(e){return e&&"number"==typeof e.length?h(e):Ft(e)}function an(e){for(var t=-1,n=e?e.length:0,r=[];++t<n;){var i=e[t];i&&r.push(i)}return r}function fn(n){var r=-1,i=ot(),o=n?n.length:0,u=Q(arguments,!0,!0,1),a=[],f=o>=b&&i===e;if(f){var l=s(u);l?(i=t,u=l):f=!1}for(;++r<o;){var h=n[r];i(u,h)<0&&a.push(h)}return f&&c(u),a}function ln(e,t,n){var r=-1,i=e?e.length:0;for(t=v.createCallback(t,n,3);++r<i;)if(t(e[r],r,e))return r;return-1}function cn(e,t,n){var r=e?e.length:0;for(t=v.createCallback(t,n,3);r--;)if(t(e[r],r,e))return r;return-1}function hn(e,t,n){var r=0,i=e?e.length:0;if("number"!=typeof t&&null!=t){var s=-1;for(t=v.createCallback(t,n,3);++s<i&&t(e[s],s,e);)r++}else if(r=t,null==r||n)return e?e[0]:d;return h(e,0,Rr(qr(0,r),i))}function pn(e,t,n,r){return"boolean"!=typeof t&&null!=t&&(r=n,n=r&&r[t]===e?null:t,t=!1),null!=n&&(e=Jt(e,n,r)),Q(e,t)}function dn(t,n,r){if("number"==typeof r){var i=t?t.length:0;r=0>r?qr(0,i+r):r||0}else if(r){var s=xn(t,n);return t[s]===n?s:-1}return e(t,n,r)}function vn(e,t,n){var r=0,i=e?e.length:0;if("number"!=typeof t&&null!=t){var s=i;for(t=v.createCallback(t,n,3);s--&&t(e[s],s,e);)r++}else r=null==t||n?1:t||r;return h(e,0,Rr(qr(0,i-r),i))}function mn(n){for(var r=arguments,i=r.length,o=-1,a=u(),f=-1,h=ot(),p=n?n.length:0,d=[],v=u();++o<i;){var m=r[o];a[o]=h===e&&(m?m.length:0)>=b&&s(o?r[o]:v)}e:for(;++f<p;){var g=a[0];if(m=n[f],(g?t(g,m):h(v,m))<0){for(o=i,(g||v).push(m);--o;)if(g=a[o],(g?t(g,m):h(r[o],m))<0)continue e;d.push(m)}}for(;i--;)g=a[i],g&&c(g);return l(a),l(v),d}function gn(e,t,n){var r=0,i=e?e.length:0;if("number"!=typeof t&&null!=t){var s=i;for(t=v.createCallback(t,n,3);s--&&t(e[s],s,e);)r++}else if(r=t,null==r||n)return e?e[i-1]:d;return h(e,qr(0,i-r))}function yn(e,t,n){var r=e?e.length:0;for("number"==typeof n&&(r=(0>n?qr(0,r+n):Rr(n,r-1))+1);r--;)if(e[r]===t)return r;return-1}function bn(e){for(var t=arguments,n=0,r=t.length,i=e?e.length:0;++n<r;)for(var s=-1,o=t[n];++s<i;)e[s]===o&&(Or.call(e,s--,1),i--);return e}function wn(e,t,n){e=+e||0,n="number"==typeof n?n:+n||1,null==t&&(t=e,e=0);for(var r=-1,i=qr(0,wr((t-e)/(n||1))),s=or(i);++r<i;)s[r]=e,e+=n;return s}function En(e,t,n){var r=-1,i=e?e.length:0,s=[];for(t=v.createCallback(t,n,3);++r<i;){var o=e[r];t(o,r,e)&&(s.push(o),Or.call(e,r--,1),i--)}return s}function Sn(e,t,n){if("number"!=typeof t&&null!=t){var r=0,i=-1,s=e?e.length:0;for(t=v.createCallback(t,n,3);++i<s&&t(e[i],i,e);)r++}else r=null==t||n?1:qr(0,t);return h(e,r)}function xn(e,t,n,r){var i=0,s=e?e.length:i;for(n=n?v.createCallback(n,r,1):Vn,t=n(t);s>i;){var o=i+s>>>1;n(e[o])<t?i=o+1:s=o}return i}function Tn(){return tt(Q(arguments,!0,!0))}function Nn(e,t,n,r){return"boolean"!=typeof t&&null!=t&&(r=n,n=r&&r[t]===e?null:t,t=!1),null!=n&&(n=v.createCallback(n,r,3)),tt(e,t,n)}function Cn(e){return fn(e,Wr.call(arguments,1))}function kn(){for(var e=arguments.length>1?arguments:arguments[0],t=-1,n=e?Kt(Gt(e,"length")):0,r=or(0>n?0:n);++t<n;)r[t]=Gt(e,t);return r}function Ln(e,t){for(var n=-1,r=e?e.length:0,i={};++n<r;){var s=e[n];t?i[s]=t[n]:s&&(i[s[0]]=s[1])}return i}function An(e,t){if(!Nt(t))throw new vr;return function(){return--e<1?t.apply(this,arguments):void 0}}function On(e,t){return arguments.length>2?rt(e,17,Wr.call(arguments,2),null,t):rt(e,1,null,null,t)}function Mn(e){for(var t=arguments.length>1?Q(arguments,!0,!1,1):mt(e),n=-1,r=t.length;++n<r;){var i=t[n];e[i]=rt(e[i],1,null,null,e)}return e}function _n(e,t){return arguments.length>2?rt(t,19,Wr.call(arguments,2),null,e):rt(t,3,null,null,e)}function Dn(){for(var e=arguments,t=e.length;t--;)if(!Nt(e[t]))throw new vr;return function(){for(var t=arguments,n=e.length;n--;)t=[e[n].apply(this,t)];return t[0]}}function Pn(e,t,n){var r=typeof e;if(null==e||"function"==r)return J(e,t,n);if("object"!=r)return function(t){return t[e]};var i=Yr(e),s=i[0],o=e[s];return 1!=i.length||o!==o||Ct(o)?function(t){for(var n=i.length,r=!1;n--&&(r=G(t[i[n]],e[i[n]],null,!0)););return r}:function(e){var t=e[s];return o===t&&(0!==o||1/o==1/t)}}function Hn(e,t){return t="number"==typeof t?t:+t||e.length,rt(e,4,null,null,null,t)}function Bn(e,t,n){var r,i,s,o,u,a,f,l=0,c=!1,h=!0;if(!Nt(e))throw new vr;if(t=qr(0,t)||0,n===!0){var p=!0;h=!1}else Ct(n)&&(p=n.leading,c="maxWait"in n&&(qr(t,n.maxWait)||0),h="trailing"in n?n.trailing:h);var v=function(){var n=t-(Cr()-o);if(0>=n){i&&Er(i);var c=f;i=a=f=d,c&&(l=Cr(),s=e.apply(u,r))}else a=Ar(v,n)},m=function(){a&&Er(a),i=a=f=d,(h||c!==t)&&(l=Cr(),s=e.apply(u,r))};return function(){if(r=arguments,o=Cr(),u=this,f=h&&(a||!p),c===!1)var n=p&&!a;else{i||p||(l=o);var d=c-(o-l);0>=d?(i&&(i=Er(i)),l=o,s=e.apply(u,r)):i||(i=Ar(m,d))}return a||t===c||(a=Ar(v,t)),n&&(s=e.apply(u,r)),s}}function jn(e){if(!Nt(e))throw new vr;var t=Wr.call(arguments,1);return Ar(function(){e.apply(d,t)},1)}function Fn(e,t){if(!Nt(e))throw new vr;var n=Wr.call(arguments,2);return Ar(function(){e.apply(d,n)},t)}function In(e,t){if(!Nt(e))throw new vr;var n=function(){var r=n.cache,i=t?t.apply(this,arguments):y+arguments[0];return Nr.call(r,i)?r[i]:r[i]=e.apply(this,arguments)};return n.cache={},n}function qn(e){var t,n;if(!Nt(e))throw new vr;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}}function Rn(e){return rt(e,16,Wr.call(arguments,1))}function Un(e){return rt(e,32,null,Wr.call(arguments,1))}function zn(e,t,n){var r=!0,i=!0;if(!Nt(e))throw new vr;n===!1?r=!1:Ct(n)&&(r="leading"in n?n.leading:r,i="trailing"in n?n.trailing:i),X.leading=r,X.maxWait=t,X.trailing=i;var s=Bn(e,t,X);return s}function Wn(e,t){if(!Nt(t))throw new vr;return function(){var n=[e];return kr.apply(n,arguments),t.apply(this,n)}}function Xn(e){return null==e?"":dr(e).replace(ni,st)}function Vn(e){return e}function $n(e,t){var n=e,r=!t||Nt(n);t||(n=m,t=e,e=v),Xt(mt(t),function(i){var s=e[i]=t[i];r&&(n.prototype[i]=function(){var t=this.__wrapped__,r=[t];kr.apply(r,arguments);var i=s.apply(e,r);return t&&"object"==typeof t&&t===i?this:(i=new n(i),i.__chain__=this.__chain__,i)})})}function Jn(){return n._=yr,this}function Kn(e,t,n){var r=null==e,i=null==t;null==n&&("boolean"==typeof e&&i?(n=e,e=1):i||"boolean"!=typeof t||(n=t,i=!0)),r&&i&&(t=1),e=+e||0,i?(t=e,e=0):t=+t||0;var s=zr();return n||e%1||t%1?Rr(e+s*(t-e+parseFloat("1e-"+((s+"").length-1))),t):e+Sr(s*(t-e+1))}function Qn(e,t){if(e){var n=e[t];return Nt(n)?e[t]():n}}function Gn(e,t,n){var r=v.templateSettings;e||(e=""),n=ii({},n,r);var i,s=ii({},n.imports,r.imports),u=Yr(s),a=Ft(s),f=0,l=n.interpolate||O,c="__p += '",h=pr((n.escape||O).source+"|"+l.source+"|"+(l===L?N:O).source+"|"+(n.evaluate||O).source+"|$","g");e.replace(h,function(t,n,r,s,u,a){return r||(r=s),c+=e.slice(f,a).replace(_,o),n&&(c+="' +\n__e("+n+") +\n'"),u&&(i=!0,c+="';\n"+u+";\n__p += '"),r&&(c+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),f=a+t.length,t}),c+="';\n";var p=n.variable,m=p;m||(p="obj",c="with ("+p+") {\n"+c+"\n}\n"),c=(i?c.replace(S,""):c).replace(x,"$1").replace(T,"$1;"),c="function("+p+") {\n"+(m?"":p+" || ("+p+" = {});\n")+"var __t, __p = '', __e = _.escape"+(i?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+c+"return __p\n}";var g="\n/*\n//# sourceURL="+(n.sourceURL||"/lodash/template/source["+P++ +"]")+"\n*/";try{var y=fr(u,"return "+c+g).apply(d,a)}catch(b){throw b.source=c,b}return t?y(t):(y.source=c,y)}function Yn(e,t,n){e=(e=+e)>-1?e:0;var r=-1,i=or(e);for(t=J(t,n,1);++r<e;)i[r]=t(r);return i}function Zn(e){return null==e?"":dr(e).replace(ti,at)}function er(e){var t=++g;return dr(null==e?"":e)+t}function tr(e){return e=new m(e),e.__chain__=!0,e}function nr(e,t){return t(e),e}function rr(){return this.__chain__=!0,this}function ir(){return dr(this.__wrapped__)}function sr(){return this.__wrapped__}n=n?et.defaults(K.Object(),n,et.pick(K,D)):K;var or=n.Array,ur=n.Boolean,ar=n.Date,fr=n.Function,lr=n.Math,cr=n.Number,hr=n.Object,pr=n.RegExp,dr=n.String,vr=n.TypeError,mr=[],gr=hr.prototype,yr=n._,br=pr("^"+dr(gr.valueOf).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),wr=lr.ceil,Er=n.clearTimeout,Sr=lr.floor,xr=fr.prototype.toString,Tr=br.test(Tr=hr.getPrototypeOf)&&Tr,Nr=gr.hasOwnProperty,Cr=br.test(Cr=ar.now)&&Cr||function(){return+(new ar)},kr=mr.push,Lr=n.setImmediate,Ar=n.setTimeout,Or=mr.splice,Mr=gr.toString,_r=mr.unshift,Dr=function(){try{var e={},t=br.test(t=hr.defineProperty)&&t,n=t(e,e,e)&&t}catch(r){}return n}(),Pr=br.test(Pr=Mr.bind)&&Pr,Hr=br.test(Hr=hr.create)&&Hr,Br=br.test(Br=or.isArray)&&Br,jr=n.isFinite,Fr=n.isNaN,Ir=br.test(Ir=hr.keys)&&Ir,qr=lr.max,Rr=lr.min,Ur=n.parseInt,zr=lr.random,Wr=mr.slice,Xr=br.test(n.attachEvent),Vr=Pr&&!/\n|true/.test(Pr+Xr),$r={};$r[B]=or,$r[j]=ur,$r[F]=ar,$r[I]=fr,$r[R]=hr,$r[q]=cr,$r[U]=pr,$r[z]=dr,m.prototype=v.prototype;var Jr=v.support={};Jr.fastBind=Pr&&!Vr,Jr.funcDecomp=!br.test(n.WinRTError)&&M.test(p),Jr.funcNames="string"==typeof fr.name,v.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:L,variable:"",imports:{_:v}},Hr||(it=function(e){if(Ct(e)){f.prototype=e;var t=new f;f.prototype=null}return t||{}});var Kr=Dr?function(e,t){V.value=t,Dr(e,"__bindData__",V)}:f,Qr=Br||function(e){return e&&"object"==typeof e&&"number"==typeof e.length&&Mr.call(e)==B||!1},Gr=function(e){var t,n=e,r=[];if(!n)return r;if(!$[typeof e])return r;for(t in n)Nr.call(n,t)&&r.push(t);return r},Yr=Ir?function(e){return Ct(e)?Ir(e):[]}:Gr,Zr={"&":"&","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ei=yt(Zr),ti=pr("("+Yr(ei).join("|")+")","g"),ni=pr("["+Yr(Zr).join("")+"]","g"),ri=function(e,t,n){var r,i=e,s=i;if(!i)return s;var o=arguments,u=0,a="number"==typeof n?2:o.length;if(a>3&&"function"==typeof o[a-2])var f=J(o[--a-1],o[a--],2);else a>2&&"function"==typeof o[a-1]&&(f=o[--a]);for(;++u<a;)if(i=o[u],i&&$[typeof i])for(var l=-1,c=$[typeof i]&&Yr(i),h=c?c.length:0;++l<h;)r=c[l],s[r]=f?f(s[r],i[r]):i[r];return s},ii=function(e,t,n){var r,i=e,s=i;if(!i)return s;for(var o=arguments,u=0,a="number"==typeof n?2:o.length;++u<a;)if(i=o[u],i&&$[typeof i])for(var f=-1,l=$[typeof i]&&Yr(i),c=l?l.length:0;++f<c;)r=l[f],"undefined"==typeof s[r]&&(s[r]=i[r]);return s},si=function(e,t,n){var r,i=e,s=i;if(!i)return s;if(!$[typeof i])return s;t=t&&"undefined"==typeof n?t:J(t,n,3);for(r in i)if(t(i[r],r,e)===!1)return s;return s},oi=function(e,t,n){var r,i=e,s=i;if(!i)return s;if(!$[typeof i])return s;t=t&&"undefined"==typeof n?t:J(t,n,3);for(var o=-1,u=$[typeof i]&&Yr(i),a=u?u.length:0;++o<a;)if(r=u[o],t(i[r],r,e)===!1)return s;return s},ui=function(e){if(!e||Mr.call(e)!=R)return!1;var t=e.valueOf,n="function"==typeof t&&(n=Tr(t))&&Tr(n);return n?e==n||Tr(e)==n:ut(e)},ai=nt(function(e,t,n){Nr.call(e,n)?e[n]++:e[n]=1}),fi=nt(function(e,t,n){(Nr.call(e,n)?e[n]:e[n]=[]).push(t)}),li=nt(function(e,t,n){e[n]=t}),ci=Ut;Vr&&Y&&"function"==typeof Lr&&(jn=function(e){if(!Nt(e))throw new vr;return Lr.apply(n,arguments)});var hi=8==Ur(E+"08")?Ur:function(e,t){return Ur(Mt(e)?e.replace(A,""):e,t||0)};return v.after=An,v.assign=ri,v.at=It,v.bind=On,v.bindAll=Mn,v.bindKey=_n,v.chain=tr,v.compact=an,v.compose=Dn,v.countBy=ai,v.createCallback=Pn,v.curry=Hn,v.debounce=Bn,v.defaults=ii,v.defer=jn,v.delay=Fn,v.difference=fn,v.filter=Ut,v.flatten=pn,v.forEach=Xt,v.forEachRight=Vt,v.forIn=si,v.forInRight=dt,v.forOwn=oi,v.forOwnRight=vt,v.functions=mt,v.groupBy=fi,v.indexBy=li,v.initial=vn,v.intersection=mn,v.invert=yt,v.invoke=$t,v.keys=Yr,v.map=Jt,v.max=Kt,v.memoize=In,v.merge=Dt,v.min=Qt,v.omit=Pt,v.once=qn,v.pairs=Ht,v.partial=Rn,v.partialRight=Un,v.pick=Bt,v.pluck=Gt,v.pull=bn,v.range=wn,v.reject=en,v.remove=En,v.rest=Sn,v.shuffle=nn,v.sortBy=on,v.tap=nr,v.throttle=zn,v.times=Yn,v.toArray=un,v.transform=jt,v.union=Tn,v.uniq=Nn,v.values=Ft,v.where=ci,v.without=Cn,v.wrap=Wn,v.zip=kn,v.zipObject=Ln,v.collect=Jt,v.drop=Sn,v.each=Xt,v.eachRight=Vt,v.extend=ri,v.methods=mt,v.object=Ln,v.select=Ut,v.tail=Sn,v.unique=Nn,v.unzip=kn,$n(v),v.clone=lt,v.cloneDeep=ct,v.contains=qt,v.escape=Xn,v.every=Rt,v.find=zt,v.findIndex=ln,v.findKey=ht,v.findLast=Wt,v.findLastIndex=cn,v.findLastKey=pt,v.has=gt,v.identity=Vn,v.indexOf=dn,v.isArguments=ft,v.isArray=Qr,v.isBoolean=bt,v.isDate=wt,v.isElement=Et,v.isEmpty=St,v.isEqual=xt,v.isFinite=Tt,v.isFunction=Nt,v.isNaN=kt,v.isNull=Lt,v.isNumber=At,v.isObject=Ct,v.isPlainObject=ui,v.isRegExp=Ot,v.isString=Mt,v.isUndefined=_t,v.lastIndexOf=yn,v.mixin=$n,v.noConflict=Jn,v.parseInt=hi,v.random=Kn,v.reduce=Yt,v.reduceRight=Zt,v.result=Qn,v.runInContext=p,v.size=rn,v.some=sn,v.sortedIndex=xn,v.template=Gn,v.unescape=Zn,v.uniqueId=er,v.all=Rt,v.any=sn,v.detect=zt,v.findWhere=zt,v.foldl=Yt,v.foldr=Zt,v.include=qt,v.inject=Yt,oi(v,function(e,t){v.prototype[t]||(v.prototype[t]=function(){var t=[this.__wrapped__],n=this.__chain__;kr.apply(t,arguments);var r=e.apply(v,t);return n?new m(r,n):r})}),v.first=hn,v.last=gn,v.sample=tn,v.take=hn,v.head=hn,oi(v,function(e,t){var n="sample"!==t;v.prototype[t]||(v.prototype[t]=function(t,r){var i=this.__chain__,s=e(this.__wrapped__,t,r);return i||null!=t&&(!r||n&&"function"==typeof t)?new m(s,i):s})}),v.VERSION="2.2.1",v.prototype.chain=rr,v.prototype.toString=ir,v.prototype.value=sr,v.prototype.valueOf=sr,Xt(["join","pop","shift"],function(e){var t=mr[e];v.prototype[e]=function(){var e=this.__chain__,n=t.apply(this.__wrapped__,arguments);return e?new m(n,e):n}}),Xt(["push","reverse","sort","unshift"],function(e){var t=mr[e];v.prototype[e]=function(){return t.apply(this.__wrapped__,arguments),this}}),Xt(["concat","slice","splice"],function(e){var t=mr[e];v.prototype[e]=function(){return new m(t.apply(this.__wrapped__,arguments),this.__chain__)}}),v}var d,v=[],m=[],g=0,y=+(new Date)+"",b=75,w=40,E=" 	\f\n\r\u2028\u2029??",S=/\b__p \+= '';/g,x=/\b(__p \+=) '' \+/g,T=/(__e\(.*?\)|\b__t\)) \+\n'';/g,N=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,C=/\w*$/,k=/^function[ \n\r\t]+\w/,L=/<%=([\s\S]+?)%>/g,A=RegExp("^["+E+"]*0+(?=.$)"),O=/($^)/,M=/\bthis\b/,_=/['\n\r\t\u2028\u2029\\]/g,D=["Array","Boolean","Date","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setImmediate","setTimeout"],P=0,H="[object Arguments]",B="[object Array]",j="[object Boolean]",F="[object Date]",I="[object Function]",q="[object Number]",R="[object Object]",U="[object RegExp]",z="[object String]",W={};W[I]=!1,W[H]=W[B]=W[j]=W[F]=W[q]=W[R]=W[U]=W[z]=!0;var X={leading:!1,maxWait:0,trailing:!1},V={configurable:!1,enumerable:!1,value:null,writable:!1},$={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,"undefined":!1},J={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},K=$[typeof window]&&window||this,Q=$[typeof exports]&&exports&&!exports.nodeType&&exports,G=$[typeof module]&&module&&!module.nodeType&&module,Y=G&&G.exports===Q&&Q,Z=$[typeof global]&&global;!Z||Z.global!==Z&&Z.window!==Z||(K=Z);var et=p();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(K._=et,define(function(){return et})):Q&&G?Y?(G.exports=et)._=et:Q._=et:K._=et}.call(this),function(e,t){if("function"==typeof define&&define.amd)define(["underscore","jquery","exports"],function(n,r,i){e.Backbone=t(e,i,n,r)});else if("undefined"!=typeof exports){var n=require("underscore");t(e,exports,n)}else e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}(this,function(e,t,n,r){{var i=e.Backbone,s=[],o=(s.push,s.slice);s.splice}t.VERSION="1.1.2",t.$=r,t.noConflict=function(){return e.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var u=t.Events={on:function(e,t,n){if(!f(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var r=this._events[e]||(this._events[e]=[]);return r.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,r){if(!f(this,"once",e,[t,r])||!t)return this;var i=this,s=n.once(function(){i.off(e,s),t.apply(this,arguments)});return s._callback=t,this.on(e,s,r)},off:function(e,t,r){var i,s,o,u,a,l,c,h;if(!this._events||!f(this,"off",e,[t,r]))return this;if(!e&&!t&&!r)return this._events=void 0,this;for(u=e?[e]:n.keys(this._events),a=0,l=u.length;l>a;a++)if(e=u[a],o=this._events[e]){if(this._events[e]=i=[],t||r)for(c=0,h=o.length;h>c;c++)s=o[c],(t&&t!==s.callback&&t!==s.callback._callback||r&&r!==s.context)&&i.push(s);i.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=o.call(arguments,1);if(!f(this,"trigger",e,t))return this;var n=this._events[e],r=this._events.all;return n&&l(n,t),r&&l(r,arguments),this},stopListening:function(e,t,r){var i=this._listeningTo;if(!i)return this;var s=!t&&!r;r||"object"!=typeof t||(r=this),e&&((i={})[e._listenId]=e);for(var o in i)e=i[o],e.off(t,r,this),(s||n.isEmpty(e._events))&&delete this._listeningTo[o];return this}},a=/\s+/,f=function(e,t,n,r){if(!n)return!0;if("object"==typeof n){for(var i in n)e[t].apply(e,[i,n[i]].concat(r));return!1}if(a.test(n)){for(var s=n.split(a),o=0,u=s.length;u>o;o++)e[t].apply(e,[s[o]].concat(r));return!1}return!0},l=function(e,t){var n,r=-1,i=e.length,s=t[0],o=t[1],u=t[2];switch(t.length){case 0:for(;++r<i;)(n=e[r]).callback.call(n.ctx);return;case 1:for(;++r<i;)(n=e[r]).callback.call(n.ctx,s);return;case 2:for(;++r<i;)(n=e[r]).callback.call(n.ctx,s,o);return;case 3:for(;++r<i;)(n=e[r]).callback.call(n.ctx,s,o,u);return;default:for(;++r<i;)(n=e[r]).callback.apply(n.ctx,t);return}},c={listenTo:"on",listenToOnce:"once"};n.each(c,function(e,t){u[t]=function(t,r,i){var s=this._listeningTo||(this._listeningTo={}),o=t._listenId||(t._listenId=n.uniqueId("l"));return s[o]=t,i||"object"!=typeof r||(i=this),t[e](r,i,this),this}}),u.bind=u.on,u.unbind=u.off,n.extend(t,u);var h=t.Model=function(e,t){var r=e||{};t||(t={}),this.cid=n.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(r=this.parse(r,t)||{}),r=n.defaults({},r,n.result(this,"defaults")),this.set(r,t),this.changed={},this.initialize.apply(this,arguments)};n.extend(h.prototype,u,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return n.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return n.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,r){var i,s,o,u,a,f,l,c;if(null==e)return this;if("object"==typeof e?(s=e,r=t):(s={})[e]=t,r||(r={}),!this._validate(s,r))return!1;o=r.unset,a=r.silent,u=[],f=this._changing,this._changing=!0,f||(this._previousAttributes=n.clone(this.attributes),this.changed={}),c=this.attributes,l=this._previousAttributes,this.idAttribute in s&&(this.id=s[this.idAttribute]);for(i in s)t=s[i],n.isEqual(c[i],t)||u.push(i),n.isEqual(l[i],t)?delete this.changed[i]:this.changed[i]=t,o?delete c[i]:c[i]=t;if(!a){u.length&&(this._pending=r);for(var h=0,p=u.length;p>h;h++)this.trigger("change:"+u[h],this,c[u[h]],r)}if(f)return this;if(!a)for(;this._pending;)r=this._pending,this._pending=!1,this.trigger("change",this,r);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,n.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var r in this.attributes)t[r]=void 0;return this.set(t,n.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!n.isEmpty(this.changed):n.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?n.clone(this.changed):!1;var t,r=!1,i=this._changing?this._previousAttributes:this.attributes;for(var s in e)n.isEqual(i[s],t=e[s])||((r||(r={}))[s]=t);return r},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(e){e=e?n.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=this,r=e.success;return e.success=function(n){return t.set(t.parse(n,e),e)?(r&&r(t,n,e),t.trigger("sync",t,n,e),void 0):!1},j(this,e),this.sync("read",this,e)},save:function(e,t,r){var i,s,o,u=this.attributes;if(null==e||"object"==typeof e?(i=e,r=t):(i={})[e]=t,r=n.extend({validate:!0},r),i&&!r.wait){if(!this.set(i,r))return!1}else if(!this._validate(i,r))return!1;i&&r.wait&&(this.attributes=n.extend({},u,i)),void 0===r.parse&&(r.parse=!0);var a=this,f=r.success;return r.success=function(e){a.attributes=u;var t=a.parse(e,r);return r.wait&&(t=n.extend(i||{},t)),n.isObject(t)&&!a.set(t,r)?!1:(f&&f(a,e,r),a.trigger("sync",a,e,r),void 0)},j(this,r),s=this.isNew()?"create":r.patch?"patch":"update","patch"===s&&(r.attrs=i),o=this.sync(s,this,r),i&&r.wait&&(this.attributes=u),o},destroy:function(e){e=e?n.clone(e):{};var t=this,r=e.success,i=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(n){(e.wait||t.isNew())&&i(),r&&r(t,n,e),t.isNew()||t.trigger("sync",t,n,e)},this.isNew())return e.success(),!1;j(this,e);var s=this.sync("delete",this,e);return e.wait||i(),s},url:function(){var e=n.result(this,"urlRoot")||n.result(this.collection,"url")||B();return this.isNew()?e:e.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(e){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},n.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=n.extend({},this.attributes,e);var r=this.validationError=this.validate(e,t)||null;return r?(this.trigger("invalid",this,r,n.extend(t,{validationError:r})),!1):!0}});var p=["keys","values","pairs","invert","pick","omit"];n.each(p,function(e){h.prototype[e]=function(){var t=o.call(arguments);return t.unshift(this.attributes),n[e].apply(n,t)}});var d=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,n.extend({silent:!0},t))},v={add:!0,remove:!0,merge:!0},m={add:!0,remove:!1};n.extend(d.prototype,u,{model:h,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,n.extend({merge:!1},t,m))},remove:function(e,t){var r=!n.isArray(e);e=r?[e]:n.clone(e),t||(t={});var i,s,o,u;for(i=0,s=e.length;s>i;i++)u=e[i]=this.get(e[i]),u&&(delete this._byId[u.id],delete this._byId[u.cid],o=this.indexOf(u),this.models.splice(o,1),this.length--,t.silent||(t.index=o,u.trigger("remove",u,this,t)),this._removeReference(u,t));return r?e[0]:e},set:function(e,t){t=n.defaults({},t,v),t.parse&&(e=this.parse(e,t));var r=!n.isArray(e);e=r?e?[e]:[]:n.clone(e);var i,s,o,u,a,f,l,c=t.at,p=this.model,d=this.comparator&&null==c&&t.sort!==!1,m=n.isString(this.comparator)?this.comparator:null,g=[],y=[],b={},w=t.add,E=t.merge,S=t.remove,x=!d&&w&&S?[]:!1;for(i=0,s=e.length;s>i;i++){if(a=e[i]||{},o=a instanceof h?u=a:a[p.prototype.idAttribute||"id"],f=this.get(o))S&&(b[f.cid]=!0),E&&(a=a===u?u.attributes:a,t.parse&&(a=f.parse(a,t)),f.set(a,t),d&&!l&&f.hasChanged(m)&&(l=!0)),e[i]=f;else if(w){if(u=e[i]=this._prepareModel(a,t),!u)continue;g.push(u),this._addReference(u,t)}u=f||u,!x||!u.isNew()&&b[u.id]||x.push(u),b[u.id]=!0}if(S){for(i=0,s=this.length;s>i;++i)b[(u=this.models[i]).cid]||y.push(u);y.length&&this.remove(y,t)}if(g.length||x&&x.length)if(d&&(l=!0),this.length+=g.length,null!=c)for(i=0,s=g.length;s>i;i++)this.models.splice(c+i,0,g[i]);else{x&&(this.models.length=0);var T=x||g;for(i=0,s=T.length;s>i;i++)this.models.push(T[i])}if(l&&this.sort({silent:!0}),!t.silent){for(i=0,s=g.length;s>i;i++)(u=g[i]).trigger("add",u,this,t);(l||x&&x.length)&&this.trigger("sort",this,t)}return r?e[0]:e},reset:function(e,t){t||(t={});for(var r=0,i=this.models.length;i>r;r++)this._removeReference(this.models[r],t);return t.previousModels=this.models,this._reset(),e=this.add(e,n.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,n.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,n.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return o.apply(this.models,arguments)},get:function(e){return null==e?void 0:this._byId[e]||this._byId[e.id]||this._byId[e.cid]},at:function(e){return this.models[e]},where:function(e,t){return n.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),n.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(n.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return n.invoke(this.models,"get",e)},fetch:function(e){e=e?n.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success,r=this;return e.success=function(n){var i=e.reset?"reset":"set";r[i](n,e),t&&t(r,n,e),r.trigger("sync",r,n,e)},j(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?n.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var r=this,i=t.success;return t.success=function(e,n){t.wait&&r.add(e,t),i&&i(e,n,t)},e.save(null,t),e},parse:function(e){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof h)return e;t=t?n.clone(t):{},t.collection=this;var r=new this.model(e,t);return r.validationError?(this.trigger("invalid",this,r.validationError,t),!1):r},_addReference:function(e){this._byId[e.cid]=e,null!=e.id&&(this._byId[e.id]=e),e.collection||(e.collection=this),e.on("all",this._onModelEvent,this)},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){("add"!==e&&"remove"!==e||n===this)&&("destroy"===e&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var g=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];n.each(g,function(e){d.prototype[e]=function(){var t=o.call(arguments);return t.unshift(this.models),n[e].apply(n,t)}});var y=["groupBy","countBy","sortBy","indexBy"];n.each(y,function(e){d.prototype[e]=function(t,r){var i=n.isFunction(t)?t:function(e){return e.get(t)};return n[e](this.models,i,r)}});var b=t.View=function(e){this.cid=n.uniqueId("view"),e||(e={}),n.extend(this,n.pick(e,E)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,E=["model","collection","el","id","attributes","className","tagName","events"];n.extend(b.prototype,u,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,n){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=n.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var r=e[t];if(n.isFunction(r)||(r=this[e[t]]),r){var i=t.match(w),s=i[1],o=i[2];r=n.bind(r,this),s+=".delegateEvents"+this.cid,""===o?this.$el.on(s,r):this.$el.on(s,o,r)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"),!1);else{var e=n.extend({},n.result(this,"attributes"));this.id&&(e.id=n.result(this,"id")),this.className&&(e["class"]=n.result(this,"className"));var r=t.$("<"+n.result(this,"tagName")+">").attr(e);this.setElement(r,!1)}}}),t.sync=function(e,r,i){var s=x[e];n.defaults(i||(i={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var o={type:s,dataType:"json"};if(i.url||(o.url=n.result(r,"url")||B()),null!=i.data||!r||"create"!==e&&"update"!==e&&"patch"!==e||(o.contentType="application/json",o.data=JSON.stringify(i.attrs||r.toJSON(i))),i.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),i.emulateHTTP&&("PUT"===s||"DELETE"===s||"PATCH"===s)){o.type="POST",i.emulateJSON&&(o.data._method=s);var u=i.beforeSend;i.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",s),u?u.apply(this,arguments):void 0}}"GET"===o.type||i.emulateJSON||(o.processData=!1),"PATCH"===o.type&&S&&(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var a=i.xhr=t.ajax(n.extend(o,i));return r.trigger("request",r,a,i),a};var S=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),x={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var T=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},N=/\((.*?)\)/g,C=/(\(\?)?:\w+/g,k=/\*\w+/g,L=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(T.prototype,u,{initialize:function(){},route:function(e,r,i){n.isRegExp(e)||(e=this._routeToRegExp(e)),n.isFunction(r)&&(i=r,r=""),i||(i=this[r]);var s=this;return t.history.route(e,function(n){var o=s._extractParameters(e,n);s.execute(i,o),s.trigger.apply(s,["route:"+r].concat(o)),s.trigger("route",r,o),t.history.trigger("route",s,r,o)}),this},execute:function(e,t){e&&e.apply(this,t)},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var e,t=n.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(L,"\\$&").replace(N,"(?:$1)?").replace(C,function(e,t){return t?e:"([^/?]+)"}).replace(k,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var r=e.exec(t).slice(1);return n.map(r,function(e,t){return t===r.length-1?e||null:e?decodeURIComponent(e):null})}});var A=t.History=function(){this.handlers=[],n.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},O=/^[#\/]|\s+$/g,M=/^\/+|\/+$/g,_=/msie [\w.]+/,D=/\/$/,P=/#.*$/;A.started=!1,n.extend(A.prototype,u,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=decodeURI(this.location.pathname+this.location.search);var n=this.root.replace(D,"");e.indexOf(n)||(e=e.slice(n.length))}else e=this.getHash();return e.replace(O,"")},start:function(e){if(A.started)throw new Error("Backbone.history has already been started");A.started=!0,this.options=n.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var r=this.getFragment(),i=document.documentMode,s=_.exec(navigator.userAgent.toLowerCase())&&(!i||7>=i);if(this.root=("/"+this.root+"/").replace(M,"/"),s&&this._wantsHashChange){var o=t.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=o.hide().appendTo("body")[0].contentWindow,this.navigate(r)}this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!s?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=r;var u=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&u.hash&&(this.fragment=this.getHash().replace(O,""),this.history.replaceState({},document.title,this.root+this.fragment))}return this.options.silent?void 0:this.loadUrl()},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),A.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment?!1:(this.iframe&&this.navigate(e),this.loadUrl(),void 0)},loadUrl:function(e){return e=this.fragment=this.getFragment(e),n.any(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0})},navigate:function(e,t){if(!A.started)return!1;t&&t!==!0||(t={trigger:!!t});var n=this.root+(e=this.getFragment(e||""));if(e=e.replace(P,""),this.fragment!==e){if(this.fragment=e,""===e&&"/"!==n&&(n=n.slice(0,-1)),this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),t.history=new A;var H=function(e,t){var r,i=this;r=e&&n.has(e,"constructor")?e.constructor:function(){return i.apply(this,arguments)},n.extend(r,i,t);var s=function(){this.constructor=r};return s.prototype=i.prototype,r.prototype=new s,e&&n.extend(r.prototype,e),r.__super__=i.prototype,r};h.extend=d.extend=T.extend=b.extend=A.extend=H;var B=function(){throw new Error('A "url" property or function must be specified')},j=function(e,t){var n=t.error;t.error=function(r){n&&n(e,r,t),e.trigger("error",e,r,t)}};return t}),function(e,t){"function"==typeof define&&define.amd?define([],t):e.Vectorizer=e.V=t()}(this,function(){function e(){var e=++c+"";return"v-"+e}function t(e){var t='<svg xmlns="'+f.xmlns+'" xmlns:xlink="'+f.xlink+'" version="'+l+'">'+(e||"")+"</svg>",n=new DOMParser;return n.async=!1,n.parseFromString(t,"text/xml").documentElement}function n(e,n,i){if(!e)return void 0;if("object"==typeof e)return new u(e);if(n=n||{},"svg"===e.toLowerCase())return new u(t());if("<"===e[0]){var s=t(e);if(s.childNodes.length>1){for(var o=[],a=0,l=s.childNodes.length;l>a;a++){var c=s.childNodes[a];o.push(new u(document.importNode(c,!0)))}return o}return new u(document.importNode(s.firstChild,!0))}e=document.createElementNS(f.xmlns,e);for(var h in n)r(e,h,n[h]);"[object Array]"!=Object.prototype.toString.call(i)&&(i=[i]);for(var p,a=0,l=i[0]&&i.length||0;l>a;a++)p=i[a],e.appendChild(p instanceof u?p.node:p);return new u(e)}function r(e,t,n){if(t.indexOf(":")>-1){var r=t.split(":");e.setAttributeNS(f[r[0]],r[1],n)}else"id"===t?e.id=n:e.setAttribute(t,n)}function i(e){var t,n,r;if(e){var i=/[ ,]+/,s=e.match(/translate\((.*)\)/);s&&(t=s[1].split(i));var o=e.match(/rotate\((.*)\)/);o&&(n=o[1].split(i));var u=e.match(/scale\((.*)\)/);u&&(r=u[1].split(i))}var a=r&&r[0]?parseFloat(r[0]):1;return{translate:{tx:t&&t[0]?parseInt(t[0],10):0,ty:t&&t[1]?parseInt(t[1],10):0},rotate:{angle:n&&n[0]?parseInt(n[0],10):0,cx:n&&n[1]?parseInt(n[1],10):void 0,cy:n&&n[2]?parseInt(n[2],10):void 0},scale:{sx:a,sy:r&&r[1]?parseFloat(r[1]):a}}}function s(e,t){var n=t.x*e.a+t.y*e.c+0,r=t.x*e.b+t.y*e.d+0;return{x:n,y:r}}function o(e){var t=s(e,{x:0,y:1}),n=s(e,{x:1,y:0}),r=180/Math.PI*Math.atan2(t.y,t.x)-90,i=180/Math.PI*Math.atan2(n.y,n.x);return{translateX:e.e,translateY:e.f,scaleX:Math.sqrt(e.a*e.a+e.b*e.b),scaleY:Math.sqrt(e.c*e.c+e.d*e.d),skewX:r,skewY:i,rotation:r}}function u(t){this.node=t,this.node.id||(this.node.id=e())}function a(e){var t=e.rx||e["top-rx"]||0,n=e.rx||e["bottom-rx"]||0,r=e.ry||e["top-ry"]||0,i=e.ry||e["bottom-ry"]||0;return["M",e.x,e.y+r,"v",e.height-r-i,"a",n,i,0,0,0,n,i,"h",e.width-2*n,"a",n,i,0,0,0,n,-i,"v",-(e.height-i-r),"a",t,r,0,0,0,-t,-r,"h",-(e.width-2*t),"a",t,r,0,0,0,-t,r].join(" ")}var f=(!(!window.SVGAngle&&!document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")),{xmlns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"}),l="1.1",c=0;u.prototype={translate:function(e,t,n){n=n||{},t=t||0;var r=this.attr("transform")||"",s=i(r);if("undefined"==typeof e)return s.translate;r=r.replace(/translate\([^\)]*\)/g,"").trim();var o=n.absolute?e:s.translate.tx+e,u=n.absolute?t:s.translate.ty+t,a="translate("+o+","+u+")";return this.attr("transform",(a+" "+r).trim()),this},rotate:function(e,t,n,r){r=r||{};var s=this.attr("transform")||"",o=i(s);if("undefined"==typeof e)return o.rotate;s=s.replace(/rotate\([^\)]*\)/g,"").trim(),e%=360;var u=r.absolute?e:o.rotate.angle+e,a=void 0!==t&&void 0!==n?","+t+","+n:"",f="rotate("+u+a+")";return this.attr("transform",(s+" "+f).trim()),this},scale:function(e,t){t="undefined"==typeof t?e:t;var n=this.attr("transform")||"",r=i(n);if("undefined"==typeof e)return r.scale;n=n.replace(/scale\([^\)]*\)/g,"").trim();var s="scale("+e+","+t+")";return this.attr("transform",(n+" "+s).trim()),this},bbox:function(e,t){if(!this.node.ownerSVGElement)return{x:0,y:0,width:0,height:0};var n;try{n=this.node.getBBox(),n={x:0|n.x,y:0|n.y,width:0|n.width,height:0|n.height}}catch(r){n={x:this.node.clientLeft,y:this.node.clientTop,width:this.node.clientWidth,height:this.node.clientHeight}}if(e)return n;var i=this.node.getTransformToElement(t||this.node.ownerSVGElement),s=[],o=this.node.ownerSVGElement.createSVGPoint();o.x=n.x,o.y=n.y,s.push(o.matrixTransform(i)),o.x=n.x+n.width,o.y=n.y,s.push(o.matrixTransform(i)),o.x=n.x+n.width,o.y=n.y+n.height,s.push(o.matrixTransform(i)),o.x=n.x,o.y=n.y+n.height,s.push(o.matrixTransform(i));for(var u=s[0].x,a=u,f=s[0].y,l=f,c=1,h=s.length;h>c;c++){var p=s[c].x,d=s[c].y;u>p?u=p:p>a&&(a=p),f>d?f=d:d>l&&(l=d)}return{x:u,y:f,width:a-u,height:l-f}},text:function(e,t){t=t||{};var n,r=e.split("\n"),i=0;if(this.attr("y","0.8em"),this.attr("display",e?null:"none"),this.node.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),1===r.length)return this.node.textContent=e,this;for(this.node.textContent="";i<r.length;i++)n=h("tspan",{dy:0==i?"0em":t.lineHeight||"1em",x:this.attr("x")||0}),n.node.textContent=r[i]||" ",this.append(n);return this},attr:function(e,t){if("string"==typeof e&&"undefined"==typeof t)return this.node.getAttribute(e);if("object"==typeof e)for(var n in e)e.hasOwnProperty(n)&&r(this.node,n,e[n]);else r(this.node,e,t);return this},remove:function(){this.node.parentNode&&this.node.parentNode.removeChild(this.node)},append:function(e){var t=e;"[object Array]"!==Object.prototype.toString.call(e)&&(t=[e]);for(var n=0,r=t.length;r>n;n++)e=t[n],this.node.appendChild(e instanceof u?e.node:e);return this},prepend:function(e){this.node.insertBefore(e instanceof u?e.node:e,this.node.firstChild)},svg:function(){return this.node instanceof window.SVGSVGElement?this:h(this.node.ownerSVGElement)},defs:function(){var e=this.svg().node.getElementsByTagName("defs");return e&&e.length?h(e[0]):void 0},clone:function(){var t=h(this.node.cloneNode(!0));return t.node.id=e(),t},findOne:function(e){var t=this.node.querySelector(e);return t?h(t):void 0},find:function(e){for(var t=this.node.querySelectorAll(e),n=0,r=t.length;r>n;n++)t[n]=h(t[n]);return t},toLocalPoint:function(e,t){var n=this.svg().node,r=n.createSVGPoint();r.x=e,r.y=t;try{var i=r.matrixTransform(n.getScreenCTM().inverse()),s=this.node.getTransformToElement(n).inverse()}catch(o){return r}return i.matrixTransform(s)},translateCenterToPoint:function(e){var t=this.bbox(),n=g.rect(t).center();this.translate(e.x-n.x,e.y-n.y)},translateAndAutoOrient:function(e,t,n){var r=this.scale();this.attr("transform",""),this.scale(r.sx,r.sy);var i=this.svg().node,s=this.bbox(!1,n),u=i.createSVGTransform();u.setTranslate(-s.x-s.width/2,-s.y-s.height/2);var a=i.createSVGTransform(),f=g.point(e).changeInAngle(e.x-t.x,e.y-t.y,t);a.setRotate(f,0,0);var l=i.createSVGTransform(),c=g.point(e).move(t,s.width/2);l.setTranslate(e.x+(e.x-c.x),e.y+(e.y-c.y));var h=this.node.getTransformToElement(n),p=i.createSVGTransform();p.setMatrix(l.matrix.multiply(a.matrix.multiply(u.matrix.multiply(h))));var d=o(p.matrix);return this.translate(d.translateX,d.translateY),this.rotate(d.rotation),this},animateAlongPath:function(e,t){var n=h("animateMotion",e),r=h("mpath",{"xlink:href":"#"+h(t).node.id});n.append(r),this.append(n);try{n.node.beginElement()}catch(i){if("fake"===document.documentElement.getAttribute("smiling")){var s=n.node;s.animators=[];var o=s.getAttribute("id");o&&(id2anim[o]=s);for(var u=getTargets(s),a=0,f=u.length;f>a;a++){var l=u[a],c=new Animator(s,l,a);animators.push(c),s.animators[a]=c,c.register()}}}},hasClass:function(e){return(new RegExp("(\\s|^)"+e+"(\\s|$)")).test(this.node.getAttribute("class"))},addClass:function(e){if(!this.hasClass(e)){var t=this.node.getAttribute("class")||"";this.node.setAttribute("class",(t+" "+e).trim())}return this},removeClass:function(e){if(this.hasClass(e)){var t=this.node.getAttribute("class").replace(new RegExp("(\\s|^)"+e+"(\\s|$)","g"),"$2");this.node.setAttribute("class",t)}return this},toggleClass:function(e,t){var n="undefined"==typeof t?this.hasClass(e):!t;return n?this.removeClass(e):this.addClass(e),this}};var h=n;h.decomposeMatrix=o,h.rectToPath=a;var p=h("svg").node;return h.createSVGMatrix=function(e){var t=p.createSVGMatrix();for(var n in e)t[n]=e[n];return t},h.createSVGTransform=function(){return p.createSVGTransform()},h.createSVGPoint=function(e,t){var n=p.createSVGPoint();return n.x=e,n.y=t,n},h}),function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.g=t()}(this,function(){function e(t,n){if(!(this instanceof e))return new e(t,n);var r;void 0===n&&Object(t)!==t?(r=t.split(-1===t.indexOf("@")?" ":"@"),this.x=parseInt(r[0],10),this.y=parseInt(r[1],10)):Object(t)===t?(this.x=t.x,this.y=t.y):(this.x=t,this.y=n)}function t(n,r){return this instanceof t?(this.start=e(n),this.end=e(r),void 0):new t(n,r)}function n(e,t,r,i){return this instanceof n?(void 0===t&&(t=e.y,r=e.width,i=e.height,e=e.x),this.x=e,this.y=t,this.width=r,this.height=i,void 0):new n(e,t,r,i)}function r(t,n,i){return this instanceof r?(t=e(t),this.x=t.x,this.y=t.y,this.a=n,this.b=i,void 0):new r(t,n,i)}var i=Math,s=i.abs,o=i.cos,u=i.sin,a=i.sqrt,f=i.min,l=i.max,c=(i.atan,i.atan2),h=(i.acos,i.round),p=i.floor,d=i.PI,v=i.random,m=function(e){return 180*e/d%360},g=function(e,t){return t=t||!1,e=t?e:e%360,e*d/180},y=function(e,t){return t*Math.round(e/t)},b=function(e){return e%360+(0>e?360:0)};e.prototype={toString:function(){return this.x+"@"+this.y},adhereToRect:function(e){return e.containsPoint(this)?this:(this.x=f(l(this.x,e.x),e.x+e.width),this.y=f(l(this.y,e.y),e.y+e.height),this)},theta:function(t){t=e(t);var n=-(t.y-this.y),r=t.x-this.x,i=10,s=0==n.toFixed(i)&&0==r.toFixed(i)?0:c(n,r);return 0>s&&(s=2*d+s),180*s/d},distance:function(e){return t(this,e).length()},manhattanDistance:function(e){return s(e.x-this.x)+s(e.y-this.y)},offset:function(e,t){return this.x+=e||0,this.y+=t||0,this},magnitude:function(){return a(this.x*this.x+this.y*this.y)||.01},update:function(e,t){return this.x=e||0,this.y=t||0,this},round:function(e){return this.x=e?this.x.toFixed(e):h(this.x),this.y=e?this.y.toFixed(e):h(this.y),this},normalize:function(e){var t=(e||1)/this.magnitude();return this.x=t*this.x,this.y=t*this.y,this},difference:function(t){return e(this.x-t.x,this.y-t.y)},bearing:function(e){return t(this,e).bearing()},toPolar:function(t){t=t&&e(t)||e(0,0);var n=this.x,r=this.y;return this.x=a((n-t.x)*(n-t.x)+(r-t.y)*(r-t.y)),this.y=g(t.theta(e(n,r))),this},rotate:function(t,n){n=(n+360)%360,this.toPolar(t),this.y+=g(n);var r=e.fromPolar(this.x,this.y,t);return this.x=r.x,this.y=r.y,this},move:function(t,n){var r=g(e(t).theta(this));return this.offset(o(r)*n,-u(r)*n)},changeInAngle:function(t,n,r){return e(this).offset(-t,-n).theta(r)-this.theta(r)},equals:function(e){return this.x===e.x&&this.y===e.y},snapToGrid:function(e,t){return this.x=y(this.x,e),this.y=y(this.y,t||e),this},reflection:function(t){return e(t).move(this,this.distance(t))}},e.fromPolar=function(t,n,r){r=r&&e(r)||e(0,0);var i=s(t*o(n)),a=s(t*u(n)),f=b(m(n));return 90>f?a=-a:180>f?(i=-i,a=-a):270>f&&(i=-i),e(r.x+i,r.y+a)},e.random=function(t,n,r,i){return e(p(v()*(n-t+1)+t),p(v()*(i-r+1)+r))},t.prototype={toString:function(){return this.start.toString()+" "+this.end.toString()},length:function(){return a(this.squaredLength())},squaredLength:function(){var e=this.start.x,t=this.start.y,n=this.end.x,r=this.end.y;return(e-=n)*e+(t-=r)*t},midpoint:function(){return e((this.start.x+this.end.x)/2,(this.start.y+this.end.y)/2)},intersection:function(t){var n=e(this.end.x-this.start.x,this.end.y-this.start.y),r=e(t.end.x-t.start.x,t.end.y-t.start.y),i=n.x*r.y-n.y*r.x,s=e(t.start.x-this.start.x,t.start.y-this.start.y),o=s.x*r.y-s.y*r.x,u=s.x*n.y-s.y*n.x;if(0===i||0>o*i||0>u*i)return null;if(i>0){if(o>i||u>i)return null}else if(i>o||i>u)return null;return e(this.start.x+o*n.x/i,this.start.y+o*n.y/i)},bearing:function(){var e=g(this.start.y),t=g(this.end.y),n=this.start.x,r=this.end.x,i=g(r-n),s=u(i)*o(t),a=o(e)*u(t)-u(e)*o(t)*o(i),f=m(c(s,a)),l=["NE","E","SE","S","SW","W","NW","N"],h=f-22.5;return 0>h&&(h+=360),h=parseInt(h/45),l[h]},pointAt:function(t){var n=(1-t)*this.start.x+t*this.end.x,r=(1-t)*this.start.y+t*this.end.y;return e(n,r)}},n.prototype={toString:function(){return this.origin().toString()+" "+this.corner().toString()},origin:function(){return e(this.x,this.y)},corner:function(){return e(this.x+this.width,this.y+this.height)},topRight:function(){return e(this.x+this.width,this.y)},bottomLeft:function(){return e(this.x,this.y+this.height)},center:function(){return e(this.x+this.width/2,this.y+this.height/2)},intersect:function(e){var t=this.origin(),n=this.corner(),r=e.origin(),i=e.corner();return i.x<=t.x||i.y<=t.y||r.x>=n.x||r.y>=n.y?!1:!0},sideNearestToPoint:function(t){t=e(t);var n=t.x-this.x,r=this.x+this.width-t.x,i=t.y-this.y,s=this.y+this.height-t.y,o=n,u="left";return o>r&&(o=r,u="right"),o>i&&(o=i,u="top"),o>s&&(o=s,u="bottom"),u},containsPoint:function(t){return t=e(t),t.x>=this.x&&t.x<=this.x+this.width&&t.y>=this.y&&t.y<=this.y+this.height?!0:!1},containsRect:function(e){var t=n(e).normalize(),r=t.width,i=t.height,s=t.x,o=t.y,u=this.width,a=this.height;if(0>(u|a|r|i))return!1;var f=this.x,l=this.y;if(f>s||l>o)return!1;if(u+=f,r+=s,s>=r){if(u>=f||r>u)return!1}else if(u>=f&&r>u)return!1;if(a+=l,i+=o,o>=i){if(a>=l||i>a)return!1}else if(a>=l&&i>a)return!1;return!0},pointNearestToPoint:function(t){if(t=e(t),this.containsPoint(t)){var n=this.sideNearestToPoint(t);switch(n){case"right":return e(this.x+this.width,t.y);case"left":return e(this.x,t.y);case"bottom":return e(t.x,this.y+this.height);case"top":return e(t.x,this.y)}}return t.adhereToRect(this)},intersectionWithLineFromCenterToPoint:function(n,r){n=e(n);var i,s=e(this.x+this.width/2,this.y+this.height/2);r&&n.rotate(s,r);for(var o=[t(this.origin(),this.topRight()),t(this.topRight(),this.corner()),t(this.corner(),this.bottomLeft()),t(this.bottomLeft(),this.origin())],u=t(s,n),a=o.length-1;a>=0;--a){var f=o[a].intersection(u);if(null!==f){i=f;break}}return i&&r&&i.rotate(s,-r),i},moveAndExpand:function(e){return this.x+=e.x,this.y+=e.y,this.width+=e.width,this.height+=e.height,this},round:function(e){return this.x=e?this.x.toFixed(e):h(this.x),this.y=e?this.y.toFixed(e):h(this.y),this.width=e?this.width.toFixed(e):h(this.width),this.height=e?this.height.toFixed(e):h(this.height),this},normalize:function(){var e=this.x,t=this.y,n=this.width,r=this.height;return this.width<0&&(e=this.x+this.width,n=-this.width),this.height<0&&(t=this.y+this.height,r=-this.height),this.x=e,this.y=t,this.width=n,this.height=r,this},bbox:function(e){var t=g(e||0),r=s(u(t)),i=s(o(t)),a=this.width*i+this.height*r,f=this.width*r+this.height*i;return n(this.x+(this.width-a)/2,this.y+(this.height-f)/2,a,f)}},r.prototype={toString:function(){return e(this.x,this.y).toString()+" "+this.a+" "+this.b},bbox:function(){return n(this.x-this.a,this.y-this.b,2*this.a,2*this.b)},intersectionWithLineFromCenterToPoint:function(t,n){t=e(t),n&&t.rotate(e(this.x,this.y),n);var r,i=t.x-this.x,s=t.y-this.y;if(0===i)return r=this.bbox().pointNearestToPoint(t),n?r.rotate(e(this.x,this.y),-n):r;var o=s/i,u=o*o,f=this.a*this.a,l=this.b*this.b,c=a(1/(1/f+u/l));c=0>i?-c:c;var h=o*c;return r=e(this.x+c,this.y+h),n?r.rotate(e(this.x,this.y),-n):r}};var w={curveThroughPoints:function(e){for(var t=this.getCurveControlPoints(e),n=["M",e[0].x,e[0].y],r=0;r<t[0].length;r++)n.push("C",t[0][r].x,t[0][r].y,t[1][r].x,t[1][r].y,e[r+1].x,e[r+1].y);return n},getCurveControlPoints:function(t){var n,r=[],i=[],s=t.length-1;if(1==s)return r[0]=e((2*t[0].x+t[1].x)/3,(2*t[0].y+t[1].y)/3),i[0]=e(2*r[0].x-t[0].x,2*r[0].y-t[0].y),[r,i];var o=[];for(n=1;s-1>n;n++)o[n]=4*t[n].x+2*t[n+1].x;o[0]=t[0].x+2*t[1].x,o[s-1]=(8*t[s-1].x+t[s].x)/2;var u=this.getFirstControlPoints(o);for(n=1;s-1>n;++n)o[n]=4*t[n].y+2*t[n+1].y;o[0]=t[0].y+2*t[1].y,o[s-1]=(8*t[s-1].y+t[s].y)/2;var a=this.getFirstControlPoints(o);for(n=0;s>n;n++)r.push(e(u[n],a[n])),s-1>n?i.push(e(2*t[n+1].x-u[n+1],2*t[n+1].y-a[n+1])):i.push(e((t[s].x+u[s-1])/2,(t[s].y+a[s-1])/2));return[r,i]},getFirstControlPoints:function(e){var t=e.length,n=[],r=[],i=2;n[0]=e[0]/i;for(var s=1;t>s;s++)r[s]=1/i,i=(t-1>s?4:3.5)-r[s],n[s]=(e[s]-n[s-1])/i;for(s=1;t>s;s++)n[t-s-1]-=r[t-s]*n[t-s];return n},getInversionSolver:function(e,t){function n(e,t){var n=r[e],i=r[t];return function(r){var s=(e%3?3:1)*(t%3?3:1),o=r.x*(n.y-i.y)+r.y*(i.x-n.x)+n.x*i.y-n.y*i.x;return s*o}}var r=arguments;return function(r){var i=3*n(2,3)(t),s=n(1,3)(e)/i,o=-n(2,3)(e)/i,u=s*n(3,1)(r)+o*(n(3,0)(r)+n(2,1)(r))+n(2,0)(r),a=s*n(3,0)(r)+o*n(2,0)(r)+n(1,0)(r);return a/(a-u)}},getCurveDivider:function(e,n,r,i){return function(s){var o=t(e,n).pointAt(s),u=t(n,r).pointAt(s),a=t(r,i).pointAt(s),f=t(o,u).pointAt(s),l=t(u,a).pointAt(s),c=t(f,l).pointAt(s);return[{p0:e,p1:o,p2:f,p3:c},{p0:c,p1:l,p2:a,p3:i}]}}},E={linear:function(e,t,n){var r=e[1]-e[0],i=t[1]-t[0];return(n-e[0])/r*i+t[0]||0}};return{toDeg:m,toRad:g,snapToGrid:y,normalizeAngle:b,point:e,line:t,rect:n,ellipse:r,bezier:w,scale:E}}),"object"==typeof exports)var _=require("lodash");var joint={version:"0.9.2",dia:{},ui:{},layout:{},shapes:{},format:{},connectors:{},routers:{},util:{hashCode:function(e){var t=0;if(0==e.length)return t;for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);t=(t<<5)-t+r,t&=t}return t},getByPath:function(e,t,n){n=n||".";for(var r,i=t.split(n);i.length;){if(r=i.shift(),!(r in e))return void 0;e=e[r]}return e},setByPath:function(e,t,n,r){r=r||".";var i=t.split(r),s=e,o=0;if(t.indexOf(r)>-1){for(var u=i.length;u-1>o;o++)s=s[i[o]]||(s[i[o]]={});s[i[u-1]]=n}else e[t]=n;return e},unsetByPath:function(e,t,n){n=n||".";var r=t.lastIndexOf(n);if(r>-1){var i=joint.util.getByPath(e,t.substr(0,r),n);i&&delete i[t.slice(r+1)]}else delete e[t];return e},flattenObject:function(e,t,n){t=t||".";var r={};for(var i in e)if(e.hasOwnProperty(i)){var s="object"==typeof e[i];if(s&&n&&n(e[i])&&(s=!1),s){var o=this.flattenObject(e[i],t,n);for(var u in o)o.hasOwnProperty(u)&&(r[i+t+u]=o[u])}else r[i]=e[i]}return r},uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)})},guid:function(e){return this.guid.id=this.guid.id||1,e.id=void 0===e.id?"j_"+this.guid.id++:e.id,e.id},mixin:function(){for(var e=arguments[0],t=1,n=arguments.length;n>t;t++){var r=arguments[t];(Object(r)===r||_.isFunction(r)||null!==r&&void 0!==r)&&_.each(r,function(t,n){return this.mixin.deep&&Object(t)===t?(e[n]||(e[n]=_.isArray(t)?[]:{}),this.mixin(e[n],t),void 0):(e[n]!==t&&(this.mixin.supplement&&e.hasOwnProperty(n)||(e[n]=t)),void 0)},this)}return e},supplement:function(){this.mixin.supplement=!0;var e=this.mixin.apply(this,arguments);return this.mixin.supplement=!1,e},deepMixin:function(){this.mixin.deep=!0;var e=this.mixin.apply(this,arguments);return this.mixin.deep=!1,e},deepSupplement:function(){this.mixin.deep=this.mixin.supplement=!0;var e=this.mixin.apply(this,arguments);return this.mixin.deep=this.mixin.supplement=!1,e},normalizeEvent:function(e){return e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches.length?e.originalEvent.changedTouches[0]:e},nextFrame:function(){var e,t="undefined"!=typeof window;if(t&&(e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame),!e){var n=0;e=function(e){var t=(new Date).getTime(),r=Math.max(0,16-(t-n)),i=setTimeout(function(){e(t+r)},r);return n=t+r,i}}return t?_.bind(e,window):e}(),cancelFrame:function(){var e,t="undefined"!=typeof window;return t&&(e=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.msCancelRequestAnimationFrame||window.oCancelAnimationFrame||window.oCancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelRequestAnimationFrame),e=e||clearTimeout,t?_.bind(e,window):e}(),breakText:function(e,t,n,r){r=r||{};var i=t.width,s=t.height,o=r.svgDocument||V("svg").node,u=V("<text><tspan></tspan></text>").attr(n||{}).node,a=u.firstChild,f=document.createTextNode("");a.appendChild(f),o.appendChild(u),r.svgDocument||document.body.appendChild(o);for(var l,c=e.split(" "),h=[],p=[],d=0,v=0,m=c.length;m>d;d++){var g=c[d];if(f.data=p[v]?p[v]+" "+g:g,a.getComputedTextLength()<=i)p[v]=f.data,l&&(h[v++]=!0,l=0);else{if(!p[v]||l){var y=!!l;if(l=g.length-1,y||!l){if(!l){if(!p[v]){p=[];break}c.splice(d,2,g+c[d+1]),m--,h[v++]=!0,d--;continue}c[d]=g.substring(0,l),c[d+1]=g.substring(l)+c[d+1]}else c.splice(d,1,g.substring(0,l),g.substring(l)),m++,v&&!h[v-1]&&v--;d--;continue}v++,d--}if("undefined"!=typeof s){var b=b||1.25*u.getBBox().height;if(b*p.length>s){p.splice(Math.floor(s/b));break}}}return r.svgDocument?o.removeChild(u):document.body.removeChild(o),p.join("\n")},imageToDataUri:function(e,t){if("data:"===e.substr(0,"data:".length))return setTimeout(function(){t(null,e)},0);var n=document.createElement("canvas"),r=document.createElement("img");r.onload=function(){var i=n.getContext("2d");n.width=r.width,n.height=r.height,i.drawImage(r,0,0);try{var s=(e.split(".").pop()||"png","jpeg"),o=n.toDataURL(s)}catch(u){if(/\.svg$/.test(e)){var f=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");f.open("GET",e,!1),f.send(null);var l=f.responseText;return t(null,"data:image/svg+xml,"+encodeURIComponent(l))}console.error(r.src,"fails to convert",u)}t(null,o)},r.ononerror=function(){t(new Error("Failed to load image."))},r.src=e},timing:{linear:function(e){return e},quad:function(e){return e*e},cubic:function(e){return e*e*e},inout:function(e){if(0>=e)return 0;if(e>=1)return 1;var t=e*e,n=t*e;return 4*(.5>e?n:3*(e-t)+n-.75)},exponential:function(e){return Math.pow(2,10*(e-1))},bounce:function(e){for(var t=0,n=1;1;t+=n,n/=2)if(e>=(7-4*t)/11){var r=(11-6*t-11*e)/4;return-r*r+n*n}},reverse:function(e){return function(t){return 1-e(1-t)}},reflect:function(e){return function(t){return.5*(.5>t?e(2*t):2-e(2-2*t))}},clamp:function(e,t,n){return t=t||0,n=n||1,function(r){var i=e(r);return t>i?t:i>n?n:i}},back:function(e){return e||(e=1.70158),function(t){return t*t*((e+1)*t-e)}},elastic:function(e){return e||(e=1.5),function(t){return Math.pow(2,10*(t-1))*Math.cos(20*Math.PI*e/3*t)}}},interpolate:{number:function(e,t){var n=t-e;return function(t){return e+n*t}},object:function(e,t){var n=_.keys(e);return function(r){var i,s,o={};for(i=n.length-1;-1!=i;i--)s=n[i],o[s]=e[s]+(t[s]-e[s])*r;return o}},hexColor:function(e,t){var n=parseInt(e.slice(1),16),r=parseInt(t.slice(1),16),i=255&n,s=(255&r)-i,o=65280&n,u=(65280&r)-o,a=16711680&n,f=(16711680&r)-a;return function(e){var t=i+s*e&255,n=o+u*e&65280,r=a+f*e&16711680;return"#"+(1<<24|t|n|r).toString(16).slice(1)}},unit:function(e,t){var n=/(-?[0-9]*.[0-9]*)(px|em|cm|mm|in|pt|pc|%)/,r=n.exec(e),i=n.exec(t),s=i[1].indexOf("."),o=s>0?i[1].length-s-1:0,e=+r[1],u=+i[1]-e,a=r[2];return function(t){return(e+u*t).toFixed(o)+a}}},filter:{blur:function(e){var t=_.isFinite(e.x)?e.x:2;return _.template('<filter><feGaussianBlur stdDeviation="${stdDeviation}"/></filter>',{stdDeviation:_.isFinite(e.y)?[t,e.y]:t})},dropShadow:function(e){var t="SVGFEDropShadowElement"in window?'<filter><feDropShadow stdDeviation="${blur}" dx="${dx}" dy="${dy}" flood-color="${color}" flood-opacity="${opacity}"/></filter>':'<filter><feGaussianBlur in="SourceAlpha" stdDeviation="${blur}"/><feOffset dx="${dx}" dy="${dy}" result="offsetblur"/><feFlood flood-color="${color}"/><feComposite in2="offsetblur" operator="in"/><feComponentTransfer><feFuncA type="linear" slope="${opacity}"/></feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge></filter>';return _.template(t,{dx:e.dx||0,dy:e.dy||0,opacity:_.isFinite(e.opacity)?e.opacity:1,color:e.color||"black",blur:_.isFinite(e.blur)?e.blur:4})},grayscale:function(e){var t=_.isFinite(e.amount)?e.amount:1;return _.template('<filter><feColorMatrix type="matrix" values="${a} ${b} ${c} 0 0 ${d} ${e} ${f} 0 0 ${g} ${b} ${h} 0 0 0 0 0 1 0"/></filter>',{a:.2126+.7874*(1-t),b:.7152-.7152*(1-t),c:.0722-.0722*(1-t),d:.2126-.2126*(1-t),e:.7152+.2848*(1-t),f:.0722-.0722*(1-t),g:.2126-.2126*(1-t),h:.0722+.9278*(1-t)})},sepia:function(e){var t=_.isFinite(e.amount)?e.amount:1;return _.template('<filter><feColorMatrix type="matrix" values="${a} ${b} ${c} 0 0 ${d} ${e} ${f} 0 0 ${g} ${h} ${i} 0 0 0 0 0 1 0"/></filter>',{a:.393+.607*(1-t),b:.769-.769*(1-t),c:.189-.189*(1-t),d:.349-.349*(1-t),e:.686+.314*(1-t),f:.168-.168*(1-t),g:.272-.272*(1-t),h:.534-.534*(1-t),i:.131+.869*(1-t)})},saturate:function(e){var t=_.isFinite(e.amount)?e.amount:1;return _.template('<filter><feColorMatrix type="saturate" values="${amount}"/></filter>',{amount:1-t})},hueRotate:function(e){return _.template('<filter><feColorMatrix type="hueRotate" values="${angle}"/></filter>',{angle:e.angle||0})},invert:function(e){var t=_.isFinite(e.amount)?e.amount:1;return _.template('<filter><feComponentTransfer><feFuncR type="table" tableValues="${amount} ${amount2}"/><feFuncG type="table" tableValues="${amount} ${amount2}"/><feFuncB type="table" tableValues="${amount} ${amount2}"/></feComponentTransfer></filter>',{amount:t,amount2:1-t})},brightness:function(e){return _.template('<filter><feComponentTransfer><feFuncR type="linear" slope="${amount}"/><feFuncG type="linear" slope="${amount}"/><feFuncB type="linear" slope="${amount}"/></feComponentTransfer></filter>',{amount:_.isFinite(e.amount)?e.amount:1})},contrast:function(e){var t=_.isFinite(e.amount)?e.amount:1;return _.template('<filter><feComponentTransfer><feFuncR type="linear" slope="${amount}" intercept="${amount2}"/><feFuncG type="linear" slope="${amount}" intercept="${amount2}"/><feFuncB type="linear" slope="${amount}" intercept="${amount2}"/></feComponentTransfer></filter>',{amount:t,amount2:.5-t/2})}},format:{number:function(e,t,n){function r(e){for(var t=e.length,r=[],i=0,s=n.grouping[0];t>0&&s>0;)r.push(e.substring(t-=s,t+s)),s=n.grouping[i=(i+1)%n.grouping.length];return r.reverse().join(n.thousands)}n=n||{currency:["$",""],decimal:".",thousands:",",grouping:[3]};var i=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,s=i.exec(e),o=s[1]||" ",u=s[2]||">",a=s[3]||"",f=s[4]||"",l=s[5],c=+s[6],h=s[7],p=s[8],d=s[9],v=1,m="",g="",y=!1;switch(p&&(p=+p.substring(1)),(l||"0"===o&&"="===u)&&(l=o="0",u="=",h&&(c-=Math.floor((c-1)/4))),d){case"n":h=!0,d="g";break;case"%":v=100,g="%",d="f";break;case"p":v=100,g="%",d="r";break;case"b":case"o":case"x":case"X":"#"===f&&(m="0"+d.toLowerCase());case"c":case"d":y=!0,p=0;break;case"s":v=-1,d="r"}"$"===f&&(m=n.currency[0],g=n.currency[1]),"r"!=d||p||(d="g"),null!=p&&("g"==d?p=Math.max(1,Math.min(21,p)):("e"==d||"f"==d)&&(p=Math.max(0,Math.min(20,p))));var b=l&&h;if(y&&t%1)return"";var w=0>t||0===t&&0>1/t?(t=-t,"-"):a,E=g;if(0>v){var S=this.prefix(t,p);t=S.scale(t),E=S.symbol+g}else t*=v;t=this.convert(d,t,p);var x=t.lastIndexOf("."),T=0>x?t:t.substring(0,x),N=0>x?"":n.decimal+t.substring(x+1);!l&&h&&n.grouping&&(T=r(T));var C=m.length+T.length+N.length+(b?0:w.length),k=c>C?(new Array(C=c-C+1)).join(o):"";return b&&(T=r(k+T)),w+=m,t=T+N,("<"===u?w+t+k:">"===u?k+w+t:"^"===u?k.substring(0,C>>=1)+w+t+k.substring(C):w+(b?t:k+t))+E},string:function(e,t){for(var n,r="{",i=!1,s=[];-1!==(n=e.indexOf(r));){var o,u,a;if(o=e.slice(0,n),i){u=o.split(":"),a=u.shift().split("."),o=t;for(var f=0;f<a.length;f++)o=o[a[f]];u.length&&(o=this.number(u,o))}s.push(o),e=e.slice(n+1),r=(i=!i)?"}":"{"}return s.push(e),s.join("")},convert:function(e,t,n){switch(e){case"b":return t.toString(2);case"c":return String.fromCharCode(t);case"o":return t.toString(8);case"x":return t.toString(16);case"X":return t.toString(16).toUpperCase();case"g":return t.toPrecision(n);case"e":return t.toExponential(n);case"f":return t.toFixed(n);case"r":return(t=this.round(t,this.precision(t,n))).toFixed(Math.max(0,Math.min(20,this.precision(t*(1+1e-15),n))));default:return t+""}},round:function(e,t){return t?Math.round(e*(t=Math.pow(10,t)))/t:Math.round(e)},precision:function(e,t){return t-(e?Math.ceil(Math.log(e)/Math.LN10):1)},prefix:function(e,t){var n=_.map(["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"],function(e,t){var n=Math.pow(10,3*abs(8-t));return{scale:t>8?function(e){return e/n}:function(e){return e*n},symbol:e}}),r=0;return e&&(0>e&&(e*=-1),t&&(e=d3.round(e,this.precision(e,t))),r=1+Math.floor(1e-12+Math.log(e)/Math.LN10),r=Math.max(-24,Math.min(24,3*Math.floor((0>=r?r+1:r-1)/3)))),n[8+r/3]}}}};if("object"==typeof exports&&(module.exports=joint),"object"==typeof exports)var joint={dia:{Link:require("./joint.dia.link").Link,Element:require("./joint.dia.element").Element},shapes:require("../plugins/shapes")},Backbone=require("backbone"),_=require("lodash"),g=require("./geometry");if(joint.dia.GraphCells=Backbone.Collection.extend({initialize:function(){this.on("change:z",this.sort,this)},model:function(e,t){if("link"===e.type)return new joint.dia.Link(e,t);var n=e.type.split(".")[0],r=e.type.split(".")[1];return joint.shapes[n]&&joint.shapes[n][r]?new joint.shapes[n][r](e,t):new joint.dia.Element(e,t)},comparator:function(e){return e.get("z")||0},getConnectedLinks:function(e,t){t=t||{},_.isUndefined(t.inbound)&&_.isUndefined(t.outbound)&&(t.inbound=t.outbound=!0);var n=[];return this.each(function(r){var i=r.get("source"),s=r.get("target");i&&i.id===e.id&&t.outbound&&n.push(r),s&&s.id===e.id&&t.inbound&&n.push(r)}),n}}),joint.dia.Graph=Backbone.Model.extend({initialize:function(){this.set("cells",new joint.dia.GraphCells),this.get("cells").on("all",this.trigger,this),this.get("cells").on("remove",this.removeCell,this)},toJSON:function(){var e=Backbone.Model.prototype.toJSON.apply(this,arguments);return e.cells=this.get("cells").toJSON(),e},fromJSON:function(e,t){if(!e.cells)throw new Error("Graph JSON must contain cells array.");this.set(_.omit(e,"cells"),t),this.resetCells(e.cells,t)},clear:function(e){this.trigger("batch:start"),this.get("cells").remove(this.get("cells").models,e),this.trigger("batch:stop")},_prepareCell:function(e){return e instanceof Backbone.Model&&_.isUndefined(e.get("z"))?e.set("z",this.maxZIndex()+1,{silent:!0}):_.isUndefined(e.z)&&(e.z=this.maxZIndex()+1),e},maxZIndex:function(){var e=this.get("cells").last();return e?e.get("z")||0:0},addCell:function(e,t){return _.isArray(e)?this.addCells(e,t):(this.get("cells").add(this._prepareCell(e),t||{}),this)},addCells:function(e,t){return t=t||{},t.position=e.length,_.each(e,function(e){t.position--,this.addCell(e,t)},this),this},resetCells:function(e,t){return this.get("cells").reset(_.map(e,this._prepareCell,this),t),this},removeCell:function(e,t,n){n&&n.disconnectLinks?this.disconnectLinks(e):this.removeLinks(e),this.get("cells").remove(e,{silent:!0})},getCell:function(e){return this.get("cells").get(e)},getElements:function(){return this.get("cells").filter(function(e){return e instanceof joint.dia.Element})},getLinks:function(){return this.get("cells").filter(function(e){return e instanceof joint.dia.Link})},getConnectedLinks:function(e,t){return this.get("cells").getConnectedLinks(e,t)},getNeighbors:function(e){var t=this.getConnectedLinks(e),n=[],r=this.get("cells");return _.each(t,function(t){var i=t.get("source"),s=t.get("target");if(!i.x){var o=r.get(i.id);o!==e&&n.push(o)}if(!s.x){var u=r.get(s.id);u!==e&&n.push(u)}}),n},disconnectLinks:function(e){_.each(this.getConnectedLinks(e),function(t){t.set(t.get("source").id===e.id?"source":"target",g.point(0,0))})},removeLinks:function(e){_.invoke(this.getConnectedLinks(e),"remove")},findModelsFromPoint:function(e){return _.filter(this.getElements(),function(t){return t.getBBox().containsPoint(e)})},findModelsInArea:function(e){return _.filter(this.getElements(),function(t){return t.getBBox().intersect(e)})},getBBox:function(e){var t={x:1/0,y:1/0},n={x:0,y:0};return _.each(e,function(e){var r=e.getBBox();t.x=Math.min(t.x,r.x),t.y=Math.min(t.y,r.y),n.x=Math.max(n.x,r.x+r.width),n.y=Math.max(n.y,r.y+r.height)}),g.rect(t.x,t.y,n.x-t.x,n.y-t.y)}}),"object"==typeof exports&&(module.exports.Graph=joint.dia.Graph),"object"==typeof exports)var joint={util:require("./core").util,dia:{Link:require("./joint.dia.link").Link}},Backbone=require("backbone"),_=require("lodash");if(joint.dia.Cell=Backbone.Model.extend({constructor:function(e,t){var n,r=e||{};this.cid=_.uniqueId("c"),this.attributes={},t&&t.collection&&(this.collection=t.collection),t&&t.parse&&(r=this.parse(r,t)||{}),(n=_.result(this,"defaults"))&&(r=_.merge({},n,r)),this.set(r,t),this.changed={},this.initialize.apply(this,arguments)},toJSON:function(){var e=this.constructor.prototype.defaults.attrs||{},t=this.attributes.attrs,n={};_.each(t,function(t,r){var i=e[r];_.each(t,function(e,t){_.isObject(e)&&!_.isArray(e)?_.each(e,function(e,s){i&&i[t]&&_.isEqual(i[t][s],e)||(n[r]=n[r]||{},(n[r][t]||(n[r][t]={}))[s]=e)}):i&&_.isEqual(i[t],e)||(n[r]=n[r]||{},n[r][t]=e)})});var r=_.cloneDeep(_.omit(this.attributes,"attrs"));return r.attrs=n,r},initialize:function(e){e&&e.id||this.set("id",joint.util.uuid(),{silent:!0}),this._transitionIds={},this.processPorts(),this.on("change:attrs",this.processPorts,this)},processPorts:function(){var e=this.ports,t={};_.each(this.get("attrs"),function(e){e&&e.port&&(_.isUndefined(e.port.id)?t[e.port]={id:e.port}:t[e.port.id]=e.port)});var n={};if(_.each(e,function(e,r){t[r]||(n[r]=!0)}),this.collection&&!_.isEmpty(n)){var r=this.collection.getConnectedLinks(this,{inbound:!0});_.each(r,function(e){n[e.get("target").port]&&e.remove()});var i=this.collection.getConnectedLinks(this,{outbound:!0});_.each(i,function(e){n[e.get("source").port]&&e.remove()})}this.ports=t},remove:function(e){var t=this.collection;t&&t.trigger("batch:start");var n=this.get("parent");if(n){var r=this.collection&&this.collection.get(n);r.unembed(this)}return _.invoke(this.getEmbeddedCells(),"remove",e),this.trigger("remove",this,this.collection,e),t&&t.trigger("batch:stop"),this},toFront:function(){return this.collection&&this.set("z",(this.collection.last().get("z")||0)+1),this},toBack:function(){return this.collection&&this.set("z",(this.collection.first().get("z")||0)-1),this},embed:function(e){if(this.get("parent")==e.id)throw new Error("Recursive embedding not allowed.");return this.trigger("batch:start"),e.set("parent",this.id),this.set("embeds",_.uniq((this.get("embeds")||[]).concat([e.id]))),this.trigger("batch:stop"),this},unembed:function(e){this.trigger("batch:start");var t=e.id;return e.unset("parent"),this.set("embeds",_.without(this.get("embeds"),t)),this.trigger("batch:stop"),this},getEmbeddedCells:function(){return this.collection?_.map(this.get("embeds")||[],function(e){return this.collection.get(e)},this):[]},clone:function(e){e=e||{};var t=Backbone.Model.prototype.clone.apply(this,arguments);if(t.set("id",joint.util.uuid(),{silent:!0}),t.set("embeds",""),!e.deep)return t;var n=_.sortBy(this.getEmbeddedCells(),function(e){return e instanceof joint.dia.Element}),r=[t],i={};return _.each(n,function(e){var n=e.clone({deep:!0});t.embed(n[0]),_.each(n,function(n){if(n instanceof joint.dia.Link)return n.get("source").id==this.id&&n.prop("source",{id:t.id}),n.get("target").id==this.id&&n.prop("target",{id:t.id}),i[e.id]=n,void 0;r.push(n);var s=this.collection.getConnectedLinks(e,{inbound:!0});_.each(s,function(e){var t=i[e.id]||e.clone();i[e.id]=t,t.prop("target",{id:n.id})});var o=this.collection.getConnectedLinks(e,{outbound:!0});_.each(o,function(e){var t=i[e.id]||e.clone();i[e.id]=t,t.prop("source",{id:n.id})})},this)},this),r=r.concat(_.values(i))},prop:function(e,t,n){var r="/";if(_.isString(e)){if("undefined"!=typeof t){var i=e,s=i.split("/"),o=s[0];if(1==s.length)return this.set(o,t,n);var u={},a=u,f=o;_.each(_.rest(s),function(e){a=a[f]=_.isFinite(Number(e))?[]:{},f=e}),u=joint.util.setByPath(u,i,t,"/");var l=_.merge({},this.attributes,u);return this.set(o,l[o],n)}return joint.util.getByPath(this.attributes,e,r)}return this.set(_.merge({},this.attributes,e),t)},attr:function(e,t,n){var r=this.get("attrs"),i="/";if(_.isString(e)){if("undefined"!=typeof t){var s={};return joint.util.setByPath(s,e,t,i),this.set("attrs",_.merge({},r,s),n)}return joint.util.getByPath(r,e,i)}return this.set("attrs",_.merge({},r,e),t,n)},removeAttr:function(e,t){if(_.isArray(e))return _.each(e,function(e){this.removeAttr(e,t)},this),this;var n=joint.util.unsetByPath(_.merge({},this.get("attrs")),e,"/");return this.set("attrs",n,_.extend({dirty:!0},t))},transition:function(e,t,n,r){r=r||"/";var i={duration:100,delay:10,timingFunction:joint.util.timing.linear,valueFunction:joint.util.interpolate.number};n=_.extend(i,n);var s,o=0,u=_.bind(function(t){var r,i,a;o=o||t,t-=o,i=t/n.duration,1>i?this._transitionIds[e]=r=joint.util.nextFrame(u):(i=1,delete this._transitionIds[e]),a=s(n.timingFunction(i)),n.transitionId=r,this.prop(e,a,n),r||this.trigger("transition:end",this,e)},this),a=_.bind(function(i){this.stopTransitions(e),s=n.valueFunction(joint.util.getByPath(this.attributes,e,r),t),this._transitionIds[e]=joint.util.nextFrame(i),this.trigger("transition:start",this,e)},this);return _.delay(a,n.delay,u)},getTransitions:function(){return _.keys(this._transitionIds)},stopTransitions:function(e,t){t=t||"/";var n=e&&e.split(t);return _(this._transitionIds).keys().filter(n&&function(e){return _.isEqual(n,e.split(t).slice(0,n.length))}).each(function(e){joint.util.cancelFrame(this._transitionIds[e]),delete this._transitionIds[e],this.trigger("transition:end",this,e)},this),this},addTo:function(e){return e.addCell(this),this},findView:function(e){return e.findViewByModel(this)}}),joint.dia.CellView=Backbone.View.extend({tagName:"g",attributes:function(){return{"model-id":this.model.id}},constructor:function(e){this._configure(e),Backbone.View.apply(this,arguments)},_configure:function(e){this.options&&(e=_.extend({},_.result(this,"options"),e)),this.options=e,this.options.id=this.options.id||joint.util.guid(this)},initialize:function(){_.bindAll(this,"remove","update"),this.$el.data("view",this),this.listenTo(this.model,"remove",this.remove),this.listenTo(this.model,"change:attrs",this.onChangeAttrs)},onChangeAttrs:function(e,t,n){return n.dirty?this.render():this.update()},_ensureElement:function(){var e;if(this.el)e=_.result(this,"el");else{var t=_.extend({id:this.id},_.result(this,"attributes"));this.className&&(t["class"]=_.result(this,"className")),e=V(_.result(this,"tagName"),t).node}this.setElement(e,!1)},findBySelector:function(e){var t="."===e?this.$el:this.$el.find(e);return t},notify:function(e){if(this.paper){var t=Array.prototype.slice.call(arguments,1);this.trigger.apply(this,[e].concat(t)),this.paper.trigger.apply(this.paper,[e,this].concat(t))}},getStrokeBBox:function(e){var t=!!e;e=e||this.el;var n,r=V(e).bbox(!1,this.paper.viewport);return n=t?V(e).attr("stroke-width"):this.model.attr("rect/stroke-width")||this.model.attr("circle/stroke-width")||this.model.attr("ellipse/stroke-width")||this.model.attr("path/stroke-width"),n=parseFloat(n)||0,g.rect(r).moveAndExpand({x:-n/2,y:-n/2,width:n,height:n})},getBBox:function(){return V(this.el).bbox()},highlight:function(e){e=e?this.$(e)[0]||this.el:this.el,V(e).addClass("highlighted")},unhighlight:function(e){e=e?this.$(e)[0]||this.el:this.el,V(e).removeClass("highlighted")},findMagnet:function(e){var t=this.$(e);if(0===t.length||t[0]===this.el){var n=this.model.get("attrs")||{};return n["."]&&n["."].magnet===!1?void 0:this.el}return t.attr("magnet")?t[0]:this.findMagnet(t.parent())},applyFilter:function(e,t){var n=this.findBySelector(e),r=t.name+this.paper.svg.id+joint.util.hashCode(JSON.stringify(t));if(!this.paper.svg.getElementById(r)){var i=joint.util.filter[t.name]&&joint.util.filter[t.name](t.args||{});if(!i)throw new Error("Non-existing filter "+t.name);var s=V(i);s.attr({filterUnits:"objectBoundingBox",x:-1,y:-1,width:3,height:3}),t.attrs&&s.attr(t.attrs),s.node.id=r,V(this.paper.svg).defs().append(s)}n.each(function(){V(this).attr("filter","url(#"+r+")")})},applyGradient:function(e,t,n){var r=this.findBySelector(e),i=n.type+this.paper.svg.id+joint.util.hashCode(JSON.stringify(n));if(!this.paper.svg.getElementById(i)){var s=["<"+n.type+">",_.map(n.stops,function(e){return'<stop offset="'+e.offset+'" stop-color="'+e.color+'" stop-opacity="'+(_.isFinite(e.opacity)?e.opacity:1)+'" />'}).join(""),"</"+n.type+">"].join(""),o=V(s);n.attrs&&o.attr(n.attrs),o.node.id=i,V(this.paper.svg).defs().append(o)}r.each(function(){V(this).attr(t,"url(#"+i+")")})},getSelector:function(e,t){if(e===this.el)return t;var n=$(e).index();return t=e.tagName+":nth-child("+(n+1)+") "+(t||""),this.getSelector($(e).parent()[0],t+" ")},pointerdblclick:function(e,t,n){this.notify("cell:pointerdblclick",e,t,n)},pointerclick:function(e,t,n){this.notify("cell:pointerclick",e,t,n)},pointerdown:function(e,t,n){this.model.collection&&(this.model.trigger("batch:start"),this._collection=this.model.collection),this.notify("cell:pointerdown",e,t,n)},pointermove:function(e,t,n){this.notify("cell:pointermove",e,t,n)},pointerup:function(e,t,n){this.notify("cell:pointerup",e,t,n),this._collection&&(this._collection.trigger("batch:stop"),delete this._collection)}}),"object"==typeof exports&&(module.exports.Cell=joint.dia.Cell,module.exports.CellView=joint.dia.CellView),"object"==typeof exports)var joint={util:require("./core").util,dia:{Cell:require("./joint.dia.cell").Cell,CellView:require("./joint.dia.cell").CellView}},Backbone=require("backbone"),_=require("lodash");if(joint.dia.Element=joint.dia.Cell.extend({defaults:{position:{x:0,y:0},size:{width:1,height:1},angle:0},position:function(e,t){this.set("position",{x:e,y:t})},translate:function(e,t,n){if(t=t||0,0===e&&0===t)return this;var r=this.get("position")||{x:0,y:0},i={x:r.x+e||0,y:r.y+t||0};return n&&n.transition?(_.isObject(n.transition)||(n.transition={}),this.transition("position",i,_.extend({},n.transition,{valueFunction:joint.util.interpolate.object}))):(this.set("position",i,n),_.invoke(this.getEmbeddedCells(),"translate",e,t,n)),this},resize:function(e,t){return this.trigger("batch:start"),this.set("size",{width:e,height:t}),this.trigger("batch:stop"),this},rotate:function(e,t,n){if(n){var r=this.getBBox().center(),i=this.get("size"),s=this.get("position");r.rotate(n,(this.get("angle")||0)-e);var o=r.x-i.width/2-s.x,u=r.y-i.height/2-s.y;this.trigger("batch:start"),this.translate(o,u),this.rotate(e,t),this.trigger("batch:stop")}else this.set("angle",t?e:((this.get("angle")||0)+e)%360);return this},getBBox:function(){var e=this.get("position"),t=this.get("size");return g.rect(e.x,e.y,t.width,t.height)}}),joint.dia.ElementView=joint.dia.CellView.extend({className:function(){return"element "+this.model.get("type").split(".").join(" ")},initialize:function(){_.bindAll(this,"translate","resize","rotate"),joint.dia.CellView.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"change:position",this.translate),this.listenTo(this.model,"change:size",this.resize),this.listenTo(this.model,"change:angle",this.rotate)},update:function(e,t){var n=this.model.get("attrs"),r=V(this.$(".rotatable")[0]);if(r){var i=r.attr("transform");r.attr("transform","")}var s=[];_.each(t||n,function(e,t){var n=this.findBySelector(t);if(0!==n.length){var r=["style","text","html","ref-x","ref-y","ref-dx","ref-dy","ref-width","ref-height","ref","x-alignment","y-alignment","port"];_.isObject(e.filter)&&(r.push("filter"),this.applyFilter(t,e.filter)),_.isObject(e.fill)&&(r.push("fill"),this.applyGradient(t,"fill",e.fill)),_.isObject(e.stroke)&&(r.push("stroke"),this.applyGradient(t,"stroke",e.stroke)),_.isUndefined(e.text)||n.each(function(){V(this).text(e.text+"",{lineHeight:e.lineHeight})});var i=_.omit(e,r);n.each(function(){V(this).attr(i)}),e.port&&n.attr("port",_.isUndefined(e.port.id)?e.port:e.port.id),e.style&&n.css(e.style),_.isUndefined(e.html)||n.each(function(){$(this).html(e.html+"")}),_.isUndefined(e["ref-x"])&&_.isUndefined(e["ref-y"])&&_.isUndefined(e["ref-dx"])&&_.isUndefined(e["ref-dy"])&&_.isUndefined(e["x-alignment"])&&_.isUndefined(e["y-alignment"])&&_.isUndefined(e["ref-width"])&&_.isUndefined(e["ref-height"])||_.each(n,function(e,t,n){var r=$(e);r.selector=n.selector,s.push(r)})}},this);var o=this.el.getBBox();t=t||{},_.each(s,function(e){var r=t[e.selector],i=r?_.merge({},n[e.selector],r):n[e.selector];this.positionRelative(e,o,i)},this),r&&r.attr("transform",i||"")},positionRelative:function(e,t,n){function r(e){return _.isNumber(e)&&!_.isNaN(e)}var i=n.ref,s=parseFloat(n["ref-x"]),o=parseFloat(n["ref-y"]),u=parseFloat(n["ref-dx"]),a=parseFloat(n["ref-dy"]),f=n["y-alignment"],l=n["x-alignment"],c=parseFloat(n["ref-width"]),h=parseFloat(n["ref-height"]),p=_.contains(_.pluck(_.pluck(e.parents("g"),"className"),"baseVal"),"scalable");i&&(t=V(this.findBySelector(i)[0]).bbox(!1,this.el));var d=V(e[0]);d.attr("transform")&&d.attr("transform",d.attr("transform").replace(/translate\([^)]*\)/g,"").trim()||"");var v=0,m=0;if(r(c)&&(c>=0&&1>=c?d.attr("width",c*t.width):d.attr("width",Math.max(c+t.width,0))),r(h)&&(h>=0&&1>=h?d.attr("height",h*t.height):d.attr("height",Math.max(h+t.height,0))),r(u))if(p){var g=V(this.$(".scalable")[0]).scale();v=t.x+t.width+u/g.sx}else v=t.x+t.width+u;if(r(a))if(p){var g=V(this.$(".scalable")[0]).scale();m=t.y+t.height+a/g.sy}else m=t.y+t.height+a;if(r(s))if(s>0&&1>s)v=t.x+t.width*s;else if(p){var g=V(this.$(".scalable")[0]).scale();v=t.x+s/g.sx}else v=t.x+s;if(r(o))if(o>0&&1>o)m=t.y+t.height*o;else if(p){var g=V(this.$(".scalable")[0]).scale();m=t.y+o/g.sy}else m=t.y+o;var y=d.bbox(!1,this.paper.viewport);"middle"===f?m-=y.height/2:r(f)&&(m+=f>-1&&1>f?y.height*f:f),"middle"===l?v-=y.width/2:r(l)&&(v+=l>-1&&1>l?y.width*l:l),d.translate(v,m)},renderMarkup:function(){var e=this.model.markup||this.model.get("markup");if(!e)throw new Error("properties.markup is missing while the default render() implementation is used.");var t=V(e);V(this.el).append(t)},render:function(){return this.$el.empty(),this.renderMarkup(),this.update(),this.resize(),this.rotate(),this.translate(),this},scale:function(e,t){V(this.el).scale(e,t)},resize:function(){var e=this.model.get("size")||{width:1,height:1},t=this.model.get("angle")||0,n=V(this.$(".scalable")[0]);if(n){var r=n.bbox(!0);n.attr("transform","scale("+e.width/(r.width||1)+","+e.height/(r.height||1)+")");var i=V(this.$(".rotatable")[0]),s=i&&i.attr("transform");if(s&&"null"!==s){i.attr("transform",s+" rotate("+ -t+","+e.width/2+","+e.height/2+")");var o=n.bbox(!1,this.paper.viewport);this.model.set("position",{x:o.x,y:o.y}),this.rotate()}this.update()}},translate:function(){var e=this.model.get("position")||{x:0,y:0};V(this.el).attr("transform","translate("+e.x+","+e.y+")")},rotate:function(){var e=V(this.$(".rotatable")[0]);if(e){var t=this.model.get("angle")||0,n=this.model.get("size")||{width:1,height:1},r=n.width/2,i=n.height/2;e.attr("transform","rotate("+t+","+r+","+i+")")}},pointerdown:function(e,t,n){if(e.target.getAttribute("magnet")&&this.paper.options.validateMagnet.call(this.paper,this,e.target)){this.model.trigger("batch:start");var r=this.paper.getDefaultLink(this,e.target);r.set({source:{id:this.model.id,selector:this.getSelector(e.target),port:$(e.target).attr("port")},target:{x:t,y:n}}),this.paper.model.addCell(r),this._linkView=this.paper.findViewByModel(r),this._linkView.startArrowheadMove("target")}else this._dx=t,this._dy=n,joint.dia.CellView.prototype.pointerdown.apply(this,arguments)},pointermove:function(e,t,n){if(this._linkView)this._linkView.pointermove(e,t,n);else{var r=this.paper.options.gridSize,i=_.isFunction(this.options.interactive)?this.options.interactive(this,"pointermove"):this.options.interactive;if(i!==!1){var s=this.model.get("position");this.model.translate(g.snapToGrid(s.x,r)-s.x+g.snapToGrid(t-this._dx,r),g.snapToGrid(s.y,r)-s.y+g.snapToGrid(n-this._dy,r))}this._dx=g.snapToGrid(t,r),this._dy=g.snapToGrid(n,r),joint.dia.CellView.prototype.pointermove.apply(this,arguments)}},pointerup:function(e,t,n){this._linkView?(this._linkView.pointerup(e,t,n),delete this._linkView,this.model.trigger("batch:stop")):joint.dia.CellView.prototype.pointerup.apply(this,arguments)}}),"object"==typeof exports&&(module.exports.Element=joint.dia.Element,module.exports.ElementView=joint.dia.ElementView),"object"==typeof exports)var joint={dia:{Cell:require("./joint.dia.cell").Cell,CellView:require("./joint.dia.cell").CellView}},Backbone=require("backbone"),_=require("lodash"),g=require("./geometry");if(joint.dia.Link=joint.dia.Cell.extend({markup:['<path class="connection" stroke="black"/>','<path class="marker-source" fill="black" stroke="black" />','<path class="marker-target" fill="black" stroke="black" />','<path class="connection-wrap"/>','<g class="labels"/>','<g class="marker-vertices"/>','<g class="marker-arrowheads"/>','<g class="link-tools"/>'].join(""),labelMarkup:['<g class="label">',"<rect />","<text />","</g>"].join(""),toolMarkup:['<g class="link-tool">','<g class="tool-remove" event="remove">','<circle r="11" />','<path transform="scale(.8) translate(-16, -16)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z"/>',"<title>Remove link.</title>","</g>",'<g class="tool-options" event="link:options">','<circle r="11" transform="translate(25)"/>','<path fill="white" transform="scale(.55) translate(29, -16)" d="M31.229,17.736c0.064-0.571,0.104-1.148,0.104-1.736s-0.04-1.166-0.104-1.737l-4.377-1.557c-0.218-0.716-0.504-1.401-0.851-2.05l1.993-4.192c-0.725-0.91-1.549-1.734-2.458-2.459l-4.193,1.994c-0.647-0.347-1.334-0.632-2.049-0.849l-1.558-4.378C17.165,0.708,16.588,0.667,16,0.667s-1.166,0.041-1.737,0.105L12.707,5.15c-0.716,0.217-1.401,0.502-2.05,0.849L6.464,4.005C5.554,4.73,4.73,5.554,4.005,6.464l1.994,4.192c-0.347,0.648-0.632,1.334-0.849,2.05l-4.378,1.557C0.708,14.834,0.667,15.412,0.667,16s0.041,1.165,0.105,1.736l4.378,1.558c0.217,0.715,0.502,1.401,0.849,2.049l-1.994,4.193c0.725,0.909,1.549,1.733,2.459,2.458l4.192-1.993c0.648,0.347,1.334,0.633,2.05,0.851l1.557,4.377c0.571,0.064,1.148,0.104,1.737,0.104c0.588,0,1.165-0.04,1.736-0.104l1.558-4.377c0.715-0.218,1.399-0.504,2.049-0.851l4.193,1.993c0.909-0.725,1.733-1.549,2.458-2.458l-1.993-4.193c0.347-0.647,0.633-1.334,0.851-2.049L31.229,17.736zM16,20.871c-2.69,0-4.872-2.182-4.872-4.871c0-2.69,2.182-4.872,4.872-4.872c2.689,0,4.871,2.182,4.871,4.872C20.871,18.689,18.689,20.871,16,20.871z"/>',"<title>Link options.</title>","</g>","</g>"].join(""),vertexMarkup:['<g class="marker-vertex-group" transform="translate(<%= x %>, <%= y %>)">','<circle class="marker-vertex" idx="<%= idx %>" r="10" />','<path class="marker-vertex-remove-area" idx="<%= idx %>" d="M16,5.333c-7.732,0-14,4.701-14,10.5c0,1.982,0.741,3.833,2.016,5.414L2,25.667l5.613-1.441c2.339,1.317,5.237,2.107,8.387,2.107c7.732,0,14-4.701,14-10.5C30,10.034,23.732,5.333,16,5.333z" transform="translate(5, -33)"/>','<path class="marker-vertex-remove" idx="<%= idx %>" transform="scale(.8) translate(9.5, -37)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z">',"<title>Remove vertex.</title>","</path>","</g>"].join(""),arrowheadMarkup:['<g class="marker-arrowhead-group marker-arrowhead-group-<%= end %>">','<path class="marker-arrowhead" end="<%= end %>" d="M 26 0 L 0 13 L 26 26 z" />',"</g>"].join(""),defaults:{type:"link"},disconnect:function(){return this.set({source:g.point(0,0),target:g.point(0,0)})},label:function(e,t){e=e||0;var n=this.get("labels")||[];if(0===arguments.length||1===arguments.length)return n[e];var r=_.merge({},n[e],t),i=n.slice();return i[e]=r,this.set({labels:i})},translate:function(e,t,n){var r={},i=this.get("source"),s=this.get("target"),o=this.get("vertices");return i.id||(r.source={x:i.x+e,y:i.y+t}),s.id||(r.target={x:s.x+e,y:s.y+t}),o&&o.length&&(r.vertices=_.map(o,function(n){return{x:n.x+e,y:n.y+t}})),this.set(r,n)}}),joint.dia.LinkView=joint.dia.CellView.extend({className:function(){return _.unique(this.model.get("type").split(".").concat("link")).join(" ")},options:{shortLinkLength:100},initialize:function(){joint.dia.CellView.prototype.initialize.apply(this,arguments),"function"!=typeof this.constructor.prototype.watchSource&&(this.constructor.prototype.watchSource=this._createWatcher("source"),this.constructor.prototype.watchTarget=this._createWatcher("target")),this._labelCache={},this._markerCache={},this.startListening()},startListening:function(){this.listenTo(this.model,"change:markup",this.render),this.listenTo(this.model,"change:smooth change:manhattan change:router change:connector",this.update),this.listenTo(this.model,"change:toolMarkup",function(){this.renderTools().updateToolsPosition()}),this.listenTo(this.model,"change:labels change:labelMarkup",function(){this.renderLabels().updateLabelPositions()}),this.listenTo(this.model,"change:vertices change:vertexMarkup",function(){this.renderVertexMarkers().update()}),this.listenTo(this.model,"change:source",function(e,t){this.watchSource(e,t).update()}),this.listenTo(this.model,"change:target",function(e,t){this.watchTarget(e,t).update()})},render:function(){this.$el.empty();var e=V(this.model.get("markup")||this.model.markup);if(_.isArray(e)||(e=[e]),this._V={},_.each(e,function(e){var t=e.attr("class");t&&(this._V[$.camelCase(t)]=e)},this),!this._V.connection)throw new Error("link: no connection path in the markup");return this.renderTools(),this.renderVertexMarkers(),this.renderArrowheadMarkers(),V(this.el).append(e),this.renderLabels(),this.watchSource(this.model,this.model.get("source")).watchTarget(this.model,this.model.get("target")).update(),this},renderLabels:function(){if(!this._V.labels)return this;this._labelCache={};var e=$(this._V.labels.node).empty(),t=this.model.get("labels")||[];if(!t.length)return this;var n=_.template(this.model.get("labelMarkup")||this.model.labelMarkup),r=V(n());return _.each(t,function(t,n){var i=r.clone().node;this._labelCache[n]=V(i);var s=$(i).find("text"),o=$(i).find("rect"),u=_.extend({"text-anchor":"middle","font-size":14},joint.util.getByPath(t,"attrs/text","/"));s.attr(_.omit(u,"text")),_.isUndefined(u.text)||V(s[0]).text(u.text+""),e.append(i);var f=V(s[0]).bbox(!0,e[0]);V(s[0]).translate(0,-f.height/2);var l=_.extend({fill:"white",rx:3,ry:3},joint.util.getByPath(t,"attrs/rect","/"));o.attr(_.extend(l,{x:f.x,y:f.y-f.height/2,width:f.width,height:f.height}))},this),this},renderTools:function(){if(!this._V.linkTools)return this;var e=$(this._V.linkTools.node).empty(),t=_.template(this.model.get("toolMarkup")||this.model.toolMarkup),n=V(t());return e.append(n.node),this._toolCache=n,this},renderVertexMarkers:function(){if(!this._V.markerVertices)return this;var e=$(this._V.markerVertices.node).empty(),t=_.template(this.model.get("vertexMarkup")||this.model.vertexMarkup);return _.each(this.model.get("vertices"),function(n,r){e.append(V(t(_.extend({idx:r},n))).node)}),this},renderArrowheadMarkers:function(){if(!this._V.markerArrowheads)return this;var e=$(this._V.markerArrowheads.node);e.empty();var t=_.template(this.model.get("arrowheadMarkup")||this.model.arrowheadMarkup);return this._V.sourceArrowhead=V(t({end:"source"})),this._V.targetArrowhead=V(t({end:"target"})),e.append(this._V.sourceArrowhead.node,this._V.targetArrowhead.node),this},update:function(){_.each(this.model.get("attrs"),function(e,t){_.isObject(e.filter)?(this.findBySelector(t).attr(_.omit(e,"filter")),this.applyFilter(t,e.filter)):this.findBySelector(t).attr(e)},this);var e=this.route=this.findRoute(this.model.get("vertices")||[]);this._findConnectionPoints(e);var t=this.getPathData(e);return this._V.connection.attr("d",t),this._V.connectionWrap&&this._V.connectionWrap.attr("d",t),this._translateAndAutoOrientArrows(this._V.markerSource,this._V.markerTarget),this.updateLabelPositions(),this.updateToolsPosition(),this.updateArrowheadMarkers(),delete this.options.perpendicular,this},_findConnectionPoints:function(e){var t,n,r,i,s=_.first(e);t=this.getConnectionPoint("source",this.model.get("source"),s||this.model.get("target")).round();var o=_.last(e);n=this.getConnectionPoint("target",this.model.get("target"),o||t).round();var u=this._markerCache;this._V.markerSource&&(u.sourceBBox=u.sourceBBox||this._V.markerSource.bbox(!0),r=g.point(t).move(s||n,u.sourceBBox.width*this._V.markerSource.scale().sx*-1).round()),this._V.markerTarget&&(u.targetBBox=u.targetBBox||this._V.markerTarget.bbox(!0),i=g.point(n).move(o||t,u.targetBBox.width*this._V.markerTarget.scale().sx*-1).round()),u.sourcePoint=r||t,u.targetPoint=i||n,this.sourcePoint=t,this.targetPoint=n},updateLabelPositions:function(){if(!this._V.labels)return this;var e=this.model.get("labels")||[];if(!e.length)return this;var t=this._V.connection.node,n=t.getTotalLength();return _.isNaN(n)||_.each(e,function(e,r){var i=e.position;i=i>n?n:i,i=0>i?n+i:i,i=i>1?i:n*i;var s=t.getPointAtLength(i);this._labelCache[r].attr("transform","translate("+s.x+", "+s.y+")")},this),this},updateToolsPosition:function(){if(!this._V.linkTools)return this;var e="",t=40;this.getConnectionLength()<this.options.shortLinkLength&&(e="scale(.5)",t/=2);var n=this.getPointAtLength(t);return this._toolCache.attr("transform","translate("+n.x+", "+n.y+") "+e),this},updateArrowheadMarkers:function(){if(!this._V.markerArrowheads)return this;if("none"===$.css(this._V.markerArrowheads.node,"display"))return this;var e=this.getConnectionLength()<this.options.shortLinkLength?.5:1;return this._V.sourceArrowhead.scale(e),this._V.targetArrowhead.scale(e),this._translateAndAutoOrientArrows(this._V.sourceArrowhead,this._V.targetArrowhead),this},_createWatcher:function(e){function t(t,n){n=n||{};var r=t.previous(e)||{},i=this["_"+e+"BBoxUpdate"];return this._isModel(r)&&this.stopListening(this.paper.getModelById(r.id),"change",i),this._isModel(n)&&this.listenTo(this.paper.getModelById(n.id),"change",i),_.bind(i,this)({cacheOnly:!0}),this}return t},_sourceBBoxUpdate:function(e){this.lastEndChange="source",e=e||{};var t=this.model.get("source");if(this._isModel(t)){var n=this._makeSelector(t),r=this.paper.findViewByModel(t.id),i=this.paper.viewport.querySelector(n);this.sourceBBox=r.getStrokeBBox(i),this.sourceView=r,this.sourceMagnet=i}else t&&(this.sourceBBox=g.rect(t.x,t.y,1,1));e.cacheOnly||this.update()},_targetBBoxUpdate:function(e){this.lastEndChange="target",e=e||{};var t=this.model.get("target");if(this._isModel(t)){var n=this._makeSelector(t),r=this.paper.findViewByModel(t.id),i=this.paper.viewport.querySelector(n);this.targetBBox=r.getStrokeBBox(i),this.targetView=r,this.targetMagnet=i}else t&&(this.targetBBox=g.rect(t.x,t.y,1,1));e.cacheOnly||this.update()},_translateAndAutoOrientArrows:function(e,t){e&&e.translateAndAutoOrient(this.sourcePoint,_.first(this.route)||this.targetPoint,this.paper.viewport),t&&t.translateAndAutoOrient(this.targetPoint,_.last(this.route)||this.sourcePoint,this.paper.viewport)},removeVertex:function(e){var t=_.clone(this.model.get("vertices"));return t&&t.length&&(t.splice(e,1),this.model.set("vertices",t)),this},addVertex:function(e){this.model.set("attrs",this.model.get("attrs")||{});for(var t,n=(this.model.get("attrs"),(this.model.get("vertices")||[]).slice()),r=n.slice(),i=this._V.connection.node.cloneNode(!1),s=i.getTotalLength(),o=20,u=n.length+1;u--&&(n.splice(u,0,e),V(i).attr("d",this.getPathData(this.findRoute(n))),t=i.getTotalLength(),t-s>o);)n=r.slice();return-1===u&&(u=0,n.splice(u,0,e)),this.model.set("vertices",n),u},sendToken:function(e,t,n){t=t||1e3,V(this.paper.viewport).append(e),V(e).animateAlongPath({dur:t+"ms",repeatCount:1},this._V.connection.node),_.delay(function(){V(e).remove(),n&&n()},t)},findRoute:function(e){var t=this.model.get("router");if(!t){if(!this.model.get("manhattan"))return e;t={name:"orthogonal"}}var n=joint.routers[t.name];if(!_.isFunction(n))throw"unknown router: "+t.name;var r=n.call(this,e||[],t.args||{},this);return r},getPathData:function(e){var t=this.model.get("connector");if(t||(t=this.model.get("smooth")?{name:"smooth"}:{name:"normal"}),!_.isFunction(joint.connectors[t.name]))throw"unknown connector: "+t.name;var n=joint.connectors[t.name].call(this,this._markerCache.sourcePoint,this._markerCache.targetPoint,e||this.model.get("vertices")||{},t.args||{},this);return n},getConnectionPoint:function(e,t,n){var r;if(t=t||{x:0,y:0},n=n||{x:0,y:0},this._isPoint(t))r=g.point(t);else{var i,s="source"===e?this.sourceBBox:this.targetBBox;if(this._isPoint(n))i=g.point(n);else{var o="source"===e?this.targetBBox:this.sourceBBox;i=g.rect(o).intersectionWithLineFromCenterToPoint(g.rect(s).center()),i=i||g.rect(o).center()}if(this.paper.options.perpendicularLinks||this.options.perpendicular){var u,a=g.rect(0,i.y,this.paper.options.width,1),f=g.rect(i.x,0,1,this.paper.options.height);if(a.intersect(g.rect(s)))switch(u=g.rect(s).sideNearestToPoint(i)){case"left":r=g.point(s.x,i.y);break;case"right":r=g.point(s.x+s.width,i.y);break;default:r=g.rect(s).center()}else if(f.intersect(g.rect(s)))switch(u=g.rect(s).sideNearestToPoint(i)){case"top":r=g.point(i.x,s.y);break;case"bottom":r=g.point(i.x,s.y+s.height);break;default:r=g.rect(s).center()}else r=g.rect(s).intersectionWithLineFromCenterToPoint(i),r=r||g.rect(s).center()}else if(this.paper.options.linkConnectionPoint){var l="target"===e?this.targetView:this.sourceView,c="target"===e?this.targetMagnet:this.sourceMagnet;r=this.paper.options.linkConnectionPoint(this,l,c,i)}else r=g.rect(s).intersectionWithLineFromCenterToPoint(i),r=r||g.rect(s).center()}return r},_isModel:function(e){return e&&e.id},_isPoint:function(e){return!this._isModel(e)},_makeSelector:function(e){var t='[model-id="'+e.id+'"]';return e.port?t+=' [port="'+e.port+'"]':e.selector&&(t+=" "+e.selector),t},getConnectionLength:function(){return this._V.connection.node.getTotalLength()},getPointAtLength:function(e){return this._V.connection.node.getPointAtLength(e)},_beforeArrowheadMove:function(){this.model.trigger("batch:start"),this._z=this.model.get("z"),this.model.set("z",Number.MAX_VALUE),this.el.style.pointerEvents="none",this.paper.options.markAvailable&&this._markAvailableMagnets()},_afterArrowheadMove:function(){this._z&&(this.model.set("z",this._z),delete this._z),this.el.style.pointerEvents="visiblePainted",this.paper.options.markAvailable&&this._unmarkAvailableMagnets(),this.model.trigger("batch:stop")},_createValidateConnectionArgs:function(e){function t(e,t){return n[s]=e,n[s+1]=e.el===t?void 0:t,n}var n=[];n[4]=e,n[5]=this;var r,i=0,s=0;"source"===e?(i=2,r="target"):(s=2,r="source");var o=this.model.get(r);return o.id&&(n[i]=this.paper.findViewByModel(o.id),n[i+1]=o.selector&&n[i].el.querySelector(o.selector)),t},_markAvailableMagnets:function(){var e=this.paper.model.getElements(),t=this.paper.options.validateConnection;_.chain(e).map(this.paper.findViewByModel,this.paper).each(function(e){var n="false"!==e.el.getAttribute("magnet")&&t.apply(this.paper,this._validateConnectionArgs(e,null)),r=_.filter(e.el.querySelectorAll("[magnet]"),function(n){return t.apply(this.paper,this._validateConnectionArgs(e,n))},this);n&&V(e.el).addClass("available-magnet"),_.each(r,function(e){V(e).addClass("available-magnet")}),(n||r.length)&&V(e.el).addClass("available-cell")},this)},_unmarkAvailableMagnets:function(){_.each(this.paper.el.querySelectorAll(".available-cell, .available-magnet"),function(e){V(e).removeClass("available-magnet").removeClass("available-cell")})},startArrowheadMove:function(e){this._action="arrowhead-move",this._arrowhead=e,this._validateConnectionArgs=this._createValidateConnectionArgs(this._arrowhead),this._beforeArrowheadMove()},pointerdown:function(e,t,n){function r(e){return _.isObject(i)&&i[e]===!1?!1:!0}joint.dia.CellView.prototype.pointerdown.apply(this,arguments),this._dx=t,this._dy=n;var i=_.isFunction(this.options.interactive)?this.options.interactive(this,"pointerdown"):this.options.interactive;if(i!==!1){var s=e.target.getAttribute("class");switch(s){case"marker-vertex":r("vertexMove")&&(this._action="vertex-move",this._vertexIdx=e.target.getAttribute("idx"));break;case"marker-vertex-remove":case"marker-vertex-remove-area":r("vertexRemove")&&this.removeVertex(e.target.getAttribute("idx"));break;case"marker-arrowhead":r("arrowheadMove")&&this.startArrowheadMove(e.target.getAttribute("end"));break;default:var o=e.target.parentNode.getAttribute("event");o?"remove"===o?this.model.remove():this.paper.trigger(o,e,this,t,n):r("vertexAdd")&&(this._vertexIdx=this.addVertex({x:t,y:n}),this._action="vertex-move")}this.paper.trigger("link:pointerdown",e,this,t,n)}},pointermove:function(e,t,n){switch(joint.dia.CellView.prototype.pointermove.apply(this,arguments),this._action){case"vertex-move":var r=_.clone(this.model.get("vertices"));r[this._vertexIdx]={x:t,y:n},this.model.set("vertices",r);break;case"arrowhead-move":if(this.paper.options.snapLinks){var i=this.paper.options.snapLinks.radius||50,s=this.paper.findViewsInArea({x:t-i,y:n-i,width:2*i,height:2*i});this._closestView&&this._closestView.unhighlight(this._closestEnd.selector),this._closestView=this._closestEnd=null;var o,u=g.point(t,n),a=Number.MAX_VALUE;_.each(s,function(e){"false"!==e.el.getAttribute("magnet")&&(o=e.model.getBBox().center().distance(u),i>o&&a>o&&this.paper.options.validateConnection.apply(this.paper,this._validateConnectionArgs(e,null))&&(a=o,this._closestView=e,this._closestEnd={id:e.model.id})),e.$("[magnet]").each(_.bind(function(t,n){var r=V(n).bbox(!1,this.paper.viewport);o=u.distance({x:r.x+r.width/2,y:r.y+r.height/2}),i>o&&a>o&&this.paper.options.validateConnection.apply(this.paper,this._validateConnectionArgs(e,n))&&(a=o,this._closestView=e,this._closestEnd={id:e.model.id,selector:e.getSelector(n),port:n.getAttribute("port")})},this))},this),this._closestView&&this._closestView.highlight(this._closestEnd.selector),this.model.set(this._arrowhead,this._closestEnd||{x:t,y:n})}else{var f="mousemove"===e.type?e.target:document.elementFromPoint(e.clientX,e.clientY);this._targetEvent!==f&&(this._magnetUnderPointer&&this._viewUnderPointer.unhighlight(this._magnetUnderPointer),this._viewUnderPointer=this.paper.findView(f),this._viewUnderPointer?(this._magnetUnderPointer=this._viewUnderPointer.findMagnet(f),this._magnetUnderPointer&&this.paper.options.validateConnection.apply(this.paper,this._validateConnectionArgs(this._viewUnderPointer,this._magnetUnderPointer))?this._magnetUnderPointer&&this._viewUnderPointer.highlight(this._magnetUnderPointer):this._magnetUnderPointer=null):this._magnetUnderPointer=null),this._targetEvent=f,this.model.set(this._arrowhead,{x:t,y:n})}}this._dx=t,this._dy=n},pointerup:function(){joint.dia.CellView.prototype.pointerup.apply(this,arguments),"arrowhead-move"===this._action&&(this.paper.options.snapLinks?(this._closestView&&this._closestView.unhighlight(this._closestEnd.selector),this._closestView=this._closestEnd=null):(this._magnetUnderPointer&&(this._viewUnderPointer.unhighlight(this._magnetUnderPointer),this.model.set(this._arrowhead,{id:this._viewUnderPointer.model.id,selector:this._viewUnderPointer.getSelector(this._magnetUnderPointer),port:$(this._magnetUnderPointer).attr("port")})),delete this._viewUnderPointer,delete this._magnetUnderPointer,delete this._staticView,delete this._staticMagnet),this._afterArrowheadMove()),delete this._action}}),"object"==typeof exports&&(module.exports.Link=joint.dia.Link,module.exports.LinkView=joint.dia.LinkView),joint.dia.Paper=Backbone.View.extend({className:"paper",options:{width:800,height:600,origin:{x:0,y:0},gridSize:50,perpendicularLinks:!1,elementView:joint.dia.ElementView,linkView:joint.dia.LinkView,snapLinks:!1,markAvailable:!1,defaultLink:new joint.dia.Link,validateMagnet:function(e,t){return"passive"!==t.getAttribute("magnet")},validateConnection:function(e,t,n,r,i){return("target"===i?n:e)instanceof joint.dia.ElementView}},events:{mousedown:"pointerdown",dblclick:"mousedblclick",click:"mouseclick",touchstart:"pointerdown",mousemove:"pointermove",touchmove:"pointermove"},constructor:function(e){this._configure(e),Backbone.View.apply(this,arguments)},_configure:function(e){this.options&&(e=_.extend({},_.result(this,"options"),e)),this.options=e},initialize:function(){_.bindAll(this,"addCell","sortCells","resetCells","pointerup","asyncRenderCells"),this.svg=V("svg").node,this.viewport=V("g").node,V(this.svg).append(V("defs").node),V(this.viewport).attr({"class":"viewport"}),V(this.svg).append(this.viewport),this.$el.append(this.svg),this.setOrigin(),this.setDimensions(),this.listenTo(this.model,"add",this.onAddCell),this.listenTo(this.model,"reset",this.resetCells),this.listenTo(this.model,"sort",this.sortCells),$(document).on("mouseup touchend",this.pointerup),this._mousemoved=!1},remove:function(){$(document).off("mouseup touchend",this.pointerup),Backbone.View.prototype.remove.call(this)},setDimensions:function(e,t){e=this.options.width=e||this.options.width,t=this.options.height=t||this.options.height,V(this.svg).attr({width:e,height:t}),this.trigger("resize",e,t)},setOrigin:function(e,t){this.options.origin.x=e||0,this.options.origin.y=t||0,V(this.viewport).translate(e,t,{absolute:!0}),this.trigger("translate",e,t)},fitToContent:function(e,t,n,r){_.isObject(e)?(r=e,e=r.gridWidth||1,t=r.gridHeight||1,n=r.padding||0):(r=r||{},e=e||1,t=t||1,n=n||0);var i=V(this.viewport).bbox(!0,this.svg),s=V(this.viewport).scale();i.x*=s.sx,i.y*=s.sy,i.width*=s.sx,i.height*=s.sy;var o=Math.max(Math.ceil((i.width+i.x)/e),1)*e,u=Math.max(Math.ceil((i.height+i.y)/t),1)*t,a=0,f=0;("negative"==r.allowNewOrigin&&i.x<0||"positive"==r.allowNewOrigin&&i.x>=0||"any"==r.allowNewOrigin)&&(a=Math.ceil(-i.x/e)*e,a+=n,o+=a),("negative"==r.allowNewOrigin&&i.y<0||"positive"==r.allowNewOrigin&&i.y>=0||"any"==r.allowNewOrigin)&&(f=Math.ceil(-i.y/t)*t,f+=n,u+=f),o+=n,u+=n;var l=o!=this.options.width||u!=this.options.height,c=a!=this.options.origin.x||f!=this.options.origin.y;c&&this.setOrigin(a,f),l&&this.setDimensions(o,u)},scaleContentToFit:function(e){var t=this.getContentBBox();if(t.width&&t.height){e=e||{},_.defaults(e,{padding:0,preserveAspectRatio:!0,scaleGrid:null,minScale:0,maxScale:Number.MAX_VALUE});var n=e.padding,r=e.minScaleX||e.minScale,i=e.maxScaleX||e.maxScale,s=e.minScaleY||e.minScale,o=e.maxScaleY||e.maxScale,u=e.fittingBBox||{x:this.options.origin.x,y:this.options.origin.y,width:this.options.width,height:this.options.height};u=g.rect(u).moveAndExpand({x:n,y:n,width:-2*n,height:-2*n});var a=V(this.viewport).scale(),f=u.width/t.width*a.sx,l=u.height/t.height*a.sy;if(e.preserveAspectRatio&&(f=l=Math.min(f,l)),e.scaleGrid){var c=e.scaleGrid;f=c*Math.floor(f/c),l=c*Math.floor(l/c)}f=Math.min(i,Math.max(r,f)),l=Math.min(o,Math.max(s,l)),this.scale(f,l);var h=this.getContentBBox(),p=u.x-h.x,d=u.y-h.y;this.setOrigin(p,d)}},getContentBBox:function(){var e=this.viewport.getBoundingClientRect(),t=this.viewport.getScreenCTM(),n=this.viewport.getCTM(),r=g.rect({x:e.left-t.e+n.e,y:e.top-t.f+n.f,width:e.width,height:e.height});return r},createViewForModel:function(e){var t,n=e.get("type"),r=n.split(".")[0],i=n.split(".")[1];return t=joint.shapes[r]&&joint.shapes[r][i+"View"]?new joint.shapes[r][i+"View"]({model:e,interactive:this.options.interactive}):e instanceof joint.dia.Element?new this.options.elementView({model:e,interactive:this.options.interactive}):new this.options.linkView({model:e,interactive:this.options.interactive})},onAddCell:function(e,t,n){if(this.options.async&&n.async!==!1&&_.isNumber(n.position)){if(this._asyncCells=this._asyncCells||[],this._asyncCells.push(e),0==n.position){if(this._frameId)throw"another asynchronous rendering in progress";this.asyncRenderCells(this._asyncCells),delete this._asyncCells}}else this.addCell(e)},addCell:function(e){var t=this.createViewForModel(e);V(this.viewport).append(t.el),t.paper=this,t.render(),$(t.el).find("image").on("dragstart",function(){return!1})},resetCells:function(e){$(this.viewport).empty();var t=e.models.slice();t.sort(function(e){return e instanceof joint.dia.Link?1:-1}),this._frameId&&(joint.util.cancelFrame(this._frameId),delete this._frameId),this.options.async?this.asyncRenderCells(t):(_.each(t,this.addCell,this),this.sortCells())},asyncRenderCells:function(e){var t=!1;this._frameId&&_.each(_.range(this.options.async&&this.options.async.batchSize||50),function(){var n=e.shift();t=!n,t||this.addCell(n)},this),t?(delete this._frameId,this.sortCells(),this.trigger("render:done")):this._frameId=joint.util.nextFrame(_.bind(function(){this.asyncRenderCells(e)},this))},sortCells:function(){var e=$(this.viewport).children("[model-id]"),t=this.model.get("cells");this.sortElements(e,function(e,n){var r=t.get($(e).attr("model-id")),i=t.get($(n).attr("model-id"));return(r.get("z")||0)>(i.get("z")||0)?1:-1})},sortElements:function(e,t){var n=$(e),r=n.map(function(){var e=this,t=e.parentNode,n=t.insertBefore(document.createTextNode(""),e.nextSibling);return function(){if(t===this)throw new Error("You can't sort elements if any one is a descendant of another.");t.insertBefore(this,n),t.removeChild(n)}});return Array.prototype.sort.call(n,t).each(function(e){r[e].call(this)})},scale:function(e,t,n,r){t=t||e,_.isUndefined(n)&&(n=0,r=0),V(this.viewport).attr("transform","");var i=this.options.origin.x,s=this.options.origin.y;if(n||r||i||s){var o=i-n*(e-1),u=s-r*(t-1);this.setOrigin(o,u)}return V(this.viewport).scale(e,t),this.trigger("scale",e,t,n,r),this},rotate:function(e,t,n){if(_.isUndefined(t)){var r=this.viewport.getBBox();t=r.width/2,n=r.height/2}V(this.viewport).rotate(e,t,n)},findView:function(e){var t=this.$(e);return 0===t.length||t[0]===this.el?void 0:t.data("view")?t.data("view"):this.findView(t.parent())},findViewByModel:function(e){var t=_.isString(e)?e:e.id,n=this.$('[model-id="'+t+'"]');return n.length?n.data("view"):void 0},findViewsFromPoint:function(e){e=g.point(e);var t=_.map(this.model.getElements(),this.findViewByModel);return _.filter(t,function(t){return g.rect(V(t.el).bbox(!1,this.viewport)).containsPoint(e)},this)},findViewsInArea:function(e){e=g.rect(e);var t=_.map(this.model.getElements(),this.findViewByModel);return _.filter(t,function(t){return e.intersect(g.rect(V(t.el).bbox(!1,this.viewport)))},this)},getModelById:function(e){return this.model.getCell(e)},snapToGrid:function(e){var t=V(this.viewport).toLocalPoint(e.x,e.y);return{x:g.snapToGrid(t.x,this.options.gridSize),y:g.snapToGrid(t.y,this.options.gridSize)}},getDefaultLink:function(e,t){return _.isFunction(this.options.defaultLink)?this.options.defaultLink.call(this,e,t):this.options.defaultLink.clone()},mousedblclick:function(e){e.preventDefault(),e=joint.util.normalizeEvent(e);var t=this.findView(e.target),n=this.snapToGrid({x:e.clientX,y:e.clientY});t?t.pointerdblclick(e,n.x,n.y):this.trigger("blank:pointerdblclick",e,n.x,n.y)},mouseclick:function(e){if(!this._mousemoved){e=joint.util.normalizeEvent(e);var t=this.findView(e.target),n=this.snapToGrid({x:e.clientX,y:e.clientY});t?t.pointerclick(e,n.x,n.y):this.trigger("blank:pointerclick",e,n.x,n.y)}this._mousemoved=!1},pointerdown:function(e){e=joint.util.normalizeEvent(e);var t=this.findView(e.target),n=this.snapToGrid({x:e.clientX,y:e.clientY});t?(this.sourceView=t,t.pointerdown(e,n.x,n.y)):this.trigger("blank:pointerdown",e,n.x,n.y)},pointermove:function(e){if(e.preventDefault(),e=joint.util.normalizeEvent(e),this.sourceView){this._mousemoved=!0;var t=this.snapToGrid({x:e.clientX,y:e.clientY});this.sourceView.pointermove(e,t.x,t.y)}},pointerup:function(e){e=joint.util.normalizeEvent(e);var t=this.snapToGrid({x:e.clientX,y:e.clientY});this.sourceView?(this.sourceView.pointerup(e,t.x,t.y),this.sourceView=null):this.trigger("blank:pointerup",e,t.x,t.y)}}),"object"==typeof exports)var joint={util:require("../src/core").util,shapes:{},dia:{Element:require("../src/joint.dia.element").Element,ElementView:require("../src/joint.dia.element").ElementView}},_=require("lodash");if(joint.shapes.basic={},joint.shapes.basic.Generic=joint.dia.Element.extend({defaults:joint.util.deepSupplement({type:"basic.Generic",attrs:{".":{fill:"#FFFFFF",stroke:"none"}}},joint.dia.Element.prototype.defaults)}),joint.shapes.basic.Rect=joint.shapes.basic.Generic.extend({markup:'<g class="rotatable"><g class="scalable"><rect/></g><text/></g>',defaults:joint.util.deepSupplement({type:"basic.Rect",attrs:{rect:{fill:"#FFFFFF",stroke:"black",width:100,height:60},text:{"font-size":14,text:"","ref-x":.5,"ref-y":.5,ref:"rect","y-alignment":"middle","x-alignment":"middle",fill:"black","font-family":"Arial, helvetica, sans-serif"}}},joint.shapes.basic.Generic.prototype.defaults)}),joint.shapes.basic.Text=joint.shapes.basic.Generic.extend({markup:'<g class="rotatable"><g class="scalable"><text/></g></g>',defaults:joint.util.deepSupplement({type:"basic.Text",attrs:{text:{"font-size":18,fill:"black"}}},joint.shapes.basic.Generic.prototype.defaults)}),joint.shapes.basic.Circle=joint.shapes.basic.Generic.extend({markup:'<g class="rotatable"><g class="scalable"><circle/></g><text/></g>',defaults:joint.util.deepSupplement({type:"basic.Circle",size:{width:60,height:60},attrs:{circle:{fill:"#FFFFFF",stroke:"black",r:30,transform:"translate(30, 30)"},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-y":.5,ref:"circle","y-alignment":"middle",fill:"black","font-family":"Arial, helvetica, sans-serif"}}},joint.shapes.basic.Generic.prototype.defaults)}),joint.shapes.basic.Image=joint.shapes.basic.Generic.extend({markup:'<g class="rotatable"><g class="scalable"><image/></g><text/></g>',defaults:joint.util.deepSupplement({type:"basic.Image",attrs:{text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,ref:"image","y-alignment":"middle",fill:"black","font-family":"Arial, helvetica, sans-serif"}}},joint.shapes.basic.Generic.prototype.defaults)}),joint.shapes.basic.Path=joint.shapes.basic.Generic.extend({markup:'<g class="rotatable"><g class="scalable"><path/></g><text/></g>',defaults:joint.util.deepSupplement({type:"basic.Path",size:{width:60,height:60},attrs:{path:{fill:"#FFFFFF",stroke:"black"},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,ref:"path","y-alignment":"middle",fill:"black","font-family":"Arial, helvetica, sans-serif"}}},joint.shapes.basic.Generic.prototype.defaults)}),joint.shapes.basic.Rhombus=joint.shapes.basic.Path.extend({defaults:joint.util.deepSupplement({type:"basic.Rhombus",attrs:{path:{d:"M 30 0 L 60 30 30 60 0 30 z"},text:{"ref-y":.5}}},joint.shapes.basic.Path.prototype.defaults)}),joint.shapes.basic.PortsModelInterface={initialize:function(){this.updatePortsAttrs(),this.on("change:inPorts change:outPorts",this.updatePortsAttrs,this),this.constructor.__super__.constructor.__super__.initialize.apply(this,arguments)},updatePortsAttrs:function(){var e=this.get("attrs");_.each(this._portSelectors,function(t){e[t]&&delete e[t]}),this._portSelectors=[];var t={};_.each(this.get("inPorts"),function(e,n,r){var i=this.getPortAttrs(e,n,r.length,".inPorts","in");this._portSelectors=this._portSelectors.concat(_.keys(i)),_.extend(t,i)},this),_.each(this.get("outPorts"),function(e,n,r){var i=this.getPortAttrs(e,n,r.length,".outPorts","out");this._portSelectors=this._portSelectors.concat(_.keys(i)),_.extend(t,i)},this),this.attr(t,{silent:!0}),this.processPorts(),this.trigger("process:ports")},getPortSelector:function(e){var t=".inPorts",n=this.get("inPorts").indexOf(e);if(0>n&&(t=".outPorts",n=this.get("outPorts").indexOf(e),0>n))throw new Error("getPortSelector(): Port doesn't exist.");return t+">g:nth-child("+(n+1)+")>circle"}},joint.shapes.basic.PortsViewInterface={initialize:function(){this.listenTo(this.model,"process:ports",this.update),joint.dia.ElementView.prototype.initialize.apply(this,arguments)},update:function(){this.renderPorts(),joint.dia.ElementView.prototype.update.apply(this,arguments)},renderPorts:function(){var e=this.$(".inPorts").empty(),t=this.$(".outPorts").empty(),n=_.template(this.model.portMarkup);_.each(_.filter(this.model.ports,function(e){return"in"===e.type}),function(t,r){e.append(V(n({id:r,port:t})).node)}),_.each(_.filter(this.model.ports,function(e){return"out"===e.type}),function(e,r){t.append(V(n({id:r,port:e})).node)})}},joint.shapes.basic.TextBlock=joint.shapes.basic.Generic.extend({markup:['<g class="rotatable"><g class="scalable"><rect/></g><switch>','<foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" class="fobj">','<body xmlns="http://www.w3.org/1999/xhtml"><div/></body>',"</foreignObject>",'<text class="content"/>',"</switch></g>"].join(""),defaults:joint.util.deepSupplement({type:"basic.TextBlock",attrs:{rect:{fill:"#ffffff",stroke:"#000000",width:80,height:100},text:{fill:"#000000","font-size":14,"font-family":"Arial, helvetica, sans-serif"},".content":{text:"",ref:"rect","ref-x":.5,"ref-y":.5,"y-alignment":"middle","x-alignment":"middle"}},content:""},joint.shapes.basic.Generic.prototype.defaults),initialize:function(){"undefined"!=typeof SVGForeignObjectElement&&(this.setForeignObjectSize(this,this.get("size")),this.setDivContent(this,this.get("content")),this.listenTo(this,"change:size",this.setForeignObjectSize),this.listenTo(this,"change:content",this.setDivContent)),joint.shapes.basic.Generic.prototype.initialize.apply(this,arguments)},setForeignObjectSize:function(e,t){e.attr({".fobj":_.clone(t),div:{style:_.clone(t)}})},setDivContent:function(e,t){e.attr({div:{html:t}})}}),joint.shapes.basic.TextBlockView=joint.dia.ElementView.extend({initialize:function(){joint.dia.ElementView.prototype.initialize.apply(this,arguments),"undefined"==typeof SVGForeignObjectElement&&(this.noSVGForeignObjectElement=!0,this.listenTo(this.model,"change:content",function(e){this.updateContent(e)}))},update:function(e,t){if(this.noSVGForeignObjectElement){var n=this.model,r=_.omit(t||n.get("attrs"),".content");joint.dia.ElementView.prototype.update.call(this,n,r),(!t||_.has(t,".content"))&&this.updateContent(n,t)}else joint.dia.ElementView.prototype.update.call(this,n,t)},updateContent:function(e,t){var n=_.merge({},(t||e.get("attrs"))[".content"]);delete n.text;var r=joint.util.breakText(e.get("content"),e.get("size"),n,{svgDocument:this.paper.svg}),i=joint.util.setByPath({},".content",n,"/");i[".content"].text=r,joint.dia.ElementView.prototype.update.call(this,e,i)}}),"object"==typeof exports&&(module.exports=joint.shapes.basic),joint.routers.orthogonal=function(){function e(e,t){return e.y<t.y&&e.x===t.x?"down":e.y>t.y&&e.x===t.x?"up":e.x<t.x&&e.y===t.y?"right":"left"}function t(e,t,n){var r;if(r=e.x<t.x?e.y>t.y?["up","right"]:e.y<t.y?["down","right"]:["right"]:e.x>t.x?e.y>t.y?["up","left"]:e.y<t.y?["down","left"]:["left"]:e.y>t.y?["up"]:["down"],_.contains(r,n))return n;var i=_.first(r);switch(n){case"down":if("up"===i)return _.last(r);break;case"up":if("down"===i)return _.last(r);break;case"left":if("right"===i)return _.last(r);break;case"right":if("left"===i)return _.last(r)}return i}function n(e,n,r){var i=t(e,n,r);return"down"===i||"up"===i?{x:e.x,y:n.y,d:i}:{x:n.x,y:e.y,d:i}}function r(t){t=(t||[]).slice();var r=[],o=i.center(),u=s.center();t.length||(Math.abs(o.x-u.x)<i.width/2||Math.abs(o.y-u.y)<i.height/2)&&(t=[{x:Math.min(o.x,u.x)+Math.abs(o.x-u.x)/2,y:Math.min(o.y,u.y)+Math.abs(o.y-u.y)/2}]),t.unshift(o),t.push(u);for(var l,h,p,d,v=0;v<t.length-1;v++){p=t[v],d=t[v+1],h=_.last(r),v>0&&(l=p,l.d=h?e(h,p):"top",r.push(l),h=l);var m=h&&h.d;l=n(p,d,m),g.point(l).equals(g.point(p))||g.point(l).equals(g.point(d))||r.push(l)}return r}var i,s;return function(e){return i=this.sourceBBox,s=this.targetBBox,r(e)}}(),joint.routers.manhattan=function(){"use strict";function e(e,t){for(var n,r=[],i={x:0,y:0},s=t;n=e[s];){var o=n.difference(s);o.equals(i)||(r.unshift(s),i=o),s=n}return r.unshift(s),r}function t(e,t,n){var r=n.step,i=e.center(),s=_.chain(n.directionMap).pick(t).map(function(t){var n=t.x*e.width/2,s=t.y*e.height/2,o=g.point(i).offset(n,s).snapToGrid(r);return e.containsPoint(o)&&o.offset(t.x*r,t.y*r),o}).value();return s}function n(e,t,n){var r=360/n,i=Math.floor(e.theta(t)/r);return n-i}function r(r,i,s,o){var u=o.reversed?o.endDirections:o.startDirections,f=o.reversed?o.startDirections:o.endDirections,l=r instanceof g.rect?t(r,u,o):[r],h=i instanceof g.rect?t(i,f,o):[i],p=l.length>1?r.center():l[0],d=h.length>1?i.center():h[0],v=_.filter(h,function(e){var t=g.point(e).snapToGrid(o.mapGridSize).toString(),n=_.every(s[t],function(t){return!t.containsPoint(e)});return n});if(v.length)for(var m=o.step,y=o.penalties,w=_.chain(v).invoke("snapToGrid",m).min(function(e){return o.estimateCost(p,e)}).value(),E={},S={},x={},T=o.directions,N=T.length,C=N/2,k=o.previousDirIndexes||{},L={},A={},O=_.chain(l).invoke("snapToGrid",m).each(function(e){var t=e.toString();S[t]=0,x[t]=o.estimateCost(e,w),k[t]=k[t]||n(p,e,N),A[t]=!0}).map(function(e){return e.toString()}).sortBy(function(e){return x[e]}).value(),M=o.maximumLoops,D=o.maxAllowedDirectionChange;O.length&&M--;){var P=O[0],H=g.point(P);if(w.equals(H))return o.previousDirIndexes=_.pick(k,P),e(E,H);O.splice(0,1),A[U]=null,L[U]=!0;for(var B=k[P],j=S[P],F=0;N>F;F++){var I=Math.abs(F-B);if(I>C&&(I=N-I),!(I>D)){var q=T[F],R=g.point(H).offset(q.offsetX,q.offsetY),U=R.toString();if(!L[U]){var z=g.point(R).snapToGrid(o.mapGridSize).toString(),W=_.every(s[z],function(e){return!e.containsPoint(R)});if(W){var X=_.has(A,U),V=j+q.cost;if((!X||V<S[U])&&(E[U]=H,k[U]=F,S[U]=V,x[U]=V+o.estimateCost(R,w)+y[I],!X)){var $=_.sortedIndex(O,U,function(e){return x[e]});O.splice($,0,U),A[U]=!0}}}}}}return o.fallbackRoute(p,d,o)}function i(e,t){t.directions=_.result(t,"directions"),t.penalties=_.result(t,"penalties"),t.paddingBox=_.result(t,"paddingBox"),this.options.perpendicular=!!t.perpendicular;var n=t.reversed="source"===this.lastEndChange,i=n?g.rect(this.targetBBox):g.rect(this.sourceBBox),s=n?g.rect(this.sourceBBox):g.rect(this.targetBBox);i.moveAndExpand(t.paddingBox),s.moveAndExpand(t.paddingBox);for(var o=this.model,u=this.paper.model,a=_.chain(t.excludeEnds).map(o.get,o).pluck("id").map(u.getCell,u).value(),f=t.mapGridSize,l=_.chain(u.getElements()).difference(a).reject(function(e){return _.contains(t.excludeTypes,e.get("type"))}).invoke("getBBox").invoke("moveAndExpand",t.paddingBox).foldl(function(e,t){for(var n=t.origin().snapToGrid(f),r=t.corner().snapToGrid(f),i=n.x;i<=r.x;i+=f)for(var s=n.y;s<=r.y;s+=f){var o=i+"@"+s;e[o]=e[o]||[],e[o].push(t)}return e},{}).value(),c=[],h=_.map(e,g.point),p=i.center(),v=0,m=h.length;m>=v;v++){var y=null,b=w||i,w=h[v];if(!w){w=s;var E=!this.model.get("source").id||!this.model.get("target").id;if(E&&_.isFunction(t.draggingRoute)){var S=b instanceof g.rect?b.center():b;y=t.draggingRoute(S,w.origin(),t)}}y=y||r(b,w,l,t);var x=_.first(y);x&&x.equals(p)&&y.shift(),p=_.last(y)||p,c=c.concat(y)}return n?c.reverse():c}var s={step:10,perpendicular:!0,mapGridSize:100,excludeEnds:[],excludeTypes:["basic.Text"],maximumLoops:500,startDirections:["left","right","top","bottom"],endDirections:["left","right","top","bottom"],directionMap:{right:{x:1,y:0},bottom:{x:0,y:1},left:{x:-1,y:0},top:{x:0,y:-1}},maxAllowedDirectionChange:1,paddingBox:function(){var e=this.step;return{x:-e,y:-e,width:2*e,height:2*e}},directions:function(){var e=this.step;return[{offsetX:e,offsetY:0,cost:e},{offsetX:0,offsetY:e,cost:e},{offsetX:-e,offsetY:0,cost:e},{offsetX:0,offsetY:-e,cost:e}]},penalties:function(){return[0,this.step/2,this.step]},estimateCost:function(e,t){return e.manhattanDistance(t)},fallbackRoute:function(e,t,n){var r=n.prevDirIndexes||{},i=(r[e]||0)%2?g.point(e.x,t.y):g.point(t.x,e.y);return[i,t]},draggingRoute:null};return function(e,t,n){return i.call(n,e,_.extend({},s,t))}}(),joint.routers.metro=function(){if(!_.isFunction(joint.routers.manhattan))throw"Metro requires the manhattan router.";var e={diagonalCost:null,directions:function(){var e=this.step,t=this.diagonalCost||Math.ceil(Math.sqrt(e*e<<1));return[{offsetX:e,offsetY:0,cost:e},{offsetX:e,offsetY:e,cost:t},{offsetX:0,offsetY:e,cost:e},{offsetX:-e,offsetY:e,cost:t},{offsetX:-e,offsetY:0,cost:e},{offsetX:-e,offsetY:-e,cost:t},{offsetX:0,offsetY:-e,cost:e},{offsetX:e,offsetY:-e,cost:t}]},fallbackRoute:function(e,t){var n=e.theta(t),r={x:t.x,y:e.y},i={x:e.x,y:t.y};if(n%180>90){var s=r;r=i,i=s}var o=45>n%90?r:i,u=g.line(e,o),a=90*Math.ceil(n/90),f=g.point.fromPolar(u.squaredLength(),g.toRad(a+135),o),l=g.line(t,f),c=u.intersection(l);return c?[c.round(),t]:[t]}};return function(t,n,r){return joint.routers.manhattan(t,_.extend({},e,n),r)}}(),joint.connectors.normal=function(e,t,n){var r=["M",e.x,e.y];return _.each(n,function(e){r.push(e.x,e.y)}),r.push(t.x,t.y),r.join(" ")},joint.connectors.rounded=function(e,t,n,r){var i,s,o,u,a,f,l=r.radius||10,c=["M",e.x,e.y];return _.each(n,function(r,p){a=n[p-1]||e,f=n[p+1]||t,o=u||g.point(r).distance(a)/2,u=g.point(r).distance(f)/2,i=g.point(r).move(a,-Math.min(l,o)).round(),s=g.point(r).move(f,-Math.min(l,u)).round(),c.push(i.x,i.y,"S",r.x,r.y,s.x,s.y,"L")}),c.push(t.x,t.y),c.join(" ")},joint.connectors.smooth=function(e,t,n){var r;if(n.length)r=g.bezier.curveThroughPoints([e].concat(n).concat([t]));else{var i=e.x<t.x?t.x-(t.x-e.x)/2:e.x-(e.x-t.x)/2;r=["M",e.x,e.y,"C",i,e.y,i,t.y,t.x,t.y]}return r.join(" ")},"object"==typeof exports)var joint={util:require("../src/core").util,shapes:{},dia:{Element:require("../src/joint.dia.element").Element,Link:require("../src/joint.dia.link").Link}};if(joint.shapes.erd={},joint.shapes.erd.Entity=joint.dia.Element.extend({markup:'<g class="rotatable"><g class="scalable"><polygon class="outer"/><polygon class="inner"/></g><text/></g>',defaults:joint.util.deepSupplement({type:"erd.Entity",size:{width:150,height:60},attrs:{".outer":{fill:"#2ECC71",stroke:"#27AE60","stroke-width":2,points:"100,0 100,60 0,60 0,0"},".inner":{fill:"#2ECC71",stroke:"#27AE60","stroke-width":2,points:"95,5 95,55 5,55 5,5",display:"none"},text:{text:"Entity","font-family":"Arial","font-size":14,ref:".outer","ref-x":.5,"ref-y":.5,"x-alignment":"middle","y-alignment":"middle"}}},joint.dia.Element.prototype.defaults)}),joint.shapes.erd.WeakEntity=joint.shapes.erd.Entity.extend({defaults:joint.util.deepSupplement({type:"erd.WeakEntity",attrs:{".inner":{display:"auto"},text:{text:"Weak Entity"}}},joint.shapes.erd.Entity.prototype.defaults)}),joint.shapes.erd.Relationship=joint.dia.Element.extend({markup:'<g class="rotatable"><g class="scalable"><polygon class="outer"/><polygon class="inner"/></g><text/></g>',defaults:joint.util.deepSupplement({type:"erd.Relationship",size:{width:80,height:80},attrs:{".outer":{fill:"#3498DB",stroke:"#2980B9","stroke-width":2,points:"40,0 80,40 40,80 0,40"},".inner":{fill:"#3498DB",stroke:"#2980B9","stroke-width":2,points:"40,5 75,40 40,75 5,40",display:"none"},text:{text:"Relationship","font-family":"Arial","font-size":12,ref:".","ref-x":.5,"ref-y":.5,"x-alignment":"middle","y-alignment":"middle"}}},joint.dia.Element.prototype.defaults)}),joint.shapes.erd.IdentifyingRelationship=joint.shapes.erd.Relationship.extend({defaults:joint.util.deepSupplement({type:"erd.IdentifyingRelationship",attrs:{".inner":{display:"auto"},text:{text:"Identifying"}}},joint.shapes.erd.Relationship.prototype.defaults)}),joint.shapes.erd.Attribute=joint.dia.Element.extend({markup:'<g class="rotatable"><g class="scalable"><ellipse class="outer"/><ellipse class="inner"/></g><text/></g>',defaults:joint.util.deepSupplement({type:"erd.Attribute",size:{width:100,height:50},attrs:{ellipse:{transform:"translate(50, 25)"},".outer":{stroke:"#D35400","stroke-width":2,cx:0,cy:0,rx:50,ry:25,fill:"#E67E22"},".inner":{stroke:"#D35400","stroke-width":2,cx:0,cy:0,rx:45,ry:20,fill:"transparent",display:"none"},text:{"font-family":"Arial","font-size":14,ref:".","ref-x":.5,"ref-y":.5,"x-alignment":"middle","y-alignment":"middle"}}},joint.dia.Element.prototype.defaults)}),joint.shapes.erd.Multivalued=joint.shapes.erd.Attribute.extend({defaults:joint.util.deepSupplement({type:"erd.Multivalued",attrs:{".inner":{display:"block"},text:{text:"multivalued"}}},joint.shapes.erd.Attribute.prototype.defaults)}),joint.shapes.erd.Derived=joint.shapes.erd.Attribute.extend({defaults:joint.util.deepSupplement({type:"erd.Derived",attrs:{".outer":{"stroke-dasharray":"3,5"},text:{text:"derived"}}},joint.shapes.erd.Attribute.prototype.defaults)}),joint.shapes.erd.Key=joint.shapes.erd.Attribute.extend({defaults:joint.util.deepSupplement({type:"erd.Key",attrs:{ellipse:{"stroke-width":4},text:{text:"key","font-weight":"bold","text-decoration":"underline"}}},joint.shapes.erd.Attribute.prototype.defaults)}),joint.shapes.erd.Normal=joint.shapes.erd.Attribute.extend({defaults:joint.util.deepSupplement({type:"erd.Normal",attrs:{text:{text:"Normal"}}},joint.shapes.erd.Attribute.prototype.defaults)}),joint.shapes.erd.ISA=joint.dia.Element.extend({markup:'<g class="rotatable"><g class="scalable"><polygon/></g><text/></g>',defaults:joint.util.deepSupplement({type:"erd.ISA",size:{width:100,height:50},attrs:{polygon:{points:"0,0 50,50 100,0",fill:"#F1C40F",stroke:"#F39C12","stroke-width":2},text:{text:"ISA",ref:".","ref-x":.5,"ref-y":.3,"x-alignment":"middle","y-alignment":"middle"}}},joint.dia.Element.prototype.defaults)}),joint.shapes.erd.Line=joint.dia.Link.extend({defaults:{type:"erd.Line"},cardinality:function(e){this.set("labels",[{position:-20,attrs:{text:{dy:-8,text:e}}}])}}),"object"==typeof exports&&(module.exports=joint.shapes.erd),"object"==typeof exports)var joint={util:require("../src/core").util,shapes:{basic:require("./joint.shapes.basic")},dia:{Element:require("../src/joint.dia.element").Element,Link:require("../src/joint.dia.link").Link}};if(joint.shapes.fsa={},joint.shapes.fsa.State=joint.shapes.basic.Circle.extend({defaults:joint.util.deepSupplement({type:"fsa.State",attrs:{circle:{"stroke-width":3},text:{"font-weight":"bold"}}},joint.shapes.basic.Circle.prototype.defaults)}),joint.shapes.fsa.StartState=joint.dia.Element.extend({markup:'<g class="rotatable"><g class="scalable"><circle/></g></g>',defaults:joint.util.deepSupplement({type:"fsa.StartState",size:{width:20,height:20},attrs:{circle:{transform:"translate(10, 10)",r:10,fill:"black"}}},joint.dia.Element.prototype.defaults)}),joint.shapes.fsa.EndState=joint.dia.Element.extend({markup:'<g class="rotatable"><g class="scalable"><circle class="outer"/><circle class="inner"/></g></g>',defaults:joint.util.deepSupplement({type:"fsa.EndState",size:{width:20,height:20},attrs:{".outer":{transform:"translate(10, 10)",r:10,fill:"#FFFFFF",stroke:"black"},".inner":{transform:"translate(10, 10)",r:6,fill:"#000000"}}},joint.dia.Element.prototype.defaults)}),joint.shapes.fsa.Arrow=joint.dia.Link.extend({defaults:joint.util.deepSupplement({type:"fsa.Arrow",attrs:{".marker-target":{d:"M 10 0 L 0 5 L 10 10 z"}},smooth:!0},joint.dia.Link.prototype.defaults)}),"object"==typeof exports&&(module.exports=joint.shapes.fsa),"object"==typeof exports)var joint={util:require("../src/core").util,shapes:{},dia:{Element:require("../src/joint.dia.element").Element,Link:require("../src/joint.dia.link").Link}};if(joint.shapes.org={},joint.shapes.org.Member=joint.dia.Element.extend({markup:'<g class="rotatable"><g class="scalable"><rect class="card"/><image/></g><text class="rank"/><text class="name"/></g>',defaults:joint.util.deepSupplement({type:"org.Member",size:{width:180,height:70},attrs:{rect:{width:170,height:60},".card":{fill:"#FFFFFF",stroke:"#000000","stroke-width":2,"pointer-events":"visiblePainted",rx:10,ry:10},image:{width:48,height:48,ref:".card","ref-x":10,"ref-y":5},".rank":{"text-decoration":"underline",ref:".card","ref-x":.9,"ref-y":.2,"font-family":"Courier New","font-size":14,"text-anchor":"end"},".name":{"font-weight":"bold",ref:".card","ref-x":.9,"ref-y":.6,"font-family":"Courier New","font-size":14,"text-anchor":"end"}}},joint.dia.Element.prototype.defaults)}),joint.shapes.org.Arrow=joint.dia.Link.extend({defaults:{type:"org.Arrow",source:{selector:".card"},target:{selector:".card"},attrs:{".connection":{stroke:"#585858","stroke-width":3}},z:-1}}),"object"==typeof exports&&(module.exports=joint.shapes.org),"object"==typeof exports)var joint={util:require("../src/core").util,shapes:{basic:require("./joint.shapes.basic")},dia:{}};if(joint.shapes.chess={},joint.shapes.chess.KingWhite=joint.shapes.basic.Generic.extend({markup:'<g class="rotatable"><g class="scalable"><g style="fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;"><path      d="M 22.5,11.63 L 22.5,6"      style="fill:none; stroke:#000000; stroke-linejoin:miter;" />    <path      d="M 20,8 L 25,8"      style="fill:none; stroke:#000000; stroke-linejoin:miter;" />    <path      d="M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25"      style="fill:#ffffff; stroke:#000000; stroke-linecap:butt; stroke-linejoin:miter;" />    <path      d="M 11.5,37 C 17,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 19,16 9.5,13 6.5,19.5 C 3.5,25.5 11.5,29.5 11.5,29.5 L 11.5,37 z "      style="fill:#ffffff; stroke:#000000;" />    <path      d="M 11.5,30 C 17,27 27,27 32.5,30"      style="fill:none; stroke:#000000;" />    <path      d="M 11.5,33.5 C 17,30.5 27,30.5 32.5,33.5"      style="fill:none; stroke:#000000;" />    <path      d="M 11.5,37 C 17,34 27,34 32.5,37"      style="fill:none; stroke:#000000;" />  </g></g></g>',defaults:joint.util.deepSupplement({type:"chess.KingWhite",size:{width:42,height:38}},joint.shapes.basic.Generic.prototype.defaults)}),joint.shapes.chess.KingBlack=joint.shapes.basic.Generic.extend({markup:'<g class="rotatable"><g class="scalable"><g style="fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path       d="M 22.5,11.63 L 22.5,6"       style="fill:none; stroke:#000000; stroke-linejoin:miter;"       id="path6570" />    <path       d="M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25"       style="fill:#000000;fill-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;" />    <path       d="M 11.5,37 C 17,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 19,16 9.5,13 6.5,19.5 C 3.5,25.5 11.5,29.5 11.5,29.5 L 11.5,37 z "       style="fill:#000000; stroke:#000000;" />    <path       d="M 20,8 L 25,8"       style="fill:none; stroke:#000000; stroke-linejoin:miter;" />    <path       d="M 32,29.5 C 32,29.5 40.5,25.5 38.03,19.85 C 34.15,14 25,18 22.5,24.5 L 22.51,26.6 L 22.5,24.5 C 20,18 9.906,14 6.997,19.85 C 4.5,25.5 11.85,28.85 11.85,28.85"       style="fill:none; stroke:#ffffff;" />    <path       d="M 11.5,30 C 17,27 27,27 32.5,30 M 11.5,33.5 C 17,30.5 27,30.5 32.5,33.5 M 11.5,37 C 17,34 27,34 32.5,37"       style="fill:none; stroke:#ffffff;" />  </g></g></g>',defaults:joint.util.deepSupplement({type:"chess.KingBlack",size:{width:42,height:38}},joint.shapes.basic.Generic.prototype.defaults)}),joint.shapes.chess.QueenWhite=joint.shapes.basic.Generic.extend({markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:#ffffff; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(-1,-1)" />    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(15.5,-5.5)" />    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(32,-1)" />    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(7,-4.5)" />    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(24,-4)" />    <path      d="M 9,26 C 17.5,24.5 30,24.5 36,26 L 38,14 L 31,25 L 31,11 L 25.5,24.5 L 22.5,9.5 L 19.5,24.5 L 14,10.5 L 14,25 L 7,14 L 9,26 z "      style="stroke-linecap:butt;" />    <path      d="M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 10.5,36 10.5,36 C 9,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z "      style="stroke-linecap:butt;" />    <path      d="M 11.5,30 C 15,29 30,29 33.5,30"      style="fill:none;" />    <path      d="M 12,33.5 C 18,32.5 27,32.5 33,33.5"      style="fill:none;" />  </g></g></g>',defaults:joint.util.deepSupplement({type:"chess.QueenWhite",size:{width:42,height:38}},joint.shapes.basic.Generic.prototype.defaults)}),joint.shapes.chess.QueenBlack=joint.shapes.basic.Generic.extend({markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:#000000; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <g style="fill:#000000; stroke:none;">      <circle cx="6"    cy="12" r="2.75" />      <circle cx="14"   cy="9"  r="2.75" />      <circle cx="22.5" cy="8"  r="2.75" />      <circle cx="31"   cy="9"  r="2.75" />      <circle cx="39"   cy="12" r="2.75" />    </g>    <path       d="M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z"       style="stroke-linecap:butt; stroke:#000000;" />    <path       d="M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 10.5,36 10.5,36 C 9,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z"       style="stroke-linecap:butt;" />    <path       d="M 11,38.5 A 35,35 1 0 0 34,38.5"       style="fill:none; stroke:#000000; stroke-linecap:butt;" />    <path       d="M 11,29 A 35,35 1 0 1 34,29"       style="fill:none; stroke:#ffffff;" />    <path       d="M 12.5,31.5 L 32.5,31.5"       style="fill:none; stroke:#ffffff;" />    <path       d="M 11.5,34.5 A 35,35 1 0 0 33.5,34.5"       style="fill:none; stroke:#ffffff;" />    <path       d="M 10.5,37.5 A 35,35 1 0 0 34.5,37.5"       style="fill:none; stroke:#ffffff;" />  </g></g></g>',defaults:joint.util.deepSupplement({type:"chess.QueenBlack",size:{width:42,height:38}},joint.shapes.basic.Generic.prototype.defaults)}),joint.shapes.chess.RookWhite=joint.shapes.basic.Generic.extend({markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:#ffffff; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z "      style="stroke-linecap:butt;" />    <path      d="M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z "      style="stroke-linecap:butt;" />    <path      d="M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14"      style="stroke-linecap:butt;" />    <path      d="M 34,14 L 31,17 L 14,17 L 11,14" />    <path      d="M 31,17 L 31,29.5 L 14,29.5 L 14,17"      style="stroke-linecap:butt; stroke-linejoin:miter;" />    <path      d="M 31,29.5 L 32.5,32 L 12.5,32 L 14,29.5" />    <path      d="M 11,14 L 34,14"      style="fill:none; stroke:#000000; stroke-linejoin:miter;" />  </g></g></g>',defaults:joint.util.deepSupplement({type:"chess.RookWhite",size:{width:32,height:34}},joint.shapes.basic.Generic.prototype.defaults)}),joint.shapes.chess.RookBlack=joint.shapes.basic.Generic.extend({markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:#000000; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z "      style="stroke-linecap:butt;" />    <path      d="M 12.5,32 L 14,29.5 L 31,29.5 L 32.5,32 L 12.5,32 z "      style="stroke-linecap:butt;" />    <path      d="M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z "      style="stroke-linecap:butt;" />    <path      d="M 14,29.5 L 14,16.5 L 31,16.5 L 31,29.5 L 14,29.5 z "      style="stroke-linecap:butt;stroke-linejoin:miter;" />    <path      d="M 14,16.5 L 11,14 L 34,14 L 31,16.5 L 14,16.5 z "      style="stroke-linecap:butt;" />    <path      d="M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14 L 11,14 z "      style="stroke-linecap:butt;" />    <path      d="M 12,35.5 L 33,35.5 L 33,35.5"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />    <path      d="M 13,31.5 L 32,31.5"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />    <path      d="M 14,29.5 L 31,29.5"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />    <path      d="M 14,16.5 L 31,16.5"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />    <path      d="M 11,14 L 34,14"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />  </g></g></g>',defaults:joint.util.deepSupplement({type:"chess.RookBlack",size:{width:32,height:34}},joint.shapes.basic.Generic.prototype.defaults)}),joint.shapes.chess.BishopWhite=joint.shapes.basic.Generic.extend({markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:none; fill-rule:evenodd; fill-opacity:1; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:round; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <g style="fill:#ffffff; stroke:#000000; stroke-linecap:butt;">       <path        d="M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.646,38.99 6.677,38.97 6,38 C 7.354,36.06 9,36 9,36 z" />      <path        d="M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z" />      <path        d="M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z" />    </g>    <path      d="M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18"      style="fill:none; stroke:#000000; stroke-linejoin:miter;" />  </g></g></g>',defaults:joint.util.deepSupplement({type:"chess.BishopWhite",size:{width:38,height:38}},joint.shapes.basic.Generic.prototype.defaults)}),joint.shapes.chess.BishopBlack=joint.shapes.basic.Generic.extend({markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:none; fill-rule:evenodd; fill-opacity:1; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:round; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <g style="fill:#000000; stroke:#000000; stroke-linecap:butt;">       <path        d="M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.646,38.99 6.677,38.97 6,38 C 7.354,36.06 9,36 9,36 z" />      <path        d="M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z" />      <path        d="M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z" />    </g>    <path       d="M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18"       style="fill:none; stroke:#ffffff; stroke-linejoin:miter;" />  </g></g></g>',defaults:joint.util.deepSupplement({type:"chess.BishopBlack",size:{width:38,height:38}},joint.shapes.basic.Generic.prototype.defaults)}),joint.shapes.chess.KnightWhite=joint.shapes.basic.Generic.extend({markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18"      style="fill:#ffffff; stroke:#000000;" />    <path      d="M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10"      style="fill:#ffffff; stroke:#000000;" />    <path      d="M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z"      style="fill:#000000; stroke:#000000;" />    <path      d="M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z"      transform="matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)"      style="fill:#000000; stroke:#000000;" />  </g></g></g>',defaults:joint.util.deepSupplement({type:"chess.KnightWhite",size:{width:38,height:37}},joint.shapes.basic.Generic.prototype.defaults)}),joint.shapes.chess.KnightBlack=joint.shapes.basic.Generic.extend({markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18"      style="fill:#000000; stroke:#000000;" />    <path      d="M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10"      style="fill:#000000; stroke:#000000;" />    <path      d="M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z"      style="fill:#ffffff; stroke:#ffffff;" />    <path      d="M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z"      transform="matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)"      style="fill:#ffffff; stroke:#ffffff;" />    <path      d="M 24.55,10.4 L 24.1,11.85 L 24.6,12 C 27.75,13 30.25,14.49 32.5,18.75 C 34.75,23.01 35.75,29.06 35.25,39 L 35.2,39.5 L 37.45,39.5 L 37.5,39 C 38,28.94 36.62,22.15 34.25,17.66 C 31.88,13.17 28.46,11.02 25.06,10.5 L 24.55,10.4 z "      style="fill:#ffffff; stroke:none;" />  </g></g></g>',defaults:joint.util.deepSupplement({type:"chess.KnightBlack",size:{width:38,height:37}},joint.shapes.basic.Generic.prototype.defaults)}),joint.shapes.chess.PawnWhite=joint.shapes.basic.Generic.extend({markup:'<g class="rotatable"><g class="scalable"><path d="M 22,9 C 19.79,9 18,10.79 18,13 C 18,13.89 18.29,14.71 18.78,15.38 C 16.83,16.5 15.5,18.59 15.5,21 C 15.5,23.03 16.44,24.84 17.91,26.03 C 14.91,27.09 10.5,31.58 10.5,39.5 L 33.5,39.5 C 33.5,31.58 29.09,27.09 26.09,26.03 C 27.56,24.84 28.5,23.03 28.5,21 C 28.5,18.59 27.17,16.5 25.22,15.38 C 25.71,14.71 26,13.89 26,13 C 26,10.79 24.21,9 22,9 z "  style="opacity:1; fill:#ffffff; fill-opacity:1; fill-rule:nonzero; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:miter; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;" /></g></g>',defaults:joint.util.deepSupplement({type:"chess.PawnWhite",size:{width:28,height:33}},joint.shapes.basic.Generic.prototype.defaults)}),joint.shapes.chess.PawnBlack=joint.shapes.basic.Generic.extend({markup:'<g class="rotatable"><g class="scalable"><path d="M 22,9 C 19.79,9 18,10.79 18,13 C 18,13.89 18.29,14.71 18.78,15.38 C 16.83,16.5 15.5,18.59 15.5,21 C 15.5,23.03 16.44,24.84 17.91,26.03 C 14.91,27.09 10.5,31.58 10.5,39.5 L 33.5,39.5 C 33.5,31.58 29.09,27.09 26.09,26.03 C 27.56,24.84 28.5,23.03 28.5,21 C 28.5,18.59 27.17,16.5 25.22,15.38 C 25.71,14.71 26,13.89 26,13 C 26,10.79 24.21,9 22,9 z "  style="opacity:1; fill:#000000; fill-opacity:1; fill-rule:nonzero; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:miter; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;" /></g></g>',defaults:joint.util.deepSupplement({type:"chess.PawnBlack",size:{width:28,height:33}},joint.shapes.basic.Generic.prototype.defaults)}),"object"==typeof exports&&(module.exports=joint.shapes.chess),"object"==typeof exports)var joint={util:require("../src/core").util,shapes:{basic:require("./joint.shapes.basic")},dia:{ElementView:require("../src/joint.dia.element").ElementView,Link:require("../src/joint.dia.link").Link}};if(joint.shapes.pn={},joint.shapes.pn.Place=joint.shapes.basic.Generic.extend({markup:'<g class="rotatable"><g class="scalable"><circle class="root"/><g class="tokens" /></g><text class="label"/></g>',defaults:joint.util.deepSupplement({type:"pn.Place",size:{width:50,height:50},attrs:{".root":{r:25,fill:"white",stroke:"black",transform:"translate(25, 25)"},".label":{"text-anchor":"middle","ref-x":.5,"ref-y":-20,ref:".root",fill:"black","font-size":12},".tokens > circle":{fill:"black",r:5},".tokens.one > circle":{transform:"translate(25, 25)"},".tokens.two > circle:nth-child(1)":{transform:"translate(19, 25)"},".tokens.two > circle:nth-child(2)":{transform:"translate(31, 25)"},".tokens.three > circle:nth-child(1)":{transform:"translate(18, 29)"},".tokens.three > circle:nth-child(2)":{transform:"translate(25, 19)"},".tokens.three > circle:nth-child(3)":{transform:"translate(32, 29)"},".tokens.alot > text":{transform:"translate(25, 18)","text-anchor":"middle",fill:"black"}}},joint.shapes.basic.Generic.prototype.defaults)}),joint.shapes.pn.PlaceView=joint.dia.ElementView.extend({initialize:function(){joint.dia.ElementView.prototype.initialize.apply(this,arguments),this.model.on("change:tokens",function(){this.renderTokens(),this.update()},this)},render:function(){joint.dia.ElementView.prototype.render.apply(this,arguments),this.renderTokens(),this.update()},renderTokens:function(){var e=this.$(".tokens").empty();e[0].className.baseVal="tokens";var t=this.model.get("tokens");if(t)switch(t){case 1:e[0].className.baseVal+=" one",e.append(V("<circle/>").node);break;case 2:e[0].className.baseVal+=" two",e.append(V("<circle/>").node,V("<circle/>").node);break;case 3:e[0].className.baseVal+=" three",e.append(V("<circle/>").node,V("<circle/>").node,V("<circle/>").node);break;default:e[0].className.baseVal+=" alot",e.append(V("<text/>").text(t+"").node)}}}),joint.shapes.pn.Transition=joint.shapes.basic.Generic.extend({markup:'<g class="rotatable"><g class="scalable"><rect class="root"/></g></g><text class="label"/>',defaults:joint.util.deepSupplement({type:"pn.Transition",size:{width:12,height:50},attrs:{rect:{width:12,height:50,fill:"black",stroke:"black"},".label":{"text-anchor":"middle","ref-x":.5,"ref-y":-20,ref:"rect",fill:"black","font-size":12}}},joint.shapes.basic.Generic.prototype.defaults)}),joint.shapes.pn.Link=joint.dia.Link.extend({defaults:joint.util.deepSupplement({attrs:{".marker-target":{d:"M 10 0 L 0 5 L 10 10 z"}}},joint.dia.Link.prototype.defaults)}),"object"==typeof exports&&(module.exports=joint.shapes.pn),"object"==typeof exports)var joint={util:require("../src/core").util,shapes:{basic:require("./joint.shapes.basic")},dia:{ElementView:require("../src/joint.dia.element").ElementView,Link:require("../src/joint.dia.link").Link}},_=require("lodash");if(joint.shapes.devs={},joint.shapes.devs.Model=joint.shapes.basic.Generic.extend(_.extend({},joint.shapes.basic.PortsModelInterface,{markup:'<g class="rotatable"><g class="scalable"><rect class="body"/></g><text class="label"/><g class="inPorts"/><g class="outPorts"/></g>',portMarkup:'<g class="port port<%= id %>"><circle class="port-body"/><text class="port-label"/></g>',defaults:joint.util.deepSupplement({type:"devs.Model",size:{width:1,height:1},inPorts:[],outPorts:[],attrs:{".":{magnet:!1},".body":{width:150,height:250,stroke:"black"},".port-body":{r:10,magnet:!0,stroke:"black"},text:{fill:"black","pointer-events":"none"},".label":{text:"Model","ref-x":.5,"ref-y":10,ref:".body","text-anchor":"middle"},".inPorts .port-label":{x:-15,dy:4,"text-anchor":"end"},".outPorts .port-label":{x:15,dy:4}}},joint.shapes.basic.Generic.prototype.defaults),getPortAttrs:function(e,t,n,r,i){var s={},o="port"+t,u=r+">."+o,a=u+">.port-label",f=u+">.port-body";return s[a]={text:e},s[f]={port:{id:e||_.uniqueId(i),type:i}},s[u]={ref:".body","ref-y":(t+.5)*(1/n)},".outPorts"===r&&(s[u]["ref-dx"]=0),s}})),joint.shapes.devs.Atomic=joint.shapes.devs.Model.extend({defaults:joint.util.deepSupplement({type:"devs.Atomic",size:{width:80,height:80},attrs:{".body":{fill:"salmon"},".label":{text:"Atomic"},".inPorts .port-body":{fill:"PaleGreen"},".outPorts .port-body":{fill:"Tomato"}}},joint.shapes.devs.Model.prototype.defaults)}),joint.shapes.devs.Coupled=joint.shapes.devs.Model.extend({defaults:joint.util.deepSupplement({type:"devs.Coupled",size:{width:200,height:300},attrs:{".body":{fill:"seaGreen"},".label":{text:"Coupled"},".inPorts .port-body":{fill:"PaleGreen"},".outPorts .port-body":{fill:"Tomato"}}},joint.shapes.devs.Model.prototype.defaults)}),joint.shapes.devs.Link=joint.dia.Link.extend({defaults:{type:"devs.Link",attrs:{".connection":{"stroke-width":2}}}}),joint.shapes.devs.ModelView=joint.dia.ElementView.extend(joint.shapes.basic.PortsViewInterface),joint.shapes.devs.AtomicView=joint.shapes.devs.ModelView,joint.shapes.devs.CoupledView=joint.shapes.devs.ModelView,"object"==typeof exports&&(module.exports=joint.shapes.devs),"object"==typeof exports)var joint={util:require("../src/core").util,shapes:{basic:require("./joint.shapes.basic")},dia:{ElementView:require("../src/joint.dia.element").ElementView,Link:require("../src/joint.dia.link").Link}},_=require("lodash");if(joint.shapes.uml={},joint.shapes.uml.Class=joint.shapes.basic.Generic.extend({markup:['<g class="rotatable">','<g class="scalable">','<rect class="uml-class-name-rect"/><rect class="uml-class-attrs-rect"/><rect class="uml-class-methods-rect"/>',"</g>",'<text class="uml-class-name-text"/><text class="uml-class-attrs-text"/><text class="uml-class-methods-text"/>',"</g>"].join(""),defaults:joint.util.deepSupplement({type:"uml.Class",attrs:{rect:{width:200},".uml-class-name-rect":{stroke:"black","stroke-width":2,fill:"#3498db"},".uml-class-attrs-rect":{stroke:"black","stroke-width":2,fill:"#2980b9"},".uml-class-methods-rect":{stroke:"black","stroke-width":2,fill:"#2980b9"},".uml-class-name-text":{ref:".uml-class-name-rect","ref-y":.5,"ref-x":.5,"text-anchor":"middle","y-alignment":"middle","font-weight":"bold",fill:"black","font-size":12,"font-family":"Times New Roman"},".uml-class-attrs-text":{ref:".uml-class-attrs-rect","ref-y":5,"ref-x":5,fill:"black","font-size":12,"font-family":"Times New Roman"},".uml-class-methods-text":{ref:".uml-class-methods-rect","ref-y":5,"ref-x":5,fill:"black","font-size":12,"font-family":"Times New Roman"}},name:[],attributes:[],methods:[]},joint.shapes.basic.Generic.prototype.defaults),initialize:function(){this.on("change:name change:attributes change:methods",function(){this.updateRectangles(),this.trigger("uml-update")},this),this.updateRectangles(),joint.shapes.basic.Generic.prototype.initialize.apply(this,arguments)},getClassName:function(){return this.get("name")},updateRectangles:function(){var e=this.get("attrs"),t=[{type:"name",text:this.getClassName()},{type:"attrs",text:this.get("attributes")},{type:"methods",text:this.get("methods")}],n=0;_.each(t,function(t){var r=_.isArray(t.text)?t.text:[t.text],i=20*r.length+20;e[".uml-class-"+t.type+"-text"].text=r.join("\n"),e[".uml-class-"+t.type+"-rect"].height=i,e[".uml-class-"+t.type+"-rect"].transform="translate(0,"+n+")",n+=i})}}),joint.shapes.uml.ClassView=joint.dia.ElementView.extend({initialize:function(){joint.dia.ElementView.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"uml-update",function(){this.update(),this.resize()})}}),joint.shapes.uml.Abstract=joint.shapes.uml.Class.extend({defaults:joint.util.deepSupplement({type:"uml.Abstract",attrs:{".uml-class-name-rect":{fill:"#e74c3c"},".uml-class-attrs-rect":{fill:"#c0392b"},".uml-class-methods-rect":{fill:"#c0392b"}}},joint.shapes.uml.Class.prototype.defaults),getClassName:function(){return["<<Abstract>>",this.get("name")]}}),joint.shapes.uml.AbstractView=joint.shapes.uml.ClassView,joint.shapes.uml.Interface=joint.shapes.uml.Class.extend({defaults:joint.util.deepSupplement({type:"uml.Interface",attrs:{".uml-class-name-rect":{fill:"#f1c40f"},".uml-class-attrs-rect":{fill:"#f39c12"},".uml-class-methods-rect":{fill:"#f39c12"}}},joint.shapes.uml.Class.prototype.defaults),getClassName:function(){return["<<Interface>>",this.get("name")]}}),joint.shapes.uml.InterfaceView=joint.shapes.uml.ClassView,joint.shapes.uml.Generalization=joint.dia.Link.extend({defaults:{type:"uml.Generalization",attrs:{".marker-target":{d:"M 20 0 L 0 10 L 20 20 z",fill:"white"}}}}),joint.shapes.uml.Implementation=joint.dia.Link.extend({defaults:{type:"uml.Implementation",attrs:{".marker-target":{d:"M 20 0 L 0 10 L 20 20 z",fill:"white"},".connection":{"stroke-dasharray":"3,3"}}}}),joint.shapes.uml.Aggregation=joint.dia.Link.extend({defaults:{type:"uml.Aggregation",attrs:{".marker-target":{d:"M 40 10 L 20 20 L 0 10 L 20 0 z",fill:"white"}}}}),joint.shapes.uml.Composition=joint.dia.Link.extend({defaults:{type:"uml.Composition",attrs:{".marker-target":{d:"M 40 10 L 20 20 L 0 10 L 20 0 z",fill:"black"}}}}),joint.shapes.uml.Association=joint.dia.Link.extend({defaults:{type:"uml.Association"}}),joint.shapes.uml.State=joint.shapes.basic.Generic.extend({markup:['<g class="rotatable">','<g class="scalable">','<rect class="uml-state-body"/>',"</g>",'<path class="uml-state-separator"/>','<text class="uml-state-name"/>','<text class="uml-state-events"/>',"</g>"].join(""),defaults:joint.util.deepSupplement({type:"uml.State",attrs:{".uml-state-body":{width:200,height:200,rx:10,ry:10,fill:"#ecf0f1",stroke:"#bdc3c7","stroke-width":3},".uml-state-separator":{stroke:"#bdc3c7","stroke-width":2},".uml-state-name":{ref:".uml-state-body","ref-x":.5,"ref-y":5,"text-anchor":"middle",fill:"#000000","font-family":"Courier New","font-size":14},".uml-state-events":{ref:".uml-state-separator","ref-x":5,"ref-y":5,fill:"#000000","font-family":"Courier New","font-size":14}},name:"State",events:[]},joint.shapes.basic.Generic.prototype.defaults),initialize:function(){this.on({"change:name":this.updateName,"change:events":this.updateEvents,"change:size":this.updatePath},this),this.updateName(),this.updateEvents(),this.updatePath(),joint.shapes.basic.Generic.prototype.initialize.apply(this,arguments)},updateName:function(){this.attr(".uml-state-name/text",this.get("name"))},updateEvents:function(){this.attr(".uml-state-events/text",this.get("events").join("\n"))},updatePath:function(){var e="M 0 20 L "+this.get("size").width+" 20";this.attr(".uml-state-separator/d",e,{silent:!0})}}),joint.shapes.uml.StartState=joint.shapes.basic.Circle.extend({defaults:joint.util.deepSupplement({type:"uml.StartState",attrs:{circle:{fill:"#34495e",stroke:"#2c3e50","stroke-width":2,rx:1}}},joint.shapes.basic.Circle.prototype.defaults)}),joint.shapes.uml.EndState=joint.shapes.basic.Generic.extend({markup:'<g class="rotatable"><g class="scalable"><circle class="outer"/><circle class="inner"/></g></g>',defaults:joint.util.deepSupplement({type:"uml.EndState",size:{width:20,height:20},attrs:{"circle.outer":{transform:"translate(10, 10)",r:10,fill:"white",stroke:"#2c3e50"},"circle.inner":{transform:"translate(10, 10)",r:6,fill:"#34495e"}}},joint.shapes.basic.Generic.prototype.defaults)}),joint.shapes.uml.Transition=joint.dia.Link.extend({defaults:{type:"uml.Transition",attrs:{".marker-target":{d:"M 10 0 L 0 5 L 10 10 z",fill:"#34495e",stroke:"#2c3e50"},".connection":{stroke:"#2c3e50"}}}}),"object"==typeof exports&&(module.exports=joint.shapes.uml),"object"==typeof exports)var joint={util:require("../src/core").util,shapes:{basic:require("./joint.shapes.basic")},dia:{Link:require("../src/joint.dia.link").Link}};if(joint.shapes.logic={},joint.shapes.logic.Gate=joint.shapes.basic.Generic.extend({defaults:joint.util.deepSupplement({type:"logic.Gate",size:{width:80,height:40},attrs:{".":{magnet:!1},".body":{width:100,height:50},circle:{r:7,stroke:"black",fill:"transparent","stroke-width":2}}},joint.shapes.basic.Generic.prototype.defaults),operation:function(){return!0}}),joint.shapes.logic.IO=joint.shapes.logic.Gate.extend({markup:'<g class="rotatable"><g class="scalable"><rect class="body"/></g><path class="wire"/><circle/><text/></g>',defaults:joint.util.deepSupplement({type:"logic.IO",size:{width:60,height:30},attrs:{".body":{fill:"white",stroke:"black","stroke-width":2},".wire":{ref:".body","ref-y":.5,stroke:"black"},text:{fill:"black",ref:".body","ref-x":.5,"ref-y":.5,"y-alignment":"middle","text-anchor":"middle","font-weight":"bold","font-variant":"small-caps","text-transform":"capitalize","font-size":"14px"}}},joint.shapes.logic.Gate.prototype.defaults)}),joint.shapes.logic.Input=joint.shapes.logic.IO.extend({defaults:joint.util.deepSupplement({type:"logic.Input",attrs:{".wire":{"ref-dx":0,d:"M 0 0 L 23 0"},circle:{ref:".body","ref-dx":30,"ref-y":.5,magnet:!0,"class":"output",port:"out"},text:{text:"input"}}},joint.shapes.logic.IO.prototype.defaults)}),joint.shapes.logic.Output=joint.shapes.logic.IO.extend({defaults:joint.util.deepSupplement({type:"logic.Output",attrs:{".wire":{"ref-x":0,d:"M 0 0 L -23 0"},circle:{ref:".body","ref-x":-30,"ref-y":.5,magnet:"passive","class":"input",port:"in"},text:{text:"output"}}},joint.shapes.logic.IO.prototype.defaults)}),joint.shapes.logic.Gate11=joint.shapes.logic.Gate.extend({markup:'<g class="rotatable"><g class="scalable"><image class="body"/></g><circle class="input"/><circle class="output"/></g>',defaults:joint.util.deepSupplement({type:"logic.Gate11",attrs:{".input":{ref:".body","ref-x":-2,"ref-y":.5,magnet:"passive",port:"in"},".output":{ref:".body","ref-dx":2,"ref-y":.5,magnet:!0,port:"out"}}},joint.shapes.logic.Gate.prototype.defaults)}),joint.shapes.logic.Gate21=joint.shapes.logic.Gate.extend({markup:'<g class="rotatable"><g class="scalable"><image class="body"/></g><circle class="input input1"/><circle  class="input input2"/><circle class="output"/></g>',defaults:joint.util.deepSupplement({type:"logic.Gate21",attrs:{".input1":{ref:".body","ref-x":-2,"ref-y":.3,magnet:"passive",port:"in1"},".input2":{ref:".body","ref-x":-2,"ref-y":.7,magnet:"passive",port:"in2"},".output":{ref:".body","ref-dx":2,"ref-y":.5,magnet:!0,port:"out"}}},joint.shapes.logic.Gate.prototype.defaults)}),joint.shapes.logic.Repeater=joint.shapes.logic.Gate11.extend({defaults:joint.util.deepSupplement({type:"logic.Repeater",attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5PVCBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjgiCiAgICAgaW5rc2NhcGU6Y3g9Ijg0LjY4NTM1MiIKICAgICBpbmtzY2FwZTpjeT0iMTUuMjg4NjI4IgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjMzIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gNzIuMTU2OTEsMjUgTCA5NSwyNSIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAyOS4wNDM0NzgsMjUgTCA1LjA0MzQ3ODEsMjUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWpvaW46bWl0ZXI7bWFya2VyOm5vbmU7c3Ryb2tlLW9wYWNpdHk6MTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlIgogICAgICAgZD0iTSAyOC45Njg3NSwyLjU5Mzc1IEwgMjguOTY4NzUsNSBMIDI4Ljk2ODc1LDQ1IEwgMjguOTY4NzUsNDcuNDA2MjUgTCAzMS4xMjUsNDYuMzQzNzUgTCA3Mi4xNTYyNSwyNi4zNDM3NSBMIDcyLjE1NjI1LDIzLjY1NjI1IEwgMzEuMTI1LDMuNjU2MjUgTCAyOC45Njg3NSwyLjU5Mzc1IHogTSAzMS45Njg3NSw3LjQwNjI1IEwgNjguMDkzNzUsMjUgTCAzMS45Njg3NSw0Mi41OTM3NSBMIDMxLjk2ODc1LDcuNDA2MjUgeiIKICAgICAgIGlkPSJwYXRoMjYzOCIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY2NjY2NjY2NjYyIgLz4KICA8L2c+Cjwvc3ZnPgo="}}},joint.shapes.logic.Gate11.prototype.defaults),operation:function(e){return e}}),joint.shapes.logic.Not=joint.shapes.logic.Gate11.extend({defaults:joint.util.deepSupplement({type:"logic.Not",attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5PVCBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjgiCiAgICAgaW5rc2NhcGU6Y3g9Ijg0LjY4NTM1MiIKICAgICBpbmtzY2FwZTpjeT0iMTUuMjg4NjI4IgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjMzIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gNzkuMTU2OTEsMjUgTCA5NSwyNSIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAyOS4wNDM0NzgsMjUgTCA1LjA0MzQ3ODEsMjUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWpvaW46bWl0ZXI7bWFya2VyOm5vbmU7c3Ryb2tlLW9wYWNpdHk6MTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlIgogICAgICAgZD0iTSAyOC45Njg3NSwyLjU5Mzc1IEwgMjguOTY4NzUsNSBMIDI4Ljk2ODc1LDQ1IEwgMjguOTY4NzUsNDcuNDA2MjUgTCAzMS4xMjUsNDYuMzQzNzUgTCA3Mi4xNTYyNSwyNi4zNDM3NSBMIDcyLjE1NjI1LDIzLjY1NjI1IEwgMzEuMTI1LDMuNjU2MjUgTCAyOC45Njg3NSwyLjU5Mzc1IHogTSAzMS45Njg3NSw3LjQwNjI1IEwgNjguMDkzNzUsMjUgTCAzMS45Njg3NSw0Mi41OTM3NSBMIDMxLjk2ODc1LDcuNDA2MjUgeiIKICAgICAgIGlkPSJwYXRoMjYzOCIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY2NjY2NjY2NjYyIgLz4KICAgIDxwYXRoCiAgICAgICBzb2RpcG9kaTp0eXBlPSJhcmMiCiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDozO3N0cm9rZS1saW5lam9pbjptaXRlcjttYXJrZXI6bm9uZTtzdHJva2Utb3BhY2l0eToxO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGUiCiAgICAgICBpZD0icGF0aDI2NzEiCiAgICAgICBzb2RpcG9kaTpjeD0iNzYiCiAgICAgICBzb2RpcG9kaTpjeT0iMjUiCiAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgIHNvZGlwb2RpOnJ5PSI0IgogICAgICAgZD0iTSA4MCwyNSBBIDQsNCAwIDEgMSA3MiwyNSBBIDQsNCAwIDEgMSA4MCwyNSB6IgogICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEsMCkiIC8+CiAgPC9nPgo8L3N2Zz4K"}}},joint.shapes.logic.Gate11.prototype.defaults),operation:function(e){return!e}}),joint.shapes.logic.Or=joint.shapes.logic.Gate21.extend({defaults:joint.util.deepSupplement({type:"logic.Or",attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik9SIEFOU0kuc3ZnIgogICBpbmtzY2FwZTpvdXRwdXRfZXh0ZW5zaW9uPSJvcmcuaW5rc2NhcGUub3V0cHV0LnN2Zy5pbmtzY2FwZSI+CiAgPGRlZnMKICAgICBpZD0iZGVmczQiPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjUwIDogMTUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjI1IDogMTAgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjcxNCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfej0iMSA6IDAuNSA6IDEiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMC41IDogMC4zMzMzMzMzMyA6IDEiCiAgICAgICBpZD0icGVyc3BlY3RpdmUyODA2IiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUyODE5IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjM3Mi4wNDcyNCA6IDM1MC43ODczOSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI3NDQuMDk0NDggOiA1MjYuMTgxMDkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDUyNi4xODEwOSA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNzc3IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49Ijc1IDogNDAgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iMTUwIDogNjAgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDYwIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTMyNzUiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iNTAgOiAzMy4zMzMzMzMgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iMTAwIDogNTAgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDUwIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTU1MzMiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMzIgOiAyMS4zMzMzMzMgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNjQgOiAzMiA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMzIgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjU1NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDE2LjY2NjY2NyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDI1IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAyNSA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogIDwvZGVmcz4KICA8c29kaXBvZGk6bmFtZWR2aWV3CiAgICAgaWQ9ImJhc2UiCiAgICAgcGFnZWNvbG9yPSIjZmZmZmZmIgogICAgIGJvcmRlcmNvbG9yPSIjNjY2NjY2IgogICAgIGJvcmRlcm9wYWNpdHk9IjEuMCIKICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMC4wIgogICAgIGlua3NjYXBlOnBhZ2VzaGFkb3c9IjIiCiAgICAgaW5rc2NhcGU6em9vbT0iNCIKICAgICBpbmtzY2FwZTpjeD0iMTEzLjAwMDM5IgogICAgIGlua3NjYXBlOmN5PSIxMi44OTM3MzEiCiAgICAgaW5rc2NhcGU6ZG9jdW1lbnQtdW5pdHM9InB4IgogICAgIGlua3NjYXBlOmN1cnJlbnQtbGF5ZXI9ImcyNTYwIgogICAgIHNob3dncmlkPSJmYWxzZSIKICAgICBpbmtzY2FwZTpncmlkLWJib3g9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1wb2ludHM9InRydWUiCiAgICAgZ3JpZHRvbGVyYW5jZT0iMTAwMDAiCiAgICAgaW5rc2NhcGU6d2luZG93LXdpZHRoPSIxMzk5IgogICAgIGlua3NjYXBlOndpbmRvdy1oZWlnaHQ9Ijg3NCIKICAgICBpbmtzY2FwZTp3aW5kb3cteD0iMzciCiAgICAgaW5rc2NhcGU6d2luZG93LXk9Ii00IgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Im0gNzAsMjUgYyAyMCwwIDI1LDAgMjUsMCIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMSwxNSA1LDE1IgogICAgICAgaWQ9InBhdGgzMDYxIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzIsMzUgNSwzNSIKICAgICAgIGlkPSJwYXRoMzk0NCIgLz4KICAgIDxnCiAgICAgICBpZD0iZzI1NjAiCiAgICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICAgIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI2LjUsLTM5LjUpIj4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICBkPSJNIC0yLjQwNjI1LDQ0LjUgTCAtMC40MDYyNSw0Ni45Mzc1IEMgLTAuNDA2MjUsNDYuOTM3NSA1LjI1LDUzLjkzNzU0OSA1LjI1LDY0LjUgQyA1LjI1LDc1LjA2MjQ1MSAtMC40MDYyNSw4Mi4wNjI1IC0wLjQwNjI1LDgyLjA2MjUgTCAtMi40MDYyNSw4NC41IEwgMC43NSw4NC41IEwgMTQuNzUsODQuNSBDIDE3LjE1ODA3Niw4NC41MDAwMDEgMjIuNDM5Njk5LDg0LjUyNDUxNCAyOC4zNzUsODIuMDkzNzUgQyAzNC4zMTAzMDEsNzkuNjYyOTg2IDQwLjkxMTUzNiw3NC43NTA0ODQgNDYuMDYyNSw2NS4yMTg3NSBMIDQ0Ljc1LDY0LjUgTCA0Ni4wNjI1LDYzLjc4MTI1IEMgMzUuNzU5Mzg3LDQ0LjcxNTU5IDE5LjUwNjU3NCw0NC41IDE0Ljc1LDQ0LjUgTCAwLjc1LDQ0LjUgTCAtMi40MDYyNSw0NC41IHogTSAzLjQ2ODc1LDQ3LjUgTCAxNC43NSw0Ny41IEMgMTkuNDM0MTczLDQ3LjUgMzMuMDM2ODUsNDcuMzY5NzkzIDQyLjcxODc1LDY0LjUgQyAzNy45NTE5NjQsNzIuOTI5MDc1IDMyLjE5NzQ2OSw3Ny4xODM5MSAyNyw3OS4zMTI1IEMgMjEuNjM5MzM5LDgxLjUwNzkyNCAxNy4xNTgwNzUsODEuNTAwMDAxIDE0Ljc1LDgxLjUgTCAzLjUsODEuNSBDIDUuMzczNTg4NCw3OC4zOTE1NjYgOC4yNSw3Mi40NTA2NSA4LjI1LDY0LjUgQyA4LjI1LDU2LjUyNjY0NiA1LjM0MTQ2ODYsNTAuNTk5ODE1IDMuNDY4NzUsNDcuNSB6IgogICAgICAgICBpZD0icGF0aDQ5NzMiCiAgICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NzY2NjY3NjY2NjY2NjY2NzY2NzYyIgLz4KICAgIDwvZz4KICA8L2c+Cjwvc3ZnPgo="}}},joint.shapes.logic.Gate21.prototype.defaults),operation:function(e,t){return e||t}}),joint.shapes.logic.And=joint.shapes.logic.Gate21.extend({defaults:joint.util.deepSupplement({type:"logic.And",attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9IkFORCBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgPC9kZWZzPgogIDxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBpZD0iYmFzZSIKICAgICBwYWdlY29sb3I9IiNmZmZmZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMS4wIgogICAgIGlua3NjYXBlOnBhZ2VvcGFjaXR5PSIwLjAiCiAgICAgaW5rc2NhcGU6cGFnZXNoYWRvdz0iMiIKICAgICBpbmtzY2FwZTp6b29tPSI4IgogICAgIGlua3NjYXBlOmN4PSI1Ni42OTgzNDgiCiAgICAgaW5rc2NhcGU6Y3k9IjI1LjMyNjg5OSIKICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0icHgiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIgogICAgIHNob3dncmlkPSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtYmJveD0idHJ1ZSIKICAgICBpbmtzY2FwZTpncmlkLXBvaW50cz0idHJ1ZSIKICAgICBncmlkdG9sZXJhbmNlPSIxMDAwMCIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjEzOTkiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iODc0IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIzMyIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJtIDcwLDI1IGMgMjAsMCAyNSwwIDI1LDAiCiAgICAgICBpZD0icGF0aDMwNTkiCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzEsMTUgNSwxNSIKICAgICAgIGlkPSJwYXRoMzA2MSIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjk5OTk5OTg4O3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDMyLDM1IDUsMzUiCiAgICAgICBpZD0icGF0aDM5NDQiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZvbnQtc2l6ZTptZWRpdW07Zm9udC1zdHlsZTpub3JtYWw7Zm9udC12YXJpYW50Om5vcm1hbDtmb250LXdlaWdodDpub3JtYWw7Zm9udC1zdHJldGNoOm5vcm1hbDt0ZXh0LWluZGVudDowO3RleHQtYWxpZ246c3RhcnQ7dGV4dC1kZWNvcmF0aW9uOm5vbmU7bGluZS1oZWlnaHQ6bm9ybWFsO2xldHRlci1zcGFjaW5nOm5vcm1hbDt3b3JkLXNwYWNpbmc6bm9ybWFsO3RleHQtdHJhbnNmb3JtOm5vbmU7ZGlyZWN0aW9uOmx0cjtibG9jay1wcm9ncmVzc2lvbjp0Yjt3cml0aW5nLW1vZGU6bHItdGI7dGV4dC1hbmNob3I6c3RhcnQ7ZmlsbDojMDAwMDAwO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDozO21hcmtlcjpub25lO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGU7Zm9udC1mYW1pbHk6Qml0c3RyZWFtIFZlcmEgU2FuczstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOkJpdHN0cmVhbSBWZXJhIFNhbnMiCiAgICAgICBkPSJNIDMwLDUgTCAzMCw2LjQyODU3MTQgTCAzMCw0My41NzE0MjkgTCAzMCw0NSBMIDMxLjQyODU3MSw0NSBMIDUwLjQ3NjE5LDQ1IEMgNjEuNzQ0MDk4LDQ1IDcwLjQ3NjE5LDM1Ljk5OTk1NSA3MC40NzYxOSwyNSBDIDcwLjQ3NjE5LDE0LjAwMDA0NSA2MS43NDQwOTksNS4wMDAwMDAyIDUwLjQ3NjE5LDUgQyA1MC40NzYxOSw1IDUwLjQ3NjE5LDUgMzEuNDI4NTcxLDUgTCAzMCw1IHogTSAzMi44NTcxNDMsNy44NTcxNDI5IEMgNDAuODM0MjY0LDcuODU3MTQyOSA0NS45MTgzNjgsNy44NTcxNDI5IDQ4LjA5NTIzOCw3Ljg1NzE0MjkgQyA0OS4yODU3MTQsNy44NTcxNDI5IDQ5Ljg4MDk1Miw3Ljg1NzE0MjkgNTAuMTc4NTcxLDcuODU3MTQyOSBDIDUwLjMyNzM4MSw3Ljg1NzE0MjkgNTAuNDA5MjI3LDcuODU3MTQyOSA1MC40NDY0MjksNy44NTcxNDI5IEMgNTAuNDY1MDI5LDcuODU3MTQyOSA1MC40NzE1NDMsNy44NTcxNDI5IDUwLjQ3NjE5LDcuODU3MTQyOSBDIDYwLjIzNjg1Myw3Ljg1NzE0MyA2Ny4xNDI4NTcsMTUuNDk3MDk4IDY3LjE0Mjg1NywyNSBDIDY3LjE0Mjg1NywzNC41MDI5MDIgNTkuNzYwNjYyLDQyLjE0Mjg1NyA1MCw0Mi4xNDI4NTcgTCAzMi44NTcxNDMsNDIuMTQyODU3IEwgMzIuODU3MTQzLDcuODU3MTQyOSB6IgogICAgICAgaWQ9InBhdGgyODg0IgogICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjY2NjY2NzY2NjY3Nzc3NzY2NjIiAvPgogIDwvZz4KPC9zdmc+Cg=="}}},joint.shapes.logic.Gate21.prototype.defaults),operation:function(e,t){return e&&t}}),joint.shapes.logic.Nor=joint.shapes.logic.Gate21.extend({defaults:joint.util.deepSupplement({type:"logic.Nor",attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5PUiBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjEiCiAgICAgaW5rc2NhcGU6Y3g9Ijc4LjY3NzY0NCIKICAgICBpbmtzY2FwZTpjeT0iMjIuMTAyMzQ0IgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjM3IgogICAgIGlua3NjYXBlOndpbmRvdy15PSItNCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDc5LDI1IEMgOTksMjUgOTUsMjUgOTUsMjUiCiAgICAgICBpZD0icGF0aDMwNTkiCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzEsMTUgNSwxNSIKICAgICAgIGlkPSJwYXRoMzA2MSIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjk5OTk5OTg4O3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDMyLDM1IDUsMzUiCiAgICAgICBpZD0icGF0aDM5NDQiIC8+CiAgICA8ZwogICAgICAgaWQ9ImcyNTYwIgogICAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNi41LC0zOS41KSI+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjM7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgZD0iTSAtMi40MDYyNSw0NC41IEwgLTAuNDA2MjUsNDYuOTM3NSBDIC0wLjQwNjI1LDQ2LjkzNzUgNS4yNSw1My45Mzc1NDkgNS4yNSw2NC41IEMgNS4yNSw3NS4wNjI0NTEgLTAuNDA2MjUsODIuMDYyNSAtMC40MDYyNSw4Mi4wNjI1IEwgLTIuNDA2MjUsODQuNSBMIDAuNzUsODQuNSBMIDE0Ljc1LDg0LjUgQyAxNy4xNTgwNzYsODQuNTAwMDAxIDIyLjQzOTY5OSw4NC41MjQ1MTQgMjguMzc1LDgyLjA5Mzc1IEMgMzQuMzEwMzAxLDc5LjY2Mjk4NiA0MC45MTE1MzYsNzQuNzUwNDg0IDQ2LjA2MjUsNjUuMjE4NzUgTCA0NC43NSw2NC41IEwgNDYuMDYyNSw2My43ODEyNSBDIDM1Ljc1OTM4Nyw0NC43MTU1OSAxOS41MDY1NzQsNDQuNSAxNC43NSw0NC41IEwgMC43NSw0NC41IEwgLTIuNDA2MjUsNDQuNSB6IE0gMy40Njg3NSw0Ny41IEwgMTQuNzUsNDcuNSBDIDE5LjQzNDE3Myw0Ny41IDMzLjAzNjg1LDQ3LjM2OTc5MyA0Mi43MTg3NSw2NC41IEMgMzcuOTUxOTY0LDcyLjkyOTA3NSAzMi4xOTc0NjksNzcuMTgzOTEgMjcsNzkuMzEyNSBDIDIxLjYzOTMzOSw4MS41MDc5MjQgMTcuMTU4MDc1LDgxLjUwMDAwMSAxNC43NSw4MS41IEwgMy41LDgxLjUgQyA1LjM3MzU4ODQsNzguMzkxNTY2IDguMjUsNzIuNDUwNjUgOC4yNSw2NC41IEMgOC4yNSw1Ni41MjY2NDYgNS4zNDE0Njg2LDUwLjU5OTgxNSAzLjQ2ODc1LDQ3LjUgeiIKICAgICAgICAgaWQ9InBhdGg0OTczIgogICAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjc2NjY2NzY2NjY2NjY2Njc2Njc2MiIC8+CiAgICAgIDxwYXRoCiAgICAgICAgIHNvZGlwb2RpOnR5cGU9ImFyYyIKICAgICAgICAgc3R5bGU9ImZpbGw6bm9uZTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWpvaW46bWl0ZXI7bWFya2VyOm5vbmU7c3Ryb2tlLW9wYWNpdHk6MTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlIgogICAgICAgICBpZD0icGF0aDI2MDQiCiAgICAgICAgIHNvZGlwb2RpOmN4PSI3NSIKICAgICAgICAgc29kaXBvZGk6Y3k9IjI1IgogICAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgICAgc29kaXBvZGk6cnk9IjQiCiAgICAgICAgIGQ9Ik0gNzksMjUgQSA0LDQgMCAxIDEgNzEsMjUgQSA0LDQgMCAxIDEgNzksMjUgeiIKICAgICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTI2LjUsMzkuNSkiIC8+CiAgICA8L2c+CiAgPC9nPgo8L3N2Zz4K"}}},joint.shapes.logic.Gate21.prototype.defaults),operation:function(e,t){return!(e||t)}}),joint.shapes.logic.Nand=joint.shapes.logic.Gate21.extend({defaults:joint.util.deepSupplement({type:"logic.Nand",attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5BTkQgQU5TSS5zdmciCiAgIGlua3NjYXBlOm91dHB1dF9leHRlbnNpb249Im9yZy5pbmtzY2FwZS5vdXRwdXQuc3ZnLmlua3NjYXBlIj4KICA8ZGVmcwogICAgIGlkPSJkZWZzNCI+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMTUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxMCA6IDEiCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNzE0IiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDAuNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIwLjUgOiAwLjMzMzMzMzMzIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MDYiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MTkiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMzcyLjA0NzI0IDogMzUwLjc4NzM5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9Ijc0NC4wOTQ0OCA6IDUyNi4xODEwOSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTI2LjE4MTA5IDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3NzciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iNzUgOiA0MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxNTAgOiA2MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNjAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMzI3NSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI1MCA6IDMzLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxMDAgOiA1MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlNTUzMyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzMiA6IDIxLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI2NCA6IDMyIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAzMiA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogIDwvZGVmcz4KICA8c29kaXBvZGk6bmFtZWR2aWV3CiAgICAgaWQ9ImJhc2UiCiAgICAgcGFnZWNvbG9yPSIjZmZmZmZmIgogICAgIGJvcmRlcmNvbG9yPSIjNjY2NjY2IgogICAgIGJvcmRlcm9wYWNpdHk9IjEuMCIKICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMC4wIgogICAgIGlua3NjYXBlOnBhZ2VzaGFkb3c9IjIiCiAgICAgaW5rc2NhcGU6em9vbT0iMTYiCiAgICAgaW5rc2NhcGU6Y3g9Ijc4LjI4MzMwNyIKICAgICBpbmtzY2FwZTpjeT0iMTYuNDQyODQzIgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjMzIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gNzksMjUgQyA5MS44LDI1IDk1LDI1IDk1LDI1IgogICAgICAgaWQ9InBhdGgzMDU5IgogICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjYyIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDMxLDE1IDUsMTUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45OTk5OTk4ODtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMiwzNSA1LDM1IgogICAgICAgaWQ9InBhdGgzOTQ0IiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmb250LXNpemU6bWVkaXVtO2ZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtdmFyaWFudDpub3JtYWw7Zm9udC13ZWlnaHQ6bm9ybWFsO2ZvbnQtc3RyZXRjaDpub3JtYWw7dGV4dC1pbmRlbnQ6MDt0ZXh0LWFsaWduOnN0YXJ0O3RleHQtZGVjb3JhdGlvbjpub25lO2xpbmUtaGVpZ2h0Om5vcm1hbDtsZXR0ZXItc3BhY2luZzpub3JtYWw7d29yZC1zcGFjaW5nOm5vcm1hbDt0ZXh0LXRyYW5zZm9ybTpub25lO2RpcmVjdGlvbjpsdHI7YmxvY2stcHJvZ3Jlc3Npb246dGI7d3JpdGluZy1tb2RlOmxyLXRiO3RleHQtYW5jaG9yOnN0YXJ0O2ZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MzttYXJrZXI6bm9uZTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlO2ZvbnQtZmFtaWx5OkJpdHN0cmVhbSBWZXJhIFNhbnM7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjpCaXRzdHJlYW0gVmVyYSBTYW5zIgogICAgICAgZD0iTSAzMCw1IEwgMzAsNi40Mjg1NzE0IEwgMzAsNDMuNTcxNDI5IEwgMzAsNDUgTCAzMS40Mjg1NzEsNDUgTCA1MC40NzYxOSw0NSBDIDYxLjc0NDA5OCw0NSA3MC40NzYxOSwzNS45OTk5NTUgNzAuNDc2MTksMjUgQyA3MC40NzYxOSwxNC4wMDAwNDUgNjEuNzQ0MDk5LDUuMDAwMDAwMiA1MC40NzYxOSw1IEMgNTAuNDc2MTksNSA1MC40NzYxOSw1IDMxLjQyODU3MSw1IEwgMzAsNSB6IE0gMzIuODU3MTQzLDcuODU3MTQyOSBDIDQwLjgzNDI2NCw3Ljg1NzE0MjkgNDUuOTE4MzY4LDcuODU3MTQyOSA0OC4wOTUyMzgsNy44NTcxNDI5IEMgNDkuMjg1NzE0LDcuODU3MTQyOSA0OS44ODA5NTIsNy44NTcxNDI5IDUwLjE3ODU3MSw3Ljg1NzE0MjkgQyA1MC4zMjczODEsNy44NTcxNDI5IDUwLjQwOTIyNyw3Ljg1NzE0MjkgNTAuNDQ2NDI5LDcuODU3MTQyOSBDIDUwLjQ2NTAyOSw3Ljg1NzE0MjkgNTAuNDcxNTQzLDcuODU3MTQyOSA1MC40NzYxOSw3Ljg1NzE0MjkgQyA2MC4yMzY4NTMsNy44NTcxNDMgNjcuMTQyODU3LDE1LjQ5NzA5OCA2Ny4xNDI4NTcsMjUgQyA2Ny4xNDI4NTcsMzQuNTAyOTAyIDU5Ljc2MDY2Miw0Mi4xNDI4NTcgNTAsNDIuMTQyODU3IEwgMzIuODU3MTQzLDQyLjE0Mjg1NyBMIDMyLjg1NzE0Myw3Ljg1NzE0MjkgeiIKICAgICAgIGlkPSJwYXRoMjg4NCIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY2Njc2NjY2Nzc3Nzc2NjYyIgLz4KICAgIDxwYXRoCiAgICAgICBzb2RpcG9kaTp0eXBlPSJhcmMiCiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDozO3N0cm9rZS1saW5lam9pbjptaXRlcjttYXJrZXI6bm9uZTtzdHJva2Utb3BhY2l0eToxO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGUiCiAgICAgICBpZD0icGF0aDQwMDgiCiAgICAgICBzb2RpcG9kaTpjeD0iNzUiCiAgICAgICBzb2RpcG9kaTpjeT0iMjUiCiAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgIHNvZGlwb2RpOnJ5PSI0IgogICAgICAgZD0iTSA3OSwyNSBBIDQsNCAwIDEgMSA3MSwyNSBBIDQsNCAwIDEgMSA3OSwyNSB6IiAvPgogIDwvZz4KPC9zdmc+Cg=="}}},joint.shapes.logic.Gate21.prototype.defaults),operation:function(e,t){return!(e&&t)}}),joint.shapes.logic.Xor=joint.shapes.logic.Gate21.extend({defaults:joint.util.deepSupplement({type:"logic.Xor",attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9IlhPUiBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjUuNjU2ODU0MiIKICAgICBpbmtzY2FwZTpjeD0iMjUuOTM4MTE2IgogICAgIGlua3NjYXBlOmN5PSIxNy4yMzAwNSIKICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0icHgiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIgogICAgIHNob3dncmlkPSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtYmJveD0idHJ1ZSIKICAgICBpbmtzY2FwZTpncmlkLXBvaW50cz0idHJ1ZSIKICAgICBncmlkdG9sZXJhbmNlPSIxMDAwMCIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjEzOTkiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iODc0IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIzMyIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJtIDcwLDI1IGMgMjAsMCAyNSwwIDI1LDAiCiAgICAgICBpZD0icGF0aDMwNTkiCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzAuMzg1NzE3LDE1IEwgNC45OTk5OTk4LDE1IgogICAgICAgaWQ9InBhdGgzMDYxIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5NzY7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzEuMzYyMDkxLDM1IEwgNC45OTk5OTk4LDM1IgogICAgICAgaWQ9InBhdGgzOTQ0IiAvPgogICAgPGcKICAgICAgIGlkPSJnMjU2MCIKICAgICAgIGlua3NjYXBlOmxhYmVsPSJMYXllciAxIgogICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjYuNSwtMzkuNSkiPgogICAgICA8cGF0aAogICAgICAgICBpZD0icGF0aDM1MTYiCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjM7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgZD0iTSAtMi4yNSw4MS41MDAwMDUgQyAtMy44NDczNzQsODQuMTQ0NDA1IC00LjUsODQuNTAwMDA1IC00LjUsODQuNTAwMDA1IEwgLTguMTU2MjUsODQuNTAwMDA1IEwgLTYuMTU2MjUsODIuMDYyNTA1IEMgLTYuMTU2MjUsODIuMDYyNTA1IC0wLjUsNzUuMDYyNDUxIC0wLjUsNjQuNSBDIC0wLjUsNTMuOTM3NTQ5IC02LjE1NjI1LDQ2LjkzNzUgLTYuMTU2MjUsNDYuOTM3NSBMIC04LjE1NjI1LDQ0LjUgTCAtNC41LDQ0LjUgQyAtMy43MTg3NSw0NS40Mzc1IC0zLjA3ODEyNSw0Ni4xNTYyNSAtMi4yODEyNSw0Ny41IEMgLTAuNDA4NTMxLDUwLjU5OTgxNSAyLjUsNTYuNTI2NjQ2IDIuNSw2NC41IEMgMi41LDcyLjQ1MDY1IC0wLjM5NjY5Nyw3OC4zNzk0MjUgLTIuMjUsODEuNTAwMDA1IHoiCiAgICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY3NjY2Njc2MiIC8+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjM7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgZD0iTSAtMi40MDYyNSw0NC41IEwgLTAuNDA2MjUsNDYuOTM3NSBDIC0wLjQwNjI1LDQ2LjkzNzUgNS4yNSw1My45Mzc1NDkgNS4yNSw2NC41IEMgNS4yNSw3NS4wNjI0NTEgLTAuNDA2MjUsODIuMDYyNSAtMC40MDYyNSw4Mi4wNjI1IEwgLTIuNDA2MjUsODQuNSBMIDAuNzUsODQuNSBMIDE0Ljc1LDg0LjUgQyAxNy4xNTgwNzYsODQuNTAwMDAxIDIyLjQzOTY5OSw4NC41MjQ1MTQgMjguMzc1LDgyLjA5Mzc1IEMgMzQuMzEwMzAxLDc5LjY2Mjk4NiA0MC45MTE1MzYsNzQuNzUwNDg0IDQ2LjA2MjUsNjUuMjE4NzUgTCA0NC43NSw2NC41IEwgNDYuMDYyNSw2My43ODEyNSBDIDM1Ljc1OTM4Nyw0NC43MTU1OSAxOS41MDY1NzQsNDQuNSAxNC43NSw0NC41IEwgMC43NSw0NC41IEwgLTIuNDA2MjUsNDQuNSB6IE0gMy40Njg3NSw0Ny41IEwgMTQuNzUsNDcuNSBDIDE5LjQzNDE3Myw0Ny41IDMzLjAzNjg1LDQ3LjM2OTc5MyA0Mi43MTg3NSw2NC41IEMgMzcuOTUxOTY0LDcyLjkyOTA3NSAzMi4xOTc0NjksNzcuMTgzOTEgMjcsNzkuMzEyNSBDIDIxLjYzOTMzOSw4MS41MDc5MjQgMTcuMTU4MDc1LDgxLjUwMDAwMSAxNC43NSw4MS41IEwgMy41LDgxLjUgQyA1LjM3MzU4ODQsNzguMzkxNTY2IDguMjUsNzIuNDUwNjUgOC4yNSw2NC41IEMgOC4yNSw1Ni41MjY2NDYgNS4zNDE0Njg2LDUwLjU5OTgxNSAzLjQ2ODc1LDQ3LjUgeiIKICAgICAgICAgaWQ9InBhdGg0OTczIgogICAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjc2NjY2NzY2NjY2NjY2Njc2Njc2MiIC8+CiAgICA8L2c+CiAgPC9nPgo8L3N2Zz4K"}}},joint.shapes.logic.Gate21.prototype.defaults),operation:function(e,t){return!(e&&!t||!e&&t)}}),joint.shapes.logic.Xnor=joint.shapes.logic.Gate21.extend({defaults:joint.util.deepSupplement({type:"logic.Xnor",attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9IlhOT1IgQU5TSS5zdmciCiAgIGlua3NjYXBlOm91dHB1dF9leHRlbnNpb249Im9yZy5pbmtzY2FwZS5vdXRwdXQuc3ZnLmlua3NjYXBlIj4KICA8ZGVmcwogICAgIGlkPSJkZWZzNCI+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMTUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxMCA6IDEiCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNzE0IiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDAuNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIwLjUgOiAwLjMzMzMzMzMzIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MDYiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MTkiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMzcyLjA0NzI0IDogMzUwLjc4NzM5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9Ijc0NC4wOTQ0OCA6IDUyNi4xODEwOSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTI2LjE4MTA5IDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3NzciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iNzUgOiA0MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxNTAgOiA2MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNjAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMzI3NSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI1MCA6IDMzLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxMDAgOiA1MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlNTUzMyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzMiA6IDIxLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI2NCA6IDMyIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAzMiA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNTU3IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjI1IDogMTYuNjY2NjY3IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjUwIDogMjUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDI1IDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgPC9kZWZzPgogIDxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBpZD0iYmFzZSIKICAgICBwYWdlY29sb3I9IiNmZmZmZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMS4wIgogICAgIGlua3NjYXBlOnBhZ2VvcGFjaXR5PSIwLjAiCiAgICAgaW5rc2NhcGU6cGFnZXNoYWRvdz0iMiIKICAgICBpbmtzY2FwZTp6b29tPSI0IgogICAgIGlua3NjYXBlOmN4PSI5NS43MjM2NiIKICAgICBpbmtzY2FwZTpjeT0iLTI2Ljc3NTAyMyIKICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0icHgiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIgogICAgIHNob3dncmlkPSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtYmJveD0idHJ1ZSIKICAgICBpbmtzY2FwZTpncmlkLXBvaW50cz0idHJ1ZSIKICAgICBncmlkdG9sZXJhbmNlPSIxMDAwMCIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjEzOTkiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iODc0IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIzMyIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyLjAwMDAwMDI0O3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDc4LjMzMzMzMiwyNSBDIDkxLjY2NjY2NiwyNSA5NSwyNSA5NSwyNSIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45OTk5OTk4ODtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMC4zODU3MTcsMTUgTCA0Ljk5OTk5OTgsMTUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45OTk5OTk3NjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMS4zNjIwOTEsMzUgTCA0Ljk5OTk5OTgsMzUiCiAgICAgICBpZD0icGF0aDM5NDQiIC8+CiAgICA8ZwogICAgICAgaWQ9ImcyNTYwIgogICAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNi41LC0zOS41KSI+CiAgICAgIDxwYXRoCiAgICAgICAgIGlkPSJwYXRoMzUxNiIKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICBkPSJNIC0yLjI1LDgxLjUwMDAwNSBDIC0zLjg0NzM3NCw4NC4xNDQ0MDUgLTQuNSw4NC41MDAwMDUgLTQuNSw4NC41MDAwMDUgTCAtOC4xNTYyNSw4NC41MDAwMDUgTCAtNi4xNTYyNSw4Mi4wNjI1MDUgQyAtNi4xNTYyNSw4Mi4wNjI1MDUgLTAuNSw3NS4wNjI0NTEgLTAuNSw2NC41IEMgLTAuNSw1My45Mzc1NDkgLTYuMTU2MjUsNDYuOTM3NSAtNi4xNTYyNSw0Ni45Mzc1IEwgLTguMTU2MjUsNDQuNSBMIC00LjUsNDQuNSBDIC0zLjcxODc1LDQ1LjQzNzUgLTMuMDc4MTI1LDQ2LjE1NjI1IC0yLjI4MTI1LDQ3LjUgQyAtMC40MDg1MzEsNTAuNTk5ODE1IDIuNSw1Ni41MjY2NDYgMi41LDY0LjUgQyAyLjUsNzIuNDUwNjUgLTAuMzk2Njk3LDc4LjM3OTQyNSAtMi4yNSw4MS41MDAwMDUgeiIKICAgICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjY2Njc2NjY2NzYyIgLz4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICBkPSJNIC0yLjQwNjI1LDQ0LjUgTCAtMC40MDYyNSw0Ni45Mzc1IEMgLTAuNDA2MjUsNDYuOTM3NSA1LjI1LDUzLjkzNzU0OSA1LjI1LDY0LjUgQyA1LjI1LDc1LjA2MjQ1MSAtMC40MDYyNSw4Mi4wNjI1IC0wLjQwNjI1LDgyLjA2MjUgTCAtMi40MDYyNSw4NC41IEwgMC43NSw4NC41IEwgMTQuNzUsODQuNSBDIDE3LjE1ODA3Niw4NC41MDAwMDEgMjIuNDM5Njk5LDg0LjUyNDUxNCAyOC4zNzUsODIuMDkzNzUgQyAzNC4zMTAzMDEsNzkuNjYyOTg2IDQwLjkxMTUzNiw3NC43NTA0ODQgNDYuMDYyNSw2NS4yMTg3NSBMIDQ0Ljc1LDY0LjUgTCA0Ni4wNjI1LDYzLjc4MTI1IEMgMzUuNzU5Mzg3LDQ0LjcxNTU5IDE5LjUwNjU3NCw0NC41IDE0Ljc1LDQ0LjUgTCAwLjc1LDQ0LjUgTCAtMi40MDYyNSw0NC41IHogTSAzLjQ2ODc1LDQ3LjUgTCAxNC43NSw0Ny41IEMgMTkuNDM0MTczLDQ3LjUgMzMuMDM2ODUsNDcuMzY5NzkzIDQyLjcxODc1LDY0LjUgQyAzNy45NTE5NjQsNzIuOTI5MDc1IDMyLjE5NzQ2OSw3Ny4xODM5MSAyNyw3OS4zMTI1IEMgMjEuNjM5MzM5LDgxLjUwNzkyNCAxNy4xNTgwNzUsODEuNTAwMDAxIDE0Ljc1LDgxLjUgTCAzLjUsODEuNSBDIDUuMzczNTg4NCw3OC4zOTE1NjYgOC4yNSw3Mi40NTA2NSA4LjI1LDY0LjUgQyA4LjI1LDU2LjUyNjY0NiA1LjM0MTQ2ODYsNTAuNTk5ODE1IDMuNDY4NzUsNDcuNSB6IgogICAgICAgICBpZD0icGF0aDQ5NzMiCiAgICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NzY2NjY3NjY2NjY2NjY2NzY2NzYyIgLz4KICAgIDwvZz4KICAgIDxwYXRoCiAgICAgICBzb2RpcG9kaTp0eXBlPSJhcmMiCiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDozO3N0cm9rZS1saW5lam9pbjptaXRlcjttYXJrZXI6bm9uZTtzdHJva2Utb3BhY2l0eToxO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGUiCiAgICAgICBpZD0icGF0aDM1NTEiCiAgICAgICBzb2RpcG9kaTpjeD0iNzUiCiAgICAgICBzb2RpcG9kaTpjeT0iMjUiCiAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgIHNvZGlwb2RpOnJ5PSI0IgogICAgICAgZD0iTSA3OSwyNSBBIDQsNCAwIDEgMSA3MSwyNSBBIDQsNCAwIDEgMSA3OSwyNSB6IiAvPgogIDwvZz4KPC9zdmc+Cg=="}}},joint.shapes.logic.Gate21.prototype.defaults),operation:function(e,t){return!(e&&t||!e&&!t)}}),joint.shapes.logic.Wire=joint.dia.Link.extend({arrowheadMarkup:['<g class="marker-arrowhead-group marker-arrowhead-group-<%= end %>">','<circle class="marker-arrowhead" end="<%= end %>" r="7"/>',"</g>"].join(""),vertexMarkup:['<g class="marker-vertex-group" transform="translate(<%= x %>, <%= y %>)">','<circle class="marker-vertex" idx="<%= idx %>" r="10" />','<g class="marker-vertex-remove-group">','<path class="marker-vertex-remove-area" idx="<%= idx %>" d="M16,5.333c-7.732,0-14,4.701-14,10.5c0,1.982,0.741,3.833,2.016,5.414L2,25.667l5.613-1.441c2.339,1.317,5.237,2.107,8.387,2.107c7.732,0,14-4.701,14-10.5C30,10.034,23.732,5.333,16,5.333z" transform="translate(5, -33)"/>','<path class="marker-vertex-remove" idx="<%= idx %>" transform="scale(.8) translate(9.5, -37)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z">',"<title>Remove vertex.</title>","</path>","</g>","</g>"].join(""),defaults:joint.util.deepSupplement({type:"logic.Wire",attrs:{".connection":{"stroke-width":2},".marker-vertex":{r:7}},router:{name:"orthogonal"},connector:{name:"rounded",args:{radius:10}}},joint.dia.Link.prototype.defaults)}),"object"==typeof exports&&(module.exports=joint.shapes.logic),"object"==typeof exports)var joint={util:require("../src/core").util,shapes:{},dia:{Element:require("../src/joint.dia.element").Element}},_=require("lodash");if(joint.shapes.chart={},joint.shapes.chart.Plot=joint.shapes.basic.Generic.extend({markup:['<clipPath class="clip"><rect/></clipPath>','<g class="rotatable">','<g class="scalable"></g>','<g class="background"><rect/><text/></g>','<g class="axis">','<g class="y-axis"><path/><g class="ticks"></g></g>','<g class="x-axis"><path/><g class="ticks"></g></g>','<g class="markings"></g>',"</g>",'<g class="data"><g class="series"></g></g>','<g class="foreground">','<rect/><text class="caption"/><text class="subcaption"/>','<g class="legend"><g class="legend-items"></g></g>','<line class="guideline x-guideline" /><line class="guideline y-guideline" />',"</g>","</g>"].join(""),tickMarkup:'<g class="tick"><line/><text/></g>',pointMarkup:'<g class="point"><circle/><text/></g>',barMarkup:'<path class="bar"/>',markingMarkup:'<g class="marking"><rect/><text/></g>',serieMarkup:'<g><clipPath class="serie-clip"><rect/></clipPath><path/><g class="bars"></g><g class="points"></g></g>',legendItemMarkup:'<g class="legend-item"><circle/><text/></g>',defaults:joint.util.deepSupplement({type:"chart.Plot",attrs:{".data path":{fill:"none",stroke:"black"},".data .bars rect":{fill:"none",stroke:"black"},".background rect":{fill:"white",stroke:"#e5e5e5",opacity:1},".background text":{fill:"black",text:"No data available.",ref:".","ref-x":.5,"ref-y":.5,"text-anchor":"middle","y-alignment":"middle",display:"none"},".foreground > rect":{fill:"white",stroke:"#e5e5e5",opacity:0,"pointer-events":"none"},".foreground .caption":{fill:"black",text:"",ref:".foreground > rect","ref-x":.5,"ref-y":10,"text-anchor":"middle","y-alignment":"middle","font-size":14},".foreground .subcaption":{fill:"black",text:"",ref:".foreground > rect","ref-x":.5,"ref-y":23,"text-anchor":"middle","y-alignment":"middle","font-size":10},".point":{display:"inline-block"},".point circle":{r:2,stroke:"black",fill:"black",opacity:.3},".point text":{fill:"black","font-size":8,"text-anchor":"middle",display:"none"},".axis path":{fill:"none",stroke:"black"},".axis .tick":{fill:"none",stroke:"black"},".y-axis .tick line":{fill:"none",stroke:"black",x2:2,y2:0,opacity:1},".x-axis .tick line":{fill:"none",stroke:"black",x2:0,y2:-3,opacity:1},".y-axis .tick text":{fill:"black",stroke:"none","font-size":10,dy:"-.5em",x:-5,"text-anchor":"end"},".x-axis .tick text":{fill:"black",stroke:"none","font-size":10,dy:".5em",x:0,"text-anchor":"middle"},".axis .markings":{fill:"black",stroke:"none","fill-opacity":1},".axis .markings text":{fill:"black","text-anchor":"end","font-size":10,dy:-5,dx:-5},".guideline":{"pointer-events":"none",display:"none"},".x-guideline":{stroke:"black",visibility:"hidden"},".y-guideline":{stroke:"black",visibility:"hidden"},".legend":{ref:".background","ref-x":10,"ref-y":10},".legend-item text":{fill:"black",transform:"translate(14, 0)","font-size":11},".legend-item circle":{r:5,transform:"translate(5,5)"},".legend-item":{cursor:"pointer"},".legend-item.disabled circle":{fill:"gray"},".legend-item.disabled text":{opacity:.5}}},joint.shapes.basic.Generic.prototype.defaults),legendPosition:function(e,t){t=t||{},this.trigger("batch:start"),this.removeAttr([".legend/ref-x",".legend/ref-y",".legend/ref-dx",".legend/ref-dy",".legend/x-alignment",".legend/y-alignment"],{silent:!0});var n=t.padding||10,r={n:{".legend":{"ref-x":.5,"x-alignment":-.5,"ref-y":n}},ne:{".legend":{"ref-dx":-n,"x-alignment":-.999,"ref-y":n}},e:{".legend":{"ref-dx":-n,"x-alignment":-.999,"ref-y":.5,"y-alignment":-.5}},se:{".legend":{"ref-dx":-n,"ref-dy":-n,"x-alignment":-.999,"y-alignment":-.999}},s:{".legend":{"ref-x":.5,"ref-dy":-n,"x-alignment":-.5,"y-alignment":-.999}},sw:{".legend":{"ref-x":n,"ref-dy":-n,"y-alignment":-.999}},w:{".legend":{"ref-x":n,"ref-y":.5,"y-alignment":-.5}},nw:{".legend":{"ref-x":n,"ref-y":n}},nnw:{".legend":{"ref-x":n,"ref-y":-n,"y-alignment":-.999}},nn:{".legend":{"ref-x":.5,"ref-y":-n,"x-alignment":-.5,"y-alignment":-.999}},nne:{".legend":{"ref-dx":-n,"ref-y":-n,"x-alignment":-.999,"y-alignment":-.999}},nnee:{".legend":{"ref-dx":n,"ref-y":-n,"y-alignment":-.999}},nee:{".legend":{"ref-y":n,"ref-dx":n}},ee:{".legend":{"ref-dx":n,"ref-y":.5,"y-alignment":-.5}},see:{".legend":{"ref-dx":n,"ref-dy":-n,"y-alignment":-.999}},ssee:{".legend":{"ref-dx":n,"ref-dy":n}},sse:{".legend":{"ref-dx":-n,"ref-dy":n,"x-alignment":-.999}},ss:{".legend":{"ref-x":.5,"ref-dy":n,"x-alignment":-.5}},ssw:{".legend":{"ref-x":n,"ref-dy":n}},ssww:{".legend":{"ref-x":-n,"ref-dy":n,"x-alignment":-.999}},sww:{".legend":{"ref-x":-n,"ref-dy":-n,"x-alignment":-.999,"y-alignment":-.999}},ww:{".legend":{"ref-x":-n,"ref-y":.5,"x-alignment":-.999,"y-alignment":-.5}},nww:{".legend":{"ref-x":-n,"ref-y":n,"x-alignment":-.999}},nnww:{".legend":{"ref-x":-n,"ref-y":-n,"x-alignment":-.999,"y-alignment":-.999}}};r[e]&&this.attr(r[e]),this.trigger("batch:stop")},addPoint:function(e,t,n){n=n||{};var r=this.get("series"),i=_.findIndex(r,{name:t});if(-1===i)throw new Error("Serie "+t+" was not found.");var s=_.cloneDeep(r[i]);s.data.push(e),_.isFinite(n.maxLen)&&s.data.length>n.maxLen&&s.data.shift(),r=r.slice(),r[i]=s,this.set("series",r,n)},lastPoint:function(e){return _.last(_.findWhere(this.get("series"),{name:e}).data)},firstPoint:function(e){return _.first(_.findWhere(this.get("series"),{name:e}).data)}}),joint.shapes.chart.PlotView=joint.dia.ElementView.extend({events:{mousemove:"onMouseMove",mouseout:"onMouseOut"},initialize:function(){joint.dia.ElementView.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"change:series change:interpolate change:padding change:canvas change:markings change:axis",_.bind(function(){this.update()},this)),this.on("cell:pointerdown",this.onPointerDown,this),this._disabledSeries=[]},renderMarkup:function(){joint.dia.ElementView.prototype.renderMarkup.apply(this,arguments),this.elDataClipPath=this.$(".clip")[0],this.elDataClipPathRect=this.elDataClipPath.firstChild,this.elBackgroundRect=this.$(".background rect")[0],this.elBackgroundText=this.$(".background text")[0],this.elForeground=this.$(".foreground")[0],this.elForegroundRect=this.$(".foreground rect")[0],this.elDataSeries=this.$(".data .series")[0],this.elYAxisPath=this.$(".y-axis path")[0],this.elYAxisTicks=this.$(".y-axis .ticks")[0],this.elXAxisPath=this.$(".x-axis path")[0],this.elXAxisTicks=this.$(".x-axis .ticks")[0],this.elMarkings=this.$(".axis .markings")[0],this.elXGuideline=this.$(".x-guideline")[0],this.elYGuideline=this.$(".y-guideline")[0],this.elLegend=this.$(".legend")[0],this.elLegendItems=this.$(".legend-items")[0],this.elTick=V(this.model.tickMarkup),this.elMarking=V(this.model.markingMarkup),this.elLegendItem=V(this.model.legendItemMarkup),this.elPoint=V(this.model.pointMarkup),this.elBar=V(this.model.barMarkup),this.elSerie=V(this.model.serieMarkup),this.elDataClipPath.id="clip_"+this.cid,V(this.$(".data")[0]).attr("clip-path","url(#"+this.elDataClipPath.id+")"),V(this.elMarkings).attr("clip-path","url(#"+this.elDataClipPath.id+")")},update:function(e){e=this.filterSeries(e),this.calculateStats(e);var t=this.model.get("size"),n=t.width,r=t.height;this.canvas=_.extend({x:0,y:0,width:n,height:r},this.model.get("canvas"));var i,s={top:0,right:0,bottom:0,left:0},o=this.model.get("padding");i=_.isObject(o)?_.extend({},s,o):_.isUndefined(o)?s:{top:o,right:2*o,bottom:2*o,left:o},this.canvas=g.rect(this.canvas).moveAndExpand(g.rect(i.left,i.top,-i.right,-i.bottom));var u={x:0,y:0,width:n,height:r};V(this.elDataClipPathRect).attr(u),V(this.elBackgroundRect).attr(u),V(this.elForegroundRect).attr(u),this.updateAxis(),this.updateMarkings(),this.isEmpty()?$(this.elBackgroundText).show():$(this.elBackgroundText).hide(),this.updateSeries(e),this.updateLegend(),joint.dia.ElementView.prototype.update.apply(this,arguments)},calculateStats:function(e){e=e||this.model.get("series");var t=[],n=[],r={},i={},s={};_.each(e,function(e,o){var u=s[e.name||o]||(s[e.name||o]={});u.decreasingX=!0,u.decreasingY=!0,u.nonDecreasingX=!0,u.nonDecreasingY=!0;var a;_.each(e.data,function(s){u.minX=_.isUndefined(u.minX)?s.x:Math.min(u.minX,s.x),u.maxX=_.isUndefined(u.maxX)?s.x:Math.max(u.maxX,s.x),u.minY=_.isUndefined(u.minY)?s.y:Math.min(u.minY,s.y),u.maxY=_.isUndefined(u.maxY)?s.y:Math.max(u.maxY,s.y),a&&(u.decreasingX=u.decreasingX&&s.x<a.x,u.decreasingY=u.decreasingY&&s.y<a.y,u.nonDecreasingX=u.nonDecreasingX&&s.x>=a.x,u.nonDecreasingY=u.nonDecreasingY&&s.y>=a.y),_.contains(t,s.x)||t.push(s.x),_.contains(n,s.y)||n.push(s.y),(r[s.x]||(r[s.x]=[])).push({serie:e,x:s.x,y:s.y}),(i[s.y]||(i[s.y]=[])).push({serie:e,x:s.x,y:s.y}),a=s})});var o=this.model.get("axis")||{},u=o["x-axis"]||{},a=o["y-axis"]||{};this.stats={minX:_.isUndefined(u.min)?_.min(t):u.min,maxX:_.isUndefined(u.max)?_.max(t):u.max,minY:_.isUndefined(a.min)?_.min(n):a.min,maxY:_.isUndefined(a.max)?_.max(n):a.max,bySerie:s,xValues:t,yValues:n,xMap:r,yMap:i}},isEmpty:function(){return!this.stats.xValues.length},updateSeries:function(e){if(e=e||this.model.get("series"),this.elDataSeries.textContent="",!this.isEmpty()){var t=[this.stats.minX,this.stats.maxX],n=[this.stats.minY,this.stats.maxY],r=[this.canvas.x,this.canvas.x+this.canvas.width],i=[this.canvas.y+this.canvas.height,this.canvas.y],s=this.model.get("attrs");_.each(e,function(e,o){var u=e.data,a=[],l=this.elSerie.clone().attr("class",e.name||"serie-"+o);V(this.elDataSeries).append(l),_.each(u,function(o){var u=g.scale.linear(t,r,o.x),l=g.scale.linear(n,i,o.y);a.push({x:u,y:l}),s[".point"]&&"none"!==s[".point"].display&&this.renderPoint(o,e),e.bars&&this.renderBar(o,e)},this);var h=l.findOne(".serie-clip"),p=this.model.get("size"),v=this.stats.bySerie[e.name||o],m=g.scale.linear(t,r,v.minX),y=g.scale.linear(t,r,v.maxX),w=h.findOne("rect");if(w.attr(g.rect(m,0,y-m,p.height)),!e.bars){var E=l.findOne("path");E.attr({d:this.seriePathData(a,e,o),"clip-path":"url(#"+h.node.id+")"})}},this)}},seriePathClipData:function(e){var t=10,n=this.model.get("size"),r=_.first(e),i=(_.last(e),["M",r.x,r.y,"V",n.height+t]);return i.join(" ")},renderBar:function(e,t){var n=[this.stats.minX,this.stats.maxX],r=[this.stats.minY,this.stats.maxY],i=[this.canvas.x,this.canvas.x+this.canvas.width],s=[this.canvas.y+this.canvas.height,this.canvas.y],o=g.scale.linear(n,i,e.x),u=g.scale.linear(r,s,e.y),a=t.bars.barWidth||.8,f=a>1?a:this.canvas.width/(this.stats.maxX-this.stats.minX)*a,l=g.scale.linear(r,s,0)-u,c=e["top-rx"]||t.bars["top-rx"],h=e["top-ry"]||t.bars["top-ry"],p=e["bottom-rx"]||t.bars["bottom-rx"],d=e["bottom-ry"]||t.bars["bottom-ry"],v={left:o,middle:o-f/2,right:o-f}[t.bars.align||"middle"],m=this.elBar.clone();m.attr({"data-serie":t.name,"data-x":e.x,"data-y":e.y,d:V.rectToPath({x:v,y:u,width:f,height:l,"top-rx":c,"top-ry":h,"bottom-rx":p,"bottom-ry":d})});var y=t.name||"serie-"+this.model.get("series").indexOf(t);return V(this.elDataSeries).findOne("."+y+" .bars").append(m),m.node},renderPoint:function(e,t){var n=[this.stats.minX,this.stats.maxX],r=[this.stats.minY,this.stats.maxY],i=[this.canvas.x,this.canvas.x+this.canvas.width],s=[this.canvas.y+this.canvas.height,this.canvas.y],o=g.scale.linear(n,i,e.x),u=g.scale.linear(r,s,e.y),a=this.elPoint.clone();a.attr({"data-serie":t.name,"data-x":e.x,"data-y":e.y}),a.findOne("circle").attr({cx:o,cy:u}),a.findOne("text").attr({x:o,dy:u}).text(this.pointLabel(e,t));var f=t.name||"serie-"+this.model.get("series").indexOf(t);return V(this.elDataSeries).findOne("."+f+" .points").append(a),a.node},seriePathData:function(e,t,n){var r,i,s,o=_.isUndefined(t.interpolate)?this.model.get("interpolate"):t.interpolate,u=e.length;switch(o){case"bezier":r=g.bezier.curveThroughPoints(e);break;case"step":for(s=e[0],r=["M",s.x,s.y],i=1;u>i;i++)r.push("H",(s.x+e[i].x)/2,"V",e[i].y),s=e[i];break;case"stepBefore":for(r=["M",e[0].x,e[0].y],i=1;u>i;i++)r.push("V",e[i].y,"H",e[i].x);break;case"stepAfter":for(r=["M",e[0].x,e[0].y],i=1;u>i;i++)r.push("H",e[i].x,"V",e[i].y);break;default:for(r=["M"],i=0;u>i;i++)r.push(e[i].x,e[i].y)}return r=this.fixPathForFill(r,e,t,n),r.join(" ")},fixPathForFill:function(e,t,n,r){if(0===t.length)return e;var i=this.stats.bySerie[n.name||r];if(!i.nonDecreasingX)return e;var s=10,o=this.model.get("size"),u=_.first(t),a=_.last(t),f=["M",a.x,o.height+s,"H",u.x-s,"V",u.y];return e[0]="L",f.concat(e)},updateAxis:function(){{var e=this.model.get("size"),t=e.width,n=e.height,r=this.model.get("axis"),i=this.canvas.height/n;this.canvas.width/t}if(V(this.elYAxisPath).attr("d",["M",0,0,"L",0,n].join(" ")),V(this.elXAxisPath).attr("d",["M",0,n,"L",t,n].join(" ")),this.elXAxisTicks.textContent="",this.elYAxisTicks.textContent="",!this.isEmpty()){var s=[this.stats.minX,this.stats.maxX],o=[this.stats.minY,this.stats.maxY],u=[this.canvas.x,this.canvas.x+this.canvas.width],a=[0,this.canvas.height],f=(s[1]-s[0],o[1]-o[0]),l=r&&r["y-axis"]||{},c=r&&r["x-axis"]||{},h=f>0?l.ticks-1||10:0,p=f/h/i,d=o[0];_.each(_.range(h+1),function(){var e=g.scale.linear(o,a,d),t=this.elTick.clone();t.translate(0,e),V(this.elYAxisTicks).append(t);var n=o[1]-(d-o[0]);n+=g.scale.linear(a,o,this.canvas.y)-o[0],t.findOne("text").text(this.tickLabel(n,l)),d+=p},this),_.each(this.stats.xValues,function(e,r){if(r%(c.tickStep||1)===0){var i=g.scale.linear(s,u,e);if(!(i>t)){var o=this.elTick.clone();o.translate(i,n),V(this.elXAxisTicks).append(o),o.findOne("text").text(this.tickLabel(e,c))}}},this)}},tickLabel:function(e,t){if(_.isFunction(t.tickFormat))return t.tickFormat(e);var n=t.tickFormat||".1f",r=joint.util.format.number(n,e);return r+(_.isFunction(t.tickSuffix)?t.tickSuffix(e):t.tickSuffix||"")},pointLabel:function(e,t){if(_.isFunction(t.pointFormat))return t.pointFormat(e);var n=t.pointFormat||".1f",r=joint.util.format.number(n,e.y);return r+(t.pointSuffix||"")},updateMarkings:function(){function e(e,t){return _.isUndefined(e)?t:e}this.elMarkings.textContent="";var t=this.model.get("markings");if(t&&0!==t.length){var n=this.model.get("size"),r=n.width,i=n.height,s=[this.stats.minX,this.stats.maxX],o=[this.stats.minY,this.stats.maxY],u=[this.canvas.x,this.canvas.x+this.canvas.width],a=[this.canvas.y,this.canvas.y+this.canvas.height];_.each(t,function(t,n){var l=t.start||t.end,c=t.end||t.start,p=Math.min(e(l.x,this.stats.minX),e(c.x,this.stats.minX)),v=Math.max(e(l.x,this.stats.maxX),e(c.x,this.stats.maxX)),m=Math.min(e(l.y,this.stats.minY),e(c.y,this.stats.minY)),y=Math.max(e(l.y,this.stats.maxY),e(c.y,this.stats.maxY)),b=_.isUndefined(l.x)||_.isUndefined(c.x),w=_.isUndefined(l.y)||_.isUndefined(c.y);b&&(u=[0,r]),w&&(a=[0,i]);var E=g.scale.linear(s,u,p),S=g.scale.linear(s,u,v),x=g.scale.linear(o,a,m),T=g.scale.linear(o,a,y),N=E,C=a[1]-T+a[0],k=S-E,L=T-x;k=Math.max(k,1),L=Math.max(L,1);var A=this.elMarking.clone();A.findOne("rect").attr({x:N,y:C,width:k,height:L}),A.findOne("text").text(t.label||"").attr({x:N+k,y:C});var O=A.attr("class")+" "+(t.name||"marking-"+n);A.attr(_.extend({"class":O},t.attrs)),V(this.elMarkings).append(A)},this)}},updateLegend:function(){var e=this.model.get("series");this.elLegendItems.textContent="",_.each(e,function(e,t){var n=this.elLegendItem.clone();_.contains(this._disabledSeries,e.name)&&n.addClass("disabled"),n.attr("data-serie",e.name),n.findOne("circle").attr({fill:this.getSerieColor(e.name)}),n.findOne("text").text(e.label||e.name),n.translate(0,16*t),V(this.elLegendItems).append(n)},this)},getSerieColor:function(e){var t=this.model.get("attrs"),n=_.find(t,function(t,n){return _.contains(n,e)?!0:void 0});return n?n.stroke||n.fill:"black"},hideSerie:function(e){_.contains(this._disabledSeries,e)||this._disabledSeries.push(e);var t=this.filterSeries();this.update(t)},showSerie:function(e){this._disabledSeries=_.without(this._disabledSeries,e);var t=this.filterSeries();this.update(t)},filterSeries:function(e){return e=e||this.model.get("series"),e=_.reject(e,function(e){return _.contains(this._disabledSeries,e.name)},this)},onPointerDown:function(e){var t=$(e.target).closest(".legend-item")[0];t&&(V(t).toggleClass("disabled"),V(t).hasClass("disabled")?this.hideSerie(V(t).attr("data-serie")):this.showSerie(V(t).attr("data-serie")))},onMouseMove:function(e){this.showGuidelines(e.clientX,e.clientY,e)},onMouseOut:function(e){this.hideGuidelines(),this.trigger("mouseout",e)},showGuidelines:function(e,t,n){var r=this.model.get("angle"),i=this.model.getBBox(),s=(this.model.get("series"),g.point(V(this.paper.viewport).toLocalPoint(e,t)).rotate(i.center(),r));if(g.rect(i).containsPoint(s)){var o=this.model.get("size"),u=s.x-i.x,a=s.y-i.y;V(this.elXGuideline).attr({x1:u,y1:0,x2:u,y2:o.height,visibility:"visible"}),V(this.elYGuideline).attr({x1:0,y1:a,x2:o.width,y2:a,visibility:"visible"});var f=g.scale.linear([this.canvas.x,this.canvas.x+this.canvas.width],[this.stats.minX,this.stats.maxX],u),l=g.scale.linear([this.canvas.y,this.canvas.y+this.canvas.height],[this.stats.minY,this.stats.maxY],a),c={x:f,y:this.stats.minY+this.stats.maxY-l},h={x:e,y:t},p=this.closestPoints(f);this.trigger("mouseover",c,h,p,n)}},closestPoints:function(e){var t=_.sortedIndex(this.stats.xValues,e),n=this.stats.xValues[t],r=this.stats.xValues[t-1],i=_.isUndefined(r)?n:Math.abs(e-n)<Math.abs(e-r)?n:r;return this.stats.xMap[i]},hideGuidelines:function(){V(this.elXGuideline).attr("visibility","hidden"),V(this.elYGuideline).attr("visibility","hidden")}}),joint.shapes.chart.Pie=joint.shapes.basic.Generic.extend({markup:['<g class="rotatable">','<g class="scalable"></g>','<g class="background"><rect/><text/></g>','<g class="data"></g>','<g class="foreground">','<rect/><text class="caption"/><text class="subcaption"/>','<g class="legend"><g class="legend-items"></g></g>',"</g>","</g>"].join(""),sliceMarkup:'<g class="slice"/>',sliceFillMarkup:'<path class="slice-fill"/>',sliceBorderMarkup:'<path class="slice-border"/>',sliceInnerLabelMarkup:'<text class="slice-inner-label"/>',legendSerieMarkup:'<g class="legend-serie"><text/></g>',legendSliceMarkup:'<g class="legend-slice"><circle/><text/></g>',defaults:joint.util.deepSupplement({type:"chart.Pie",size:{width:200,height:200},pieHole:0,serieDefaults:{startAngle:0,degree:360,label:null,showLegend:!0,labelLineHeight:6},sliceDefaults:{innerLabel:"{percentage:.0f}%",innerLabelMargin:6,legendLabel:"{label}: {value}",legendLabelLineHeight:6,legendLabelMargin:14,offset:0,onClickEffect:{type:"offset",offset:20},onHoverEffect:null},series:[],attrs:{".background > rect":{opacity:0},".background > text":{fill:"black",text:"No data available.",ref:".background > rect","ref-x":.5,"ref-y":.5,"text-anchor":"middle","y-alignment":"middle",display:"none"},".foreground > rect":{fill:"white",stroke:"#e5e5e5",opacity:0,"pointer-events":"none"},".foreground .caption":{fill:"black",text:"",ref:".foreground > rect","ref-x":2,"ref-y":6,"text-anchor":"start","y-alignment":"middle","font-size":14},".foreground .subcaption":{fill:"black",text:"",ref:".foreground > rect","ref-x":2,"ref-y":18,"text-anchor":"start","y-alignment":"middle","font-size":10},".data":{ref:".background","ref-x":.5,"ref-y":.5},".slice":{cursor:"pointer"},".slice > .slice-fill":{stroke:"#ffffff","stroke-width":1,"fill-opacity":1},".slice.hover > .slice-fill":{"fill-opacity":.8},".slice > .slice-border":{"stroke-width":6,"stroke-opacity":.4,"fill-opacity":1,fill:"none",display:"none"},".slice.hover > .slice-border":{display:"block"},".slice > .slice-inner-label":{"text-anchor":"middle","font-size":"12",stroke:"none","stroke-width":"0",fill:"#ffffff",dy:"-.5em"},".legend":{ref:".background","ref-dx":20,"ref-y":5},".legend-serie text":{fill:"grey",transform:"translate(2, 0)","font-size":13},".legend-slice":{cursor:"pointer"},".legend-slice text":{"font-weight":"normal",fill:"black","font-size":11},".legend-slice.hover text":{"font-weight":"bold"},".legend-slice circle":{r:5,transform:"translate(5,5)"}}},joint.shapes.basic.Generic.prototype.defaults),addSlice:function(e,t,n){n=n||{},t=t||0;var r=this.get("series");_.isUndefined(r[t])&&(r[t]={data:[]});var i=_.cloneDeep(r[t]);i.data.push(e),r=r.slice(),r[t]=i,n=i.data.length>1?_.extend(n,{changedSerieIndex:t}):n,this.set("series",r,n)},editSlice:function(e,t,n,r){r=r||{},n=n||0;var i=this.get("series");if(_.isUndefined(i[n])||_.isUndefined(i[n].data[t]))throw new Error("Slice "+t+" on serie "+n+" was not found.");var s=_.cloneDeep(i[n]);s.data[t]=_.extend(s.data[t],e),i=i.slice(),i[n]=s,this.set("series",i,_.extend(r,{changedSerieIndex:n}))}}),joint.shapes.chart.PieView=joint.dia.ElementView.extend({events:{"mouseover .slice":"onMouseOverSlice","mouseout .slice":"onMouseOverSlice","mousemove .slice":"onMouseMoveSlice","mouseover .legend-slice":"onEventLegendItem","mouseout .legend-slice":"onEventLegendItem"},initialize:function(){joint.dia.ElementView.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"change:series change:serieDefaults change:sliceDefaults change:pieHole",function(e,t,n){this.update(null,null,n.changedSerieIndex)}),this.on("cell:pointerclick",this.onClickSlice,this),this.on("cell:pointerclick",this.onEventLegendItem,this)},renderMarkup:function(){joint.dia.ElementView.prototype.renderMarkup.apply(this,arguments),this.elBackgroundRect=this.$(".background rect")[0],this.elBackgroundText=this.$(".background text")[0],this.elForegroundRect=this.$(".foreground rect")[0],this.elLegendItems=this.$(".legend-items")[0],this.elPie=this.$(".data")[0],this.elSlice=V(this.model.sliceMarkup),this.elSliceFill=V(this.model.sliceFillMarkup),this.elSliceBorder=V(this.model.sliceBorderMarkup),this.elSliceInnerLabel=V(this.model.sliceInnerLabelMarkup),this.elLegendSerie=V(this.model.legendSerieMarkup),this.elLegendSlice=V(this.model.legendSliceMarkup)},update:function(e,t,n){var r=this.calculateSeries(n);n in r?$(this.elPie).find(".serie-"+n).remove():$(this.elPie).empty();var i=this.model.get("size");V(this.elBackgroundRect).attr(i),V(this.elForegroundRect).attr(i),r.length?$(this.elBackgroundText).hide():$(this.elBackgroundText).show(),_.each(r,function(e,t){(_.isUndefined(n)||n===t)&&_.each(e.data,function(e){this.updateSlice(e)},this)},this),this.updateLegend(),joint.dia.ElementView.prototype.update.apply(this,arguments)},calculateSeries:function(e){var t=_.cloneDeep(this.model.get("series")),n=this.model.get("serieDefaults"),r=this.model.get("sliceDefaults"),i=this.model.get("size"),s=_.min([i.width,i.height])/2,o=this.model.get("pieHole");o=o>1?o:s*o;var u=s,a=(s-o)/t.length;return this._series=_.map(t,function(t,i){if(!_.isUndefined(e)&&e!==i)return t;t=_.defaults(t,n);var s=t.startAngle,o=_.reduce(t.data,function(e,t){return e+t.value},0),f=t.degree/o||0,l=100/o;return t.data=_.map(t.data,function(e,t){e=_.defaults(e,_.omit(r,"offset","onClickEffect","onHoverEffect")),e.outerRadius=u,e.innerRadius=u-a,i||(e=_.defaults(e,_.pick(r,"offset","onClickEffect","onHoverEffect")),e.outer=!0,e.offset=e.offset>1?e.offset:e.offset*e.outerRadius,e.onClickEffect.offset=e.onClickEffect.offset>1?e.onClickEffect.offset:e.onClickEffect.offset*e.outerRadius),e.serieIndex=i,e.sliceIndex=t,e.innerLabelMargin=e.innerLabelMargin<-1||e.innerLabelMargin>1?e.innerLabelMargin:e.innerLabelMargin*e.outerRadius,e.percentage=e.value*l;var n=e.value*f;return e.degree={angle:n,start:s,end:n+s},e.rad={angle:g.toRad(e.degree.angle,!0),start:g.toRad(e.degree.start,!0),end:g.toRad(e.degree.end,!0)},e.middleangle=(e.rad.start+e.rad.end)/2,s=e.degree.end,e}),u-=a,t}),this._series},updateLegend:function(){var e=this._series;this.elLegendItems.textContent="";var t=0,n=parseInt(this.model.attr(".legend-serie text/font-size"),10),r=parseInt(this.model.attr(".legend-slice text/font-size"),10);_.each(e,function(e,i){if(e.showLegend){if(e.label){var s=this.elLegendSerie.clone();e.name&&s.addClass(e.name),s.attr({"data-serie":i}),s.findOne("text").text(e.label),s.translate(0,t),V(this.elLegendItems).append(s),t+=n+e.labelLineHeight}_.each(e.data,function(e,n){var s=this.elLegendSlice.clone(),o=this.getSliceFillColor(n,i);e.name&&s.addClass(e.name),s.attr({"data-serie":i,"data-slice":n}),s.findOne("circle").attr({fill:o}),s.findOne("text").text(joint.util.format.string(e.legendLabel,e)),s.findOne("text").translate(e.legendLabelMargin),s.translate(0,t),t+=r+e.legendLabelLineHeight,V(this.elLegendItems).append(s),_.isObject(o)&&this.applyGradient("#"+s.findOne("circle").attr("id"),"fill",o)},this)}},this)},updateSlice:function(e){var t=this.elSlice.clone();V(this.elPie).append(t);var n=this.elSliceFill.clone(),r=this.getSliceFillColor(e.sliceIndex,e.serieIndex);n.attr({fill:r,d:this.drawSlice(e.innerRadius,e.outerRadius,e.rad.start,e.rad.end)}),t.append(n),_.isObject(r)&&this.applyGradient("#"+n.attr("id"),"fill",r);var i=this.elSliceBorder.clone(),s=parseInt(this.model.attr(".slice > .slice-border/stroke-width"),10),o=g.point.fromPolar(e.outerRadius+s/2,-e.rad.start,g.point(0,0)),u=g.point.fromPolar(e.outerRadius+s/2,-e.rad.end,g.point(0,0));i.attr({stroke:r,d:this.drawArc(o,u,e.outerRadius+s/2,e.rad.start,e.rad.end)}),t.append(i),_.isObject(r)&&this.applyGradient("#"+i.attr("id"),"stroke",r);var a=this.elSliceInnerLabel.clone();a.text(joint.util.format.string(e.innerLabel,e)),t.append(a);var f=a.bbox(),l=e.outerRadius-f.width/2-e.innerLabelMargin;a.translate(l*Math.cos(-e.middleangle),-l*Math.sin(-e.middleangle)),t.attr({"data-serie":e.serieIndex,"data-slice":e.sliceIndex,"data-value":e.value});var c=this._series[e.serieIndex].name;return c&&t.addClass(c),e.name&&t.addClass(e.name),t.addClass("serie-"+e.serieIndex+" slice-"+e.sliceIndex),e.outer&&(t.addClass("outer"),e.offset&&(t.addClass("clicked"),this.effectOnSlice(t,e,{type:"offset",offset:e.offset}))),t},getSliceFillColor:function(e,t){t=t||0;var n=this.model.get("attrs"),r=_.find(n,function(n,r){return r.indexOf(".serie-"+t+".slice-"+e+" > .slice-fill")>-1});return r?r.fill:this._series[t].data[e].fill},onMouseMoveSlice:function(e){var t=V(e.currentTarget),n=t.attr("data-serie"),r=t.attr("data-slice"),i=this._series[n].data[r];this.trigger(e.type,i,e)},mouseOverSlice:function(e,t){t=t||0;var n=V(this.$('.slice[data-serie="'+t+'"][data-slice="'+e+'"]')[0]),r=this._series[t].data[e];n.toggleClass("hover"),r.outer&&!_.isEmpty(r.onHoverEffect)&&this.effectOnSlice(n,r,r.onHoverEffect,n.hasClass("hover")?!1:!0);var i=V(this.$('.legend-slice[data-serie="'+t+'"][data-slice="'+e+'"]')[0]);i&&i.toggleClass("hover");var s=_.filter(_.keys(this.model.get("attrs")),function(e){return e.indexOf(".slice")>-1||e.indexOf(".legend-slice")>-1});joint.dia.ElementView.prototype.update.call(this,this.model,_.pick(this.model.get("attrs"),s))},onMouseOverSlice:function(e){var t=V(e.currentTarget),n=t.attr("data-serie"),r=t.attr("data-slice");this.mouseOverSlice(r,n);var i=this._series[n].data[r];this.trigger(e.type,i,e)},clickSlice:function(e,t){t=t||0;var n=V(this.$('.slice[data-serie="'+t+'"][data-slice="'+e+'"]')[0]),r=this._series[t].data[e];r.outer&&(n.hasClass("clicked")?(n.removeClass("clicked"),this.model.get("series")[t].data[e].offset=0,this.effectOnSlice(n,r,r.onClickEffect,!0)):(n.addClass("clicked"),this.model.get("series")[t].data[e].offset=r.onClickEffect.offset,this.effectOnSlice(n,r,r.onClickEffect)))},onClickSlice:function(e){var t=V($(e.target).closest(".slice.outer")[0]);if(t){var n=t.attr("data-serie"),r=t.attr("data-slice");this.clickSlice(r,n);var i=this._series[n].data[r];this.trigger(e.type,i,e)}},onEventLegendItem:function(e){var t=V($(e.target).closest(".legend-slice")[0]);if(t){var n=t.attr("data-serie"),r=t.attr("data-slice");switch(e.type){case"click":this.clickSlice(r,n);break;case"mouseover":case"mouseout":this.mouseOverSlice(r,n)}}},effectOnSlice:function(e,t,n,r){switch(r=r||!1,n.type){case"enlarge":r?e.scale(1):e.scale(n.scale||1.05);break;case"offset":r?e.translate(0,0,{absolute:!0}):e.translate(n.offset*Math.cos(-t.middleangle),-n.offset*Math.sin(-t.middleangle))}},svgArcMax:2*Math.PI-1e-6,drawArc:function(e,t,n,r,i){var s=0,o=1,u=i-r;return u>Math.PI&&(s=1,u>=this.svgArcMax&&(s=0,o=0)),"M"+e.x+","+e.y+" A"+n+","+n+" 0 "+s+","+o+" "+t.x+","+t.y},drawSlice:function(e,t,n,r){var i=e,s=t,o=n,u=r,a=(o>u&&(a=o,o=u,u=a),u-o),f=a<Math.PI?"0":"1",l=Math.cos(o),c=Math.sin(o),h=Math.cos(u),p=Math.sin(u);return a>=this.svgArcMax?i?"M0,"+s+"A"+s+","+s+" 0 1,1 0,"+ -s+"A"+s+","+s+" 0 1,1 0,"+s+"M0,"+i+"A"+i+","+i+" 0 1,0 0,"+ -i+"A"+i+","+i+" 0 1,0 0,"+i+"Z":"M0,"+s+"A"+s+","+s+" 0 1,1 0,"+ -s+"A"+s+","+s+" 0 1,1 0,"+s+"Z":i?"M"+s*l+","+s*c+"A"+s+","+s+" 0 "+f+",1 "+s*h+","+s*p+"L"+i*h+","+i*p+"A"+i+","+i+" 0 "+f+",0 "+i*l+","+i*c+"Z":"M"+s*l+","+s*c+"A"+s+","+s+" 0 "+f+",1 "+s*h+","+s*p+"L0,0Z"}}),joint.shapes.chart.Knob=joint.shapes.chart.Pie.extend({defaults:joint.util.deepSupplement({type:"chart.Knob",sliceDefaults:{legendLabel:"{value:.0f}",outer:{offsetOnClick:0}},pieHole:.7,value:0,attrs:{".legend":{"ref-x":.5,"ref-y":.5,"x-alignment":-.9,"y-alignment":-.4},".legend-slice text":{"font-size":30},".legend-slice circle":{display:"none"},".slice-inner-label":{display:"none"},".slice-fill":{stroke:"none"}}},joint.shapes.chart.Pie.prototype.defaults),initialize:function(){this.set("series",this.getKnobSeries(),{silent:!0}),joint.shapes.chart.Pie.prototype.initialize.apply(this,arguments),this.on("change:value change:min change:max change:fill",this.updateKnob,this)},getKnobSeries:function(){var e=_.isArray(this.get("value"))?this.get("value"):[this.get("value")],t=_.isArray(this.get("fill"))?this.get("fill"):[this.get("fill")],n=_.isArray(this.get("min"))?this.get("min"):[this.get("min")],r=_.isArray(this.get("max"))?this.get("max"):[this.get("max")],i=_.map(e,function(e,i){var s=_.isUndefined(n[i])?n[0]:n[i],o=_.isUndefined(r[i])?r[0]:r[i],u=_.isUndefined(t[i])?t[0]:t[i];return{degree:g.scale.linear([s,o],[0,360],e),data:[{value:e,fill:u}],showLegend:i>0?!1:!0}});return i},updateKnob:function(){this.set("series",this.getKnobSeries())}}),joint.shapes.chart.KnobView=joint.shapes.chart.PieView,"object"==typeof exports&&(module.exports=joint.shapes.chart),"object"==typeof exports)var joint={util:require("../src/core").util,shapes:{},dia:{Element:require("../src/joint.dia.element").Element,Link:require("../src/joint.dia.link").Link}};joint.shapes.bpmn={},joint.shapes.bpmn.icons={none:"",message:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjwhRE9DVFlQRSBzdmcgIFBVQkxJQyAnLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4nICAnaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkJz48c3ZnIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDUxMiA1MTIiIGhlaWdodD0iNTEycHgiIGlkPSJMYXllcl8xIiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA1MTIgNTEyIiB3aWR0aD0iNTEycHgiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxwYXRoIGQ9Ik00NzkuOTk4LDY0SDMyQzE0LjMyOSw2NCwwLDc4LjMxMiwwLDk2djMyMGMwLDE3LjY4OCwxNC4zMjksMzIsMzIsMzJoNDQ3Ljk5OEM0OTcuNjcxLDQ0OCw1MTIsNDMzLjY4OCw1MTIsNDE2Vjk2ICBDNTEyLDc4LjMxMiw0OTcuNjcxLDY0LDQ3OS45OTgsNjR6IE00MTYsMTI4TDI1NiwyNTZMOTYsMTI4SDQxNnogTTQ0OCwzODRINjRWMTYwbDE5MiwxNjBsMTkyLTE2MFYzODR6Ii8+PC9zdmc+",plus:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjwhRE9DVFlQRSBzdmcgIFBVQkxJQyAnLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4nICAnaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkJz48c3ZnIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDI0IDI0IiBoZWlnaHQ9IjI0cHgiIGlkPSJMYXllcl8xIiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjI0cHgiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxwYXRoIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTIyLjUsMTRIMTR2OC41YzAsMC4yNzYtMC4yMjQsMC41LTAuNSwwLjVoLTRDOS4yMjQsMjMsOSwyMi43NzYsOSwyMi41VjE0SDAuNSAgQzAuMjI0LDE0LDAsMTMuNzc2LDAsMTMuNXYtNEMwLDkuMjI0LDAuMjI0LDksMC41LDlIOVYwLjVDOSwwLjIyNCw5LjIyNCwwLDkuNSwwaDRDMTMuNzc2LDAsMTQsMC4yMjQsMTQsMC41VjloOC41ICBDMjIuNzc2LDksMjMsOS4yMjQsMjMsOS41djRDMjMsMTMuNzc2LDIyLjc3NiwxNCwyMi41LDE0eiIgZmlsbC1ydWxlPSJldmVub2RkIi8+PC9zdmc+",cross:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjwhRE9DVFlQRSBzdmcgIFBVQkxJQyAnLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4nICAnaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkJz48c3ZnIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDI0IDI0IiBoZWlnaHQ9IjI0cHgiIGlkPSJMYXllcl8xIiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjI0cHgiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxwYXRoIGQ9Ik0yMi4yNDUsNC4wMTVjMC4zMTMsMC4zMTMsMC4zMTMsMC44MjYsMCwxLjEzOWwtNi4yNzYsNi4yN2MtMC4zMTMsMC4zMTItMC4zMTMsMC44MjYsMCwxLjE0bDYuMjczLDYuMjcyICBjMC4zMTMsMC4zMTMsMC4zMTMsMC44MjYsMCwxLjE0bC0yLjI4NSwyLjI3N2MtMC4zMTQsMC4zMTItMC44MjgsMC4zMTItMS4xNDIsMGwtNi4yNzEtNi4yNzFjLTAuMzEzLTAuMzEzLTAuODI4LTAuMzEzLTEuMTQxLDAgIGwtNi4yNzYsNi4yNjdjLTAuMzEzLDAuMzEzLTAuODI4LDAuMzEzLTEuMTQxLDBsLTIuMjgyLTIuMjhjLTAuMzEzLTAuMzEzLTAuMzEzLTAuODI2LDAtMS4xNGw2LjI3OC02LjI2OSAgYzAuMzEzLTAuMzEyLDAuMzEzLTAuODI2LDAtMS4xNEwxLjcwOSw1LjE0N2MtMC4zMTQtMC4zMTMtMC4zMTQtMC44MjcsMC0xLjE0bDIuMjg0LTIuMjc4QzQuMzA4LDEuNDE3LDQuODIxLDEuNDE3LDUuMTM1LDEuNzMgIEwxMS40MDUsOGMwLjMxNCwwLjMxNCwwLjgyOCwwLjMxNCwxLjE0MSwwLjAwMWw2LjI3Ni02LjI2N2MwLjMxMi0wLjMxMiwwLjgyNi0wLjMxMiwxLjE0MSwwTDIyLjI0NSw0LjAxNXoiLz48L3N2Zz4=",user:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjwhRE9DVFlQRSBzdmcgIFBVQkxJQyAnLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4nICAnaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkJz48c3ZnIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDI0IDI0IiBoZWlnaHQ9IjI0cHgiIGlkPSJMYXllcl8xIiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjI0cHgiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxwYXRoIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTIyLDIwLjk5OGgtMWMwLDAtMSwwLTEtMVYxNy41YzAtMC4yNzctMC4yMjQtMC41LTAuNS0wLjVTMTksMTcuMjIzLDE5LDE3LjUgIGwtMC4wMDgsNC4yOTVjMCwwLjYwOS0yLjAxLDIuMjA1LTYuNDkyLDIuMjA1cy02LjQ5Mi0xLjU5Ni02LjQ5Mi0yLjIwNUw2LDE3LjVDNiwxNy4yMjMsNS43NzYsMTcsNS41LDE3UzUsMTcuMjIzLDUsMTcuNXYyLjQ5OCAgYzAsMS0xLDEtMSwxSDNjMCwwLTEsMC0xLTFWMTUuNzVjMC0yLjkyMiwyLjg5Mi01LjQwMSw2LjkzLTYuMzQxYzAsMCwxLjIzNCwxLjEwNywzLjU3LDEuMTA3czMuNTctMS4xMDcsMy41Ny0xLjEwNyAgYzQuMDM4LDAuOTQsNi45MywzLjQxOSw2LjkzLDYuMzQxdjQuMjQ4QzIzLDIwLjk5OCwyMiwyMC45OTgsMjIsMjAuOTk4eiBNMTIuNDc3LDljLTIuNDg1LDAtNC41LTIuMDE1LTQuNS00LjVTOS45OTEsMCwxMi40NzcsMCAgczQuNSwyLjAxNSw0LjUsNC41UzE0Ljk2Miw5LDEyLjQ3Nyw5eiIgZmlsbC1ydWxlPSJldmVub2RkIi8+PC9zdmc+",circle:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3gULEBE3DEP64QAAAwlJREFUaN7dmktrU0EUx38ZmmBbfEIL2hSjkYKC1EW6EDFudC+404/gE6WKSvGxERQfIH4AX1T9EOKrCrYurVrbgsZWoaBVixDbpC6ci+Fyz9ybZG478cBs7syc+Z+5c86c+c8ksCPrgW1ADtgEbARafG1+AW+AYWAIGADGWUTZAJwHxoD5GssocA7ILiTwLcADoFQHcH8pAfeB7jiBtwO3gLJF4P5S1mO02wa/C5iMEbi/TAI7bYE/Y3m5VLOs+sLAJULqrgKHIxhZBp4DT4FX2jkLGoinq1M7fg7YDmwFVATd14CjFboiy5UIs/QBOAmka/izaeCU1hE2zuVqlZ8IUfgVOAA0WViiTcBBrdM0Zm9UhTuAOYOiRzXOeJh0Ak8M484B+TAlK4BPBiU3gWSMoTqpw6g0fgFYblJww9D5dojT25IEcMeA47rUsdsQLp9FmPmURSNSOqpJS2lzUKd+ocN3IBNx5mz+oXXADwHTXX/jjMFxjy1iwtgrYJoF1lY27BMafozZaaMspYKA7XRlw7f1xt4Y5biA7bXXIGv4TW0OGNCmsQRhzCidlwTJADDlgAFTwAuhLq+AHqHyMe6IhKVHAV1C5ZBDBkhYupThPPreIQNGJTJBGXKLLw4Z8NmQu/Fb8PCkQwakBIxFRWPLvAJmhMpWh4AuFb7PKGBaqFzjkAGrhe/TSjNrQZJ1yAAJy5gCRoTKnEMGSFhGFDBoOBu7IhKWQe8wLRFLHQ6A7zCcFNNK59vvAjoqYK8DBuwTCLBhTUD8Hweahj9S2jjU297VqzrU26BVmi2yEjXRKg1PbHnpqYla7AeWxAi+GbhHHdSit2mYyN2XQQ5kQTJ6Y6qL3PUkCr2+H7v0+jcs0eueRLngGNeKa9mxY73g8JzpEtHusorAQ/7e+e7WUWIl//jSVTrK7QEu6KgW9d7tYr3B44iBWPJfkZZ8pZ4r2VngkC0HywMTLNwN5YSBcKtZWoGzernEBbyox2iJc6Np2KcGfnHisYet1CDouc2yCjbhp07MrD+3+QNxi4JkAscRswAAAABJRU5ErkJggg=="},joint.shapes.bpmn.IconInterface={initialize:function(){this._parent=(this._parent||this).constructor.__super__,this._parent.initialize.apply(this,arguments),this.listenTo(this,"change:icon",this._onIconChange),this._onIconChange(this,this.get("icon")||"none")},_onIconChange:function(e,t){var n=joint.shapes.bpmn.icons;if(!_.has(n,t))throw"BPMN: Unknown icon: "+t;e.attr("image/xlink:href",n[t])}},joint.shapes.bpmn.SubProcessInterface={initialize:function(){this._parent=(this._parent||this).constructor.__super__,this._parent.initialize.apply(this,arguments),this.listenTo(this,"change:subProcess",this._onSubProcessChange),this._onSubProcessChange(this,this.get("subProcess")||null)},_onSubProcessChange:function(e,t){e.attr({".sub-process":{visibility:t?"visible":"hidden","data-sub-process":t||""}})}},joint.shapes.bpmn.ActivityView=joint.shapes.basic.TextBlockView,joint.shapes.bpmn.Activity=joint.shapes.basic.TextBlock.extend({markup:['<g class="rotatable">','<g class="scalable"><rect class="body outer"/><rect class="body inner"/></g>',"<switch>",'<foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" class="fobj">','<body xmlns="http://www.w3.org/1999/xhtml"><div/></body>',"</foreignObject>",'<text class="content"/>','</switch><path class="sub-process"/><image class="icon"/></g>'].join(""),defaults:joint.util.deepSupplement({size:{width:100,height:100},type:"bpmn.Activity",attrs:{rect:{rx:8,ry:8,width:100,height:100},".body":{fill:"#ffffff",stroke:"#000000"},".inner":{transform:"scale(0.9,0.9) translate(5,5)"},path:{d:"M 0 0 L 30 0 30 30 0 30 z M 15 4 L 15 26 M 4 15 L 26 15",ref:".inner","ref-x":.5,"ref-dy":-30,"x-alignment":"middle",stroke:"#000000",fill:"transparent"},image:{ref:".inner","ref-x":5,width:20,height:20}},activityType:"task",subProcess:null},joint.shapes.basic.TextBlock.prototype.defaults),initialize:function(){joint.shapes.basic.TextBlock.prototype.initialize.apply(this,arguments),this.listenTo(this,"change:activityType",this.onActivityTypeChange),this.listenTo(this,"change:subProcess",this.onSubProcessChange),this.onSubProcessChange(this,this.get("subProcess")),this.onActivityTypeChange(this,this.get("activityType"))},onActivityTypeChange:function(e,t){switch(t){case"task":e.attr({".inner":{visibility:"hidden"},".outer":{"stroke-width":1,"stroke-dasharray":"none"},path:{ref:".outer"},image:{ref:".outer"}});break;case"transaction":e.attr({".inner":{visibility:"visible"},".outer":{"stroke-width":1,"stroke-dasharray":"none"},path:{ref:".inner"},image:{ref:".inner"}});break;case"event-sub-process":e.attr({".inner":{visibility:"hidden"},".outer":{"stroke-width":1,"stroke-dasharray":"1,2"},path:{ref:".outer"},image:{ref:".outer"}});break;case"call-activity":e.attr({".inner":{visibility:"hidden"},".outer":{"stroke-width":5,"stroke-dasharray":"none"},path:{ref:".outer"},image:{ref:".outer"}});break;default:throw"BPMN: Unknown Activity Type: "+t}},onSubProcessChange:function(e,t){t?e.attr({".fobj div":{style:{verticalAlign:"baseline",paddingTop:10}},image:{"ref-dy":-25,"ref-y":""},text:{"ref-y":25}}):e.attr({".fobj div":{style:{verticalAlign:"middle",paddingTop:0}},image:{"ref-dy":"","ref-y":5},text:{"ref-y":.5}})}}).extend(joint.shapes.bpmn.IconInterface).extend(joint.shapes.bpmn.SubProcessInterface),joint.shapes.bpmn.AnnotationView=joint.shapes.basic.TextBlockView,joint.shapes.bpmn.Annotation=joint.shapes.basic.TextBlock.extend({markup:['<g class="rotatable">','<g class="scalable"><rect class="body"/></g>',"<switch>",'<foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" class="fobj">','<body xmlns="http://www.w3.org/1999/xhtml"><div/></body>',"</foreignObject>",'<text class="content"/>','</switch><path class="stroke"/></g>'].join(""),defaults:joint.util.deepSupplement({size:{width:100,height:100},type:"bpmn.Annotation",attrs:{rect:{width:100,height:100},".body":{"fill-opacity":.1,fill:"#ffffff",stroke:"none"},".fobj div":{style:{textAlign:"left",paddingLeft:10}},".stroke":{stroke:"#000000",fill:"none","stroke-width":3}},wingLength:20},joint.shapes.basic.TextBlock.prototype.defaults),initialize:function(){joint.shapes.basic.TextBlock.prototype.initialize.apply(this,arguments),this.listenTo(this,"change:size",this.onSizeChange),this.onSizeChange(this,this.get("size"))},onSizeChange:function(e,t){e.attr(".stroke",{d:e.getStrokePathData(t.width,t.height,e.get("wingLength"))})},getStrokePathData:function(e,t,n){return n=Math.min(n,e),["M",n,"0 L 0 0 0",t,n,t].join(" ")}}),joint.shapes.bpmn.Gateway=joint.dia.Element.extend({markup:'<g class="rotatable"><g class="scalable"><polygon class="body"/><image/></g></g><text class="label"/>',defaults:joint.util.deepSupplement({type:"bpmn.Gateway",size:{width:80,height:80},attrs:{".body":{points:"40,0 80,40 40,80 0,40",fill:"#ffffff",stroke:"#000000"},".label":{text:"",ref:".body","ref-x":.5,"ref-dy":20,"y-alignment":"middle","x-alignment":"middle","font-size":14,"font-family":"Arial, helvetica, sans-serif",fill:"#000000"},image:{width:40,height:40,"xlink:href":"",transform:"translate(20,20)"}}},joint.dia.Element.prototype.defaults)}).extend(joint.shapes.bpmn.IconInterface),joint.shapes.bpmn.Event=joint.dia.Element.extend({markup:'<g class="rotatable"><g class="scalable"><circle class="body outer"/><circle class="body inner"/><image/></g><text class="label"/></g>',defaults:joint.util.deepSupplement({type:"bpmn.Event",size:{width:60,height:60},attrs:{".body":{fill:"#ffffff",stroke:"#000000"},".outer":{"stroke-width":1,r:30,transform:"translate(30,30)"},".inner":{"stroke-width":1,r:26,transform:"translate(30,30)"},image:{width:40,height:40,"xlink:href":"",transform:"translate(10,10)"},".label":{text:"",fill:"#000000","font-family":"Arial","font-size":14,ref:".outer","ref-x":.5,"ref-dy":20,"x-alignment":"middle","y-alignment":"middle"}},eventType:"start"},joint.dia.Element.prototype.defaults),initialize:function(){joint.dia.Element.prototype.initialize.apply(this,arguments),this.listenTo(this,"change:eventType",this.onEventTypeChange),this.onEventTypeChange(this,this.get("eventType"))},onEventTypeChange:function(e,t){switch(t){case"start":e.attr({".inner":{visibility:"hidden"},".outer":{"stroke-width":1}});break;case"end":e.attr({".inner":{visibility:"hidden"},".outer":{"stroke-width":5}});break;case"intermediate":e.attr({".inner":{visibility:"visible"},".outer":{"stroke-width":1}});break;default:throw"BPMN: Unknown Event Type: "+t}}}).extend(joint.shapes.bpmn.IconInterface),joint.shapes.bpmn.Pool=joint.dia.Element.extend({markup:['<g class="rotatable">','<g class="scalable"><rect class="body"/></g>','<svg overflow="hidden" class="blackbox-wrap"><text class="blackbox-label"/></svg>','<rect class="header"/><text class="label"/>','<g class="lanes"/>',"</g>"].join(""),laneMarkup:'<g class="lane"><rect class="lane-body"/><rect class="lane-header"/><text class="lane-label"/></g>',defaults:joint.util.deepSupplement({type:"bpmn.Pool",size:{width:600,height:300},attrs:{".body":{fill:"#ffffff",stroke:"#000000",width:500,height:200,"pointer-events":"stroke"},".header":{fill:"#ffffff",stroke:"#000000",width:20,ref:".body","ref-height":1,"pointer-events":"visiblePainted"},".label":{transform:"rotate(-90)",ref:".header","ref-x":10,"ref-y":.5,"font-family":"Arial","font-size":14,"x-alignment":"middle","text-anchor":"middle"},".lane-body":{fill:"#ffffff",stroke:"#000000","pointer-events":"stroke"},".lane-header":{fill:"#ffffff",stroke:"#000000","pointer-events":"visiblePainted"},".lane-label":{transform:"rotate(-90)","text-anchor":"middle","font-family":"Arial","font-size":13},".blackbox-wrap":{ref:".body","ref-width":1,"ref-height":1},".blackbox-label":{text:"Black Box",dx:"50%",dy:"50%","text-anchor":"middle",transform:"translate(0,-7)"}}},joint.dia.Element.prototype.defaults)}),joint.shapes.bpmn.PoolView=joint.dia.ElementView.extend({options:{headerWidth:20},initialize:function(){this.listenTo(this.model,"change:lanes",function(e,t){this.renderLanes(t)}),joint.dia.ElementView.prototype.initialize.apply(this,arguments)},update:function(){return _.isUndefined(this.lanesAttrs)?this.renderLanes(this.model.get("lanes")):joint.dia.ElementView.prototype.update.call(this,this.model,_.merge({},this.model.get("attrs"),this.lanesAttrs||{}))},renderMarkup:function(){joint.dia.ElementView.prototype.renderMarkup.apply(this,arguments),this.$lanes=this.$(".lanes"),this.laneMarkup=V(this.model.laneMarkup)},renderLanes:function(e){e=e||{},this.index=0,this.lanesAttrs={".header":{width:this.options.headerWidth},".label":{text:e.label||""}},this.$lanes.empty(),e.sublanes&&this.renderSublanes(e.sublanes,0,0,1),this.update(this.model,_.merge({},this.model.get("attrs"),this.lanesAttrs))},renderSublanes:function(e,t,n,r){var i=this.options.headerWidth,s=1/e.length*r;_.each(e,function(e,r){var o="lane"+this.index,u="."+o+" .lane-body",a="."+o+" .lane-header",l="."+o+" .lane-label";e.name&&(o+=" "+e.name),this.$lanes.append(this.laneMarkup.clone().addClass(o).node);var h=t+i,p=n+s*r;this.lanesAttrs[u]={ref:".body","ref-height":s,"ref-width":-h,"ref-x":h,"ref-y":p},this.lanesAttrs[a]={width:i,ref:".body","ref-height":s,"ref-x":h,"ref-y":p},this.lanesAttrs[l]={text:e.label,ref:a,"ref-x":10,"ref-y":.5,"x-alignment":"middle"},this.index++,e.sublanes&&this.renderSublanes(e.sublanes,h,p,s)},this)}}),joint.shapes.bpmn.Group=joint.dia.Element.extend({markup:'<g class="rotatable"><g class="scalable"><rect class="body"/></g><rect class="label-rect"/><g class="label-group"><svg overflow="hidden" class="label-wrap"><text class="label"/></svg></g></g>',defaults:joint.util.deepSupplement({type:"bpmn.Group",size:{width:200,height:200},attrs:{".body":{width:200,height:200,stroke:"#000000","stroke-dasharray":"6,6","stroke-width":2,fill:"transparent",rx:15,ry:15,"pointer-events":"stroke"},".label-rect":{ref:".body","ref-width":.6,"ref-x":.4,"ref-y":-30,height:25,fill:"#ffffff",stroke:"#000000"},".label-group":{ref:".label-rect","ref-x":0,"ref-y":0},".label-wrap":{ref:".label-rect","ref-width":1,"ref-height":1},".label":{text:"",x:"50%",dy:5,"text-anchor":"middle","font-family":"Arial","font-size":14,fill:"#000000"}}},joint.dia.Element.prototype.defaults)}),joint.shapes.bpmn.DataObject=joint.dia.Element.extend({markup:'<g class="rotatable"><g class="scalable"><polygon class="body"/></g><text class="label"/></g>',defaults:joint.util.deepSupplement({type:"bpmn.DataObject",size:{width:60,height:80},attrs:{".body":{points:"20,0 60,0 60,80 0,80 0,20 20,0 20,20 0,20",stroke:"#000000",fill:"#ffffff"},".label":{ref:".body","ref-x":.5,"ref-dy":5,text:"","text-anchor":"middle"}}},joint.dia.Element.prototype.defaults)}),joint.shapes.bpmn.Conversation=joint.dia.Element.extend({markup:'<g class="rotatable"><g class="scalable"><polygon class="body"/></g><text class="label"/><path class="sub-process"/></g>',defaults:joint.util.deepSupplement({type:"bpmn.Conversation",size:{width:100,height:100},attrs:{".body":{points:"25,0 75,0 100,50 75,100 25,100 0,50",stroke:"#000000",fill:"#ffffff"},".label":{text:"",ref:".body","ref-x":.5,"ref-dy":5,"text-anchor":"middle"},path:{d:"M 0 0 L 30 0 30 30 0 30 z M 15 4 L 15 26 M 4 15 L 26 15",ref:".body","ref-x":.5,"ref-dy":-30,"x-alignment":"middle",fill:"#ffffff",stroke:"#000000","fill-opacity":0}},conversationType:"conversation"},joint.dia.Element.prototype.defaults),initialize:function(){joint.dia.Element.prototype.initialize.apply(this,arguments),this.listenTo(this,"change:conversationType",this.onConversationTypeChange),this.onConversationTypeChange(this,this.get("conversationType"))},onConversationTypeChange:function(e,t){switch(t){case"conversation":e.attr("polygon/stroke-width",1);break;case"call-conversation":e.attr("polygon/stroke-width",4);break;default:throw"BPMN: Unknown Conversation Type: "+t}}}).extend(joint.shapes.bpmn.SubProcessInterface),joint.shapes.bpmn.Choreography=joint.shapes.basic.TextBlock.extend({markup:['<g class="rotatable">','<g class="scalable"><rect class="body"/></g>',"<switch>",'<foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" class="fobj">','<body xmlns="http://www.w3.org/1999/xhtml"><div/></body>',"</foreignObject>",'<text class="content"/>',"</switch>",'<text class="label"/><path class="sub-process"/><g class="participants"/>',"</g>"].join(""),participantMarkup:'<g class="participant"><rect class="participant-rect"/><text class="participant-label"/></g>',defaults:joint.util.deepSupplement({type:"bpmn.Choreography",size:{width:60,height:80},attrs:{rect:{},".body":{width:60,height:80,stroke:"#000000",fill:"#ffffff"},".label":{ref:".body","ref-x":.5,"ref-dy":5,text:"","text-anchor":"middle"},".participant-rect":{stroke:"#000000",fill:"#aaaaaa",ref:".body","ref-width":1},".participant-label":{"text-anchor":"middle",ref:".participant_0 .participant-rect","ref-x":.5,"ref-y":.5,"y-alignment":"middle"},".sub-process":{d:"M 0 0 L 30 0 30 30 0 30 z M 15 4 L 15 26 M 4 15 L 26 15",ref:".body","ref-x":.5,"ref-dy":-30,"x-alignment":"middle",fill:"transparent",stroke:"#000000"}},participants:[],initiatingParticipant:0},joint.shapes.basic.TextBlock.prototype.defaults)}).extend(joint.shapes.bpmn.SubProcessInterface),joint.shapes.bpmn.ChoreographyView=joint.shapes.basic.TextBlockView.extend({options:{participantHeight:20},initialize:function(){this.listenTo(this.model,"change:participants",function(e,t){this.renderParticipants(t)}),this.listenTo(this.model,"change:initiatingParticipant",this.layoutAndUpdate),joint.shapes.basic.TextBlockView.prototype.initialize.apply(this,arguments),this.noSVGForeignObjectElement&&this.off(null,"change:content").listenTo(this.model,"change:content",function(e){this.updateContent(e,this.participantsAttrs)})},update:function(){return _.isUndefined(this.participantsAttrs)?this.renderParticipants(this.model.get("participants")):(this.layoutAndUpdate(),this)},renderMarkup:function(){joint.dia.ElementView.prototype.renderMarkup.apply(this,arguments),this.$participants=this.$(".participants"),this.participantMarkup=V(this.model.participantMarkup)},renderParticipants:function(e){this.$participants.empty(),this.participantsAttrs={},_.each(e,function(e,t){var n="participant_"+t,r="."+n;this.participantsAttrs[r+" .participant-rect"]={height:this.options.participantHeight},this.participantsAttrs[r+" .participant-label"]={text:e},this.$participants.append(this.participantMarkup.clone().addClass(n).node)},this),this.layoutAndUpdate()},layoutAndUpdate:function(){var e=this.model.get("participants")||[],t=e.length,n=this.options.participantHeight,r=this.model.get("size").height,i=Math.max(0,r-n*t),s=0,o=this.model.get("initiatingParticipant"),u=Math.max(_.isNumber(o)?Math.abs(o):e.indexOf(o),0),a=Math.min(u,t-2);_.each(e,function(e,t){var r=".participant_"+t;this.participantsAttrs[r]={transform:"translate(0,"+s+")"},this.participantsAttrs[r+" .participant-rect"].fill=u==t?this.model.attr(".body/fill"):this.model.attr(".participant-rect/fill"),this.participantsAttrs[r+" .participant-rect"].stroke=u==t?this.model.attr(".body/stroke"):this.model.attr(".participant-rect/stroke"),s+=n+(a==t?i:0)},this);var f=2>t?0:a-t+1;this.participantsAttrs[".sub-process"]={"ref-dy":Math.max(-r,f*n-30)};var l=2>t?0:a+1;this.participantsAttrs[".fobj div"]={style:{height:i,paddingTop:n*l}},this.participantsAttrs[".content"]={"ref-y":n*l+i/2};var c=_.merge({},this.model.get("attrs"),this.participantsAttrs||{});joint.shapes.basic.TextBlockView.prototype.update.call(this,this.model,c)}}),joint.shapes.bpmn.Message=joint.dia.Element.extend({markup:'<g class="rotatable"><g class="scalable"><polygon class="body"/></g><text class="label"/></g>',defaults:joint.util.deepSupplement({type:"bpmn.Message",size:{width:60,height:40},attrs:{".body":{points:"0,0 60,0 60,40 0,40 0,0 60,0 30,20 0,0",stroke:"#000000",fill:"#ffffff"},".label":{ref:".body","ref-x":.5,"ref-dy":5,text:"","text-anchor":"middle"}}},joint.dia.Element.prototype.defaults)}),joint.shapes.bpmn.Flow=joint.dia.Link.extend({defaults:{type:"bpmn.Flow",attrs:{".marker-source":{d:"M 0 0"},".marker-target":{d:"M 10 0 L 0 5 L 10 10 z",fill:"#000000"},".connection":{"stroke-dasharray":" ","stroke-width":1},".connection-wrap":{style:"",onMouseOver:"",onMouseOut:""}},flowType:"normal"},initialize:function(){joint.dia.Link.prototype.initialize.apply(this,arguments),this.listenTo(this,"change:flowType",this.onFlowTypeChange),this.onFlowTypeChange(this,this.get("flowType"))},onFlowTypeChange:function(e,t){var n;switch(t){case"default":n={".marker-source":{d:"M 0 5 L 20 5 M 20 0 L 10 10",fill:"none"}};break;case"conditional":n={".marker-source":{d:"M 20 8 L 10 0 L 0 8 L 10 16 z",fill:"#FFF"}};break;case"normal":n={};break;case"message":n={".marker-target":{fill:"#FFF"},".connection":{"stroke-dasharray":"4,4"}};break;case"association":n={".marker-target":{d:"M 0 0"},".connection":{"stroke-dasharray":"4,4"}};break;case"conversation":n={".marker-target":{d:"M 0 0"},".connection":{"stroke-width":"7px"},".connection-wrap":{style:"stroke: #fff; stroke-width: 5px; opacity: 1;",onMouseOver:"var s=this.style;s.stroke='#000';s.strokeWidth=15;s.opacity=.4",onMouseOut:"var s=this.style;s.stroke='#fff';s.strokeWidth=5;s.opacity=1"}};break;default:throw"BPMN: Unknown Flow Type: "+t}e.attr(_.merge({},this.defaults.attrs,n))}}),joint.dia.CommandManager=Backbone.Model.extend({defaults:{cmdBeforeAdd:null,cmdNameRegex:/^(?:add|remove|change:\w+)$/},PREFIX_LENGTH:7,initialize:function(e){_.bindAll(this,"initBatchCommand","storeBatchCommand"),this.graph=e.graph,this.reset(),this.listen()},listen:function(){this.listenTo(this.graph,"all",this.addCommand,this),this.listenTo(this.graph,"batch:start",this.initBatchCommand,this),this.listenTo(this.graph,"batch:stop",this.storeBatchCommand,this)},createCommand:function(e){var t={action:void 0,data:{id:void 0,type:void 0,previous:{},next:{}},batch:e&&e.batch};return t},addCommand:function(e,t,n,r){if(this.get("cmdNameRegex").test(e)&&("function"!=typeof this.get("cmdBeforeAdd")||this.get("cmdBeforeAdd").apply(this,arguments))){var i=_.bind(function(e){this.redoStack=[],e.batch?(this.lastCmdIndex=Math.max(this.lastCmdIndex,0),this.trigger("batch",e)):(this.undoStack.push(e),this.trigger("add",e))},this),s=void 0;if(this.batchCommand?(s=this.batchCommand[Math.max(this.lastCmdIndex,0)],this.lastCmdIndex>=0&&(s.data.id!==t.id||s.action!==e)&&(s=_.find(this.batchCommand,function(n,r){return this.lastCmdIndex=r,n.data.id===t.id&&n.action===e},this),s||(this.lastCmdIndex=this.batchCommand.push(this.createCommand({batch:!0}))-1,s=_.last(this.batchCommand)))):(s=this.createCommand(),s.batch=!1),"add"===e||"remove"===e)return s.action=e,s.data.id=t.id,s.data.type=t.attributes.type,s.data.attributes=_.merge({},t.toJSON()),s.options=r||{},i(s);var o=e.substr(this.PREFIX_LENGTH);return s.batch&&s.action||(s.action=e,s.data.id=t.id,s.data.type=t.attributes.type,s.data.previous[o]=_.clone(t.previous(o)),s.options=r||{}),s.data.next[o]=_.clone(t.get(o)),i(s)}},initBatchCommand:function(){this.batchCommand?this.batchLevel++:(this.batchCommand=[this.createCommand({batch:!0})],this.lastCmdIndex=-1,this.batchLevel=0)},storeBatchCommand:function(){this.batchCommand&&this.batchLevel<=0?(this.lastCmdIndex>=0&&(this.redoStack=[],this.undoStack.push(this.batchCommand),this.trigger("add",this.batchCommand)),delete this.batchCommand,delete this.lastCmdIndex,delete this.batchLevel):this.batchCommand&&this.batchLevel>0&&this.batchLevel--},revertCommand:function(e){this.stopListening();var t;t=_.isArray(e)?e:[e];for(var n=t.length-1;n>=0;n--){var r=t[n],i=this.graph.getCell(r.data.id);switch(r.action){case"add":i.remove();break;case"remove":this.graph.addCell(r.data.attributes);break;default:var s=r.action.substr(this.PREFIX_LENGTH);i.set(s,r.data.previous[s])}}this.listen()},applyCommand:function(e){this.stopListening();var t;t=_.isArray(e)?e:[e];for(var n=0;n<t.length;n++){var r=t[n],i=this.graph.getCell(r.data.id);switch(r.action){case"add":this.graph.addCell(r.data.attributes);break;case"remove":i.remove();break;default:var s=r.action.substr(this.PREFIX_LENGTH);i.set(s,r.data.next[s])}}this.listen()},undo:function(){var e=this.undoStack.pop();e&&(this.revertCommand(e),this.redoStack.push(e))},redo:function(){var e=this.redoStack.pop();e&&(this.applyCommand(e),this.undoStack.push(e))},cancel:function(){this.hasUndo()&&(this.revertCommand(this.undoStack.pop()),this.redoStack=[])},reset:function(){this.undoStack=[],this.redoStack=[]},hasUndo:function(){return this.undoStack.length>0},hasRedo:function(){return this.redoStack.length>0}}),joint.dia.Validator=Backbone.Model.extend({initialize:function(e){this._map={},this._commandManager=e.commandManager,this.listenTo(this._commandManager,"add",this._onCommand)},defaults:{cancelInvalid:!0},_onCommand:function(e){return _.isArray(e)?_.find(e,function(e){return!this._validateCommand(e)},this):this._validateCommand(e)},_validateCommand:function(e){if(e.options&&e.options.validation===!1)return!0;var t;return _.each(this._map[e.action],function(n){function r(s){var o=n[i++];try{if(!o)return t=s,void 0;o(s,e,r)}catch(s){r(s)}}var i=0;r(t)}),t?(this.get("cancelInvalid")&&this._commandManager.cancel(),this.trigger("invalid",t),!1):!0},validate:function(e){var t=_.rest(arguments);return _.each(t,function(t){if(!_.isFunction(t))throw new Error(e+" requires callback functions.")}),_.each(e.split(" "),function(e){(this._map[e]=this._map[e]||[]).push(t)},this),this}}),function(){function e(e,n,r){if(_.isUndefined(r))return t.call(this,e,n);r.direction=r.direction||"bottom-right";var i=g.normalizeAngle(this.get("angle")||0),s={"top-right":0,"top-left":1,"bottom-left":2,"bottom-right":3}[r.direction];r.absolute&&(s+=Math.floor((i+45)/90),s%=4);var o=this.getBBox(),u=o[["bottomLeft","corner","topRight","origin"][s]](),a=g.point(u).rotate(o.center(),-i),f=Math.sqrt(e*e+n*n)/2,l=s*Math.PI/2;l+=Math.atan(s%2==0?n/e:e/n),l-=g.toRad(i);var c=g.point.fromPolar(f,l,a),h=g.point(c).offset(e/-2,n/-2);this.resize(e,n).position(h.x,h.y)}var t=joint.dia.Element.prototype.resize;joint.dia.Element.prototype.resize=e}(),joint.dia.Graph.prototype.constructTree=function(e,t,n,r){r=r||[];var i=_.isFunction(t.children)?t.children(e):e[t.children||"children"];return n||(n=t.makeElement(e),r.push(n)),_.each(i,function(e){var i=t.makeElement(e),s=t.makeLink(n,i);r.push(i,s),this.constructTree(e,t,i,r)},this),r},joint.ui.PaperScroller=Backbone.View.extend({className:"paper-scroller",events:{mousedown:"pointerdown",mousemove:"pointermove",touchmove:"pointermove",mouseout:"stopPanning"},options:{paper:void 0,padding:0,autoResizePaper:!1},initialize:function(e){_.bindAll(this,"startPanning","stopPanning"),this.options=_.extend({},_.result(this,"options"),e||{});var t=this.options.paper,n=V(t.viewport).scale();this._sx=n.sx,this._sy=n.sy,this._baseWidth=t.options.width,this._baseHeight=t.options.height,this.$el.append(t.el),this.addPadding(),this.listenTo(t,"scale",this.onScale),this.listenTo(t,"resize",this.onResize),this.options.autoResizePaper&&this.listenTo(t.model,"change add remove reset",this.adjustPaper),$(document.body).on("mouseup.stopPanning touchend.stopPanning",this.stopPanning)},onResize:function(){this._center&&this.center(this._center.x,this._center.y)},onScale:function(e,t,n,r){this._sx=e,this._sy=t,this.adjustPaper(),(n||r)&&this.center(n,r)},toLocalPoint:function(e,t){var n=this.options.paper.viewport.getCTM();return e+=this.el.scrollLeft-this.padding.paddingLeft-n.e,e/=n.a,t+=this.el.scrollTop-this.padding.paddingTop-n.f,t/=n.d,g.point(e,t)},adjustPaper:function(){return this._center=this.toLocalPoint(this.el.clientWidth/2,this.el.clientHeight/2),this.options.paper.fitToContent({gridWidth:this._baseWidth*this._sx,gridHeight:this._baseHeight*this._sy,allowNewOrigin:"negative"}),this},center:function(e,t){var n=this.options.paper.viewport.getCTM(),r=-n.e,i=-n.f,s=r+this.options.paper.options.width,o=i+this.options.paper.options.height;_.isUndefined(e)||_.isUndefined(t)?(e=(r+s)/2,t=(i+o)/2):(e*=n.a,t*=n.d);var u=this.options.padding,a=this.el.clientWidth/2,f=this.el.clientHeight/2,l=a-u-e+r,c=a-u+e-s,h=f-u-t+i,p=f-u+t-o;return this.addPadding(Math.max(l,0),Math.max(c,0),Math.max(h,0),Math.max(p,0)),this.el.scrollLeft=e-a+n.e+this.padding.paddingLeft,this.el.scrollTop=t-f+n.f+this.padding.paddingTop,this},centerContent:function(){var e=V(this.options.paper.viewport).bbox(!0,this.options.paper.svg);return this.center(e.x+e.width/2,e.y+e.height/2),this},addPadding:function(e,t,n,r){var i=this.options.padding,s=this.padding={paddingLeft:Math.round(i+(e||0)),paddingTop:Math.round(i+(n||0))},o={marginBottom:Math.round(i+(r||0)),marginRight:Math.round(i+(t||0))};return s.paddingLeft=Math.min(s.paddingLeft,.9*this.el.clientWidth),s.paddingTop=Math.min(s.paddingTop,.9*this.el.clientHeight),this.$el.css(s),this.options.paper.$el.css(o),this},zoom:function(e,t){t=t||{};var n,r,i=this.toLocalPoint(this.el.clientWidth/2,this.el.clientHeight/2),s=e,o=e;if(t.absolute||(s+=this._sx,o+=this._sy),t.grid&&(s=Math.round(s/t.grid)*t.grid,o=Math.round(o/t.grid)*t.grid),t.max&&(s=Math.min(t.max,s),o=Math.min(t.max,o)),t.min&&(s=Math.max(t.min,s),o=Math.max(t.min,o)),_.isUndefined(t.ox)||_.isUndefined(t.oy))n=i.x,r=i.y;else{var u=s/this._sx,a=o/this._sy;n=t.ox-(t.ox-i.x)/u,r=t.oy-(t.oy-i.y)/a}return this.options.paper.scale(s,o),this.center(n,r),this},zoomToFit:function(e){e=e||{};var t=this.options.paper,n=_.clone(t.options.origin);return e.fittingBBox=e.fittingBBox||_.extend({},g.point(n),{width:this.$el.width()+this.padding.paddingLeft,height:this.$el.height()+this.padding.paddingTop}),t.scaleContentToFit(e),t.setOrigin(n.x,n.y),this.adjustPaper().centerContent(),this},startPanning:function(e){e=joint.util.normalizeEvent(e),this._panning=!0,this._clientX=e.clientX,this._clientY=e.clientY},pan:function(e){if(this._panning){e=joint.util.normalizeEvent(e);var t=e.clientX-this._clientX,n=e.clientY-this._clientY;this.el.scrollTop-=n,this.el.scrollLeft-=t,this._clientX=e.clientX,this._clientY=e.clientY}},stopPanning:function(){delete this._panning},pointerdown:function(e){e.target==this.el&&this.options.paper.pointerdown.apply(this.options.paper,arguments)},pointermove:function(e){this.pan.apply(this,arguments),e.target==this.el&&this.options.paper.pointermove.apply(this.options.paper,arguments)},remove:function(){Backbone.View.prototype.remove.apply(this,arguments),$(document.body).off(".stopPanning",this.stopPanning)}}),joint.ui.SelectionView=Backbone.View.extend({options:{paper:void 0,graph:void 0,selectionLabel:"elements selected",boxContent:function(){var e=_.template("<%= length %> "+this.selectionLabel);return e({length:this.model.length})},handles:[{name:"remove",position:"nw",events:{pointerdown:"removeElements"}},{name:"rotate",position:"sw",events:{pointerdown:"startRotating",pointermove:"doRotate",pointerup:"stopBatch"}}]},className:"selection",events:{"mousedown .selection-box":"startTranslatingSelection","touchstart .selection-box":"startTranslatingSelection","mousedown .handle":"onHandlePointerDown","touchstart .handle":"onHandlePointerDown"},initialize:function(e){this.options=_.extend({},_.result(this,"options"),e||{}),_.bindAll(this,"startSelecting","stopSelecting","adjustSelection","pointerup"),$(document.body).on("mousemove.selectionView touchmove.selectionView",this.adjustSelection),$(document).on("mouseup.selectionView touchend.selectionView",this.pointerup),this.listenTo(this.options.graph,"reset",this.cancelSelection),this.listenTo(this.options.paper,"scale translate",this.updateSelectionBoxes),this.listenTo(this.options.graph,"remove change",function(e,t){t["selectionView_"+this.cid]||this.updateSelectionBoxes()}),this.options.paper.$el.append(this.$el),this._boxCount=0,this.createSelectionWrapper(),this.handles=[],_.each(this.options.handles,this.addHandle,this)},addHandle:function(e){this.handles.push(e);var t=$("<div/>",{"class":"handle "+(e.position||"")+" "+(e.name||""),draggable:"false","data-action":e.name});return e.icon&&t.css("background-image","url("+e.icon+")"),t.html(e.content||""),this.$(".selection-wrapper").append(t),_.each(e.events,function(t,n){_.isString(t)?this.on("action:"+e.name+":"+n,this[t],this):this.on("action:"+e.name+":"+n,t)},this),this},removeHandle:function(e){var t=_.findIndex(this.handles,{name:e}),n=this.handles[t];return n&&(_.each(n.events,function(t,n){this.off("action:"+e+":"+n)},this),this.$(".handle."+e).remove(),this.handles.splice(t,1)),this},changeHandle:function(e,t){var n=_.findWhere(this.handles,{name:e});return n&&(this.removeHandle(e),this.addHandle(_.merge({name:e},n,t))),this},startTranslatingSelection:function(e){e.stopPropagation(),e=joint.util.normalizeEvent(e),this._action="translating",this.options.graph.trigger("batch:start");var t=this.options.paper.snapToGrid(g.point(e.clientX,e.clientY));this._snappedClientX=t.x,this._snappedClientY=t.y,this.trigger("selection-box:pointerdown",e)},startSelecting:function(e){e=joint.util.normalizeEvent(e),this.cancelSelection(),this._action="selecting",this._clientX=e.clientX,this._clientY=e.clientY;var t=e.target.parentElement||e.target.parentNode,n=$(t).offset(),r=t.scrollLeft,i=t.scrollTop;this._offsetX=void 0===e.offsetX?e.clientX-n.left+window.pageXOffset+r:e.offsetX,this._offsetY=void 0===e.offsetY?e.clientY-n.top+window.pageYOffset+i:e.offsetY,this.$el.css({width:1,height:1,left:this._offsetX,top:this._offsetY}).show()},adjustSelection:function(e){e=joint.util.normalizeEvent(e);var t,n;switch(this._action){case"selecting":t=e.clientX-this._clientX,n=e.clientY-this._clientY;var r=(this.$el.width(),this.$el.height(),parseInt(this.$el.css("left"),10)),i=parseInt(this.$el.css("top"),10);this.$el.css({left:0>t?this._offsetX+t:r,top:0>n?this._offsetY+n:i,width:Math.abs(t),height:Math.abs(n)});break;case"translating":var s=this.options.paper.snapToGrid(g.point(e.clientX,e.clientY)),o=s.x,u=s.y;t=o-this._snappedClientX,n=u-this._snappedClientY;var a={};if(this.model.each(function(e){var r={};r["selectionView_"+this.cid]=!0,e.translate(t,n,r);var i=this.options.graph.getConnectedLinks(e);_.each(i,function(e){a[e.id]||(e.translate(t,n,r),a[e.id]=!0)})},this),t||n){var f=V(this.options.paper.viewport).scale();t*=f.sx,n*=f.sy,this.$(".selection-box").each(function(){var e=parseFloat($(this).css("left"),10),r=parseFloat($(this).css("top"),10);$(this).css({left:e+t,top:r+n})});var l=this.$(".selection-wrapper");if(l.length){var r=parseFloat(l.css("left"),10),i=parseFloat(l.css("top"),10);l.css({left:r+t,top:i+n})}this._snappedClientX=o,this._snappedClientY=u}this.trigger("selection-box:pointermove",e);break;default:this._action&&this.pointermove(e)}},stopSelecting:function(e){switch(this._action){case"selecting":var t=this.$el.offset(),n=this.$el.width(),r=this.$el.height(),i=V(this.options.paper.viewport).toLocalPoint(t.left,t.top);i.x-=window.pageXOffset,i.y-=window.pageYOffset;var s=V(this.options.paper.viewport).scale();n/=s.sx,r/=s.sy;var o=this.options.paper.findViewsInArea(g.rect(i.x,i.y,n,r));this.model.reset(_.pluck(o,"model")),o.length?(_.each(o,this.createSelectionBox,this),this.$el.addClass("selected")):this.$el.hide();break;case"translating":this.options.graph.trigger("batch:stop"),this.trigger("selection-box:pointerup",e);break;default:this._action||this.cancelSelection()}delete this._action},pointerup:function(e){this._action&&(this.triggerAction(this._action,"pointerup",e),this.stopSelecting(),delete this._action)},cancelSelection:function(){this.$el.hide(),this.$(".selection-box").remove(),this.$el.removeClass("selected"),this.model.reset([]),this._boxCount=0,this.updateSelectionWrapper()},destroySelectionBox:function(e){this.$('[data-model="'+e.model.get("id")+'"]').remove(),0===this.$(".selection-box").length&&this.$el.hide().removeClass("selected"),this._boxCount=Math.max(0,this._boxCount-1),this.updateSelectionWrapper()},createSelectionBox:function(e){var t=e.getBBox(),n=$("<div/>",{"class":"selection-box","data-model":e.model.get("id")});n.css({left:t.x,top:t.y,width:t.width,height:t.height}),this.$el.append(n),this.$el.addClass("selected").show(),this._boxCount++,this.updateSelectionWrapper()},createSelectionWrapper:function(){var e=$("<div/>",{"class":"selection-wrapper"}),t=$("<div/>",{"class":"box"});e.append(t),e.attr("data-selection-length",this.model.length),this.$el.prepend(e)},updateSelectionWrapper:function(){var e={x:1/0,y:1/0},t={x:0,y:0};if(this.model.each(function(n){var r=this.options.paper.findViewByModel(n);if(r){var i=r.getBBox();e.x=Math.min(e.x,i.x),e.y=Math.min(e.y,i.y),t.x=Math.max(t.x,i.x+i.width),t.y=Math.max(t.y,i.y+i.height)}},this),this.$(".selection-wrapper").css({left:e.x,top:e.y,width:t.x-e.x,height:t.y-e.y}).attr("data-selection-length",this.model.length),_.isFunction(this.options.boxContent)){var n=this.$(".box"),r=this.options.boxContent.call(this,n[0]);r&&n.html(r)}},updateSelectionBoxes:function(){this._boxCount&&(this.$el.hide().removeClass("selected").find(".selection-box").each(_.bind(function(e,t){var n=$(t).remove().attr("data-model"),r=this.options.paper.findViewByModel(this.model.get(n));r&&this.createSelectionBox(r)},this)),this.updateSelectionWrapper())},remove:function(){Backbone.View.prototype.remove.apply(this,arguments),$(document.body).off(".selectionView")},onHandlePointerDown:function(e){this._action=$(e.target).closest(".handle").attr("data-action"),this._action&&(e.preventDefault(),e.stopPropagation(),e=joint.util.normalizeEvent(e),this._clientX=e.clientX,this._clientY=e.clientY,this._startClientX=this._clientX,this._startClientY=this._clientY,this.triggerAction(this._action,"pointerdown",e))},pointermove:function(e){if(this._action){var t=this.options.paper.snapToGrid({x:e.clientX,y:e.clientY}),n=this.options.paper.snapToGrid({x:this._clientX,y:this._clientY}),r=t.x-n.x,i=t.y-n.y;this.triggerAction(this._action,"pointermove",e,r,i,e.clientX-this._startClientX,e.clientY-this._startClientY),this._clientX=e.clientX,this._clientY=e.clientY}},triggerAction:function(e,t){var n=["action:"+e+":"+t].concat(_.rest(_.toArray(arguments),2));this.trigger.apply(this,n)},removeElements:function(){var e=this.model.models;this.cancelSelection(),this.options.graph.trigger("batch:start"),_.invoke(e,"remove"),this.options.graph.trigger("batch:stop")},startRotating:function(e){this.options.graph.trigger("batch:start");var t=this.options.graph.getBBox(this.model.models);if(this._center=t.center(),"undefined"==typeof e.offsetX||"undefined"==typeof e.offsetY){var n=$(e.target).offset();e.offsetX=e.pageX-n.left,e.offsetY=e.pageY-n.top}this._rotationStart=g.point(e.offsetX+e.target.parentNode.offsetLeft,e.offsetY+e.target.parentNode.offsetTop+e.target.parentNode.offsetHeight),this._rotationStartAngle={},this.model.each(function(e){this._rotationStartAngle[e.id]=e.get("angle")||0},this)},doRotate:function(e,t,n,r,i){var s=g.point(this._rotationStart).offset(r,i),o=s.distance(this._center),u=this._center.distance(this._rotationStart),a=this._rotationStart.distance(s),f=(this._center.x-this._rotationStart.x)*(s.y-this._rotationStart.y)-(this._center.y-this._rotationStart.y)*(s.x-this._rotationStart.x),l=Math.acos((o*o+u*u-a*a)/(2*o*u));0>=f&&(l=-l);var c=-g.toDeg(l);c=g.snapToGrid(c,15),this.model.each(function(e){e.rotate(c+this._rotationStartAngle[e.id],!0,this._center)},this)},stopBatch:function(){this.options.graph.trigger("batch:stop")}}),joint.ui.Clipboard=Backbone.Collection.extend({copyElements:function(e,t,n){n=n||{};var r=[],i=[],s={};e.each(function(o){var u=t.getConnectedLinks(o);r=r.concat(_.filter(u,function(t){return e.get(t.get("source").id)&&e.get(t.get("target").id)?!0:!1}));var l=o.clone();n.translate&&l.translate(n.translate.dx||20,n.translate.dy||20),i.push(l),s[o.get("id")]=l.get("id")});var o=_.unique(r);return r=_.map(o,function(e){var t=e.clone(),r=t.get("source"),i=t.get("target");return r.id=s[r.id],i.id=s[i.id],t.set({source:_.clone(r),target:_.clone(i)}),n.translate&&_.each(t.get("vertices"),function(e){e.x+=n.translate.dx||20,e.y+=n.translate.dy||20}),t}),this.reset(i.concat(r)),n.useLocalStorage&&window.localStorage&&localStorage.setItem("joint.ui.Clipboard.cells",JSON.stringify(this.toJSON())),(e.models||[]).concat(o)},pasteCells:function(e,t){t=t||{},t.useLocalStorage&&0===this.length&&window.localStorage&&this.reset(JSON.parse(localStorage.getItem("joint.ui.Clipboard.cells"))),e.trigger("batch:start"),this.each(function(n){n.unset("z"),n instanceof joint.dia.Link&&t.link&&n.set(t.link),e.addCell(n.toJSON())}),e.trigger("batch:stop")},clear:function(){this.reset([]),window.localStorage&&localStorage.removeItem("joint.ui.Clipboard.cells")}});var Handlebars={};!function(e,t){e.VERSION="1.0.0",e.COMPILER_REVISION=4,e.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"},e.helpers={},e.partials={};var n=Object.prototype.toString,r="[object Function]",i="[object Object]";e.registerHelper=function(t,r,s){if(n.call(t)===i){if(s||r)throw new e.Exception("Arg not supported with multiple helpers");e.Utils.extend(this.helpers,t)}else s&&(r.not=s),this.helpers[t]=r},e.registerPartial=function(t,r){n.call(t)===i?e.Utils.extend(this.partials,t):this.partials[t]=r},e.registerHelper("helperMissing",function(e){if(2===arguments.length)return t;throw new Error("Missing helper: '"+e+"'")}),e.registerHelper("blockHelperMissing",function(t,i){var s=i.inverse||function(){},o=i.fn,u=n.call(t);return u===r&&(t=t.call(this)),t===!0?o(this):t===!1||null==t?s(this):"[object Array]"===u?t.length>0?e.helpers.each(t,i):s(this):o(t)}),e.K=function(){},e.createFrame=Object.create||function(t){e.K.prototype=t;var n=new e.K;return e.K.prototype=null,n},e.logger={DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,methodMap:{0:"debug",1:"info",2:"warn",3:"error"},log:function(t,n){if(e.logger.level<=t){var r=e.logger.methodMap[t];"undefined"!=typeof console&&console[r]&&console[r].call(console,n)}}},e.log=function(t,n){e.logger.log(t,n)},e.registerHelper("each",function(t,i){var s,o=i.fn,u=i.inverse,a=0,f="",l=n.call(t);if(l===r&&(t=t.call(this)),i.data&&(s=e.createFrame(i.data)),t&&"object"==typeof t)if(t instanceof Array)for(var h=t.length;h>a;a++)s&&(s.index=a),f+=o(t[a],{data:s});else for(var p in t)t.hasOwnProperty(p)&&(s&&(s.key=p),f+=o(t[p],{data:s}),a++);return 0===a&&(f=u(this)),f}),e.registerHelper("if",function(t,i){var s=n.call(t);return s===r&&(t=t.call(this)),!t||e.Utils.isEmpty(t)?i.inverse(this):i.fn(this)}),e.registerHelper("unless",function(t,n){return e.helpers["if"].call(this,t,{fn:n.inverse,inverse:n.fn})}),e.registerHelper("with",function(t,i){var s=n.call(t);return s===r&&(t=t.call(this)),e.Utils.isEmpty(t)?void 0:i.fn(t)}),e.registerHelper("log",function(t,n){var r=n.data&&null!=n.data.level?parseInt(n.data.level,10):1;e.log(r,t)});var s=["description","fileName","lineNumber","message","name","number","stack"];e.Exception=function(){for(var e=Error.prototype.constructor.apply(this,arguments),t=0;t<s.length;t++)this[s[t]]=e[s[t]]},e.Exception.prototype=new Error,e.SafeString=function(e){this.string=e},e.SafeString.prototype.toString=function(){return this.string.toString()};var o={"&":"&","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},u=/[&<>"'`]/g,a=/[&<>"'`]/,f=function(e){return o[e]||"&"};e.Utils={extend:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},escapeExpression:function(t){return t instanceof e.SafeString?t.toString():null==t||t===!1?"":(t=t.toString(),a.test(t)?t.replace(u,f):t)},isEmpty:function(e){return e||0===e?"[object Array]"===n.call(e)&&0===e.length?!0:!1:!0}},e.VM={template:function(t){var n={escapeExpression:e.Utils.escapeExpression,invokePartial:e.VM.invokePartial,programs:[],program:function(t,n,r){var i=this.programs[t];return r?i=e.VM.program(t,n,r):i||(i=this.programs[t]=e.VM.program(t,n)),i},merge:function(t,n){var r=t||n;return t&&n&&(r={},e.Utils.extend(r,n),e.Utils.extend(r,t)),r},programWithDepth:e.VM.programWithDepth,noop:e.VM.noop,compilerInfo:null};return function(r,i){i=i||{};var s=t.call(n,e,r,i.helpers,i.partials,i.data),o=n.compilerInfo||[],u=o[0]||1,a=e.COMPILER_REVISION;if(u!==a){if(a>u){var f=e.REVISION_CHANGES[a],l=e.REVISION_CHANGES[u];throw"Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+f+") or downgrade your runtime to an older version ("+l+")."}throw"Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+o[1]+")."}return s}},programWithDepth:function(e,t,n){var r=Array.prototype.slice.call(arguments,3),i=function(e,i){return i=i||{},t.apply(this,[e,i.data||n].concat(r))};return i.program=e,i.depth=r.length,i},program:function(e,t,n){var r=function(e,r){return r=r||{},t(e,r.data||n)};return r.program=e,r.depth=0,r},noop:function(){return""},invokePartial:function(n,r,i,s,o,u){var a={helpers:s,partials:o,data:u};if(n===t)throw new e.Exception("The partial "+r+" could not be found");if(n instanceof Function)return n(i,a);if(e.compile)return o[r]=e.compile(n,{data:u!==t}),o[r](i,a);throw new e.Exception("The partial "+r+" could not be compiled when running in runtime-only mode")}},e.template=e.VM.template}(Handlebars),this.joint=this.joint||{},this.joint.templates=this.joint.templates||{},this.joint.templates.halo=this.joint.templates.halo||{},this.joint.templates.halo["box.html"]=Handlebars.template(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<label class="box"></label>\n'}),this.joint.templates.halo["handle.html"]=Handlebars.template(function(e,t,n,r,i){function s(e){var t="";return t+='style="background-image: url('+l(typeof e===f?e.apply(e):e)+')"'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var o,u,a="",f="function",l=this.escapeExpression,c=this,h=n.blockHelperMissing;return a+='<div class="handle ',(o=n.position)?o=o.call(t,{hash:{},data:i}):(o=t.position,o=typeof o===f?o.apply(t):o),a+=l(o)+" ",(o=n.name)?o=o.call(t,{hash:{},data:i}):(o=t.name,o=typeof o===f?o.apply(t):o),a+=l(o)+'" draggable="false" data-action="',(o=n.name)?o=o.call(t,{hash:{},data:i}):(o=t.name,o=typeof o===f?o.apply(t):o),a+=l(o)+'" ',u={hash:{},inverse:c.noop,fn:c.program(1,s,i),data:i},(o=n.icon)?o=o.call(t,u):(o=t.icon,o=typeof o===f?o.apply(t):o),n.icon||(o=h.call(t,o,u)),(o||0===o)&&(a+=o),a+=">\n    ",(o=n.content)?o=o.call(t,{hash:{},data:i}):(o=t.content,o=typeof o===f?o.apply(t):o),(o||0===o)&&(a+=o),a+="\n</div>\n\n"}),joint.ui.Halo=Backbone.View.extend({className:"halo",events:{"mousedown .handle":"onHandlePointerDown","touchstart .handle":"onHandlePointerDown"},options:{tinyTreshold:40,smallTreshold:80,loopLinkPreferredSide:"top",loopLinkWidth:40,rotateAngleGrid:15,useModelGeometry:!1,boxContent:function(e){var t=_.template("x: <%= x %>, y: <%= y %>, width: <%= width %>, height: <%= height %>, angle: <%= angle %>"),n=e.model.getBBox();return t({x:Math.floor(n.x),y:Math.floor(n.y),width:n.width,height:n.height,angle:Math.floor(e.model.get("angle")||0)})},linkAttributes:{},smoothLinks:void 0,handles:[{name:"resize",position:"se",events:{pointerdown:"startResizing",pointermove:"doResize",pointerup:"stopBatch"}},{name:"remove",position:"nw",events:{pointerdown:"removeElement"}},{name:"clone",position:"n",events:{pointerdown:"startCloning",pointermove:"doClone",pointerup:"stopBatch"}},{name:"link",position:"e",events:{pointerdown:"startLinking",pointermove:"doLink",pointerup:"stopLinking"}},{name:"fork",position:"ne",events:{pointerdown:"startForking",pointermove:"doFork",pointerup:"stopBatch"}},{name:"unlink",position:"w",events:{pointerdown:"unlinkElement"}},{name:"rotate",position:"sw",events:{pointerdown:"startRotating",pointermove:"doRotate",pointerup:"stopBatch"}}]},initialize:function(e){this.options=_.extend({},_.result(this,"options"),e||{}),_.defaults(this.options,{paper:this.options.cellView.paper,graph:this.options.cellView.paper.model}),_.bindAll(this,"pointermove","pointerup","render","update","remove"),joint.ui.Halo.clear(this.options.paper),this.handles=[],_.each(this.options.handles,this.addHandle,this),this.listenTo(this.options.graph,"reset",this.remove),this.listenTo(this.options.graph,"all",this.update),this.listenTo(this.options.paper,"blank:pointerdown halo:create",this.remove),this.listenTo(this.options.paper,"scale translate",this.update),$(document.body).on("mousemove touchmove",this.pointermove),$(document).on("mouseup touchend",this.pointerup),this.options.paper.$el.append(this.$el)},render:function(){return this.options.cellView.model.on("remove",this.remove),this.$el.append(joint.templates.halo["box.html"]()),this.renderMagnets(),this.update(),this.$el.addClass("animate"),this.$el.attr("data-type",this.options.cellView.model.get("type")),this.toggleFork(),this},update:function(){if(!(this.options.cellView.model instanceof joint.dia.Link)){if(_.isFunction(this.options.boxContent)){var e=this.$(".box"),t=this.options.boxContent.call(this,this.options.cellView,e[0]);t&&e.html(t)}var n;if(this.options.useModelGeometry){var r=this.options.cellView.model.get("angle"),i=this.options.paper.viewport.getCTM();n=this.options.cellView.model.getBBox().bbox(r),n.x=n.x*i.a+i.e,n.y=n.y*i.d+i.f,n.width*=i.a,n.height*=i.d}else n=this.options.cellView.getBBox();this.$el.toggleClass("tiny",n.width<this.options.tinyTreshold&&n.height<this.options.tinyTreshold),this.$el.toggleClass("small",!this.$el.hasClass("tiny")&&n.width<this.options.smallTreshold&&n.height<this.options.smallTreshold),this.$el.css({width:n.width,height:n.height,left:n.x,top:n.y}).show(),this.updateMagnets(),this.toggleUnlink()}},addHandle:function(e){return this.handles.push(e),this.$el.append(joint.templates.halo["handle.html"](e)),_.each(e.events,function(t,n){_.isString(t)?this.on("action:"+e.name+":"+n,this[t],this):this.on("action:"+e.name+":"+n,t)},this),this},removeHandle:function(e){var t=_.findIndex(this.handles,{name:e}),n=this.handles[t];return n&&(_.each(n.events,function(t,n){this.off("action:"+e+":"+n)},this),this.$(".handle."+e).remove(),this.handles.splice(t,1)),this},changeHandle:function(e,t){var n=_.findWhere(this.handles,{name:e});return n&&(this.removeHandle(e),this.addHandle(_.merge({name:e},n,t))),this},onHandlePointerDown:function(e){this._action=$(e.target).closest(".handle").attr("data-action"),this._action&&(e.preventDefault(),e.stopPropagation(),e=joint.util.normalizeEvent(e),this._clientX=e.clientX,this._clientY=e.clientY,this._startClientX=this._clientX,this._startClientY=this._clientY,this.triggerAction(this._action,"pointerdown",e))},triggerAction:function(e,t){var n=["action:"+e+":"+t].concat(_.rest(_.toArray(arguments),2));this.trigger.apply(this,n)},startCloning:function(){this.options.graph.trigger("batch:start"),this._clone=this.options.cellView.model.clone(),this._clone.unset("z"),this.options.graph.addCell(this._clone,{halo:this.cid})},startLinking:function(e){this.options.graph.trigger("batch:start");var t=this.options.cellView,n=$.data(e.target,"selector"),r=this.options.paper.getDefaultLink(t,n&&t.el.querySelector(n));r.set("source",{id:t.model.id,selector:n}),r.set("target",{x:e.clientX,y:e.clientY}),r.attr(this.options.linkAttributes),_.isBoolean(this.options.smoothLinks)&&r.set("smooth",this.options.smoothLinks),this.options.graph.addCell(r,{validation:!1,halo:this.cid}),r.set("target",this.options.paper.snapToGrid({x:e.clientX,y:e.clientY})),this._linkView=this.options.paper.findViewByModel(r),this._linkView.startArrowheadMove("target")},startForking:function(){this.options.graph.trigger("batch:start"),this._clone=this.options.cellView.model.clone(),this._clone.unset("z"),this.options.graph.addCell(this._clone,{halo:this.cid});var e=this.options.paper.getDefaultLink(this.options.cellView);e.set("source",{id:this.options.cellView.model.id}),e.set("target",{id:this._clone.id}),e.attr(this.options.linkAttributes),_.isBoolean(this.options.smoothLinks)&&e.set("smooth",this.options.smoothLinks),this.options.graph.addCell(e,{halo:this.cid})},startResizing:function(){this.options.graph.trigger("batch:start"),this._flip=[1,0,0,1,1,0,0,1][Math.floor(g.normalizeAngle(this.options.cellView.model.get("angle"))/45)]},startRotating:function(e){this.options.graph.trigger("batch:start");var t=this.options.cellView.getBBox();if(this._center=g.rect(t).center(),"undefined"==typeof e.offsetX||"undefined"==typeof e.offsetY){var n=$(e.target).offset();e.offsetX=e.pageX-n.left,e.offsetY=e.pageY-n.top}this._rotationStart=g.point(e.offsetX+e.target.parentNode.offsetLeft,e.offsetY+e.target.parentNode.offsetTop+e.target.parentNode.offsetHeight);var r=this.options.cellView.model.get("angle");this._rotationStartAngle=r||0},doResize:function(e,t,n){var r=this.options.cellView.model.get("size"),i=Math.max(r.width+(this._flip?t:n),1),s=Math.max(r.height+(this._flip?n:t),1);this.options.cellView.model.resize(i,s,{absolute:!0})},doRotate:function(e,t,n,r,i){var s=g.point(this._rotationStart).offset(r,i),o=s.distance(this._center),u=this._center.distance(this._rotationStart),a=this._rotationStart.distance(s),f=(this._center.x-this._rotationStart.x)*(s.y-this._rotationStart.y)-(this._center.y-this._rotationStart.y)*(s.x-this._rotationStart.x),l=Math.acos((o*o+u*u-a*a)/(2*o*u));0>=f&&(l=-l);var c=-g.toDeg(l);c=g.snapToGrid(c,this.options.rotateAngleGrid),this.options.cellView.model.rotate(c+this._rotationStartAngle,!0)},doClone:function(e,t,n){this._clone.translate(t,n)},doFork:function(e,t,n){this._clone.translate(t,n)},doLink:function(e){var t=this.options.paper.snapToGrid({x:e.clientX,y:e.clientY});this._linkView.pointermove(e,t.x,t.y)},stopLinking:function(e){this._linkView.pointerup(e);var t=this._linkView.model.get("source").id,n=this._linkView.model.get("target").id;t&&n&&t===n&&this.makeLoopLink(this._linkView.model),this.stopBatch(),delete this._linkView},pointermove:function(e){if(this._action){e.preventDefault(),e.stopPropagation(),e=joint.util.normalizeEvent(e);var t=this.options.paper.snapToGrid({x:e.clientX,y:e.clientY}),n=this.options.paper.snapToGrid({x:this._clientX,y:this._clientY}),r=t.x-n.x,i=t.y-n.y;this.triggerAction(this._action,"pointermove",e,r,i,e.clientX-this._startClientX,e.clientY-this._startClientY),this._clientX=e.clientX,this._clientY=e.clientY}},pointerup:function(e){this._action&&(this.triggerAction(this._action,"pointerup",e),delete this._action)},stopBatch:function(){this.options.graph.trigger("batch:stop")},remove:function(){Backbone.View.prototype.remove.apply(this,arguments),$(document.body).off("mousemove touchmove",this.pointermove),$(document).off("mouseup touchend",this.pointerup)},removeElement:function(){this.options.cellView.model.remove()},unlinkElement:function(){this.options.graph.removeLinks(this.options.cellView.model)},toggleUnlink:function(){this.options.graph.getConnectedLinks(this.options.cellView.model).length>0?this.$(".unlink").show():this.$(".unlink").hide()},toggleFork:function(){var e=this.options.cellView.model.clone(),t=this.options.paper.createViewForModel(e);this.options.paper.options.validateConnection(this.options.cellView,null,t,null,"target")||this.$(".fork").hide(),t.remove(),e=null},makeLoopLink:function(e){var t,n,r=this.options.loopLinkWidth,i=this.options.paper.options,s=g.rect({x:0,y:0,width:i.width,height:i.height}),o=V(this.options.cellView.el).bbox(!1,this.options.paper.viewport),u=_.uniq([this.options.loopLinkPreferredSide,"top","bottom","left","right"]),a=_.find(u,function(e){var i,u=0,a=0;switch(e){case"top":i=g.point(o.x+o.width/2,o.y-r),u=r/2;break;case"bottom":i=g.point(o.x+o.width/2,o.y+o.height+r),u=r/2;break;case"left":i=g.point(o.x-r,o.y+o.height/2),a=r/2;break;case"right":i=g.point(o.x+o.width+r,o.y+o.height/2),a=r/2}return t=g.point(i).offset(-u,-a),n=g.point(i).offset(u,a),s.containsPoint(t)&&s.containsPoint(n)},this);a&&e.set("vertices",[t,n])},renderMagnets:function(){this._magnets=[];var e=this.$(".link"),t=this.options.cellView.$('[magnet="true"]');if(this.options.magnetFilter&&(t=_.isFunction(this.options.magnetFilter)?_.filter(t,this.options.magnetFilter):t.filter(this.options.magnetFilter)),e.length&&t.length){var n=e.width(),r=e.height();_.each(t,function(t){var i=t.getBoundingClientRect(),s=e.clone().addClass("halo-magnet").css({width:Math.min(i.width,n),height:Math.min(i.height,r),"background-size":"contain"}).data("selector",this.options.cellView.getSelector(t)).appendTo(this.$el);this._magnets.push({$halo:s,el:t})},this)}"false"==this.options.cellView.$el.attr("magnet")&&(e.hide(),this.$(".fork").hide())},updateMagnets:function(){if(this._magnets.length){var e=this.el.getBoundingClientRect();_.each(this._magnets,function(t){var n=t.el.getBoundingClientRect();t.$halo.css({left:n.left-e.left+(n.width-t.$halo.width())/2,top:n.top-e.top+(n.height-t.$halo.height())/2})},this)}}},{clear:function(e){e.trigger("halo:create")}});var Handlebars={};!function(e,t){e.VERSION="1.0.0",e.COMPILER_REVISION=4,e.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"},e.helpers={},e.partials={};var n=Object.prototype.toString,r="[object Function]",i="[object Object]";e.registerHelper=function(t,r,s){if(n.call(t)===i){if(s||r)throw new e.Exception("Arg not supported with multiple helpers");e.Utils.extend(this.helpers,t)}else s&&(r.not=s),this.helpers[t]=r},e.registerPartial=function(t,r){n.call(t)===i?e.Utils.extend(this.partials,t):this.partials[t]=r},e.registerHelper("helperMissing",function(e){if(2===arguments.length)return t;throw new Error("Missing helper: '"+e+"'")}),e.registerHelper("blockHelperMissing",function(t,i){var s=i.inverse||function(){},o=i.fn,u=n.call(t);return u===r&&(t=t.call(this)),t===!0?o(this):t===!1||null==t?s(this):"[object Array]"===u?t.length>0?e.helpers.each(t,i):s(this):o(t)}),e.K=function(){},e.createFrame=Object.create||function(t){e.K.prototype=t;var n=new e.K;return e.K.prototype=null,n},e.logger={DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,methodMap:{0:"debug",1:"info",2:"warn",3:"error"},log:function(t,n){if(e.logger.level<=t){var r=e.logger.methodMap[t];"undefined"!=typeof console&&console[r]&&console[r].call(console,n)}}},e.log=function(t,n){e.logger.log(t,n)},e.registerHelper("each",function(t,i){var s,o=i.fn,u=i.inverse,a=0,f="",l=n.call(t);if(l===r&&(t=t.call(this)),i.data&&(s=e.createFrame(i.data)),t&&"object"==typeof t)if(t instanceof Array)for(var h=t.length;h>a;a++)s&&(s.index=a),f+=o(t[a],{data:s});else for(var p in t)t.hasOwnProperty(p)&&(s&&(s.key=p),f+=o(t[p],{data:s}),a++);return 0===a&&(f=u(this)),f}),e.registerHelper("if",function(t,i){var s=n.call(t);return s===r&&(t=t.call(this)),!t||e.Utils.isEmpty(t)?i.inverse(this):i.fn(this)}),e.registerHelper("unless",function(t,n){return e.helpers["if"].call(this,t,{fn:n.inverse,inverse:n.fn})}),e.registerHelper("with",function(t,i){var s=n.call(t);return s===r&&(t=t.call(this)),e.Utils.isEmpty(t)?void 0:i.fn(t)}),e.registerHelper("log",function(t,n){var r=n.data&&null!=n.data.level?parseInt(n.data.level,10):1;e.log(r,t)});var s=["description","fileName","lineNumber","message","name","number","stack"];e.Exception=function(){for(var e=Error.prototype.constructor.apply(this,arguments),t=0;t<s.length;t++)this[s[t]]=e[s[t]]},e.Exception.prototype=new Error,e.SafeString=function(e){this.string=e},e.SafeString.prototype.toString=function(){return this.string.toString()};var o={"&":"&","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},u=/[&<>"'`]/g,a=/[&<>"'`]/,f=function(e){return o[e]||"&"};e.Utils={extend:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},escapeExpression:function(t){return t instanceof e.SafeString?t.toString():null==t||t===!1?"":(t=t.toString(),a.test(t)?t.replace(u,f):t)},isEmpty:function(e){return e||0===e?"[object Array]"===n.call(e)&&0===e.length?!0:!1:!0}},e.VM={template:function(t){var n={escapeExpression:e.Utils.escapeExpression,invokePartial:e.VM.invokePartial,programs:[],program:function(t,n,r){var i=this.programs[t];return r?i=e.VM.program(t,n,r):i||(i=this.programs[t]=e.VM.program(t,n)),i},merge:function(t,n){var r=t||n;return t&&n&&(r={},e.Utils.extend(r,n),e.Utils.extend(r,t)),r},programWithDepth:e.VM.programWithDepth,noop:e.VM.noop,compilerInfo:null};return function(r,i){i=i||{};var s=t.call(n,e,r,i.helpers,i.partials,i.data),o=n.compilerInfo||[],u=o[0]||1,a=e.COMPILER_REVISION;if(u!==a){if(a>u){var f=e.REVISION_CHANGES[a],l=e.REVISION_CHANGES[u];throw"Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+f+") or downgrade your runtime to an older version ("+l+")."}throw"Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+o[1]+")."}return s}},programWithDepth:function(e,t,n){var r=Array.prototype.slice.call(arguments,3),i=function(e,i){return i=i||{},t.apply(this,[e,i.data||n].concat(r))};return i.program=e,i.depth=r.length,i},program:function(e,t,n){var r=function(e,r){return r=r||{},t(e,r.data||n)};return r.program=e,r.depth=0,r},noop:function(){return""},invokePartial:function(n,r,i,s,o,u){var a={helpers:s,partials:o,data:u};if(n===t)throw new e.Exception("The partial "+r+" could not be found");if(n instanceof Function)return n(i,a);if(e.compile)return o[r]=e.compile(n,{data:u!==t}),o[r](i,a);throw new e.Exception("The partial "+r+" could not be compiled when running in runtime-only mode")}},e.template=e.VM.template}(Handlebars),this.joint=this.joint||{},this.joint.templates=this.joint.templates||{},this.joint.templates.stencil=this.joint.templates.stencil||{},this.joint.templates.stencil["elements.html"]=Handlebars.template(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<div class="elements"></div>\n'}),this.joint.templates.stencil["group.html"]=Handlebars.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="",u="function",a=this.escapeExpression;return o+='<div class="group">\n    <h3 class="group-label">',(s=n.label)?s=s.call(t,{hash:{},data:i}):(s=t.label,s=typeof s===u?s.apply(t):s),o+=a(s)+"</h3>\n</div>\n"}),this.joint.templates.stencil["search.html"]=Handlebars.template(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<input class="search" type="search" placeholder="search"/>\n'}),this.joint.templates.stencil["stencil.html"]=Handlebars.template(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<div class="stencil-paper-drag"></div>\n<div class="content"></div>\n\n'}),joint.ui.Stencil=Backbone.View.extend({className:"stencil",events:{"click .group-label":"onGroupLabelClick","touchstart .group-label":"onGroupLabelClick","input .search":"onSearch"},options:{width:200,height:800},initialize:function(e){this.options=_.extend({},_.result(this,"options"),e||{}),this.graphs={},this.papers={},this.$groups={},_.bindAll(this,"onDrag","onDragEnd"),$(document.body).on({"mousemove.stencil touchmove.stencil":this.onDrag,"mouseup.stencil touchend.stencil":this.onDragEnd}),this.onSearch=_.debounce(this.onSearch,200)},render:function(){this.$el.html(joint.templates.stencil["stencil.html"](this.template)),this.$content=this.$(".content"),this.options.search&&this.$el.addClass("searchable").prepend(joint.templates.stencil["search.html"]());var e={width:this.options.width,height:this.options.height,interactive:!1};if(this.options.groups){var t=_.sortBy(_.pairs(this.options.groups),function(e){return e[1].index});_.each(t,function(t){var n=t[0],r=t[1],i=$(joint.templates.stencil["group.html"]({label:r.label||n}));i.attr("data-name",n),r.closed&&i.addClass("closed"),i.append($(joint.templates.stencil["elements.html"]())),this.$content.append(i),this.$groups[n]=i;var s=new joint.dia.Graph;this.graphs[n]=s;var o=new joint.dia.Paper(_.extend({},e,{el:i.find(".elements"),model:s,width:r.width||e.width,height:r.height||e.height}));this.papers[n]=o},this)}else{this.$content.append($(joint.templates.stencil["elements.html"]()));var n=new joint.dia.Graph;this.graphs.__default__=n;var r=new joint.dia.Paper(_.extend(e,{el:this.$(".elements"),model:n}));this.papers.__default__=r}return this._graphDrag=new joint.dia.Graph,this._paperDrag=new joint.dia.Paper({el:this.$(".stencil-paper-drag"),width:1,height:1,model:this._graphDrag}),_.each(this.papers,function(e){this.listenTo(e,"cell:pointerdown",this.onDragStart)},this),this},load:function(e,t){var n=this.graphs[t||"__default__"];if(!n)throw new Error("Stencil: group "+t+" does not exist.");n.resetCells(e);var r=this.options.height;t&&this.options.groups[t]&&(r=this.options.groups[t].height),r||this.papers[t||"__default__"].fitToContent(1,1,this.options.paperPadding||10)},getGraph:function(e){return this.graphs[e||"__default__"]},getPaper:function(e){return this.papers[e||"__default__"]},onDragStart:function(e,t){this.$el.addClass("dragging"),this._paperDrag.$el.addClass("dragging"),$(document.body).append(this._paperDrag.$el),this._clone=e.model.clone(),this._cloneBbox=e.getBBox();var n=5,r=g.point(this._cloneBbox.x-this._clone.get("position").x,this._cloneBbox.y-this._clone.get("position").y);this._clone.set("position",{x:-r.x+n,y:-r.y+n}),this._graphDrag.addCell(this._clone),this._paperDrag.setDimensions(this._cloneBbox.width+2*n,this._cloneBbox.height+2*n);var i=document.body.scrollTop||document.documentElement.scrollTop;this._paperDrag.$el.offset({left:t.clientX-this._cloneBbox.width/2,top:t.clientY+i-this._cloneBbox.height/2})},onDrag:function(e){if(e=joint.util.normalizeEvent(e),this._clone){var t=document.body.scrollTop||document.documentElement.scrollTop;this._paperDrag.$el.offset({left:e.clientX-this._cloneBbox.width/2,top:e.clientY+t-this._cloneBbox.height/2})}},onDragEnd:function(e){e=joint.util.normalizeEvent(e),this._clone&&this._cloneBbox&&(this.drop(e,this._clone.clone(),this._cloneBbox),this.$el.append(this._paperDrag.$el),this.$el.removeClass("dragging"),this._paperDrag.$el.removeClass("dragging"),this._clone.remove(),this._clone=void 0)},drop:function(e,t,n){var r=this.options.paper,i=this.options.graph,s=r.$el.offset(),o=document.body.scrollTop||document.documentElement.scrollTop,u=document.body.scrollLeft||document.documentElement.scrollLeft,a=g.rect(s.left+parseInt(r.$el.css("border-left-width"),10)-u,s.top+parseInt(r.$el.css("border-top-width"),10)-o,r.$el.innerWidth(),r.$el.innerHeight()),f=r.svg.createSVGPoint();if(f.x=e.clientX,f.y=e.clientY,a.containsPoint(f)){var l=V("rect",{width:r.options.width,height:r.options.height,x:0,y:0,opacity:0});V(r.svg).prepend(l);var c=$(r.svg).offset();l.remove(),f.x+=u-c.left,f.y+=o-c.top;var h=f.matrixTransform(r.viewport.getCTM().inverse()),p=t.getBBox();h.x+=p.x-n.width/2,h.y+=p.y-n.height/2,t.set("position",{x:g.snapToGrid(h.x,r.options.gridSize),y:g.snapToGrid(h.y,r.options.gridSize)}),t.unset("z"),i.addCell(t,{stencil:this.cid})}},filter:function(e,t){var n=e.toLowerCase()==e,r=_.reduce(this.papers,function(r,i,s){var o=i.model.get("cells").filter(function(r){var s=i.findViewByModel(r),o=!e||_.some(t,function(t,i){if("*"!=i&&r.get("type")!=i)return!1;var s=_.some(t,function(t){var i=joint.util.getByPath(r.attributes,t,"/");return _.isUndefined(i)||_.isNull(i)?!1:(i=i.toString(),n&&(i=i.toLowerCase()),i.indexOf(e)>=0)});return s});return V(s.el).toggleClass("unmatched",!o),o},this),u=!_.isEmpty(o),f=(new joint.dia.Graph).resetCells(o);return this.trigger("filter",f,s),this.$groups[s]&&this.$groups[s].toggleClass("unmatched",!u),i.fitToContent(1,1,this.options.paperPadding||10),r||u},!1,this);this.$el.toggleClass("not-found",!r)},onSearch:function(e){this.filter(e.target.value,this.options.search)},onGroupLabelClick:function(e){e.preventDefault();var t=$(e.target).closest(".group");this.toggleGroup(t.data("name"))},toggleGroup:function(e){this.$('.group[data-name="'+e+'"]').toggleClass("closed")},closeGroup:function(e){this.$('.group[data-name="'+e+'"]').addClass("closed")},openGroup:function(e){this.$('.group[data-name="'+e+'"]').removeClass("closed")},closeGroups:function(){this.$(".group").addClass("closed")},openGroups:function(){this.$(".group").removeClass("closed")},remove:function(){Backbone.View.prototype.remove.apply(this,arguments),$(document.body).off(".stencil",this.onDrag).off(".stencil",this.onDragEnd)}});var Handlebars={};!function(e,t){e.VERSION="1.0.0",e.COMPILER_REVISION=4,e.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"},e.helpers={},e.partials={};var n=Object.prototype.toString,r="[object Function]",i="[object Object]";e.registerHelper=function(t,r,s){if(n.call(t)===i){if(s||r)throw new e.Exception("Arg not supported with multiple helpers");e.Utils.extend(this.helpers,t)}else s&&(r.not=s),this.helpers[t]=r},e.registerPartial=function(t,r){n.call(t)===i?e.Utils.extend(this.partials,t):this.partials[t]=r},e.registerHelper("helperMissing",function(e){if(2===arguments.length)return t;throw new Error("Missing helper: '"+e+"'")}),e.registerHelper("blockHelperMissing",function(t,i){var s=i.inverse||function(){},o=i.fn,u=n.call(t);return u===r&&(t=t.call(this)),t===!0?o(this):t===!1||null==t?s(this):"[object Array]"===u?t.length>0?e.helpers.each(t,i):s(this):o(t)}),e.K=function(){},e.createFrame=Object.create||function(t){e.K.prototype=t;var n=new e.K;return e.K.prototype=null,n},e.logger={DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,methodMap:{0:"debug",1:"info",2:"warn",3:"error"},log:function(t,n){if(e.logger.level<=t){var r=e.logger.methodMap[t];"undefined"!=typeof console&&console[r]&&console[r].call(console,n)}}},e.log=function(t,n){e.logger.log(t,n)},e.registerHelper("each",function(t,i){var s,o=i.fn,u=i.inverse,a=0,f="",l=n.call(t);if(l===r&&(t=t.call(this)),i.data&&(s=e.createFrame(i.data)),t&&"object"==typeof t)if(t instanceof Array)for(var h=t.length;h>a;a++)s&&(s.index=a),f+=o(t[a],{data:s});else for(var p in t)t.hasOwnProperty(p)&&(s&&(s.key=p),f+=o(t[p],{data:s}),a++);return 0===a&&(f=u(this)),f}),e.registerHelper("if",function(t,i){var s=n.call(t);return s===r&&(t=t.call(this)),!t||e.Utils.isEmpty(t)?i.inverse(this):i.fn(this)}),e.registerHelper("unless",function(t,n){return e.helpers["if"].call(this,t,{fn:n.inverse,inverse:n.fn})}),e.registerHelper("with",function(t,i){var s=n.call(t);return s===r&&(t=t.call(this)),e.Utils.isEmpty(t)?void 0:i.fn(t)}),e.registerHelper("log",function(t,n){var r=n.data&&null!=n.data.level?parseInt(n.data.level,10):1;e.log(r,t)});var s=["description","fileName","lineNumber","message","name","number","stack"];e.Exception=function(){for(var e=Error.prototype.constructor.apply(this,arguments),t=0;t<s.length;t++)this[s[t]]=e[s[t]]},e.Exception.prototype=new Error,e.SafeString=function(e){this.string=e},e.SafeString.prototype.toString=function(){return this.string.toString()};var o={"&":"&","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},u=/[&<>"'`]/g,a=/[&<>"'`]/,f=function(e){return o[e]||"&"};e.Utils={extend:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},escapeExpression:function(t){return t instanceof e.SafeString?t.toString():null==t||t===!1?"":(t=t.toString(),a.test(t)?t.replace(u,f):t)},isEmpty:function(e){return e||0===e?"[object Array]"===n.call(e)&&0===e.length?!0:!1:!0}},e.VM={template:function(t){var n={escapeExpression:e.Utils.escapeExpression,invokePartial:e.VM.invokePartial,programs:[],program:function(t,n,r){var i=this.programs[t];return r?i=e.VM.program(t,n,r):i||(i=this.programs[t]=e.VM.program(t,n)),i},merge:function(t,n){var r=t||n;return t&&n&&(r={},e.Utils.extend(r,n),e.Utils.extend(r,t)),r},programWithDepth:e.VM.programWithDepth,noop:e.VM.noop,compilerInfo:null};return function(r,i){i=i||{};var s=t.call(n,e,r,i.helpers,i.partials,i.data),o=n.compilerInfo||[],u=o[0]||1,a=e.COMPILER_REVISION;if(u!==a){if(a>u){var f=e.REVISION_CHANGES[a],l=e.REVISION_CHANGES[u];throw"Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+f+") or downgrade your runtime to an older version ("+l+")."}throw"Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+o[1]+")."}return s}},programWithDepth:function(e,t,n){var r=Array.prototype.slice.call(arguments,3),i=function(e,i){return i=i||{},t.apply(this,[e,i.data||n].concat(r))};return i.program=e,i.depth=r.length,i},program:function(e,t,n){var r=function(e,r){return r=r||{},t(e,r.data||n)};return r.program=e,r.depth=0,r},noop:function(){return""},invokePartial:function(n,r,i,s,o,u){var a={helpers:s,partials:o,data:u};if(n===t)throw new e.Exception("The partial "+r+" could not be found");if(n instanceof Function)return n(i,a);if(e.compile)return o[r]=e.compile(n,{data:u!==t}),o[r](i,a);throw new e.Exception("The partial "+r+" could not be compiled when running in runtime-only mode")}},e.template=e.VM.template}(Handlebars),this.joint=this.joint||{},this.joint.templates=this.joint.templates||{},this.joint.templates.inspector=this.joint.templates.inspector||{},this.joint.templates.inspector["color.html"]=Handlebars.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="",u="function",a=this.escapeExpression;return o+="<label>",(s=n.label)?s=s.call(t,{hash:{},data:i}):(s=t.label,s=typeof s===u?s.apply(t):s),o+=a(s)+':</label>\n<input type="color" class="color" data-type="',(s=n.type)?s=s.call(t,{hash:{},data:i}):(s=t.type,s=typeof s===u?s.apply(t):s),o+=a(s)+'" data-attribute="',(s=n.attribute)?s=s.call(t,{hash:{},data:i}):(s=t.attribute,s=typeof s===u?s.apply(t):s),o+=a(s)+'" value="',(s=n.value)?s=s.call(t,{hash:{},data:i}):(s=t.value,s=typeof s===u?s.apply(t):s),o+=a(s)+'" />\n'}),this.joint.templates.inspector["group.html"]=Handlebars.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="",u="function",a=this.escapeExpression;return o+='<div class="group">\n    <h3 class="group-label">',(s=n.label)?s=s.call(t,{hash:{},data:i}):(s=t.label,s=typeof s===u?s.apply(t):s),o+=a(s)+"</h3>\n</div>\n"}),this.joint.templates.inspector["list-item.html"]=Handlebars.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="",u="function",a=this.escapeExpression;return o+='<div class="list-item" data-index="',(s=n.index)?s=s.call(t,{hash:{},data:i}):(s=t.index,s=typeof s===u?s.apply(t):s),o+=a(s)+'">\n    <button class="btn-list-del">-</button>\n</div>\n'}),this.joint.templates.inspector["list.html"]=Handlebars.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="",u="function",a=this.escapeExpression;return o+="<label>",(s=n.label)?s=s.call(t,{hash:{},data:i}):(s=t.label,s=typeof s===u?s.apply(t):s),o+=a(s)+':</label>\n<div class="list" data-type="',(s=n.type)?s=s.call(t,{hash:{},data:i}):(s=t.type,s=typeof s===u?s.apply(t):s),o+=a(s)+'" data-attribute="',(s=n.attribute)?s=s.call(t,{hash:{},data:i}):(s=t.attribute,s=typeof s===u?s.apply(t):s),o+=a(s)+'">\n    <button class="btn-list-add">+</button>\n    <div class="list-items">\n    </div>\n</div>\n'}),this.joint.templates.inspector["number.html"]=Handlebars.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o,u="",a="function",f=this.escapeExpression;return u+="<label>",(s=n.label)?s=s.call(t,{hash:{},data:i}):(s=t.label,s=typeof s===a?s.apply(t):s),u+=f(s)+':</label>\n<input type="number" class="number" data-type="',(s=n.type)?s=s.call(t,{hash:{},data:i}):(s=t.type,s=typeof s===a?s.apply(t):s),u+=f(s)+'" data-attribute="',(s=n.attribute)?s=s.call(t,{hash:{},data:i}):(s=t.attribute,s=typeof s===a?s.apply(t):s),u+=f(s)+'" min="'+f((s=t.options,s=null==s||s===!1?s:s.min,typeof s===a?s.apply(t):s))+'" max="'+f((s=t.options,s=null==s||s===!1?s:s.max,typeof s===a?s.apply(t):s))+'" step="'+f((s=t.options,s=null==s||s===!1?s:s.step,typeof s===a?s.apply(t):s))+'" value="',(o=n.value)?o=o.call(t,{hash:{},data:i}):(o=t.value,o=typeof o===a?o.apply(t):o),u+=f(o)+'"/>\n'}),this.joint.templates.inspector["object-property.html"]=Handlebars.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="",u="function",a=this.escapeExpression;return o+='<div class="object-property" data-property="',(s=n.property)?s=s.call(t,{hash:{},data:i}):(s=t.property,s=typeof s===u?s.apply(t):s),o+=a(s)+'">\n</div>\n'}),this.joint.templates.inspector["object.html"]=Handlebars.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="",u="function",a=this.escapeExpression;return o+="<label>",(s=n.label)?s=s.call(t,{hash:{},data:i}):(s=t.label,s=typeof s===u?s.apply(t):s),o+=a(s)+':</label>\n<div class="object" data-type="',(s=n.type)?s=s.call(t,{hash:{},data:i}):(s=t.type,s=typeof s===u?s.apply(t):s),o+=a(s)+'" data-attribute="',(s=n.attribute)?s=s.call(t,{hash:{},data:i}):(s=t.attribute,s=typeof s===u?s.apply(t):s),o+=a(s)+'">\n    <div class="object-properties"></div>\n</div>\n'}),this.joint.templates.inspector["range.html"]=Handlebars.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o,u="",a="function",f=this.escapeExpression;return u+="<form onchange=\"$(this).find('output').text(range.value)\">\n    <label>",(s=n.label)?s=s.call(t,{hash:{},data:i}):(s=t.label,s=typeof s===a?s.apply(t):s),u+=f(s)+": (<output>",(s=n.value)?s=s.call(t,{hash:{},data:i}):(s=t.value,s=typeof s===a?s.apply(t):s),u+=f(s)+"</output>"+f((s=t.options,s=null==s||s===!1?s:s.unit,typeof s===a?s.apply(t):s))+')</label>\n    <input type="range" class="range" name="range" data-type="',(o=n.type)?o=o.call(t,{hash:{},data:i}):(o=t.type,o=typeof o===a?o.apply(t):o),u+=f(o)+'" data-attribute="',(o=n.attribute)?o=o.call(t,{hash:{},data:i}):(o=t.attribute,o=typeof o===a?o.apply(t):o),u+=f(o)+'" min="'+f((s=t.options,s=null==s||s===!1?s:s.min,typeof s===a?s.apply(t):s))+'" max="'+f((s=t.options,s=null==s||s===!1?s:s.max,typeof s===a?s.apply(t):s))+'" step="'+f((s=t.options,s=null==s||s===!1?s:s.step,typeof s===a?s.apply(t):s))+'" value="',(o=n.value)?o=o.call(t,{hash:{},data:i}):(o=t.value,o=typeof o===a?o.apply(t):o),u+=f(o)+'"/>\n</form>\n'}),this.joint.templates.inspector["select.html"]=Handlebars.template(function(e,t,n,r,i){function s(e){var t,n="";return n+=' multiple size="'+h((t=e.options,t=null==t||t===!1?t:t.options,t=null==t||t===!1?t:t.length,typeof t===c?t.apply(e):t))+'" '}function o(e,t,r){var i,s,o,a="";return a+='\n    <option value="'+h((i=e.value,typeof i===c?i.apply(e):i))+'" ',o={hash:{},inverse:p.noop,fn:p.program(4,u,t),data:t},i=n["is-or-contains"]||e["is-or-contains"],s=i?i.call(e,e.value,r.value,o):d.call(e,"is-or-contains",e.value,r.value,o),(s||0===s)&&(a+=s),a+=">"+h((i=e.content,typeof i===c?i.apply(e):i))+"</option>\n    "}function u(){return" selected "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var a,f,l="",c="function",h=this.escapeExpression,p=this,d=n.helperMissing;return l+="<label>",(a=n.label)?a=a.call(t,{hash:{},data:i}):(a=t.label,a=typeof a===c?a.apply(t):a),l+=h(a)+':</label>\n<select class="select" data-type="',(a=n.type)?a=a.call(t,{hash:{},data:i}):(a=t.type,a=typeof a===c?a.apply(t):a),l+=h(a)+'" data-attribute="',(a=n.attribute)?a=a.call(t,{hash:{},data:i}):(a=t.attribute,a=typeof a===c?a.apply(t):a),l+=h(a)+'" value="',(a=n.value)?a=a.call(t,{hash:{},data:i}):(a=t.value,a=typeof a===c?a.apply(t):a),l+=h(a)+'" ',f=n["if"].call(t,(a=t.options,null==a||a===!1?a:a.multiple),{hash:{},inverse:p.noop,fn:p.program(1,s,i),data:i}),(f||0===f)&&(l+=f),l+=">\n    ",f=n.each.call(t,(a=t.options,null==a||a===!1?a:a.items),{hash:{},inverse:p.noop,fn:p.programWithDepth(3,o,i,t),data:i}),(f||0===f)&&(l+=f),l+="\n</select>\n"}),this.joint.templates.inspector["text.html"]=Handlebars.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="",u="function",a=this.escapeExpression;return o+="<label>",(s=n.label)?s=s.call(t,{hash:{},data:i}):(s=t.label,s=typeof s===u?s.apply(t):s),o+=a(s)+':</label>\n<input type="text" class="text" data-type="',(s=n.type)?s=s.call(t,{hash:{},data:i}):(s=t.type,s=typeof s===u?s.apply(t):s),o+=a(s)+'" data-attribute="',(s=n.attribute)?s=s.call(t,{hash:{},data:i}):(s=t.attribute,s=typeof s===u?s.apply(t):s),o+=a(s)+'" value="',(s=n.value)?s=s.call(t,{hash:{},data:i}):(s=t.value,s=typeof s===u?s.apply(t):s),o+=a(s)+'" />\n'}),this.joint.templates.inspector["textarea.html"]=Handlebars.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="",u="function",a=this.escapeExpression;return o+="<label>",(s=n.label)?s=s.call(t,{hash:{},data:i}):(s=t.label,s=typeof s===u?s.apply(t):s),o+=a(s)+':</label>\n<textarea class="textarea" data-type="',(s=n.type)?s=s.call(t,{hash:{},data:i}):(s=t.type,s=typeof s===u?s.apply(t):s),o+=a(s)+'" data-attribute="',(s=n.attribute)?s=s.call(t,{hash:{},data:i}):(s=t.attribute,s=typeof s===u?s.apply(t):s),o+=a(s)+'">',(s=n.value)?s=s.call(t,{hash:{},data:i}):(s=t.value,s=typeof s===u?s.apply(t):s),o+=a(s)+"</textarea>\n"}),this.joint.templates.inspector["toggle.html"]=Handlebars.template(function(e,t,n,r,i){function s(){return" checked "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var o,u="",a="function",f=this.escapeExpression,l=this;return u+="<label>",(o=n.label)?o=o.call(t,{hash:{},data:i}):(o=t.label,o=typeof o===a?o.apply(t):o),u+=f(o)+':</label>\n<div class="toggle">\n    <input type="checkbox" data-type="',(o=n.type)?o=o.call(t,{hash:{},data:i}):(o=t.type,o=typeof o===a?o.apply(t):o),u+=f(o)+'" data-attribute="',(o=n.attribute)?o=o.call(t,{hash:{},data:i}):(o=t.attribute,o=typeof o===a?o.apply(t):o),u+=f(o)+'" ',o=n["if"].call(t,t.value,{hash:{},inverse:l.noop,fn:l.program(1,s,i),data:i}),(o||0===o)&&(u+=o),u+=" />\n    <span><i></i></span>\n</div>\n"}),Handlebars.registerHelper("is",function(e,t,n){return e==t?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("is-or-contains",function(e,t,n){return(_.isArray(t)?_.contains(t,e):e==t)?n.fn(this):n.inverse(this)}),Handlebars.registerPartial("list-item",joint.templates.inspector["list-item.html"]),joint.ui.Inspector=Backbone.View.extend({className:"inspector",options:{cellView:void 0,cell:void 0,live:!0},events:{mousedown:"startBatchCommand",change:"onChangeInput","click .group-label":"onGroupLabelClick","click .btn-list-add":"addListItem","click .btn-list-del":"deleteListItem"},initialize:function(e){this.options=_.extend({},_.result(this,"options"),e||{}),this.options.groups=this.options.groups||{},_.bindAll(this,"stopBatchCommand"),$(document).on("mouseup",this.stopBatchCommand),this.flatAttributes=joint.util.flattenObject(this.options.inputs,"/",function(e){return e.type}),this._when={},this._bound={};var t=_.map(this.flatAttributes,function(e,t){if(e.when){var n={expression:e.when,path:t};_.each(this.extractExpressionPaths(n.expression),function(e){(this._when[e]||(this._when[e]=[])).push(n)},this)}return"select"==e.type&&_.isString(e.options)&&(this._bound[t]=e.options),e.path=t,e},this);this.groupedFlatAttributes=_.sortBy(_.sortBy(t,"index"),function(e){var t=this.options.groups[e.group];return t&&t.index||Number.MAX_VALUE},this),this.on("render",function(){this._byPath={},_.each(this.$("[data-attribute]"),function(e){var t=$(e);this._byPath[t.attr("data-attribute")]=t},this)},this),this.listenTo(this.getModel(),"all",this.onCellChange,this)},getModel:function(){return this.options.cell||this.options.cellView.model},onCellChange:function(e,t,n,r){if(r=r||{},!r["inspector_"+this.cid])switch(e){case"remove":this.remove();break;case"change:position":this.updateInputPosition();break;case"change:size":this.updateInputSize();break;case"change:angle":this.updateInputAngle();break;case"change:source":case"change:target":break;default:var i="change:";e.slice(0,i.length)===i&&this.render()}},render:function(){this.$el.empty();var e,t,n=[];return _.each(this.groupedFlatAttributes,function(r){if(e!==r.group){var i=this.options.groups[r.group],s=i?i.label||r.group:r.group;t=$(joint.templates.inspector["group.html"]({label:s})),t.attr("data-name",r.group),i&&i.closed&&t.addClass("closed"),n.push(t)}this.renderTemplate(t,r,r.path),e=r.group},this),this.$el.append(n),this.trigger("render"),this},getCellAttributeValue:function(e,t){var n=this.getModel(),r=joint.util.getByPath(n.attributes,e,"/");if(!t)return r;if(_.isUndefined(r)&&!_.isUndefined(t.defaultValue)&&(r=t.defaultValue),t.valueRegExp){if(_.isUndefined(r))throw new Error("Inspector: defaultValue must be present when valueRegExp is used.");var i=r.match(new RegExp(t.valueRegExp));r=i&&i[2]}return r},resolveBindings:function(e){switch(e.type){case"select":var t=e.options||[];_.isString(t)&&(t=joint.util.getByPath(this.getModel().attributes,t,"/")||[]),_.isObject(t[0])||(t=_.map(t,function(e){return{value:e,content:e}})),e.items=t}},updateBindings:function(e){var t=_.reduce(this._bound,function(t,n,r){return e.indexOf(n)||t.push(r),t},[]);_.isEmpty(t)||(_.each(t,function(e){this.renderTemplate(null,this.flatAttributes[e],e,{replace:!0})},this),this.trigger("render"))},renderTemplate:function(e,t,n,r){e=e||this.$el,r=r||{},this.resolveBindings(t);var i=$('<div class="field"></div>').attr("data-field",n);t.when&&!this.isExpressionValid(t.when)&&(i.addClass("hidden"),t.when.otherwise&&t.when.otherwise.unset&&this.unsetProperty(n));var s=this.getCellAttributeValue(n,t),o=joint.templates.inspector[t.type+".html"]({options:t,type:t.type,label:t.label||n,attribute:n,value:s}),u=$(o);if(i.append(u),_.each(t.attrs,function(e,t){i.find(t).addBack().filter(t).attr(e)}),"list"===t.type)_.each(s,function(e,r){var i=$(joint.templates.inspector["list-item.html"]({index:r}));this.renderTemplate(i,t.item,n+"/"+r),u.children(".list-items").append(i)},this);else if("object"===t.type){t.flatAttributes=joint.util.flattenObject(t.properties,"/",function(e){return e.type});var a=_.map(t.flatAttributes,function(e,t){return e.path=t,e});a=_.sortBy(a,function(e){return e.index}),_.each(a,function(e){var t=$(joint.templates.inspector["object-property.html"]({property:e.path}));this.renderTemplate(t,e,n+"/"+e.path),u.children(".object-properties").append(t)},this)}r.replace?e.find('[data-field="'+n+'"]').replaceWith(i):e.append(i)},updateInputPosition:function(){var e=this._byPath["position/x"],t=this._byPath["position/y"],n=this.getModel().get("position");e&&e.val(n.x),t&&t.val(n.y)},updateInputSize:function(){var e=this._byPath["size/width"],t=this._byPath["size/height"],n=this.getModel().get("size");e&&e.val(n.width),t&&t.val(n.height)},updateInputAngle:function(){var e=this._byPath.angle,t=this.getModel().get("angle");e&&e.val(t)},onChangeInput:function(e){var t=$(e.target),n=t.attr("data-attribute");this.options.live&&this.updateCell(t,n);var r=t.attr("data-type"),i=this.parse(r,t.val(),t[0]),s=this._when[n];this.trigger("change:"+n,i,t[0]),s&&_.each(s,function(e){var t=this._byPath[e.path],n=t.closest(".field"),r=n.hasClass("hidden"),i=this.isExpressionValid(e.expression);n.toggleClass("hidden",!i),e.expression.otherwise&&e.expression.otherwise.unset&&this.options.live&&(i?r&&this.updateCell(t,e.path):(this.unsetProperty(e.path),this.renderTemplate(null,this.flatAttributes[e.path],e.path,{replace:!0}),this.trigger("render")))},this)},unsetProperty:function(e){var t=this.getModel(),n=e.split("/"),r=_.first(n),i=_.rest(n).join("/"),s={};if(s["inspector_"+this.cid]=!0,"attrs"==e)t.removeAttr(i,s);else if(e==r)t.unset(r,s);else{var o=_.merge({},t.get(r)),u=joint.util.unsetByPath(o,i,"/");t.set(r,u,s)}},getOptions:function(e){if(0===e.length)return void 0;var t=e.attr("data-attribute"),n=(e.attr("data-type"),this.flatAttributes[t]);if(!n){var r=e.parent().closest("[data-attribute]"),i=r.attr("data-attribute");n=this.getOptions(r);var s=t.replace(i+"/",""),o=n;n=o.item||o.flatAttributes[s],n.parent=o}return n},updateCell:function(e,t){var n=this.getModel(),r={};e?r[t]=e:r=this._byPath,_.each(r,function(e,t){if(!e.hasClass("hidden")){var i,s,o=e.attr("data-type");switch(o){case"list":joint.util.unsetByPath(n.attributes,t,"/"),r[t+"/0"]||this.setProperty(t,[]);break;case"object":break;default:if(i=this.parse(o,e.val(),e[0]),s=this.getOptions(e),s.valueRegExp){var u=joint.util.getByPath(n.attributes,t,"/")||s.defaultValue;i=u.replace(new RegExp(s.valueRegExp),"$1"+i+"$3")}var a=!1;if(s.parent&&"list"===s.parent.type){var f=t.split("/"),l=parseInt(_.last(f),10);r[_.initial(f).join("/")+"/"+(l+1)]&&(a=!0)}this.setProperty(t,i,a)}this.updateBindings(t)}},this)},setProperty:function(e,t,n){var r,i=this.getModel(),s=e.split("/"),o=s[0],u={};if(u["inspector_"+this.cid]=!0,n&&(u.silent=!0),s.length>1){var a=_.cloneDeep(i.attributes);r=joint.util.getByPath(a,e,"/");var f={},l=f,c=o;_.each(_.rest(s),function(e){l=l[c]=_.isFinite(Number(e))?[]:{},c=e}),f=joint.util.setByPath(f,e,t,"/"),_.merge(a,f),i.set(o,a[o],u)}else r=i.get(o),i.set(o,t,u)},parse:function(e,t,n){switch(e){case"number":t=parseFloat(t);break;case"toggle":t=n.checked;break;default:t=t}return t},startBatchCommand:function(){this.getModel().trigger("batch:start")},stopBatchCommand:function(){this.getModel().trigger("batch:stop")},addListItem:function(e){var t=$(e.target),n=t.closest("[data-attribute]"),r=n.attr("data-attribute"),i=this.getOptions(n),s=n.children(".list-items").children(".list-item").last(),o=0===s.length?-1:parseInt(s.attr("data-index"),10),u=o+1,a=$(joint.templates.inspector["list-item.html"]({index:u}));this.renderTemplate(a,i.item,r+"/"+u),t.parent().children(".list-items").append(a),a.find("input").focus(),this.trigger("render"),this.options.live&&this.updateCell()},deleteListItem:function(e){var t=$(e.target).closest(".list-item");t.nextAll(".list-item").each(function(){var e=parseInt($(this).attr("data-index"),10),t=e-1;$(this).find("[data-attribute]").each(function(){$(this).attr("data-attribute",$(this).attr("data-attribute").replace("/"+e,"/"+t))}),$(this).attr("data-index",t)}),t.remove(),this.trigger("render"),this.options.live&&this.updateCell()},remove:function(){return $(document).off("mouseup",this.stopBatchCommand),Backbone.View.prototype.remove.apply(this,arguments)},onGroupLabelClick:function(e){e.preventDefault();var t=$(e.target).closest(".group");this.toggleGroup(t.data("name"))},toggleGroup:function(e){this.$('.group[data-name="'+e+'"]').toggleClass("closed")},closeGroup:function(e){this.$('.group[data-name="'+e+'"]').addClass("closed")},openGroup:function(e){this.$('.group[data-name="'+e+'"]').removeClass("closed")},closeGroups:function(){this.$(".group").addClass("closed")},openGroups:function(){this.$(".group").removeClass("closed")},_isComposite:function(e){var t=_.pick(e,"not","and","or","nor");return _.some(t)},_isPrimitive:function(e){var t=_.pick(e,"eq","ne","regex","text","lt","lte","gt","gte","in","nin");return _.some(t)},_evalPrimitive:function(e){return _.reduce(e,function(e,t,n){return _.reduce(t,function(e,t,r){var i=this.getCellAttributeValue(r);switch(n){case"eq":return t==i;case"ne":return t!=i;case"regex":return(new RegExp(t)).test(i);case"text":return!t||_.isString(i)&&i.toLowerCase().indexOf(t)>-1;case"lt":return t>i;case"lte":return t>=i;case"gt":return i>t;case"gte":return i>=t;case"in":return _.contains(t,i);case"nin":return!_.contains(t,i);default:return e}},!1,this)},!1,this)},_evalExpression:function(e){return this._isPrimitive(e)?this._evalPrimitive(e):_.reduce(e,function(e,t,n){if("not"==n)return!this._evalExpression(t);var r=_.map(t,this._evalExpression,this);switch(n){case"and":return _.every(r);case"or":return _.some(r);case"nor":return!_.some(r);default:return e}},!1,this)},_extractVariables:function(e){return _.isArray(e)||this._isComposite(e)?_.reduce(e,function(e,t){return e.concat(this._extractVariables(t))},[],this):_.reduce(e,function(e,t){return _.keys(t)},[])},isExpressionValid:function(e){return e=_.omit(e,"otherwise"),this._evalExpression(e)},extractExpressionPaths:function(e){return e=_.omit(e,"otherwise"),_.uniq(this._extractVariables(e))}});var Handlebars={};!function(e,t){e.VERSION="1.0.0",e.COMPILER_REVISION=4,e.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"},e.helpers={},e.partials={};var n=Object.prototype.toString,r="[object Function]",i="[object Object]";e.registerHelper=function(t,r,s){if(n.call(t)===i){if(s||r)throw new e.Exception("Arg not supported with multiple helpers");e.Utils.extend(this.helpers,t)}else s&&(r.not=s),this.helpers[t]=r},e.registerPartial=function(t,r){n.call(t)===i?e.Utils.extend(this.partials,t):this.partials[t]=r},e.registerHelper("helperMissing",function(e){if(2===arguments.length)return t;throw new Error("Missing helper: '"+e+"'")}),e.registerHelper("blockHelperMissing",function(t,i){var s=i.inverse||function(){},o=i.fn,u=n.call(t);return u===r&&(t=t.call(this)),t===!0?o(this):t===!1||null==t?s(this):"[object Array]"===u?t.length>0?e.helpers.each(t,i):s(this):o(t)}),e.K=function(){},e.createFrame=Object.create||function(t){e.K.prototype=t;var n=new e.K;return e.K.prototype=null,n},e.logger={DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,methodMap:{0:"debug",1:"info",2:"warn",3:"error"},log:function(t,n){if(e.logger.level<=t){var r=e.logger.methodMap[t];"undefined"!=typeof console&&console[r]&&console[r].call(console,n)}}},e.log=function(t,n){e.logger.log(t,n)},e.registerHelper("each",function(t,i){var s,o=i.fn,u=i.inverse,a=0,f="",l=n.call(t);if(l===r&&(t=t.call(this)),i.data&&(s=e.createFrame(i.data)),t&&"object"==typeof t)if(t instanceof Array)for(var h=t.length;h>a;a++)s&&(s.index=a),f+=o(t[a],{data:s});else for(var p in t)t.hasOwnProperty(p)&&(s&&(s.key=p),f+=o(t[p],{data:s}),a++);return 0===a&&(f=u(this)),f}),e.registerHelper("if",function(t,i){var s=n.call(t);return s===r&&(t=t.call(this)),!t||e.Utils.isEmpty(t)?i.inverse(this):i.fn(this)}),e.registerHelper("unless",function(t,n){return e.helpers["if"].call(this,t,{fn:n.inverse,inverse:n.fn})}),e.registerHelper("with",function(t,i){var s=n.call(t);return s===r&&(t=t.call(this)),e.Utils.isEmpty(t)?void 0:i.fn(t)}),e.registerHelper("log",function(t,n){var r=n.data&&null!=n.data.level?parseInt(n.data.level,10):1;e.log(r,t)});var s=["description","fileName","lineNumber","message","name","number","stack"];e.Exception=function(){for(var e=Error.prototype.constructor.apply(this,arguments),t=0;t<s.length;t++)this[s[t]]=e[s[t]]},e.Exception.prototype=new Error,e.SafeString=function(e){this.string=e},e.SafeString.prototype.toString=function(){return this.string.toString()};var o={"&":"&","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},u=/[&<>"'`]/g,a=/[&<>"'`]/,f=function(e){return o[e]||"&"};e.Utils={extend:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},escapeExpression:function(t){return t instanceof e.SafeString?t.toString():null==t||t===!1?"":(t=t.toString(),a.test(t)?t.replace(u,f):t)},isEmpty:function(e){return e||0===e?"[object Array]"===n.call(e)&&0===e.length?!0:!1:!0}},e.VM={template:function(t){var n={escapeExpression:e.Utils.escapeExpression,invokePartial:e.VM.invokePartial,programs:[],program:function(t,n,r){var i=this.programs[t];return r?i=e.VM.program(t,n,r):i||(i=this.programs[t]=e.VM.program(t,n)),i},merge:function(t,n){var r=t||n;return t&&n&&(r={},e.Utils.extend(r,n),e.Utils.extend(r,t)),r},programWithDepth:e.VM.programWithDepth,noop:e.VM.noop,compilerInfo:null};return function(r,i){i=i||{};var s=t.call(n,e,r,i.helpers,i.partials,i.data),o=n.compilerInfo||[],u=o[0]||1,a=e.COMPILER_REVISION;if(u!==a){if(a>u){var f=e.REVISION_CHANGES[a],l=e.REVISION_CHANGES[u];throw"Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+f+") or downgrade your runtime to an older version ("+l+")."}throw"Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+o[1]+")."}return s}},programWithDepth:function(e,t,n){var r=Array.prototype.slice.call(arguments,3),i=function(e,i){return i=i||{},t.apply(this,[e,i.data||n].concat(r))};return i.program=e,i.depth=r.length,i},program:function(e,t,n){var r=function(e,r){return r=r||{},t(e,r.data||n)};return r.program=e,r.depth=0,r},noop:function(){return""},invokePartial:function(n,r,i,s,o,u){var a={helpers:s,partials:o,data:u};if(n===t)throw new e.Exception("The partial "+r+" could not be found");if(n instanceof Function)return n(i,a);if(e.compile)return o[r]=e.compile(n,{data:u!==t}),o[r](i,a);throw new e.Exception("The partial "+r+" could not be compiled when running in runtime-only mode")}},e.template=e.VM.template}(Handlebars),this.joint=this.joint||{},this.joint.templates=this.joint.templates||{},this.joint.templates["freetransform.html"]=Handlebars.template(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<div class="resize" data-position="top-left" draggable="false"/>\n<div class="resize" data-position="top" draggable="false"/>\n<div class="resize" data-position="top-right" draggable="false"/>\n<div class="resize" data-position="right" draggable="false"/>\n<div class="resize" data-position="bottom-right" draggable="false"/>\n<div class="resize" data-position="bottom" draggable="false"/>\n<div class="resize" data-position="bottom-left" draggable="false"/>\n<div class="resize" data-position="left" draggable="false"/>\n<div class="rotate" draggable="false"/>\n\n'}),joint.ui.FreeTransform=Backbone.View.extend({className:"free-transform",template:"freetransform",events:{"mousedown .resize":"startResizing","mousedown .rotate":"startRotating","touchstart .resize":"startResizing","touchstart .rotate":"startRotating"},options:{directions:["nw","n","ne","e","se","s","sw","w"]},initialize:function(e){this.options=_.extend({},_.result(this,"options"),e||{}),this.options.cellView&&_.defaults(this.options,{cell:this.options.cellView.model,paper:this.options.cellView.paper,graph:this.options.cellView.paper.model}),_.bindAll(this,"update","remove","pointerup","pointermove"),joint.ui.FreeTransform.clear(this.options.paper),$(document.body).on("mousemove touchmove",this.pointermove),$(document).on("mouseup touchend",this.pointerup),this.listenTo(this.options.graph,"all",this.update),this.listenTo(this.options.graph,"reset",this.remove),this.listenTo(this.options.cell,"remove",this.remove),this.listenTo(this.options.paper,"blank:pointerdown freetransform:create",this.remove),this.listenTo(this.options.paper,"scale translate",this.update),this.options.paper.$el.append(this.el)},render:function(){this.$el.html(joint.templates["freetransform.html"](this.template)),this.$el.attr("data-type",this.options.cell.get("type")),this.update()},update:function(){var e=this.options.paper.viewport.getCTM(),t=this.options.cell.getBBox();t.x*=e.a,t.x+=e.e,t.y*=e.d,t.y+=e.f,t.width*=e.a,t.height*=e.d;var n=g.normalizeAngle(this.options.cell.get("angle")||0),r="rotate("+n+"deg)";this.$el.css({width:t.width+4,height:t.height+4,left:t.x-3,top:t.y-3,transform:r,"-webkit-transform":r,"-ms-transform":r});var i=Math.floor(n*(this.options.directions.length/360));if(i!=this._previousDirectionsShift){var s=_.rest(this.options.directions,i).concat(_.first(this.options.directions,i));this.$(".resize").removeClass("nw n ne e se s sw w").each(function(e,t){$(t).addClass(s[e])}),this._previousDirectionsShift=i}},startResizing:function(e){e.stopPropagation(),this.options.graph.trigger("batch:start");var t=$(e.target).data("position"),n=0,r=0;_.each(t.split("-"),function(e){n={left:-1,right:1}[e]||n,r={top:-1,bottom:1}[e]||r}),t={top:"top-left",bottom:"bottom-right",left:"bottom-left",right:"top-right"}[t]||t;var i={"top-right":"bottomLeft","top-left":"corner","bottom-left":"topRight","bottom-right":"origin"}[t];this._initial={angle:g.normalizeAngle(this.options.cell.get("angle")||0),resizeX:n,resizeY:r,selector:i,direction:t},this._action="resize",this.startOp(e.target)},startRotating:function(e){e.stopPropagation(),this.options.graph.trigger("batch:start");var t=this.options.cell.getBBox().center(),n=this.options.paper.snapToGrid({x:e.clientX,y:e.clientY});this._initial={centerRotation:t,modelAngle:g.normalizeAngle(this.options.cell.get("angle")||0),startAngle:g.point(n).theta(t)},this._action="rotate",this.startOp(e.target)},pointermove:function(e){if(this._action){e=joint.util.normalizeEvent(e);var t=this.options.paper.snapToGrid({x:e.clientX,y:e.clientY}),n=this.options.paper.options.gridSize,r=this.options.cell,i=this._initial;switch(this._action){case"resize":var s=r.getBBox(),o=g.point(t).rotate(s.center(),i.angle),u=o.difference(s[i.selector]()),a=i.resizeX?u.x*i.resizeX:s.width,f=i.resizeY?u.y*i.resizeY:s.height;a=n>a?n:g.snapToGrid(a,n),f=n>f?n:g.snapToGrid(f,n),(s.width!=a||s.height!=f)&&r.resize(a,f,{direction:i.direction});break;case"rotate":var l=i.startAngle-g.point(t).theta(i.centerRotation);r.rotate(g.snapToGrid(i.modelAngle+l,15),!0)}}},pointerup:function(){this._action&&(this.stopOp(),this.options.graph.trigger("batch:stop"),delete this._action,delete this._initial)},remove:function(){Backbone.View.prototype.remove.apply(this,arguments),$("body").off("mousemove touchmove",this.pointermove),$(document).off("mouseup touchend",this.pointerup)},startOp:function(e){e&&($(e).addClass("in-operation"),this._elementOp=e),this.$el.addClass("in-operation")},stopOp:function(){this._elementOp&&($(this._elementOp).removeClass("in-operation"),delete this._elementOp),this.$el.removeClass("in-operation")}},{clear:function(e){e.trigger("freetransform:create")}}),joint.ui.Tooltip=Backbone.View.extend({className:"tooltip",options:{left:void 0,right:void 0,top:void 0,bottom:void 0,padding:10,target:void 0,rootTarget:void 0},initialize:function(e){this.options=_.extend({},_.result(this,"options"),e||{}),_.bindAll(this,"render","hide","position"),this.options.rootTarget?(this.$rootTarget=$(this.options.rootTarget),this.$rootTarget.on("mouseover",this.options.target,this.render),this.$rootTarget.on("mouseout",this.options.target,this.hide),this.$rootTarget.on("mousedown",this.options.target,this.hide)):(this.$target=$(this.options.target),this.$target.on("mouseover",this.render),this.$target.on("mouseout",this.hide),this.$target.on("mousedown",this.hide)),this.$el.addClass(this.options.direction)},remove:function(){this.$target.off("mouseover",this.render),this.$target.off("mouseout",this.hide),this.$target.off("mousedown",this.hide),Backbone.View.prototype.remove.apply(this,arguments)},hide:function(){Backbone.View.prototype.remove.apply(this,arguments)},render:function(e){var t,n=!_.isUndefined(e.x)&&!_.isUndefined(e.y);n?t=e:(this.$target=$(e.target).closest(this.options.target),t=this.$target[0]),this.$el.html(_.isFunction(this.options.content)?this.options.content(t):this.options.content),this.$el.hide(),$(document.body).append(this.$el);var r=this.$("img");r.length?r.on("load",_.bind(function(){this.position(n?t:void 0)},this)):this.position(n?t:void 0)},getElementBBox:function(e){var t,n=$(e),r=n.offset(),i=document.body.scrollTop||document.documentElement.scrollTop,s=document.body.scrollLeft||document.documentElement.scrollLeft;if(r.top-=i||0,r.left-=s||0,e.ownerSVGElement){t=V(e).bbox();var o=e.getBoundingClientRect(),u=(o.width-t.width)/2,a=(o.height-t.height)/2;t.x=r.left+u,t.y=r.top+a}else t={x:r.left,y:r.top,width:n.outerWidth(),height:n.outerHeight()};return t},position:function(e){var t;t=e?{x:e.x,y:e.y,width:1,height:1}:this.getElementBBox(this.$target[0]);var n=this.options.padding;this.$el.show();var r=this.$el.outerHeight(),i=this.$el.outerWidth();if(this.options.left){var s=$(_.isFunction(this.options.left)?this.options.left(this.$target[0]):this.options.left),o=this.getElementBBox(s[0]);this.$el.css({left:o.x+o.width+n,top:t.y+t.height/2-r/2})}else if(this.options.right){var u=$(_.isFunction(this.options.right)?this.options.right(this.$target[0]):this.options.right),a=this.getElementBBox(u[0]);this.$el.css({left:a.x-i-n,top:t.y+t.height/2-r/2})}else if(this.options.top){var f=$(_.isFunction(this.options.top)?this.options.top(this.$target[0]):this.options.top),l=this.getElementBBox(f[0]);this.$el.css({top:l.y+l.height+n,left:t.x+t.width/2-i/2})}else if(this.options.bottom){var c=$(_.isFunction(this.options.bottom)?this.options.bottom(this.$target[0]):this.options.bottom),h=this.getElementBBox(c[0]);this.$el.css({top:h.y-r-n,left:t.x+t.width/2-i/2})}else this.$el.css({left:t.x+t.width+n,top:t.y+t.height/2-r/2})}}),joint.ui.Snaplines=Backbone.View.extend({options:{paper:void 0,distance:10},className:"snaplines",initialize:function(e){this.options=_.extend({},_.result(this,"options"),e||{}),this.$horizontal=$("<div>").addClass("snapline horizontal").appendTo(this.el),this.$vertical=$("<div>").addClass("snapline vertical").appendTo(this.el),this.$el.hide().appendTo(this.options.paper.el),this.startListening()},startListening:function(){this.stopListening(),this.listenTo(this.options.paper,"cell:pointerdown",this.startSnapping),this.listenTo(this.options.paper,"cell:pointermove",this.snap),this.listenTo(this.options.paper,"cell:pointerup",this.hide)},startSnapping:function(e,t,n,r){if(!(e instanceof joint.dia.LinkView)){var i=e.model.get("position");this._diffX=n-i.x,this._diffY=r-i.y}},snap:function(e,t,n,r){if(!(e instanceof joint.dia.LinkView)){var i=e.model,s=g.rect(_.extend({x:n-this._diffX,y:r-this._diffY},i.get("size"))),o=s.center(),u=s.bbox(i.get("angle")),a=u.origin(),f=u.corner(),l=this.options.distance,c=null,h=null,p=0,d=0;if(_.chain(this.options.paper.model.getElements()).without(i).find(function(e){var t=e.getBBox().bbox(e.get("angle")),n=t.center(),r=t.origin(),i=t.corner();return _.isNull(c)&&(Math.abs(n.x-o.x)<l?(c=n.x,p=.5):Math.abs(r.x-a.x)<l?c=r.x:Math.abs(r.x-f.x)<l?(c=r.x,p=1):Math.abs(i.x-f.x)<l?(c=i.x,p=1):Math.abs(i.x-a.x)<l&&(c=i.x)),_.isNull(h)&&(Math.abs(n.y-o.y)<l?(h=n.y,d=.5):Math.abs(r.y-a.y)<l?h=r.y:Math.abs(r.y-f.y)<l?(h=r.y,d=1):Math.abs(i.y-f.y)<l?(h=i.y,d=1):Math.abs(i.y-a.y)<l&&(h=i.y)),_.isNumber(c)&&_.isNumber(h)}),this.hide(),_.isNumber(c)||_.isNumber(h)){_.isNumber(c)&&(u.x=c-p*u.width),_.isNumber(h)&&(u.y=h-d*u.height);var v=u.center(),m=v.x-s.width/2,y=v.y-s.height/2;i.set("position",{x:m,y:y}),this.show({vertical:c,horizontal:h})}}},show:function(e){e=e||{};var t=this.options.paper.viewport.getCTM();e.horizontal?this.$horizontal.css("top",e.horizontal*t.d+t.f).show():this.$horizontal.hide(),e.vertical?this.$vertical.css("left",e.vertical*t.a+t.e).show():this.$vertical.hide(),this.$el.show()},hide:function(){this.$el.hide()}}),function a(e,t,n){function r(s,o){if(!t[s]){if(!e[s]){var u="function"==typeof require&&require;if(!o&&u)return u(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+s+"'")}var l=t[s]={exports:{}};e[s][0].call(l.exports,function(t){var n=e[s][1][t];return r(n?n:t)},l,l.exports,a,e,t,n)}return t[s].exports}for(var i="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(e){var t="undefined"!=typeof self?self:"undefined"!=typeof window?window:{};t.dagre=e("./index")},{"./index":2}],2:[function(e,t,n){n.Digraph=e("graphlib").Digraph,n.Graph=e("graphlib").Graph,n.layout=e("./lib/layout"),n.version=e("./lib/version")},{"./lib/layout":3,"./lib/version":18,graphlib:24}],3:[function(e,t){var n=e("./util"),r=e("./rank"),i=e("./order"),s=e("graphlib").CGraph,o=e("graphlib").CDigraph;t.exports=function(){function t(e){var t=new o;e.eachNode(function(e,n){void 0===n&&(n={}),t.addNode(e,{width:n.width,height:n.height}),n.hasOwnProperty("rank")&&(t.node(e).prefRank=n.rank)}),e.parent&&e.nodes().forEach(function(n){t.parent(n,e.parent(n))}),e.eachEdge(function(e,n,r,i){void 0===i&&(i={});var s={e:e,minLen:i.minLen||1,width:i.width||0,height:i.height||0,points:[]};t.addEdge(null,n,r,s)});var n=e.graph()||{};return t.graph({rankDir:n.rankDir||y.rankDir,orderRestarts:n.orderRestarts}),t}function u(e){var s,o=w.rankSep();try{return s=n.time("initLayoutGraph",t)(e),0===s.order()?s:(s.eachEdge(function(e,t,n,r){r.minLen*=2}),w.rankSep(o/2),n.time("rank.run",r.run)(s,y.rankSimplex),n.time("normalize",l)(s),n.time("order",i)(s,y.orderMaxSweeps),n.time("position",b.run)(s),n.time("undoNormalize",h)(s),n.time("fixupEdgePoints",p)(s),n.time("rank.restoreEdges",r.restoreEdges)(s),n.time("createFinalGraph",v)(s,e.isDirected()))}finally{w.rankSep(o)}}function l(e){var t=0;e.eachEdge(function(n,r,i,s){var o=e.node(r).rank,u=e.node(i).rank;if(u>o+1){for(var f=r,l=o+1,c=0;u>l;++l,++c){var h="_D"+ ++t,p={width:s.width,height:s.height,edge:{id:n,source:r,target:i,attrs:s},rank:l,dummy:!0};0===c?p.index=0:l+1===u&&(p.index=1),e.addNode(h,p),e.addEdge(null,f,h,{}),f=h}e.addEdge(null,f,i,{}),e.delEdge(n)}})}function h(e){e.eachNode(function(t,n){if(n.dummy){if("index"in n){var r=n.edge;e.hasEdge(r.id)||e.addEdge(r.id,r.source,r.target,r.attrs);var i=e.edge(r.id).points;i[n.index]={x:n.x,y:n.y,ul:n.ul,ur:n.ur,dl:n.dl,dr:n.dr}}e.delNode(t)}})}function p(e){e.eachEdge(function(e,t,n,r){r.reversed&&r.points.reverse()})}function v(e,t){var n=t?new o:new s;n.graph(e.graph()),e.eachNode(function(e,t){n.addNode(e,t)}),e.eachNode(function(t){n.parent(t,e.parent(t))}),e.eachEdge(function(e,t,r,i){n.addEdge(i.e,t,r,i)});var r=0,i=0;return e.eachNode(function(t,n){e.children(t).length||(r=Math.max(r,n.x+n.width/2),i=Math.max(i,n.y+n.height/2))}),e.eachEdge(function(e,t,n,s){var o=Math.max.apply(Math,s.points.map(function(e){return e.x})),u=Math.max.apply(Math,s.points.map(function(e){return e.y}));r=Math.max(r,o+s.width/2),i=Math.max(i,u+s.height/2)}),n.graph().width=r,n.graph().height=i,n}function m(e){return function(){return arguments.length?(e.apply(null,arguments),w):e()}}var y={debugLevel:0,orderMaxSweeps:i.DEFAULT_MAX_SWEEPS,rankSimplex:!1,rankDir:"TB"},b=e("./position")(),w={};return w.orderIters=n.propertyAccessor(w,y,"orderMaxSweeps"),w.rankSimplex=n.propertyAccessor(w,y,"rankSimplex"),w.nodeSep=m(b.nodeSep),w.edgeSep=m(b.edgeSep),w.universalSep=m(b.universalSep),w.rankSep=m(b.rankSep),w.rankDir=n.propertyAccessor(w,y,"rankDir"),w.debugAlignment=m(b.debugAlignment),w.debugLevel=n.propertyAccessor(w,y,"debugLevel",function(e){n.log.level=e,b.debugLevel(e)}),w.run=n.time("Total layout",u),w._normalize=l,w}},{"./order":4,"./position":9,"./rank":10,"./util":17,graphlib:24}],4:[function(e,t){function n(e,t){function n(){e.eachNode(function(e,t){p[e]=t.order})}arguments.length<2&&(t=d);var r=e.graph().orderRestarts||0,i=c(e);i.forEach(function(t){t=t.filterNodes(function(t){return!e.children(t).length})});for(var s,u=0,a=Number.MAX_VALUE,p={},v=0;v<Number(r)+1&&0!==a;++v){s=Number.MAX_VALUE,h(e,r>0),f.log(2,"Order phase start cross count: "+e.graph().orderInitCC);var g,y,b;for(g=0,y=0;4>y&&t>g&&s>0;++g,++y,++u)o(e,i,g),b=l(e),s>b&&(y=0,s=b,a>b&&(n(),a=b)),f.log(3,"Order phase start "+v+" iter "+g+" cross count: "+b)}Object.keys(p).forEach(function(t){e.children&&e.children(t).length||(e.node(t).order=p[t])}),e.graph().orderCC=a,f.log(2,"Order iterations: "+u),f.log(2,"Order phase best cross count: "+e.graph().orderCC)}function r(e,t){var n={};return t.forEach(function(t){n[t]=e.inEdges(t).map(function(t){return e.node(e.source(t)).order})}),n}function s(e,t){var n={};return t.forEach(function(t){n[t]=e.outEdges(t).map(function(t){return e.node(e.target(t)).order})}),n}function o(e,t,n){n%2===0?u(e,t,n):a(e,t,n)}function u(e,t){var n;for(i=1;i<t.length;++i)n=p(t[i],n,r(e,t[i].nodes()))}function a(e,t){var n;for(i=t.length-2;i>=0;--i)p(t[i],n,s(e,t[i].nodes()))}var f=e("./util"),l=e("./order/crossCount"),c=e("./order/initLayerGraphs"),h=e("./order/initOrder"),p=e("./order/sortLayer");t.exports=n;var d=24;n.DEFAULT_MAX_SWEEPS=d},{"./order/crossCount":5,"./order/initLayerGraphs":6,"./order/initOrder":7,"./order/sortLayer":8,"./util":17}],5:[function(e,t){function n(e){for(var t=0,n=i.ordering(e),s=1;s<n.length;++s)t+=r(e,n[s-1],n[s]);return t}function r(e,t,n){var r=[];t.forEach(function(t){var n=[];e.outEdges(t).forEach(function(t){n.push(e.node(e.target(t)).order)}),n.sort(function(e,t){return e-t}),r=r.concat(n)});for(var i=1;i<n.length;)i<<=1;var s=2*i-1;i-=1;for(var o=[],u=0;s>u;++u)o[u]=0;var a=0;return r.forEach(function(e){var t=e+i;for(++o[t];t>0;)t%2&&(a+=o[t+1]),t=t-1>>1,++o[t]}),a}var i=e("../util");t.exports=n},{"../util":17}],6:[function(e,t){function n(e){function t(r){if(null===r)return e.children(r).forEach(function(e){t(e)}),void 0;var s=e.node(r);s.minRank="rank"in s?s.rank:Number.MAX_VALUE,s.maxRank="rank"in s?s.rank:Number.MIN_VALUE;var o=new i;return e.children(r).forEach(function(n){var r=t(n);o=i.union([o,r]),s.minRank=Math.min(s.minRank,e.node(n).minRank),s.maxRank=Math.max(s.maxRank,e.node(n).maxRank)}),"rank"in s&&o.add(s.rank),o.keys().forEach(function(e){e in n||(n[e]=[]),n[e].push(r)}),o}var n=[];t(null);var s=[];return n.forEach(function(t,n){s[n]=e.filterNodes(r(t))}),s}var r=e("graphlib").filter.nodesFromList,i=e("cp-data").Set;t.exports=n},{"cp-data":19,graphlib:24}],7:[function(e,t){function n(e,t){var n=[];e.eachNode(function(t,r){var i=n[r.rank];e.children&&e.children(t).length>0||(i||(i=n[r.rank]=[]),i.push(t))}),n.forEach(function(n){t&&i.shuffle(n),n.forEach(function(t,n){e.node(t).order=n})});var s=r(e);e.graph().orderInitCC=s,e.graph().orderCC=Number.MAX_VALUE}var r=e("./crossCount"),i=e("../util");t.exports=n},{"../util":17,"./crossCount":5}],8:[function(e,t){function n(e,t,n){var i=[],s={};e.eachNode(function(e,t){i[t.order]=e;var o=n[e];o.length&&(s[e]=r.sum(o)/o.length)});var o=e.nodes().filter(function(e){return void 0!==s[e]});o.sort(function(t,n){return s[t]-s[n]||e.node(t).order-e.node(n).order});for(var u=0,a=0,f=o.length;f>a;++u)void 0!==s[i[u]]&&(e.node(o[a++]).order=u)}var r=e("../util");t.exports=n},{"../util":17}],9:[function(e,t){var n=e("./util");t.exports=function(){function e(e){e=e.filterNodes(n.filterNonSubgraphs(e));var t=n.ordering(e),o=r(e,t),u={};["u","d"].forEach(function(n){"d"===n&&t.reverse(),["l","r"].forEach(function(r){"r"===r&&l(t);var a=n+r,h=i(e,t,o,"u"===n?"predecessors":"successors");u[a]=s(e,t,h.pos,h.root,h.align),b.debugLevel>=3&&y(n+r,e,t,u[a]),"r"===r&&f(u[a]),"r"===r&&l(t)}),"d"===n&&t.reverse()}),a(e,t,u),e.eachNode(function(t){var n=[];for(var r in u){var i=u[r][t];m(r,e,t,i),n.push(i)}n.sort(function(e,t){return e-t}),v(e,t,(n[1]+n[2])/2)});var d=0,w="BT"===e.graph().rankDir||"RL"===e.graph().rankDir;t.forEach(function(t){var r=n.max(t.map(function(t){return p(e,t)}));d+=r/2,t.forEach(function(t){g(e,t,w?-d:d)}),d+=r/2+b.rankSep});var E=n.min(e.nodes().map(function(t){return v(e,t)-h(e,t)/2})),S=n.min(e.nodes().map(function(t){return g(e,t)-p(e,t)/2}));e.eachNode(function(t){v(e,t,v(e,t)-E),g(e,t,g(e,t)-S)})}function t(e,t){return t>e?e.toString().length+":"+e+"-"+t:t.toString().length+":"+t+"-"+e}function r(e,n){function r(e){var n=l[e];(o>n||n>a)&&(f[t(s[u],e)]=!0)}var i,s,o,u,a,f={},l={};if(n.length<=2)return f;n[1].forEach(function(e,t){l[e]=t});for(var c=1;c<n.length-1;++c){i=n[c],s=n[c+1],o=0,u=0;for(var h=0;h<s.length;++h){var p=s[h];if(l[p]=h,a=void 0,e.node(p).dummy){var d=e.predecessors(p)[0];void 0!==d&&e.node(d).dummy&&(a=l[d])}if(void 0===a&&h===s.length-1&&(a=i.length-1),void 0!==a){for(;h>=u;++u)e.predecessors(s[u]).forEach(r);o=a}}}return f}function i(e,n,r,i){var s={},o={},u={};return n.forEach(function(e){e.forEach(function(e,t){o[e]=e,u[e]=e,s[e]=t})}),n.forEach(function(n){var a=-1;n.forEach(function(n){var f,l=e[i](n);l.length>0&&(l.sort(function(e,t){return s[e]-s[t]}),f=(l.length-1)/2,l.slice(Math.floor(f),Math.ceil(f)+1).forEach(function(e){u[n]===n&&!r[t(e,n)]&&a<s[e]&&(u[e]=n,u[n]=o[n]=o[e],a=s[e])}))})}),{pos:s,root:o,align:u}}function s(e,t,r,i,s){function o(e,t,n){f[e][t]=t in f[e]?Math.min(f[e][t],n):n}function u(t){if(!(t in p)){p[t]=0;var n=t;do{if(r[n]>0){var f=i[h[n]];u(f),a[t]===t&&(a[t]=a[f]);var l=d(e,h[n])+d(e,n);a[t]!==a[f]?o(a[f],a[t],p[t]-p[f]-l):p[t]=Math.max(p[t],p[f]+l)}n=s[n]}while(n!==t)}}var a={},f={},l={},h={},p={};return t.forEach(function(e){e.forEach(function(t,n){a[t]=t,f[t]={},n>0&&(h[t]=e[n-1])})}),n.values(i).forEach(function(e){u(e)}),t.forEach(function(e){e.forEach(function(e){if(p[e]=p[i[e]],e===i[e]&&e===a[e]){var t=0;e in f&&Object.keys(f[e]).length>0&&(t=n.min(Object.keys(f[e]).map(function(t){return f[e][t]+(t in l?l[t]:0)}))),l[e]=t}})}),t.forEach(function(e){e.forEach(function(e){p[e]+=l[a[i[e]]]||0})}),p}function o(e,t,r){return n.min(t.map(function(e){var t=e[0];return r[t]}))}function u(e,t,r){return n.max(t.map(function(e){var t=e[e.length-1];return r[t]}))}function a(e,t,n){function r(e){n[c][e]+=f[c]}var i,s={},a={},f={},l=Number.POSITIVE_INFINITY;for(var c in n){var h=n[c];s[c]=o(e,t,h),a[c]=u(e,t,h);var p=a[c]-s[c];l>p&&(l=p,i=c)}["u","d"].forEach(function(e){["l","r"].forEach(function(t){var n=e+t;f[n]="l"===t?s[i]-s[n]:a[i]-a[n]})});for(c in n)e.eachNode(r)}function f(e){for(var t in e)e[t]=-e[t]}function l(e){e.forEach(function(e){e.reverse()})}function h(e,t){switch(e.graph().rankDir){case"LR":return e.node(t).height;case"RL":return e.node(t).height;default:return e.node(t).width}}function p(e,t){switch(e.graph().rankDir){case"LR":return e.node(t).width;case"RL":return e.node(t).width;default:return e.node(t).height}}function d(e,t){if(null!==b.universalSep)return b.universalSep;var n=h(e,t),r=e.node(t).dummy?b.edgeSep:b.nodeSep;return(n+r)/2}function v(e,t,n){if("LR"===e.graph().rankDir||"RL"===e.graph().rankDir){if(arguments.length<3)return e.node(t).y;e.node(t).y=n}else{if(arguments.length<3)return e.node(t).x;e.node(t).x=n}}function m(e,t,n,r){if("LR"===t.graph().rankDir||"RL"===t.graph().rankDir){if(arguments.length<3)return t.node(n)[e];t.node(n)[e]=r}else{if(arguments.length<3)return t.node(n)[e];t.node(n)[e]=r}}function g(e,t,n){if("LR"===e.graph().rankDir||"RL"===e.graph().rankDir){if(arguments.length<3)return e.node(t).x;e.node(t).x=n}else{if(arguments.length<3)return e.node(t).y;e.node(t).y=n}}function y(e,t,n,r){n.forEach(function(n,i){var s,o;n.forEach(function(n){var u=r[n];if(s){var a=d(t,s)+d(t,n);a>u-o&&console.log("Position phase: sep violation. Align: "+e+". Layer: "+i+". U: "+s+" V: "+n+". Actual sep: "+(u-o)+" Expected sep: "+a)}s=n,o=u})})}var b={nodeSep:50,edgeSep:10,universalSep:null,rankSep:30},w={};return w.nodeSep=n.propertyAccessor(w,b,"nodeSep"),w.edgeSep=n.propertyAccessor(w,b,"edgeSep"),w.universalSep=n.propertyAccessor(w,b,"universalSep"),w.rankSep=n.propertyAccessor(w,b,"rankSep"),w.debugLevel=n.propertyAccessor(w,b,"debugLevel"),w.run=e,w}},{"./util":17}],10:[function(e,t,n){function r(e,t){s(e),c.time("constraints.apply",v.apply)(e),o(e),c.time("acyclic",h)(e);var n=e.filterNodes(c.filterNonSubgraphs(e));p(n),g(n).forEach(function(e){var r=n.filterNodes(y.nodesFromList(e));f(r,t)}),c.time("constraints.relax",v.relax(e)),c.time("reorientEdges",a)(e)}function i(e){h.undo(e)}function s(e){e.eachEdge(function(t,n,r,i){if(n===r){var s=u(e,t,n,r,i,0,!1),o=u(e,t,n,r,i,1,!0),a=u(e,t,n,r,i,2,!1);e.addEdge(null,s,n,{minLen:1,selfLoop:!0}),e.addEdge(null,s,o,{minLen:1,selfLoop:!0}),e.addEdge(null,n,a,{minLen:1,selfLoop:!0}),e.addEdge(null,o,a,{minLen:1,selfLoop:!0}),e.delEdge(t)}})}function o(e){e.eachEdge(function(t,n,r,i){if(n===r){var s=i.originalEdge,o=u(e,s.e,s.u,s.v,s.value,0,!0);e.addEdge(null,n,o,{minLen:1}),e.addEdge(null,o,r,{minLen:1}),e.delEdge(t)}})}function u(e,t,n,r,i,s,o){return e.addNode(null,{width:o?i.width:0,height:o?i.height:0,edge:{id:t,source:n,target:r,attrs:i},dummy:!0,index:s})}function a(e){e.eachEdge(function(t,n,r,i){e.node(n).rank>e.node(r).rank&&(e.delEdge(t),i.reversed=!0,e.addEdge(t,r,n,i))})}function f(e,t){var n=d(e);t&&(c.log(1,"Using network simplex for ranking"),m(e,n)),l(e)}function l(e){var t=c.min(e.nodes().map(function(t){return e.node(t).rank}));e.eachNode(function(e,n){n.rank-=t})}var c=e("./util"),h=e("./rank/acyclic"),p=e("./rank/initRank"),d=e("./rank/feasibleTree"),v=e("./rank/constraints"),m=e("./rank/simplex"),g=e("graphlib").alg.components,y=e("graphlib").filter;n.run=r,n.restoreEdges=i},{"./rank/acyclic":11,"./rank/constraints":12,"./rank/feasibleTree":13,"./rank/initRank":14,"./rank/simplex":16,"./util":17,graphlib:24}],11:[function(e,t){function n(e){function t(i){i in r||(r[i]=n[i]=!0,e.outEdges(i).forEach(function(r){var o,u=e.target(r);i===u?console.error('Warning: found self loop "'+r+'" for node "'+i+'"'):u in n?(o=e.edge(r),e.delEdge(r),o.reversed=!0,++s,e.addEdge(r,u,i,o)):t(u)}),delete n[i])}var n={},r={},s=0;return e.eachNode(function(e){t(e)}),i.log(2,"Acyclic Phase: reversed "+s+" edge(s)"),s}function r(e){e.eachEdge(function(t,n,r,i){i.reversed&&(delete i.reversed,e.delEdge(t),e.addEdge(t,r,n,i))})}var i=e("../util");t.exports=n,t.exports.undo=r},{"../util":17}],12:[function(e,t,n){function r(e){return"min"!==e&&"max"!==e&&0!==e.indexOf("same_")?(console.error("Unsupported rank type: "+e),!1):!0}function i(e,t,n,r){e.inEdges(t).forEach(function(t){var i,s=e.edge(t);i=s.originalEdge?s:{originalEdge:{e:t,u:e.source(t),v:e.target(t),value:s},minLen:e.edge(t).minLen},s.selfLoop&&(r=!1),r?(e.addEdge(null,n,e.source(t),i),i.reversed=!0):e.addEdge(null,e.source(t),n,i)})}function s(e,t,n,r){e.outEdges(t).forEach(function(t){var i,s=e.edge(t);i=s.originalEdge?s:{originalEdge:{e:t,u:e.source(t),v:e.target(t),value:s},minLen:e.edge(t).minLen},s.selfLoop&&(r=!1),r?(e.addEdge(null,e.target(t),n,i),i.reversed=!0):e.addEdge(null,n,e.target(t),i)})}function o(e,t,n){void 0!==n&&e.children(t).forEach(function(t){t===n||e.outEdges(n,t).length||e.node(t).dummy||e.addEdge(null,n,t,{minLen:0})})}function u(e,t,n){void 0!==n&&e.children(t).forEach(function(t){t===n||e.outEdges(t,n).length||e.node(t).dummy||e.addEdge(null,t,n,{minLen:0})})}n.apply=function(e){function t(n){var l={};e.children(n).forEach(function(o){if(e.children(o).length)return t(o),void 0;var u=e.node(o),h=u.prefRank;if(void 0!==h){if(!r(h))return;h in l?l.prefRank.push(o):l.prefRank=[o];var p=l[h];void 0===p&&(p=l[h]=e.addNode(null,{originalNodes:[]}),e.parent(p,n)),i(e,o,p,"min"===h),s(e,o,p,"max"===h),e.node(p).originalNodes.push({u:o,value:u,parent:n}),e.delNode(o)}}),o(e,n,l.min),u(e,n,l.max)}t(null)},n.relax=function(e){var t=[];e.eachEdge(function(e,n,r,i){var s=i.originalEdge;s&&t.push(s)}),e.eachNode(function(t,n){var r=n.originalNodes;r&&(r.forEach(function(t){t.value.rank=n.rank,e.addNode(t.u,t.value),e.parent(t.u,t.parent)}),e.delNode(t))}),t.forEach(function(t){e.addEdge(t.e,t.u,t.v,t.value)})}},{}],13:[function(e,t){function n(e){function t(n){var i=!0;return e.predecessors(n).forEach(function(s){o.has(s)&&!r(e,s,n)&&(o.has(n)&&(u.addNode(n,{}),o.remove(n),u.graph({root:n})),u.addNode(s,{}),u.addEdge(null,s,n,{reversed:!0}),o.remove(s),t(s),i=!1)}),e.successors(n).forEach(function(s){o.has(s)&&!r(e,n,s)&&(o.has(n)&&(u.addNode(n,{}),o.remove(n),u.graph({root:n})),u.addNode(s,{}),u.addEdge(null,n,s,{}),o.remove(s),t(s),i=!1)}),i}function n(){var t=Number.MAX_VALUE;o.keys().forEach(function(n){e.predecessors(n).forEach(function(i){if(!o.has(i)){var s=r(e,i,n);Math.abs(s)<Math.abs(t)&&(t=-s)}}),e.successors(n).forEach(function(i){if(!o.has(i)){var s=r(e,n,i);Math.abs(s)<Math.abs(t)&&(t=s)}})}),u.eachNode(function(n){e.node(n).rank-=t})}var o=new i(e.nodes()),u=new s;if(1===o.size()){var a=e.nodes()[0];return u.addNode(a,{}),u.graph({root:a}),u}for(;o.size();){for(var l=u.order()?u.nodes():o.keys(),c=0,h=l.length;h>c&&t(l[c]);++c);o.size()&&n()}return u}function r(e,t,n){var r=e.node(n).rank-e.node(t).rank,i=o.max(e.outEdges(t,n).map(function(t){return e.edge(t).minLen}));return r-i}var i=e("cp-data").Set,s=e("graphlib").Digraph,o=e("../util");t.exports=n},{"../util":17,"cp-data":19,graphlib:24}],14:[function(e,t){function n(e){var t=i(e);t.forEach(function(t){var n=e.inEdges(t);if(0===n.length)return e.node(t).rank=0,void 0;var i=n.map(function(t){return e.node(e.source(t)).rank+e.edge(t).minLen});e.node(t).rank=r.max(i)})}var r=e("../util"),i=e("graphlib").alg.topsort;t.exports=n},{"../util":17,graphlib:24}],15:[function(e,t){function n(e,t,n,r){return Math.abs(e.node(t).rank-e.node(n).rank)-r}t.exports={slack:n}},{}],16:[function(e,t){function n(e,t){for(r(e,t);;){var n=u(t);if(null===n)break;var i=a(e,t,n);f(e,t,n,i)}}function r(e,t){function n(r){var i=t.successors(r);for(var o in i){var u=i[o];n(u)}r!==t.graph().root&&s(e,t,r)}i(t),t.eachEdge(function(e,t,n,r){r.cutValue=0}),n(t.graph().root)}function i(e){function t(r){var i=e.successors(r),s=n;for(var o in i){var u=i[o];t(u),s=Math.min(s,e.node(u).low)}e.node(r).low=s,e.node(r).lim=n++}var n=0;t(e.graph().root)}function s(e,t,n){var r=t.inEdges(n)[0],i=[],s=t.outEdges(n);for(var u in s)i.push(t.target(s[u]));var a,f=0,l=0,c=0,h=0,p=0,d=e.outEdges(n);for(var v in d){var m=e.target(d[v]);for(a in i)o(t,m,i[a])&&l++;o(t,m,n)||h++}var y=e.inEdges(n);for(var b in y){var w=e.source(y[b]);for(a in i)o(t,w,i[a])&&c++;o(t,w,n)||p++}var E=0;for(a in i){var S=t.edge(s[a]).cutValue;t.edge(s[a]).reversed?E-=S:E+=S}t.edge(r).reversed?f-=E-l+c-h+p:f+=E-l+c-h+p,t.edge(r).cutValue=f}function o(e,t,n){return e.node(n).low<=e.node(t).lim&&e.node(t).lim<=e.node(n).lim}function u(e){var t=e.edges();for(var n in t){var r=t[n],i=e.edge(r);if(i.cutValue<0)return r}return null}function a(e,t,n){var r,i=t.source(n),s=t.target(n),u=t.node(s).lim<t.node(i).lim?s:i,a=!t.edge(n).reversed,f=Number.POSITIVE_INFINITY;if(a?e.eachEdge(function(i,s,a,l){if(i!==n&&o(t,s,u)&&!o(t,a,u)){var c=p.slack(e,s,a,l.minLen);f>c&&(f=c,r=i)}}):e.eachEdge(function(i,s,a,l){if(i!==n&&!o(t,s,u)&&o(t,a,u)){var c=p.slack(e,s,a,l.minLen);f>c&&(f=c,r=i)}}),void 0===r){var l=[],c=[];throw e.eachNode(function(e){o(t,e,u)?c.push(e):l.push(e)}),new Error("No edge found from outside of tree to inside")}return r}function f(e,t,n,i){function s(e){var n=t.inEdges(e);for(var r in n){var i=n[r],o=t.source(i),u=t.edge(i);s(o),t.delEdge(i),u.reversed=!u.reversed,t.addEdge(i,e,o,u)}}t.delEdge(n);var o=e.source(i),u=e.target(i);s(u);for(var a=o,f=t.inEdges(a);f.length>0;)a=t.source(f[0]),f=t.inEdges(a);t.graph().root=a,t.addEdge(null,o,u,{cutValue:0}),r(e,t),l(e,t)}function l(e,t){function n(r){var i=t.successors(r);i.forEach(function(t){var i=c(e,r,t);e.node(t).rank=e.node(r).rank+i,n(t)})}n(t.graph().root)}function c(e,t,n){var r=e.outEdges(t,n);if(r.length>0)return h.max(r.map(function(t){return e.edge(t).minLen}));var i=e.inEdges(t,n);return i.length>0?-h.max(i.map(function(t){return e.edge(t).minLen})):void 0}var h=e("../util"),p=e("./rankUtil");t.exports=n},{"../util":17,"./rankUtil":15}],17:[function(e,t,n){function r(e,t){return function(){var n=(new Date).getTime();try{return t.apply(null,arguments)}finally{s(1,e+" time: "+((new Date).getTime()-n)+"ms")}}}function s(e){s.level>=e&&console.log.apply(console,Array.prototype.slice.call(arguments,1))}n.min=function(e){return Math.min.apply(Math,e)},n.max=function(e){return Math.max.apply(Math,e)},n.all=function(e,t){for(var n=0;n<e.length;++n)if(!t(e[n]))return!1;return!0},n.sum=function(e){return e.reduce(function(e,t){return e+t},0)},n.values=function(e){return Object.keys(e).map(function(t){return e[t]})},n.shuffle=function(e){for(i=e.length-1;i>0;--i){var t=Math.floor(Math.random()*(i+1)),n=e[t];e[t]=e[i],e[i]=n}},n.propertyAccessor=function(e,t,n,r){return function(i){return arguments.length?(t[n]=i,r&&r(i),e):t[n]}},n.ordering=function(e){var t=[];return e.eachNode(function(e,n){var r=t[n.rank]||(t[n.rank]=[]);r[n.order]=e}),t},n.filterNonSubgraphs=function(e){return function(t){return 0===e.children(t).length}},r.enabled=!1,n.time=r,s.level=0,n.log=s},{}],18:[function(e,t){t.exports="0.4.5"},{}],19:[function(e,t,n){n.Set=e("./lib/Set"),n.PriorityQueue=e("./lib/PriorityQueue"),n.version=e("./lib/version")},{"./lib/PriorityQueue":20,"./lib/Set":21,"./lib/version":23}],20:[function(e,t){function n(){this._arr=[],this._keyIndices={}}t.exports=n,n.prototype.size=function(){return this._arr.length},n.prototype.keys=function(){return this._arr.map(function(e){return e.key})},n.prototype.has=function(e){return e in this._keyIndices},n.prototype.priority=function(e){var t=this._keyIndices[e];return void 0!==t?this._arr[t].priority:void 0},n.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},n.prototype.add=function(e,t){var n=this._keyIndices;if(!(e in n)){var r=this._arr,i=r.length;return n[e]=i,r.push({key:e,priority:t}),this._decrease(i),!0}return!1},n.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key},n.prototype.decrease=function(e,t){var n=this._keyIndices[e];if(t>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+e+" Old: "+this._arr[n].priority+" New: "+t);this._arr[n].priority=t,this._decrease(n)},n.prototype._heapify=function(e){var t=this._arr,n=2*e,r=n+1,i=e;n<t.length&&(i=t[n].priority<t[i].priority?n:i,r<t.length&&(i=t[r].priority<t[i].priority?r:i),i!==e&&(this._swap(e,i),this._heapify(i)))},n.prototype._decrease=function(e){for(var t,n=this._arr,r=n[e].priority;0!==e&&(t=e>>1,!(n[t].priority<r));)this._swap(e,t),e=t},n.prototype._swap=function(e,t){var n=this._arr,r=this._keyIndices,i=n[e],s=n[t];n[e]=s,n[t]=i,r[s.key]=e,r[i.key]=t}},{}],21:[function(e,t){function n(e){if(this._size=0,this._keys={},e)for(var t=0,n=e.length;n>t;++t)this.add(e[t])}function r(e){var t,n=Object.keys(e),r=n.length,i=new Array(r);for(t=0;r>t;++t)i[t]=e[n[t]];return i}var i=e("./util");t.exports=n,n.intersect=function(e){if(0===e.length)return new n;for(var t=new n(i.isArray(e[0])?e[0]:e[0].keys()),r=1,s=e.length;s>r;++r)for(var o=t.keys(),u=i.isArray(e[r])?new n(e[r]):e[r],a=0,f=o.length;f>a;++a){var l=o[a];u.has(l)||t.remove(l)}return t},n.union=function(e){for(var t=i.reduce(e,function(e,t){return e+(t.size?t.size():t.length)},0),r=new Array(t),s=0,o=0,u=e.length;u>o;++o)for(var a=e[o],f=i.isArray(a)?a:a.keys(),l=0,h=f.length;h>l;++l)r[s++]=f[l];return new n(r)},n.prototype.size=function(){return this._size},n.prototype.keys=function(){return r(this._keys)},n.prototype.has=function(e){return e in this._keys},n.prototype.add=function(e){return e in this._keys?!1:(this._keys[e]=e,++this._size,!0)},n.prototype.remove=function(e){return e in this._keys?(delete this._keys[e],--this._size,!0):!1}},{"./util":22}],22:[function(e,t,n){n.isArray=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},n.reduce="function"!=typeof Array.prototype.reduce?function(e,t,n){"use strict";if(null===e||"undefined"==typeof e)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof t)throw new TypeError(t+" is not a function");var r,i,s=e.length>>>0,o=!1;for(1<arguments.length&&(i=n,o=!0),r=0;s>r;++r)e.hasOwnProperty(r)&&(o?i=t(i,e[r],r,e):(i=e[r],o=!0));if(!o)throw new TypeError("Reduce of empty array with no initial value");return i}:function(e,t,n){return e.reduce(t,n)}},{}],23:[function(e,t){t.exports="1.1.3"},{}],24:[function(e,t,n){n.Graph=e("./lib/Graph"),n.Digraph=e("./lib/Digraph"),n.CGraph=e("./lib/CGraph"),n.CDigraph=e("./lib/CDigraph"),e("./lib/graph-converters"),n.alg={isAcyclic:e("./lib/alg/isAcyclic"),components:e("./lib/alg/components"),dijkstra:e("./lib/alg/dijkstra"),dijkstraAll:e("./lib/alg/dijkstraAll"),findCycles:e("./lib/alg/findCycles"),floydWarshall:e("./lib/alg/floydWarshall"),postorder:e("./lib/alg/postorder"),preorder:e("./lib/alg/preorder"),prim:e("./lib/alg/prim"),tarjan:e("./lib/alg/tarjan"),topsort:e("./lib/alg/topsort")},n.converter={json:e("./lib/converter/json.js")};var r=e("./lib/filter");n.filter={all:r.all,nodesFromList:r.nodesFromList},n.version=e("./lib/version")},{"./lib/CDigraph":26,"./lib/CGraph":27,"./lib/Digraph":28,"./lib/Graph":29,"./lib/alg/components":30,"./lib/alg/dijkstra":31,"./lib/alg/dijkstraAll":32,"./lib/alg/findCycles":33,"./lib/alg/floydWarshall":34,"./lib/alg/isAcyclic":35,"./lib/alg/postorder":36,"./lib/alg/preorder":37,"./lib/alg/prim":38,"./lib/alg/tarjan":39,"./lib/alg/topsort":40,"./lib/converter/json.js":42,"./lib/filter":43,"./lib/graph-converters":44,"./lib/version":46}],25:[function(e,t){function n(){this._value=void 0,this._nodes={},this._edges={},this._nextId=0}function r(e,t,n){(e[t]||(e[t]=new s)).add(n)}function i(e,t,n){var r=e[t];r.remove(n),0===r.size()&&delete e[t]}var s=e("cp-data").Set;t.exports=n,n.prototype.order=function(){return Object.keys(this._nodes).length},n.prototype.size=function(){return Object.keys(this._edges).length},n.prototype.graph=function(e){return 0===arguments.length?this._value:(this._value=e,void 0)},n.prototype.hasNode=function(e){return e in this._nodes},n.prototype.node=function(e,t){var n=this._strictGetNode(e);return 1===arguments.length?n.value:(n.value=t,void 0)},n.prototype.nodes=function(){var e=[];return this.eachNode(function(t){e.push(t)}),e},n.prototype.eachNode=function(e){for(var t in this._nodes){var n=this._nodes[t];e(n.id,n.value)}},n.prototype.hasEdge=function(e){return e in this._edges},n.prototype.edge=function(e,t){var n=this._strictGetEdge(e);return 1===arguments.length?n.value:(n.value=t,void 0)},n.prototype.edges=function(){var e=[];return this.eachEdge(function(t){e.push(t)}),e},n.prototype.eachEdge=function(e){for(var t in this._edges){var n=this._edges[t];e(n.id,n.u,n.v,n.value)}},n.prototype.incidentNodes=function(e){var t=this._strictGetEdge(e);return[t.u,t.v]},n.prototype.addNode=function(e,t){if(void 0===e||null===e){do e="_"+ ++this._nextId;while(this.hasNode(e))}else if(this.hasNode(e))throw new Error("Graph already has node '"+e+"'");return this._nodes[e]={id:e,value:t},e},n.prototype.delNode=function(e){this._strictGetNode(e),this.incidentEdges(e).forEach(function(e){this.delEdge(e)},this),delete this._nodes[e]},n.prototype._addEdge=function(e,t,n,i,s,o){if(this._strictGetNode(t),this._strictGetNode(n),void 0===e||null===e){do e="_"+ ++this._nextId;while(this.hasEdge(e))}else if(this.hasEdge(e))throw new Error("Graph already has edge '"+e+"'");return this._edges[e]={id:e,u:t,v:n,value:i},r(s[n],t,e),r(o[t],n,e),e},n.prototype._delEdge=function(e,t,n){var r=this._strictGetEdge(e);i(t[r.v],r.u,e),i(n[r.u],r.v,e),delete this._edges[e]},n.prototype.copy=function(){var e=new this.constructor;return e.graph(this.graph()),this.eachNode(function(t,n){e.addNode(t,n)}),this.eachEdge(function(t,n,r,i){e.addEdge(t,n,r,i)}),e._nextId=this._nextId,e},n.prototype.filterNodes=function(e){var t=new this.constructor;return t.graph(this.graph()),this.eachNode(function(n,r){e(n)&&t.addNode(n,r)}),this.eachEdge(function(e,n,r,i){t.hasNode(n)&&t.hasNode(r)&&t.addEdge(e,n,r,i)}),t},n.prototype._strictGetNode=function(e){var t=this._nodes[e];if(void 0===t)throw new Error("Node '"+e+"' is not in graph");return t},n.prototype._strictGetEdge=function(e){var t=this._edges[e];if(void 0===t)throw new Error("Edge '"+e+"' is not in graph");return t}},{"cp-data":19}],26:[function(e,t){var n=e("./Digraph"),r=e("./compoundify"),i=r(n);t.exports=i,i.fromDigraph=function(e){var t=new i,n=e.graph();return void 0!==n&&t.graph(n),e.eachNode(function(e,n){void 0===n?t.addNode(e):t.addNode(e,n)}),e.eachEdge(function(e,n,r,i){void 0===i?t.addEdge(null,n,r):t.addEdge(null,n,r,i)}),t},i.prototype.toString=function(){return"CDigraph "+JSON.stringify(this,null,2)}},{"./Digraph":28,"./compoundify":41}],27:[function(e,t){var n=e("./Graph"),r=e("./compoundify"),i=r(n);t.exports=i,i.fromGraph=function(e){var t=new i,n=e.graph();return void 0!==n&&t.graph(n),e.eachNode(function(e,n){void 0===n?t.addNode(e):t.addNode(e,n)}),e.eachEdge(function(e,n,r,i){void 0===i?t.addEdge(null,n,r):t.addEdge(null,n,r,i)}),t},i.prototype.toString=function(){return"CGraph "+JSON.stringify(this,null,2)}},{"./Graph":29,"./compoundify":41}],28:[function(e,t){function n(){i.call(this),this._inEdges={},this._outEdges={}}var r=e("./util"),i=e("./BaseGraph"),s=e("cp-data").Set;t.exports=n,n.prototype=new i,n.prototype.constructor=n,n.prototype.isDirected=function(){return!0},n.prototype.successors=function(e){return this._strictGetNode(e),Object.keys(this._outEdges[e]).map(function(e){return this._nodes[e].id},this)},n.prototype.predecessors=function(e){return this._strictGetNode(e),Object.keys(this._inEdges[e]).map(function(e){return this._nodes[e].id},this)},n.prototype.neighbors=function(e){return s.union([this.successors(e),this.predecessors(e)]).keys()},n.prototype.sources=function(){var e=this;return this._filterNodes(function(t){return 0===e.inEdges(t).length})},n.prototype.sinks=function(){var e=this;return this._filterNodes(function(t){return 0===e.outEdges(t).length})},n.prototype.source=function(e){return this._strictGetEdge(e).u},n.prototype.target=function(e){return this._strictGetEdge(e).v},n.prototype.inEdges=function(e,t){this._strictGetNode(e);var n=s.union(r.values(this._inEdges[e])).keys();return arguments.length>1&&(this._strictGetNode(t),n=n.filter(function(e){return this.source(e)===t},this)),n},n.prototype.outEdges=function(e,t){this._strictGetNode(e);var n=s.union(r.values(this._outEdges[e])).keys();return arguments.length>1&&(this._strictGetNode(t),n=n.filter(function(e){return this.target(e)===t},this)),n},n.prototype.incidentEdges=function(e,t){return arguments.length>1?s.union([this.outEdges(e,t),this.outEdges(t,e)]).keys():s.union([this.inEdges(e),this.outEdges(e)]).keys()},n.prototype.toString=function(){return"Digraph "+JSON.stringify(this,null,2)},n.prototype.addNode=function(e,t){return e=i.prototype.addNode.call(this,e,t),this._inEdges[e]={},this._outEdges[e]={},e},n.prototype.delNode=function(e){i.prototype.delNode.call(this,e),delete this._inEdges[e],delete this._outEdges[e]},n.prototype.addEdge=function(e,t,n,r){return i.prototype._addEdge.call(this,e,t,n,r,this._inEdges,this._outEdges)},n.prototype.delEdge=function(e){i.prototype._delEdge.call(this,e,this._inEdges,this._outEdges)},n.prototype._filterNodes=function(e){var t=[];return this.eachNode(function(n){e(n)&&t.push(n)}),t}},{"./BaseGraph":25,"./util":45,"cp-data":19}],29:[function(e,t){function n(){i.call(this),this._incidentEdges={}}var r=e("./util"),i=e("./BaseGraph"),s=e("cp-data").Set;t.exports=n,n.prototype=new i,n.prototype.constructor=n,n.prototype.isDirected=function(){return!1},n.prototype.neighbors=function(e){return this._strictGetNode(e),Object.keys(this._incidentEdges[e]).map(function(e){return this._nodes[e].id},this)},n.prototype.incidentEdges=function(e,t){return this._strictGetNode(e),arguments.length>1?(this._strictGetNode(t),t in this._incidentEdges[e]?this._incidentEdges[e][t].keys():[]):s.union(r.values(this._incidentEdges[e])).keys()},n.prototype.toString=function(){return"Graph "+JSON.stringify(this,null,2)},n.prototype.addNode=function(e,t){return e=i.prototype.addNode.call(this,e,t),this._incidentEdges[e]={},e},n.prototype.delNode=function(e){i.prototype.delNode.call(this,e),delete this._incidentEdges[e]},n.prototype.addEdge=function(e,t,n,r){return i.prototype._addEdge.call(this,e,t,n,r,this._incidentEdges,this._incidentEdges)},n.prototype.delEdge=function(e){i.prototype._delEdge.call(this,e,this._incidentEdges,this._incidentEdges)}},{"./BaseGraph":25,"./util":45,"cp-data":19}],30:[function(e,t){function n(e){function t(n,r){i.has(n)||(i.add(n),r.push(n),e.neighbors(n).forEach(function(e){t(e,r)}))}var n=[],i=new r;return e.nodes().forEach(function(e){var r=[];t(e,r),r.length>0&&n.push(r)}),n}var r=e("cp-data").Set;t.exports=n},{"cp-data":19}],31:[function(e,t){function n(e,t,n,i){function s(t){var r=e.incidentNodes(t),i=r[0]!==a?r[0]:r[1],s=o[i],l=n(t),p=f.distance+l;if(0>l)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+t+" Weight: "+l);p<s.distance&&(s.distance=p,s.predecessor=a,u.decrease(i,p))}var o={},u=new r;n=n||function(){return 1},i=i||(e.isDirected()?function(t){return e.outEdges(t)}:function(t){return e.incidentEdges(t)}),e.eachNode(function(e){var n=e===t?0:Number.POSITIVE_INFINITY;o[e]={distance:n},u.add(e,n)});for(var a,f;u.size()>0&&(a=u.removeMin(),f=o[a],f.distance!==Number.POSITIVE_INFINITY);)i(a).forEach(s);return o}var r=e("cp-data").PriorityQueue;t.exports=n},{"cp-data":19}],32:[function(e,t){function n(e,t,n){var i={};return e.eachNode(function(s){i[s]=r(e,s,t,n)}),i}var r=e("./dijkstra");t.exports=n},{"./dijkstra":31}],33:[function(e,t){function n(e){return r(e).filter(function(e){return e.length>1})}var r=e("./tarjan");t.exports=n},{"./tarjan":39}],34:[function(e,t){function n(e,t,n){var r={},i=e.nodes();return t=t||function(){return 1},n=n||(e.isDirected()?function(t){return e.outEdges(t)}:function(t){return e.incidentEdges(t)}),i.forEach(function(s){r[s]={},r[s][s]={distance:0},i.forEach(function(e){s!==e&&(r[s][e]={distance:Number.POSITIVE_INFINITY})}),n(s).forEach(function(n){var i=e.incidentNodes(n),o=i[0]!==s?i[0]:i[1],u=t(n);u<r[s][o].distance&&(r[s][o]={distance:u,predecessor:s})})}),i.forEach(function(e){var t=r[e];i.forEach(function(n){var s=r[n];i.forEach(function(n){var r=s[e],i=t[n],o=s[n],u=r.distance+i.distance;u<o.distance&&(o.distance=u,o.predecessor=i.predecessor)})})}),r}t.exports=n},{}],35:[function(e,t){function n(e){try{r(e)}catch(t){if(t instanceof r.CycleException)return!1;throw t}return!0}var r=e("./topsort");t.exports=n},{"./topsort":40}],36:[function(e,t){function n(e,t,n){function i(t,r){if(s.has(t))throw new Error("The input graph is not a tree: "+e);s.add(t),e.neighbors(t).forEach(function(e){e!==r&&i(e,t)}),n(t)}var s=new r;if(e.isDirected())throw new Error("This function only works for undirected graphs");i(t)}var r=e("cp-data").Set;t.exports=n},{"cp-data":19}],37:[function(e,t){function n(e,t,n){function i(t,r){if(s.has(t))throw new Error("The input graph is not a tree: "+e);s.add(t),n(t),e.neighbors(t).forEach(function(e){e!==r&&i(e,t)})}var s=new r;if(e.isDirected())throw new Error("This function only works for undirected graphs");i(t)}var r=e("cp-data").Set;t.exports=n},{"cp-data":19}],38:[function(e,t){function n(e,t){function n(n){var r=e.incidentNodes(n),i=r[0]!==s?r[0]:r[1],o=a.priority(i);if(void 0!==o){var f=t(n);o>f&&(u[i]=s,a.decrease(i,f))}}var s,o=new r,u={},a=new i;if(0===e.order())return o;e.eachNode(function(e){a.add(e,Number.POSITIVE_INFINITY),o.addNode(e)}),a.decrease(e.nodes()[0],0);for(var f=!1;a.size()>0;){if(s=a.removeMin(),s in u)o.addEdge(null,s,u[s]);else{if(f)throw new Error("Input graph is not connected: "+e);f=!0}e.incidentEdges(s).forEach(n)}return o}var r=e("../Graph"),i=e("cp-data").PriorityQueue;t.exports=n},{"../Graph":29,"cp-data":19}],39:[function(e,t){function n(e){function t(o){var u=i[o]={onStack:!0,lowlink:n,index:n++};if(r.push(o),e.successors(o).forEach(function(e){e in i?i[e].onStack&&(u.lowlink=Math.min(u.lowlink,i[e].index)):(t(e),u.lowlink=Math.min(u.lowlink,i[e].lowlink))}),u.lowlink===u.index){var l,h=[];do l=r.pop(),i[l].onStack=!1,h.push(l);while(o!==l);s.push(h)}}if(!e.isDirected())throw new Error("tarjan can only be applied to a directed graph. Bad input: "+e);var n=0,r=[],i={},s=[];return e.nodes().forEach(function(e){e in i||t(e)}),s}t.exports=n},{}],40:[function(e,t){function n(e){function t(o){if(o in i)throw new r;o in n||(i[o]=!0,n[o]=!0,e.predecessors(o).forEach(function(e){t(e)}),delete i[o],s.push(o))}if(!e.isDirected())throw new Error("topsort can only be applied to a directed graph. Bad input: "+e);var n={},i={},s=[],o=e.sinks();if(0!==e.order()&&0===o.length)throw new r;return e.sinks().forEach(function(e){t(e)}),s}function r(){}t.exports=n,n.CycleException=r,r.prototype.toString=function(){return"Graph has at least one cycle"}},{}],41:[function(e,t){function n(e){function t(){e.call(this),this._parents={},this._children={},this._children[null]=new r}return t.prototype=new e,t.prototype.constructor=t,t.prototype.parent=function(e,t){if(this._strictGetNode(e),arguments.length<2)return this._parents[e];if(e===t)throw new Error("Cannot make "+e+" a parent of itself");null!==t&&this._strictGetNode(t),this._children[this._parents[e]].remove(e),this._parents[e]=t,this._children[t].add(e)},t.prototype.children=function(e){return null!==e&&this._strictGetNode(e),this._children[e].keys()},t.prototype.addNode=function(t,n){return t=e.prototype.addNode.call(this,t,n),this._parents[t]=null,this._children[t]=new r,this._children[null].add(t),t},t.prototype.delNode=function(t){var n=this.parent(t);return this._children[t].keys().forEach(function(e){this.parent(e,n)},this),this._children[n].remove(t),delete this._parents[t],delete this._children[t],e.prototype.delNode.call(this,t)},t.prototype.copy=function(){var t=e.prototype.copy.call(this);return this.nodes().forEach(function(e){t.parent(e,this.parent(e))},this),t},t.prototype.filterNodes=function(t){function n(e){var t=r.parent(e);return null===t||i.hasNode(t)?(s[e]=t,t):t in s?s[t]:n(t)}var r=this,i=e.prototype.filterNodes.call(this,t),s={};return i.eachNode(function(e){i.parent(e,n(e))}),i},t}var r=e("cp-data").Set;t.exports=n},{"cp-data":19}],42:[function(e,t,n){function r(e){return Object.prototype.toString.call(e).slice(8,-1)}var i=e("../Graph"),s=e("../Digraph"),o=e("../CGraph"),u=e("../CDigraph");n.decode=function(e,t,n){if(n=n||s,"Array"!==r(e))throw new Error("nodes is not an Array");if("Array"!==r(t))throw new Error("edges is not an Array");if("string"==typeof n)switch(n){case"graph":n=i;break;case"digraph":n=s;break;case"cgraph":n=o;break;case"cdigraph":n=u;break;default:throw new Error("Unrecognized graph type: "+n)}var a=new n;return e.forEach(function(e){a.addNode(e.id,e.value)}),a.parent&&e.forEach(function(e){e.children&&e.children.forEach(function(t){a.parent(t,e.id)})}),t.forEach(function(e){a.addEdge(e.id,e.u,e.v,e.value)}),a},n.encode=function(e){var t=[],n=[];e.eachNode(function(n,r){var i={id:n,value:r};if(e.children){var s=e.children(n);s.length&&(i.children=s)}t.push(i)}),e.eachEdge(function(e,t,r,i){n.push({id:e,u:t,v:r,value:i})});var r;if(e instanceof u)r="cdigraph";else if(e instanceof o)r="cgraph";else if(e instanceof s)r="digraph";else{if(!(e instanceof i))throw new Error("Couldn't determine type of graph: "+e);r="graph"}return{nodes:t,edges:n,type:r}}},{"../CDigraph":26,"../CGraph":27,"../Digraph":28,"../Graph":29}],43:[function(e,t,n){var r=e("cp-data").Set;n.all=function(){return function(){return!0}},n.nodesFromList=function(e){var t=new r(e);return function(e){return t.has(e)}}},{"cp-data":19}],44:[function(e){var t=e("./Graph"),n=e("./Digraph");t.prototype.toDigraph=t.prototype.asDirected=function(){var e=new n;return this.eachNode(function(t,n){e.addNode(t,n)}),this.eachEdge(function(t,n,r,i){e.addEdge(null,n,r,i),e.addEdge(null,r,n,i)}),e},n.prototype.toGraph=n.prototype.asUndirected=function(){var e=new t;return this.eachNode(function(t,n){e.addNode(t,n)}),this.eachEdge(function(t,n,r,i){e.addEdge(t,n,r,i)}),e}},{"./Digraph":28,"./Graph":29}],45:[function(e,t,n){n.values=function(e){var t,n=Object.keys(e),r=n.length,i=new Array(r);for(t=0;r>t;++t)i[t]=e[n[t]];return i}},{}],46:[function(e,t){t.exports="0.7.4"},{}]},{},[1]),joint.layout.DirectedGraph={layout:function(e,t){t=t||{};var n=this._prepareData(e),r=dagre.layout();t.debugLevel&&r.debugLevel(t.debugLevel),t.rankDir&&r.rankDir(t.rankDir),t.rankSep&&r.rankSep(t.rankSep),t.edgeSep&&r.edgeSep(t.edgeSep),t.nodeSep&&r.nodeSep(t.nodeSep);var i=r.run(n);var s;i.eachNode(function(n,r){if(!r.dummy){var i=e.getCell(n);if(s===undefined){s=i}t.setPosition?t.setPosition(i,r):e.get("cells").get(n).set("position",{x:r.x-r.width/2,y:r.y-r.height/2});i.toFront()}});if(t.allowChildrenAlignVertically){t.setVertices=jointTransform.util.setVertices;jointTransform.util.setPositions(e,s)}if(t.setLinkVertices){i.eachEdge(function(n,r,i,s){var o=e.getCell(n);if(o){t.setVertices?t.setVertices(e,o,s.points):o.set("vertices",s.points)}})}return{width:i.graph().width,height:i.graph().height}},_prepareData:function(e){var t=new dagre.Digraph;return _.each(e.getElements(),function(e){t.hasNode(e.id)||t.addNode(e.id,{width:e.get("size").width,height:e.get("size").height,rank:e.get("rank")})}),_.each(e.getLinks(),function(e){if(!t.hasEdge(e.id)){var n=e.get("source").id,r=e.get("target").id;t.addEdge(e.id,n,r,{minLen:e.get("minLen")||1})}}),t}},joint.layout.ForceDirected=Backbone.Model.extend({defaults:{linkDistance:10,linkStrength:1,charge:10},initialize:function(){this.elements=this.get("graph").getElements(),this.links=this.get("graph").getLinks(),this.cells=this.get("graph").get("cells"),this.width=this.get("width"),this.height=this.get("height"),this.gravityCenter=this.get("gravityCenter"),this.t=1,this.energy=1/0,this.progress=0},start:function(){var e=this.get("width"),t=this.get("height");_.each(this.elements,function(n){n.set("position",{x:Math.random()*e,y:Math.random()*t}),n.charge=n.get("charge")||this.get("charge"),n.weight=n.get("weight")||1;var r=n.get("position");n.x=r.x,n.y=r.y,n.px=n.x,n.py=n.y,n.fx=0,n.fy=0},this),_.each(this.links,function(e){e.strength=e.get("strength")||this.get("linkStrength"),e.distance=e.get("distance")||this.get("linkDistance"),e.source=this.cells.get(e.get("source").id),e.target=this.cells.get(e.get("target").id)},this)},step:function(){if(.99*this.t<.005)return this.notifyEnd();var e=this.width,t=this.height,n=.1,r=this.gravityCenter,i=this.energy;this.energy=0;var s,o,u=0,a=0,f=0,l=0,c=this.elements.length,h=this.links.length;for(s=0;c-1>s;s++){var p=this.elements[s];for(u+=p.x,a+=p.y,o=s+1;c>o;o++){var d=this.elements[o],v=d.x-p.x,m=d.y-p.y,g=v*v+m*m,y=Math.sqrt(g),b=this.t*p.charge/g,w=b*v,E=b*m;p.fx-=w,p.fy-=E,d.fx+=w,d.fy+=E,this.energy+=w*w+E*E}}for(u+=this.elements[c-1].x,a+=this.elements[c-1].y,s=0;h>s;s++){var S=this.links[s],p=S.source,d=S.target,v=d.x-p.x,m=d.y-p.y,g=v*v+m*m,y=Math.sqrt(g),x=this.t*S.strength*(y-S.distance)/y,w=x*v,E=x*m,T=p.weight/(p.weight+d.weight);p.x+=w*(1-T),p.y+=E*(1-T),d.x-=w*T,d.y-=E*T,this.energy+=w*w+E*E}for(s=0;c>s;s++){var N=this.elements[s],C={x:N.x,y:N.y};r&&(C.x+=(r.x-C.x)*this.t*n,C.y+=(r.y-C.y)*this.t*n),C.x+=N.fx,C.y+=N.fy,C.x=Math.max(0,Math.min(e,C.x)),C.y=Math.max(0,Math.min(t,C.y));var k=.9;C.x+=(N.px-C.x)*k,C.y+=(N.py-C.y)*k,N.px=C.x,N.py=C.y,N.fx=N.fy=0,N.x=C.x,N.y=C.y,f+=N.x,l+=N.y,this.notify(N,s,C)}this.t=this.cool(this.t,this.energy,i);var L=u-f,A=a-l,O=Math.sqrt(L*L+A*A);1>O&&this.notifyEnd()},cool:function(e,t,n){return n>t?(this.progress+=1,this.progress>=5?(this.progress=0,e/.99):e):(this.progress=0,.99*e)},notify:function(e,t,n){e.set("position",n)},notifyEnd:function(){this.trigger("end")}}),joint.layout=joint.layout||{},joint.layout.GridLayout={layout:function(e,t){t=t||{};var n=e.getElements(),r=t.columns||1,i=t.dx||0,s=t.dy||0,o=t.columnWidth||this._maxDim(n,"width")+i,u=t.rowHeight||this._maxDim(n,"height")+s,a=_.isUndefined(t.centralize)||t.centralize!==!1,f=!!t.resizeToFit;_.each(n,function(e,t){var n=0,l=0,c=e.get("size");if(f){var p=o-2*i,v=u-2*s,m=c.height*(c.width?p/c.width:1),y=c.width*(c.height?v/c.height:1);m>u?p=y:v=m,c={width:p,height:v},e.set("size",c)}a&&(n=(o-c.width)/2,l=(u-c.height)/2),e.set("position",{x:t%r*o+i+n,y:Math.floor(t/r)*u+s+l})})},_maxDim:function(e,t){return _.reduce(e,function(e,n){return Math.max(n.get("size")[t],e)},0)}},joint.format.gexf={},joint.format.gexf.toCellsArray=function(e,t,n){var r=new DOMParser,i=r.parseFromString(e,"text/xml");if("parsererror"==i.documentElement.nodeName)throw new Error("Error while parsing GEXF file.");var s=i.documentElement.querySelectorAll("node"),o=i.documentElement.querySelectorAll("edge"),u=[];return _.each(s,function(e){var n=parseFloat(e.querySelector("size").getAttribute("value")),r=t({id:e.getAttribute("id"),width:n,height:n,label:e.getAttribute("label")});u.push(r)}),_.each(o,function(e){var t=n({source:e.getAttribute("source"),target:e.getAttribute("target")});u.unshift(t)}),u},joint.dia.Paper.prototype.toSVG=function(e,t){function n(){return(new XMLSerializer).serializeToString(o)}function r(e){var t=h.shift();return t?(joint.util.imageToDataUri(V(t).attr("href"),function(n,i){V(t).attr("xlink:href",i),r(e)}),void 0):e()}t=t||{};var i=V(this.viewport).attr("transform");V(this.viewport).attr("transform","");var s=this.getContentBBox(),o=this.svg.cloneNode(!0);V(this.viewport).attr("transform",i||""),o.removeAttribute("style"),t.preserveDimensions?V(o).attr({width:s.width,height:s.height}):V(o).attr({width:"100%",height:"100%"}),V(o).attr("viewBox",s.x+" "+s.y+" "+s.width+" "+s.height);for(var u=document.styleSheets.length,a=[],f=u-1;f>=0;f--)a[f]=document.styleSheets[f],document.styleSheets[f].disabled=!0;var l={};$(this.svg).find("*").each(function(e){var t=window.getComputedStyle(this,null),n={};_.each(t,function(e){n[e]=t.getPropertyValue(e)}),l[e]=n}),u!=document.styleSheets.length&&_.each(a,function(e,t){document.styleSheets[t]=e});for(var f=0;u>f;f++)document.styleSheets[f].disabled=!1;var c={};$(this.svg).find("*").each(function(e){var t=window.getComputedStyle(this,null),n=l[e],r={};_.each(t,function(e){t.getPropertyValue(e)!==n[e]&&(r[e]=t.getPropertyValue(e))}),c[e]=r});var h=[];$(o).find("*").each(function(e){$(this).css(c[e]),"image"===this.tagName.toLowerCase()&&h.push(this)});Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0;return t.convertImagesToDataUris&&h.length?(r(function(){e(n())}),void 0):e(n())},joint.dia.Paper.prototype.openAsSVG=function(e){var t="menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes",n=_.uniqueId("svg_output"),r=window.open("",n,t);this.toSVG(function(e){var t="data:image/svg+xml,"+encodeURIComponent(e);r.document.write('<img src="'+t+'" style="max-height:100%" />')},_.extend({convertImagesToDataUris:!0},e))},function(){function e(e){var t={opts:e};t.FRAMERATE=30,t.MAX_VIRTUAL_PIXELS=3e4,t.log=function(){},1==t.opts.log&&"undefined"!=typeof console&&(t.log=function(e){console.log(e)}),t.init=function(e){var n=0;t.UniqueId=function(){return n++,"canvg"+n},t.Definitions={},t.Styles={},t.Animations=[],t.Images=[],t.ctx=e,t.ViewPort=new function(){this.viewPorts=[],this.Clear=function(){this.viewPorts=[]},this.SetCurrent=function(e,t){this.viewPorts.push({width:e,height:t})},this.RemoveCurrent=function(){this.viewPorts.pop()},this.Current=function(){return this.viewPorts[this.viewPorts.length-1]},this.width=function(){return this.Current().width},this.height=function(){return this.Current().height},this.ComputeSize=function(e){return null!=e&&"number"==typeof e?e:"x"==e?this.width():"y"==e?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}},t.init(),t.ImagesLoaded=function(){for(var e=0;e<t.Images.length;e++)if(!t.Images[e].loaded)return!1;return!0},t.trim=function(e){return e.replace(/^\s+|\s+$/g,"")},t.compressSpaces=function(e){return e.replace(/[\s\r\t\n]+/gm," ")},t.ajax=function(e){var t;return t=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),t?(t.open("GET",e,!1),t.send(null),t.responseText):null},t.parseXml=function(e){if("undefined"!=typeof Windows&&"undefined"!=typeof Windows.Data&&"undefined"!=typeof Windows.Data.Xml){var t=new Windows.Data.Xml.Dom.XmlDocument,n=new Windows.Data.Xml.Dom.XmlLoadSettings;return n.prohibitDtd=!1,t.loadXml(e,n),t}if(window.DOMParser){var r=new DOMParser;return r.parseFromString(e,"text/xml")}e=e.replace(/<!DOCTYPE svg[^>]*>/,"");var t=new ActiveXObject("Microsoft.XMLDOM");return t.async="false",t.loadXML(e),t},t.Property=function(e,t){this.name=e,this.value=t},t.Property.prototype.getValue=function(){return this.value},t.Property.prototype.hasValue=function(){return null!=this.value&&""!==this.value},t.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var e=parseFloat(this.value);return(this.value+"").match(/%$/)&&(e/=100),e},t.Property.prototype.valueOrDefault=function(e){return this.hasValue()?this.value:e},t.Property.prototype.numValueOrDefault=function(e){return this.hasValue()?this.numValue():e},t.Property.prototype.addOpacity=function(e){var n=this.value;if(null!=e.value&&""!=e.value&&"string"==typeof this.value){var r=new RGBColor(this.value);r.ok&&(n="rgba("+r.r+", "+r.g+", "+r.b+", "+e.numValue()+")")}return new t.Property(this.name,n)},t.Property.prototype.getDefinition=function(){var e=this.value.match(/#([^\)'"]+)/);return e&&(e=e[1]),e||(e=this.value),t.Definitions[e]},t.Property.prototype.isUrlDefinition=function(){return 0==this.value.indexOf("url(")},t.Property.prototype.getFillStyleDefinition=function(e,n){var r=this.getDefinition();if(null!=r&&r.createGradient)return r.createGradient(t.ctx,e,n);if(null!=r&&r.createPattern){if(r.getHrefAttribute().hasValue()){var i=r.attribute("patternTransform");r=r.getHrefAttribute().getDefinition(),i.hasValue()&&(r.attribute("patternTransform",!0).value=i.value)}return r.createPattern(t.ctx,e)}return null},t.Property.prototype.getDPI=function(){return 96},t.Property.prototype.getEM=function(e){var n=12,r=new t.Property("fontSize",t.Font.Parse(t.ctx.font).fontSize);return r.hasValue()&&(n=r.toPixels(e)),n},t.Property.prototype.getUnits=function(){var e=this.value+"";return e.replace(/[0-9\.\-]/g,"")},t.Property.prototype.toPixels=function(e,n){if(!this.hasValue())return 0;var r=this.value+"";if(r.match(/em$/))return this.numValue()*this.getEM(e);if(r.match(/ex$/))return this.numValue()*this.getEM(e)/2;if(r.match(/px$/))return this.numValue();if(r.match(/pt$/))return this.numValue()*this.getDPI(e)*(1/72);if(r.match(/pc$/))return 15*this.numValue();if(r.match(/cm$/))return this.numValue()*this.getDPI(e)/2.54;if(r.match(/mm$/))return this.numValue()*this.getDPI(e)/25.4;if(r.match(/in$/))return this.numValue()*this.getDPI(e);if(r.match(/%$/))return this.numValue()*t.ViewPort.ComputeSize(e);var i=this.numValue();return n&&1>i?i*t.ViewPort.ComputeSize(e):i},t.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var e=this.value+"";return e.match(/s$/)?1e3*this.numValue():e.match(/ms$/)?this.numValue():this.numValue()},t.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var e=this.value+"";return e.match(/deg$/)?this.numValue()*(Math.PI/180):e.match(/grad$/)?this.numValue()*(Math.PI/200):e.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180)};var n={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};return t.Property.prototype.toTextBaseline=function(){return this.hasValue()?n[this.value]:null},t.Font=new function(){this.Styles="normal|italic|oblique|inherit",this.Variants="normal|small-caps|inherit",this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit",this.CreateFont=function(e,n,r,i,s,o){var u=null!=o?this.Parse(o):this.CreateFont("","","","","",t.ctx.font);return{fontFamily:s||u.fontFamily,fontSize:i||u.fontSize,fontStyle:e||u.fontStyle,fontWeight:r||u.fontWeight,fontVariant:n||u.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var e=this;this.Parse=function(n){for(var r={},i=t.trim(t.compressSpaces(n||"")).split(" "),s={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1},o="",u=0;u<i.length;u++)s.fontStyle||-1==e.Styles.indexOf(i[u])?s.fontVariant||-1==e.Variants.indexOf(i[u])?s.fontWeight||-1==e.Weights.indexOf(i[u])?s.fontSize?"inherit"!=i[u]&&(o+=i[u]):("inherit"!=i[u]&&(r.fontSize=i[u].split("/")[0]),s.fontStyle=s.fontVariant=s.fontWeight=s.fontSize=!0):("inherit"!=i[u]&&(r.fontWeight=i[u]),s.fontStyle=s.fontVariant=s.fontWeight=!0):("inherit"!=i[u]&&(r.fontVariant=i[u]),s.fontStyle=s.fontVariant=!0):("inherit"!=i[u]&&(r.fontStyle=i[u]),s.fontStyle=!0);return""!=o&&(r.fontFamily=o),r}},t.ToNumberArray=function(e){for(var n=t.trim(t.compressSpaces((e||"").replace(/,/g," "))).split(" "),r=0;r<n.length;r++)n[r]=parseFloat(n[r]);return n},t.Point=function(e,t){this.x=e,this.y=t},t.Point.prototype.angleTo=function(e){return Math.atan2(e.y-this.y,e.x-this.x)},t.Point.prototype.applyTransform=function(e){var t=this.x*e[0]+this.y*e[2]+e[4],n=this.x*e[1]+this.y*e[3]+e[5];this.x=t,this.y=n},t.CreatePoint=function(e){var n=t.ToNumberArray(e);return new t.Point(n[0],n[1])},t.CreatePath=function(e){for(var n=t.ToNumberArray(e),r=[],i=0;i<n.length;i+=2)r.push(new t.Point(n[i],n[i+1]));return r},t.BoundingBox=function(e,t,n,r){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN,this.x=function(){return this.x1},this.y=function(){return this.y1},this.width=function(){return this.x2-this.x1},this.height=function(){return this.y2-this.y1},this.addPoint=function(e,t){null!=e&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=e,this.x2=e),e<this.x1&&(this.x1=e),e>this.x2&&(this.x2=e)),null!=t&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=t,this.y2=t),t<this.y1&&(this.y1=t),t>this.y2&&(this.y2=t))},this.addX=function(e){this.addPoint(e,null)},this.addY=function(e){this.addPoint(null,e)},this.addBoundingBox=function(e){this.addPoint(e.x1,e.y1),this.addPoint(e.x2,e.y2)},this.addQuadraticCurve=function(e,t,n,r,i,s){var o=e+2/3*(n-e),u=t+2/3*(r-t),a=o+1/3*(i-e),f=u+1/3*(s-t);this.addBezierCurve(e,t,o,a,u,f,i,s)},this.addBezierCurve=function(e,t,n,r,s,o,u,a){var f=[e,t],l=[n,r],c=[s,o],h=[u,a];for(this.addPoint(f[0],f[1]),this.addPoint(h[0],h[1]),i=0;1>=i;i++){var p=function(e){return Math.pow(1-e,3)*f[i]+3*Math.pow(1-e,2)*e*l[i]+3*(1-e)*Math.pow(e,2)*c[i]+Math.pow(e,3)*h[i]},d=6*f[i]-12*l[i]+6*c[i],v=-3*f[i]+9*l[i]-9*c[i]+3*h[i],m=3*l[i]-3*f[i];if(0!=v){var g=Math.pow(d,2)-4*m*v;if(!(0>g)){var y=(-d+Math.sqrt(g))/(2*v);y>0&&1>y&&(0==i&&this.addX(p(y)),1==i&&this.addY(p(y)));var b=(-d-Math.sqrt(g))/(2*v);b>0&&1>b&&(0==i&&this.addX(p(b)),1==i&&this.addY(p(b)))}}else{if(0==d)continue;var w=-m/d;w>0&&1>w&&(0==i&&this.addX(p(w)),1==i&&this.addY(p(w)))}}},this.isPointInBox=function(e,t){return this.x1<=e&&e<=this.x2&&this.y1<=t&&t<=this.y2},this.addPoint(e,t),this.addPoint(n,r)},t.Transform=function(e){var n=this;this.Type={},this.Type.translate=function(e){this.p=t.CreatePoint(e),this.apply=function(e){e.translate(this.p.x||0,this.p.y||0)},this.unapply=function(e){e.translate(-1*this.p.x||0,-1*this.p.y||0)},this.applyToPoint=function(e){e.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}},this.Type.rotate=function(e){var n=t.ToNumberArray(e);this.angle=new t.Property("angle",n[0]),this.cx=n[1]||0,this.cy=n[2]||0,this.apply=function(e){e.translate(this.cx,this.cy),e.rotate(this.angle.toRadians()),e.translate(-this.cx,-this.cy)},this.unapply=function(e){e.translate(this.cx,this.cy),e.rotate(-1*this.angle.toRadians()),e.translate(-this.cx,-this.cy)},this.applyToPoint=function(e){var t=this.angle.toRadians();e.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]),e.applyTransform([Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t),0,0]),e.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}},this.Type.scale=function(e){this.p=t.CreatePoint(e),this.apply=function(e){e.scale(this.p.x||1,this.p.y||this.p.x||1)},this.unapply=function(e){e.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)},this.applyToPoint=function(e){e.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}},this.Type.matrix=function(e){this.m=t.ToNumberArray(e),this.apply=function(e){e.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},this.unapply=function(e){var t=this.m[0],n=this.m[2],r=this.m[4],i=this.m[1],s=this.m[3],o=this.m[5],u=0,a=0,f=1,l=1/(t*(s*f-o*a)-n*(i*f-o*u)+r*(i*a-s*u));e.transform(l*(s*f-o*a),l*(o*u-i*f),l*(r*a-n*f),l*(t*f-r*u),l*(n*o-r*s),l*(r*i-t*o))},this.applyToPoint=function(e){e.applyTransform(this.m)}},this.Type.SkewBase=function(e){this.base=n.Type.matrix,this.base(e),this.angle=new t.Property("angle",e)},this.Type.SkewBase.prototype=new this.Type.matrix,this.Type.skewX=function(e){this.base=n.Type.SkewBase,this.base(e),this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]},this.Type.skewX.prototype=new this.Type.SkewBase,this.Type.skewY=function(e){this.base=n.Type.SkewBase,this.base(e),this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]},this.Type.skewY.prototype=new this.Type.SkewBase,this.transforms=[],this.apply=function(e){for(var t=0;t<this.transforms.length;t++)this.transforms[t].apply(e)},this.unapply=function(e){for(var t=this.transforms.length-1;t>=0;t--)this.transforms[t].unapply(e)},this.applyToPoint=function(e){for(var t=0;t<this.transforms.length;t++)this.transforms[t].applyToPoint(e)};for(var r=t.trim(t.compressSpaces(e)).replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/),i=0;i<r.length;i++){var s=t.trim(r[i].split("(")[0]),o=r[i].split("(")[1].replace(")",""),u=new this.Type[s](o);u.type=s,this.transforms.push(u)}},t.AspectRatio=function(e,n,r,i,s,o,u,a,f,l){n=t.compressSpaces(n),n=n.replace(/^defer\s/,"");var c=n.split(" ")[0]||"xMidYMid",h=n.split(" ")[1]||"meet",p=r/i,d=s/o,v=Math.min(p,d),m=Math.max(p,d);"meet"==h&&(i*=v,o*=v),"slice"==h&&(i*=m,o*=m),f=new t.Property("refX",f),l=new t.Property("refY",l),f.hasValue()&&l.hasValue()?e.translate(-v*f.toPixels("x"),-v*l.toPixels("y")):(c.match(/^xMid/)&&("meet"==h&&v==d||"slice"==h&&m==d)&&e.translate(r/2-i/2,0),c.match(/YMid$/)&&("meet"==h&&v==p||"slice"==h&&m==p)&&e.translate(0,s/2-o/2),c.match(/^xMax/)&&("meet"==h&&v==d||"slice"==h&&m==d)&&e.translate(r-i,0),c.match(/YMax$/)&&("meet"==h&&v==p||"slice"==h&&m==p)&&e.translate(0,s-o)),"none"==c?e.scale(p,d):"meet"==h?e.scale(v,v):"slice"==h&&e.scale(m,m),e.translate(null==u?0:-u,null==a?0:-a)},t.Element={},t.EmptyProperty=new t.Property("EMPTY",""),t.Element.ElementBase=function(e){if(this.attributes={},this.styles={},this.children=[],this.attribute=function(e,n){var r=this.attributes[e];return null!=r?r:(1==n&&(r=new t.Property(e,""),this.attributes[e]=r),r||t.EmptyProperty)},this.getHrefAttribute=function(){for(var e in this.attributes)if(e.match(/:href$/))return this.attributes[e];return t.EmptyProperty},this.style=function(e,n,r){var i=this.styles[e];if(null!=i)return i;var s=this.attribute(e);if(null!=s&&s.hasValue())return this.styles[e]=s,s;if(1!=r){var o=this.parent;if(null!=o){var u=o.style(e);if(null!=u&&u.hasValue())return u}}return 1==n&&(i=new t.Property(e,""),this.styles[e]=i),i||t.EmptyProperty},this.render=function(e){if("none"!=this.style("display").value&&"hidden"!=this.style("visibility").value){if(e.save(),this.attribute("mask").hasValue()){var t=this.attribute("mask").getDefinition();null!=t&&t.apply(e,this)}else if(this.style("filter").hasValue()){var n=this.style("filter").getDefinition();null!=n&&n.apply(e,this)}else this.setContext(e),this.renderChildren(e),this.clearContext(e);e.restore()}},this.setContext=function(){},this.clearContext=function(){},this.renderChildren=function(e){for(var t=0;t<this.children.length;t++)this.children[t].render(e)},this.addChild=function(e,n){var r=e;n&&(r=t.CreateElement(e)),r.parent=this,"title"!=r.type&&this.children.push(r)},null!=e&&1==e.nodeType){for(var n=0;n<e.attributes.length;n++){var r=e.attributes[n];this.attributes[r.nodeName]=new t.Property(r.nodeName,r.nodeValue)}var i=t.Styles[e.nodeName];if(null!=i)for(var s in i)this.styles[s]=i[s];if(this.attribute("class").hasValue())for(var o=t.compressSpaces(this.attribute("class").value).split(" "),u=0;u<o.length;u++){if(i=t.Styles["."+o[u]],null!=i)for(var s in i)this.styles[s]=i[s];if(i=t.Styles[e.nodeName+"."+o[u]],null!=i)for(var s in i)this.styles[s]=i[s]}if(this.attribute("id").hasValue()){var i=t.Styles["#"+this.attribute("id").value];if(null!=i)for(var s in i)this.styles[s]=i[s]}if(this.attribute("style").hasValue())for(var i=this.attribute("style").value.split(";"),n=0;n<i.length;n++)if(""!=t.trim(i[n])){var a=i[n].split(":"),s=t.trim(a[0]),f=t.trim(a[1]);this.styles[s]=new t.Property(s,f)}this.attribute("id").hasValue()&&null==t.Definitions[this.attribute("id").value]&&(t.Definitions[this.attribute("id").value]=this);for(var n=0;n<e.childNodes.length;n++){var l=e.childNodes[n];if(1==l.nodeType&&this.addChild(l,!0),this.captureTextNodes&&(3==l.nodeType||4==l.nodeType)){var c=l.nodeValue||l.text||"";""!=t.trim(t.compressSpaces(c))&&this.addChild(new t.Element.tspan(l),!1)}}}},t.Element.RenderedElementBase=function(e){this.base=t.Element.ElementBase,this.base(e),this.setContext=function(e){if(this.style("fill").isUrlDefinition()){var n=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity"));null!=n&&(e.fillStyle=n)}else if(this.style("fill").hasValue()){var r=this.style("fill");"currentColor"==r.value&&(r.value=this.style("color").value),e.fillStyle="none"==r.value?"rgba(0,0,0,0)":r.value}if(this.style("fill-opacity").hasValue()){var r=new t.Property("fill",e.fillStyle);r=r.addOpacity(this.style("fill-opacity")),e.fillStyle=r.value}if(this.style("stroke").isUrlDefinition()){var n=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity"));null!=n&&(e.strokeStyle=n)}else if(this.style("stroke").hasValue()){var i=this.style("stroke");"currentColor"==i.value&&(i.value=this.style("color").value),e.strokeStyle="none"==i.value?"rgba(0,0,0,0)":i.value}if(this.style("stroke-opacity").hasValue()){var i=new t.Property("stroke",e.strokeStyle);i=i.addOpacity(this.style("stroke-opacity")),e.strokeStyle=i.value}if(this.style("stroke-width").hasValue()){var s=this.style("stroke-width").toPixels();e.lineWidth=0==s?.001:s}if(this.style("stroke-linecap").hasValue()&&(e.lineCap=this.style("stroke-linecap").value),this.style("stroke-linejoin").hasValue()&&(e.lineJoin=this.style("stroke-linejoin").value),this.style("stroke-miterlimit").hasValue()&&(e.miterLimit=this.style("stroke-miterlimit").value),this.style("stroke-dasharray").hasValue()&&"none"!=this.style("stroke-dasharray").value){var o=t.ToNumberArray(this.style("stroke-dasharray").value);"undefined"!=typeof e.setLineDash?e.setLineDash(o):"undefined"!=typeof e.webkitLineDash?e.webkitLineDash=o:"undefined"==typeof e.mozDash||1==o.length&&0==o[0]||(e.mozDash=o);var u=this.style("stroke-dashoffset").numValueOrDefault(1);"undefined"!=typeof e.lineDashOffset?e.lineDashOffset=u:"undefined"!=typeof e.webkitLineDashOffset?e.webkitLineDashOffset=u:"undefined"!=typeof e.mozDashOffset&&(e.mozDashOffset=u)}if("undefined"!=typeof e.font&&(e.font=t.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString()),this.attribute("transform").hasValue()){var a=new t.Transform(this.attribute("transform").value);a.apply(e)}if(this.style("clip-path",!1,!0).hasValue()){var f=this.style("clip-path",!1,!0).getDefinition();null!=f&&f.apply(e)}this.style("opacity").hasValue()&&(e.globalAlpha=this.style("opacity").numValue())}},t.Element.RenderedElementBase.prototype=new t.Element.ElementBase,t.Element.PathElementBase=function(e){this.base=t.Element.RenderedElementBase,this.base(e),this.path=function(e){return null!=e&&e.beginPath(),new t.BoundingBox},this.renderChildren=function(e){this.path(e),t.Mouse.checkPath(this,e),""!=e.fillStyle&&("inherit"!=this.style("fill-rule").valueOrDefault("inherit")?e.fill(this.style("fill-rule").value):e.fill()),""!=e.strokeStyle&&e.stroke();var n=this.getMarkers();if(null!=n){if(this.style("marker-start").isUrlDefinition()){var r=this.style("marker-start").getDefinition();r.render(e,n[0][0],n[0][1])}if(this.style("marker-mid").isUrlDefinition())for(var r=this.style("marker-mid").getDefinition(),i=1;i<n.length-1;i++)r.render(e,n[i][0],n[i][1]);if(this.style("marker-end").isUrlDefinition()){var r=this.style("marker-end").getDefinition();r.render(e,n[n.length-1][0],n[n.length-1][1])}}},this.getBoundingBox=function(){return this.path()},this.getMarkers=function(){return null}},t.Element.PathElementBase.prototype=new t.Element.RenderedElementBase,t.Element.svg=function(e){this.base=t.Element.RenderedElementBase,this.base(e),this.baseClearContext=this.clearContext,this.clearContext=function(e){this.baseClearContext(e),t.ViewPort.RemoveCurrent()},this.baseSetContext=this.setContext,this.setContext=function(e){e.strokeStyle="rgba(0,0,0,0)",e.lineCap="butt",e.lineJoin="miter",e.miterLimit=4,"undefined"!=typeof e.font&&"undefined"!=typeof window.getComputedStyle&&(e.font=window.getComputedStyle(e.canvas).getPropertyValue("font")),this.baseSetContext(e),this.attribute("x").hasValue()||(this.attribute("x",!0).value=0),this.attribute("y").hasValue()||(this.attribute("y",!0).value=0),e.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var n=t.ViewPort.width(),r=t.ViewPort.height();if(this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%"),this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%"),"undefined"==typeof this.root){n=this.attribute("width").toPixels("x"),r=this.attribute("height").toPixels("y");var i=0,s=0;this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(i=-this.attribute("refX").toPixels("x"),s=-this.attribute("refY").toPixels("y")),"visible"!=this.attribute("overflow").valueOrDefault("hidden")&&(e.beginPath(),e.moveTo(i,s),e.lineTo(n,s),e.lineTo(n,r),e.lineTo(i,r),e.closePath(),e.clip())}if(t.ViewPort.SetCurrent(n,r),this.attribute("viewBox").hasValue()){var o=t.ToNumberArray(this.attribute("viewBox").value),u=o[0],a=o[1];n=o[2],r=o[3],t.AspectRatio(e,this.attribute("preserveAspectRatio").value,t.ViewPort.width(),n,t.ViewPort.height(),r,u,a,this.attribute("refX").value,this.attribute("refY").value),t.ViewPort.RemoveCurrent(),t.ViewPort.SetCurrent(o[2],o[3])}}},t.Element.svg.prototype=new t.Element.RenderedElementBase,t.Element.rect=function(e){this.base=t.Element.PathElementBase,this.base(e),this.path=function(e){var n=this.attribute("x").toPixels("x"),r=this.attribute("y").toPixels("y"),i=this.attribute("width").toPixels("x"),s=this.attribute("height").toPixels("y"),o=this.attribute("rx").toPixels("x"),u=this.attribute("ry").toPixels("y");return this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(u=o),this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(o=u),o=Math.min(o,i/2),u=Math.min(u,s/2),null!=e&&(e.beginPath(),e.moveTo(n+o,r),e.lineTo(n+i-o,r),e.quadraticCurveTo(n+i,r,n+i,r+u),e.lineTo(n+i,r+s-u),e.quadraticCurveTo(n+i,r+s,n+i-o,r+s),e.lineTo(n+o,r+s),e.quadraticCurveTo(n,r+s,n,r+s-u),e.lineTo(n,r+u),e.quadraticCurveTo(n,r,n+o,r),e.closePath()),new t.BoundingBox(n,r,n+i,r+s)}},t.Element.rect.prototype=new t.Element.PathElementBase,t.Element.circle=function(e){this.base=t.Element.PathElementBase,this.base(e),this.path=function(e){var n=this.attribute("cx").toPixels("x"),r=this.attribute("cy").toPixels("y"),i=this.attribute("r").toPixels();return null!=e&&(e.beginPath(),e.arc(n,r,i,0,2*Math.PI,!0),e.closePath()),new t.BoundingBox(n-i,r-i,n+i,r+i)}},t.Element.circle.prototype=new t.Element.PathElementBase,t.Element.ellipse=function(e){this.base=t.Element.PathElementBase,this.base(e),this.path=function(e){var n=4*((Math.sqrt(2)-1)/3),r=this.attribute("rx").toPixels("x"),i=this.attribute("ry").toPixels("y"),s=this.attribute("cx").toPixels("x"),o=this.attribute("cy").toPixels("y");return null!=e&&(e.beginPath(),e.moveTo(s,o-i),e.bezierCurveTo(s+n*r,o-i,s+r,o-n*i,s+r,o),e.bezierCurveTo(s+r,o+n*i,s+n*r,o+i,s,o+i),e.bezierCurveTo(s-n*r,o+i,s-r,o+n*i,s-r,o),e.bezierCurveTo(s-r,o-n*i,s-n*r,o-i,s,o-i),e.closePath()),new t.BoundingBox(s-r,o-i,s+r,o+i)}},t.Element.ellipse.prototype=new t.Element.PathElementBase,t.Element.line=function(e){this.base=t.Element.PathElementBase,this.base(e),this.getPoints=function(){return[new t.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new t.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]},this.path=function(e){var n=this.getPoints();return null!=e&&(e.beginPath(),e.moveTo(n[0].x,n[0].y),e.lineTo(n[1].x,n[1].y)),new t.BoundingBox(n[0].x,n[0].y,n[1].x,n[1].y)},this.getMarkers=function(){var e=this.getPoints(),t=e[0].angleTo(e[1]);return[[e[0],t],[e[1],t]]}},t.Element.line.prototype=new t.Element.PathElementBase,t.Element.polyline=function(e){this.base=t.Element.PathElementBase,this.base(e),this.points=t.CreatePath(this.attribute("points").value),this.path=function(e){var n=new t.BoundingBox(this.points[0].x,this.points[0].y);null!=e&&(e.beginPath(),e.moveTo(this.points[0].x,this.points[0].y));for(var r=1;r<this.points.length;r++)n.addPoint(this.points[r].x,this.points[r].y),null!=e&&e.lineTo(this.points[r].x,this.points[r].y);return n},this.getMarkers=function(){for(var e=[],t=0;t<this.points.length-1;t++)e.push([this.points[t],this.points[t].angleTo(this.points[t+1])]);return e.push([this.points[this.points.length-1],e[e.length-1][1]]),e}},t.Element.polyline.prototype=new t.Element.PathElementBase,t.Element.polygon=function(e){this.base=t.Element.polyline,this.base(e),this.basePath=this.path,this.path=function(e){var t=this.basePath(e);return null!=e&&(e.lineTo(this.points[0].x,this.points[0].y),e.closePath()),t}},t.Element.polygon.prototype=new t.Element.polyline,t.Element.path=function(e){this.base=t.Element.PathElementBase,this.base(e);var n=this.attribute("d").value;n=n.replace(/,/gm," "),n=n.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),n=n.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),n=n.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2"),n=n.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),n=n.replace(/([0-9])([+\-])/gm,"$1 $2"),n=n.replace(/(\.[0-9]*)(\.)/gm,"$1 $2"),n=n.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),n=t.compressSpaces(n),n=t.trim(n),this.PathParser=new function(e){this.tokens=e.split(" "),this.reset=function(){this.i=-1,this.command="",this.previousCommand="",this.start=new t.Point(0,0),this.control=new t.Point(0,0),this.current=new t.Point(0,0),this.points=[],this.angles=[]},this.isEnd=function(){return this.i>=this.tokens.length-1},this.isCommandOrEnd=function(){return this.isEnd()?!0:null!=this.tokens[this.i+1].match(/^[A-Za-z]$/)},this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1},this.getToken=function(){return this.i++,this.tokens[this.i]},this.getScalar=function(){return parseFloat(this.getToken())},this.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},this.getPoint=function(){var e=new t.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(e)},this.getAsControlPoint=function(){var e=this.getPoint();return this.control=e,e},this.getAsCurrentPoint=function(){var e=this.getPoint();return this.current=e,e},this.getReflectedControlPoint=function(){if("c"!=this.previousCommand.toLowerCase()&&"s"!=this.previousCommand.toLowerCase()&&"q"!=this.previousCommand.toLowerCase()&&"t"!=this.previousCommand.toLowerCase())return this.current;var e=new t.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y);return e},this.makeAbsolute=function(e){return this.isRelativeCommand()&&(e.x+=this.current.x,e.y+=this.current.y),e},this.addMarker=function(e,t,n){null!=n&&this.angles.length>0&&null==this.angles[this.angles.length-1]&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(n)),this.addMarkerAngle(e,null==t?null:t.angleTo(e))},this.addMarkerAngle=function(e,t){this.points.push(e),this.angles.push(t)},this.getMarkerPoints=function(){return this.points},this.getMarkerAngles=function(){for(var e=0;e<this.angles.length;e++)if(null==this.angles[e])for(var t=e+1;t<this.angles.length;t++)if(null!=this.angles[t]){this.angles[e]=this.angles[t];break}return this.angles}}(n),this.path=function(e){var n=this.PathParser;n.reset();var r=new t.BoundingBox;for(null!=e&&e.beginPath();!n.isEnd();)switch(n.nextCommand(),n.command){case"M":case"m":var i=n.getAsCurrentPoint();for(n.addMarker(i),r.addPoint(i.x,i.y),null!=e&&e.moveTo(i.x,i.y),n.start=n.current;!n.isCommandOrEnd();){var i=n.getAsCurrentPoint();n.addMarker(i,n.start),r.addPoint(i.x,i.y),null!=e&&e.lineTo(i.x,i.y)}break;case"L":case"l":for(;!n.isCommandOrEnd();){var s=n.current,i=n.getAsCurrentPoint();n.addMarker(i,s),r.addPoint(i.x,i.y),null!=e&&e.lineTo(i.x,i.y)}break;case"H":case"h":for(;!n.isCommandOrEnd();){var o=new t.Point((n.isRelativeCommand()?n.current.x:0)+n.getScalar(),n.current.y);n.addMarker(o,n.current),n.current=o,r.addPoint(n.current.x,n.current.y),null!=e&&e.lineTo(n.current.x,n.current.y)}break;case"V":case"v":for(;!n.isCommandOrEnd();){var o=new t.Point(n.current.x,(n.isRelativeCommand()?n.current.y:0)+n.getScalar());n.addMarker(o,n.current),n.current=o,r.addPoint(n.current.x,n.current.y),null!=e&&e.lineTo(n.current.x,n.current.y)}break;case"C":case"c":for(;!n.isCommandOrEnd();){var u=n.current,a=n.getPoint(),f=n.getAsControlPoint(),l=n.getAsCurrentPoint();n.addMarker(l,f,a),r.addBezierCurve(u.x,u.y,a.x,a.y,f.x,f.y,l.x,l.y),null!=e&&e.bezierCurveTo(a.x,a.y,f.x,f.y,l.x,l.y)}break;case"S":case"s":for(;!n.isCommandOrEnd();){var u=n.current,a=n.getReflectedControlPoint(),f=n.getAsControlPoint(),l=n.getAsCurrentPoint();n.addMarker(l,f,a),r.addBezierCurve(u.x,u.y,a.x,a.y,f.x,f.y,l.x,l.y),null!=e&&e.bezierCurveTo(a.x,a.y,f.x,f.y,l.x,l.y)}break;case"Q":case"q":for(;!n.isCommandOrEnd();){var u=n.current,f=n.getAsControlPoint(),l=n.getAsCurrentPoint();n.addMarker(l,f,f),r.addQuadraticCurve(u.x,u.y,f.x,f.y,l.x,l.y),null!=e&&e.quadraticCurveTo(f.x,f.y,l.x,l.y)}break;case"T":case"t":for(;!n.isCommandOrEnd();){var u=n.current,f=n.getReflectedControlPoint();n.control=f;var l=n.getAsCurrentPoint();n.addMarker(l,f,f),r.addQuadraticCurve(u.x,u.y,f.x,f.y,l.x,l.y),null!=e&&e.quadraticCurveTo(f.x,f.y,l.x,l.y)}break;case"A":case"a":for(;!n.isCommandOrEnd();){var u=n.current,c=n.getScalar(),h=n.getScalar(),p=n.getScalar()*(Math.PI/180),d=n.getScalar(),v=n.getScalar(),l=n.getAsCurrentPoint(),m=new t.Point(Math.cos(p)*(u.x-l.x)/2+Math.sin(p)*(u.y-l.y)/2,-Math.sin(p)*(u.x-l.x)/2+Math.cos(p)*(u.y-l.y)/2),g=Math.pow(m.x,2)/Math.pow(c,2)+Math.pow(m.y,2)/Math.pow(h,2);g>1&&(c*=Math.sqrt(g),h*=Math.sqrt(g));var y=(d==v?-1:1)*Math.sqrt((Math.pow(c,2)*Math.pow(h,2)-Math.pow(c,2)*Math.pow(m.y,2)-Math.pow(h,2)*Math.pow(m.x,2))/(Math.pow(c,2)*Math.pow(m.y,2)+Math.pow(h,2)*Math.pow(m.x,2)));isNaN(y)&&(y=0);var w=new t.Point(y*c*m.y/h,y*-h*m.x/c),E=new t.Point((u.x+l.x)/2+Math.cos(p)*w.x-Math.sin(p)*w.y,(u.y+l.y)/2+Math.sin(p)*w.x+Math.cos(p)*w.y),S=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2))},x=function(e,t){return(e[0]*t[0]+e[1]*t[1])/(S(e)*S(t))},T=function(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(x(e,t))},N=T([1,0],[(m.x-w.x)/c,(m.y-w.y)/h]),C=[(m.x-w.x)/c,(m.y-w.y)/h],k=[(-m.x-w.x)/c,(-m.y-w.y)/h],L=T(C,k);x(C,k)<=-1&&(L=Math.PI),x(C,k)>=1&&(L=0);var A=1-v?1:-1,O=N+A*(L/2),M=new t.Point(E.x+c*Math.cos(O),E.y+h*Math.sin(O));if(n.addMarkerAngle(M,O-A*Math.PI/2),n.addMarkerAngle(l,O-A*Math.PI),r.addPoint(l.x,l.y),null!=e){var x=c>h?c:h,_=c>h?1:c/h,D=c>h?h/c:1;e.translate(E.x,E.y),e.rotate(p),e.scale(_,D),e.arc(0,0,x,N,N+L,1-v),e.scale(1/_,1/D),e.rotate(-p),e.translate(-E.x,-E.y)}}break;case"Z":case"z":null!=e&&e.closePath(),n.current=n.start}return r},this.getMarkers=function(){for(var e=this.PathParser.getMarkerPoints(),t=this.PathParser.getMarkerAngles(),n=[],r=0;r<e.length;r++)n.push([e[r],t[r]]);return n}},t.Element.path.prototype=new t.Element.PathElementBase,t.Element.pattern=function(e){this.base=t.Element.ElementBase,this.base(e),this.createPattern=function(e){var n=this.attribute("width").toPixels("x",!0),r=this.attribute("height").toPixels("y",!0),i=new t.Element.svg;i.attributes.viewBox=new t.Property("viewBox",this.attribute("viewBox").value),i.attributes.width=new t.Property("width",n+"px"),i.attributes.height=new t.Property("height",r+"px"),i.attributes.transform=new t.Property("transform",this.attribute("patternTransform").value),i.children=this.children;var s=document.createElement("canvas");s.width=n,s.height=r;var o=s.getContext("2d");this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&o.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",!0));for(var u=-1;1>=u;u++)for(var a=-1;1>=a;a++)o.save(),o.translate(u*s.width,a*s.height),i.render(o),o.restore();var f=e.createPattern(s,"repeat");return f}},t.Element.pattern.prototype=new t.Element.ElementBase,t.Element.marker=function(e){this.base=t.Element.ElementBase,this.base(e),this.baseRender=this.render,this.render=function(e,n,r){e.translate(n.x,n.y),"auto"==this.attribute("orient").valueOrDefault("auto")&&e.rotate(r),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&e.scale(e.lineWidth,e.lineWidth),e.save();var i=new t.Element.svg;i.attributes.viewBox=new t.Property("viewBox",this.attribute("viewBox").value),i.attributes.refX=new t.Property("refX",this.attribute("refX").value),i.attributes.refY=new t.Property("refY",this.attribute("refY").value),i.attributes.width=new t.Property("width",this.attribute("markerWidth").value),i.attributes.height=new t.Property("height",this.attribute("markerHeight").value),i.attributes.fill=new t.Property("fill",this.attribute("fill").valueOrDefault("black")),i.attributes.stroke=new t.Property("stroke",this.attribute("stroke").valueOrDefault("none")),i.children=this.children,i.render(e),e.restore(),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&e.scale(1/e.lineWidth,1/e.lineWidth),"auto"==this.attribute("orient").valueOrDefault("auto")&&e.rotate(-r),e.translate(-n.x,-n.y)}},t.Element.marker.prototype=new t.Element.ElementBase,t.Element.defs=function(e){this.base=t.Element.ElementBase,this.base(e),this.render=function(){}},t.Element.defs.prototype=new t.Element.ElementBase,t.Element.GradientBase=function(e){this.base=t.Element.ElementBase,this.base(e),this.gradientUnits=this.attribute("gradientUnits").valueOrDefault("objectBoundingBox"),this.stops=[];for(var n=0;n<this.children.length;n++){var r=this.children[n];"stop"==r.type&&this.stops.push(r)}this.getGradient=function(){},this.createGradient=function(e,n,r){var i=this;this.getHrefAttribute().hasValue()&&(i=this.getHrefAttribute().getDefinition());var s=function(e){if(r.hasValue()){var n=new t.Property("color",e);return n.addOpacity(r).value}return e},o=this.getGradient(e,n);if(null==o)return s(i.stops[i.stops.length-1].color);for(var u=0;u<i.stops.length;u++)o.addColorStop(i.stops[u].offset,s(i.stops[u].color));if(this.attribute("gradientTransform").hasValue()){var a=t.ViewPort.viewPorts[0],f=new t.Element.rect;f.attributes.x=new t.Property("x",-t.MAX_VIRTUAL_PIXELS/3),f.attributes.y=new t.Property("y",-t.MAX_VIRTUAL_PIXELS/3),f.attributes.width=new t.Property("width",t.MAX_VIRTUAL_PIXELS),f.attributes.height=new t.Property("height",t.MAX_VIRTUAL_PIXELS);var l=new t.Element.g;l.attributes.transform=new t.Property("transform",this.attribute("gradientTransform").value),l.children=[f];var c=new t.Element.svg;c.attributes.x=new t.Property("x",0),c.attributes.y=new t.Property("y",0),c.attributes.width=new t.Property("width",a.width),c.attributes.height=new t.Property("height",a.height),c.children=[l];var h=document.createElement("canvas");h.width=a.width,h.height=a.height;var p=h.getContext("2d");return p.fillStyle=o,c.render(p),p.createPattern(h,"no-repeat")}return o}},t.Element.GradientBase.prototype=new t.Element.ElementBase,t.Element.linearGradient=function(e){this.base=t.Element.GradientBase,this.base(e),this.getGradient=function(e,t){var n="objectBoundingBox"==this.gradientUnits?t.getBoundingBox():null;this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=0);var r="objectBoundingBox"==this.gradientUnits?n.x()+n.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),i="objectBoundingBox"==this.gradientUnits?n.y()+n.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),s="objectBoundingBox"==this.gradientUnits?n.x()+n.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),o="objectBoundingBox"==this.gradientUnits?n.y()+n.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");return r==s&&i==o?null:e.createLinearGradient(r,i,s,o)}},t.Element.linearGradient.prototype=new t.Element.GradientBase,t.Element.radialGradient=function(e){this.base=t.Element.GradientBase,this.base(e),this.getGradient=function(e,t){var n=t.getBoundingBox();this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%"),this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%"),this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%");var r="objectBoundingBox"==this.gradientUnits?n.x()+n.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),i="objectBoundingBox"==this.gradientUnits?n.y()+n.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),s=r,o=i;this.attribute("fx").hasValue()&&(s="objectBoundingBox"==this.gradientUnits?n.x()+n.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x")),this.attribute("fy").hasValue()&&(o="objectBoundingBox"==this.gradientUnits?n.y()+n.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y"));var u="objectBoundingBox"==this.gradientUnits?(n.width()+n.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels();return e.createRadialGradient(s,o,0,r,i,u)}},t.Element.radialGradient.prototype=new t.Element.GradientBase,t.Element.stop=function(e){this.base=t.Element.ElementBase,this.base(e),this.offset=this.attribute("offset").numValue(),this.offset<0&&(this.offset=0),this.offset>1&&(this.offset=1);var n=this.style("stop-color");this.style("stop-opacity").hasValue()&&(n=n.addOpacity(this.style("stop-opacity"))),this.color=n.value},t.Element.stop.prototype=new t.Element.ElementBase,t.Element.AnimateBase=function(e){this.base=t.Element.ElementBase,this.base(e),t.Animations.push(this),this.duration=0,this.begin=this.attribute("begin").toMilliseconds(),this.maxDuration=this.begin+this.attribute("dur").toMilliseconds(),this.getProperty=function(){var e=this.attribute("attributeType").value,t=this.attribute("attributeName").value;return"CSS"==e?this.parent.style(t,!0):this.parent.attribute(t,!0)},this.initialValue=null,this.initialUnits="",this.removed=!1,this.calcValue=function(){return""},this.update=function(e){if(null==this.initialValue&&(this.initialValue=this.getProperty().value,this.initialUnits=this.getProperty().getUnits()),this.duration>this.maxDuration){if("indefinite"==this.attribute("repeatCount").value||"indefinite"==this.attribute("repeatDur").value)this.duration=0;else if("freeze"!=this.attribute("fill").valueOrDefault("remove")||this.frozen){if("remove"==this.attribute("fill").valueOrDefault("remove")&&!this.removed)return this.removed=!0,this.getProperty().value=this.parent.animationFrozen?this.parent.animationFrozenValue:this.initialValue,!0}else this.frozen=!0,this.parent.animationFrozen=!0,this.parent.animationFrozenValue=this.getProperty().value;return!1}this.duration=this.duration+e;var t=!1;if(this.begin<this.duration){var n=this.calcValue();if(this.attribute("type").hasValue()){var r=this.attribute("type").value;n=r+"("+n+")"}this.getProperty().value=n,t=!0}return t},this.from=this.attribute("from"),this.to=this.attribute("to"),this.values=this.attribute("values"),this.values.hasValue()&&(this.values.value=this.values.value.split(";")),this.progress=function(){var e={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var n=e.progress*(this.values.value.length-1),r=Math.floor(n),i=Math.ceil(n);e.from=new t.Property("from",parseFloat(this.values.value[r])),e.to=new t.Property("to",parseFloat(this.values.value[i])),e.progress=(n-r)/(i-r)}else e.from=this.from,e.to=this.to;return e}},t.Element.AnimateBase.prototype=new t.Element.ElementBase,t.Element.animate=function(e){this.base=t.Element.AnimateBase,this.base(e),this.calcValue=function(){var e=this.progress(),t=e.from.numValue()+(e.to.numValue()-e.from.numValue())*e.progress;return t+this.initialUnits}},t.Element.animate.prototype=new t.Element.AnimateBase,t.Element.animateColor=function(e){this.base=t.Element.AnimateBase,this.base(e),this.calcValue=function(){var e=this.progress(),t=new RGBColor(e.from.value),n=new RGBColor(e.to.value);if(t.ok&&n.ok){var r=t.r+(n.r-t.r)*e.progress,i=t.g+(n.g-t.g)*e.progress,s=t.b+(n.b-t.b)*e.progress;return"rgb("+parseInt(r,10)+","+parseInt(i,10)+","+parseInt(s,10)+")"}return this.attribute("from").value}},t.Element.animateColor.prototype=new t.Element.AnimateBase,t.Element.animateTransform=function(e){this.base=t.Element.AnimateBase,this.base(e),this.calcValue=function(){for(var e=this.progress(),n=t.ToNumberArray(e.from.value),r=t.ToNumberArray(e.to.value),i="",s=0;s<n.length;s++)i+=n[s]+(r[s]-n[s])*e.progress+" ";return i}},t.Element.animateTransform.prototype=new t.Element.animate,t.Element.font=function(e){this.base=t.Element.ElementBase,this.base(e),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.isRTL=!1,this.isArabic=!1,this.fontFace=null,this.missingGlyph=null,this.glyphs=[];for(var n=0;n<this.children.length;n++){var r=this.children[n];"font-face"==r.type?(this.fontFace=r,r.style("font-family").hasValue()&&(t.Definitions[r.style("font-family").value]=this)):"missing-glyph"==r.type?this.missingGlyph=r:"glyph"==r.type&&(""!=r.arabicForm?(this.isRTL=!0,this.isArabic=!0,"undefined"==typeof this.glyphs[r.unicode]&&(this.glyphs[r.unicode]=[]),this.glyphs[r.unicode][r.arabicForm]=r):this.glyphs[r.unicode]=r)}},t.Element.font.prototype=new t.Element.ElementBase,t.Element.fontface=function(e){this.base=t.Element.ElementBase,this.base(e),this.ascent=this.attribute("ascent").value,this.descent=this.attribute("descent").value,this.unitsPerEm=this.attribute("units-per-em").numValue()},t.Element.fontface.prototype=new t.Element.ElementBase,t.Element.missingglyph=function(e){this.base=t.Element.path,this.base(e),this.horizAdvX=0},t.Element.missingglyph.prototype=new t.Element.path,t.Element.glyph=function(e){this.base=t.Element.path,this.base(e),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.unicode=this.attribute("unicode").value,this.arabicForm=this.attribute("arabic-form").value},t.Element.glyph.prototype=new t.Element.path,t.Element.text=function(e){this.captureTextNodes=!0,this.base=t.Element.RenderedElementBase,this.base(e),this.baseSetContext=this.setContext,this.setContext=function(e){this.baseSetContext(e);var t=this.style("dominant-baseline").toTextBaseline();null==t&&(t=this.style("alignment-baseline").toTextBaseline()),null!=t&&(e.textBaseline=t)},this.getBoundingBox=function(){var e=this.attribute("x").toPixels("x"),n=this.attribute("y").toPixels("y"),r=this.parent.style("font-size").numValueOrDefault(t.Font.Parse(t.ctx.font).fontSize);return new t.BoundingBox(e,n-r,e+Math.floor(2*r/3)*this.children[0].getText().length,n)},this.renderChildren=function(e){this.x=this.attribute("x").toPixels("x"),this.y=this.attribute("y").toPixels("y"),this.x+=this.getAnchorDelta(e,this,0);for(var t=0;t<this.children.length;t++)this.renderChild(e,this,t)},this.getAnchorDelta=function(e,t,n){var r=this.style("text-anchor").valueOrDefault("start");if("start"!=r){for(var i=0,s=n;s<t.children.length;s++){var o=t.children[s];if(s>n&&o.attribute("x").hasValue())break;i+=o.measureTextRecursive(e)}return-1*("end"==r?i:i/2)}return 0},this.renderChild=function(e,t,n){var r=t.children[n];r.attribute("x").hasValue()?(r.x=r.attribute("x").toPixels("x")+this.getAnchorDelta(e,t,n),r.attribute("dx").hasValue()&&(r.x+=r.attribute("dx").toPixels("x"))):(this.attribute("dx").hasValue()&&(this.x+=this.attribute("dx").toPixels("x")),r.attribute("dx").hasValue()&&(this.x+=r.attribute("dx").toPixels("x")),r.x=this.x),this.x=r.x+r.measureText(e),r.attribute("y").hasValue()?(r.y=r.attribute("y").toPixels("y"),r.attribute("dy").hasValue()&&(r.y+=r.attribute("dy").toPixels("y"))):(this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),r.attribute("dy").hasValue()&&(this.y+=r.attribute("dy").toPixels("y")),r.y=this.y),this.y=r.y,r.render(e);for(var n=0;n<r.children.length;n++)this.renderChild(e,r,n)}},t.Element.text.prototype=new t.Element.RenderedElementBase,t.Element.TextElementBase=function(e){this.base=t.Element.RenderedElementBase,this.base(e),this.getGlyph=function(e,t,n){var r=t[n],i=null;if(e.isArabic){var s="isolated";(0==n||" "==t[n-1])&&n<t.length-2&&" "!=t[n+1]&&(s="terminal"),n>0&&" "!=t[n-1]&&n<t.length-2&&" "!=t[n+1]&&(s="medial"),n>0&&" "!=t[n-1]&&(n==t.length-1||" "==t[n+1])&&(s="initial"),"undefined"!=typeof e.glyphs[r]&&(i=e.glyphs[r][s],null==i&&"glyph"==e.glyphs[r].type&&(i=e.glyphs[r]))}else i=e.glyphs[r];return null==i&&(i=e.missingGlyph),i},this.renderChildren=function(e){var n=this.parent.style("font-family").getDefinition();if(null==n)""!=e.fillStyle&&e.fillText(t.compressSpaces(this.getText()),this.x,this.y),""!=e.strokeStyle&&e.strokeText(t.compressSpaces(this.getText()),this.x,this.y);else{var r=this.parent.style("font-size").numValueOrDefault(t.Font.Parse(t.ctx.font).fontSize),i=this.parent.style("font-style").valueOrDefault(t.Font.Parse(t.ctx.font).fontStyle),s=this.getText();n.isRTL&&(s=s.split("").reverse().join(""));for(var o=t.ToNumberArray(this.parent.attribute("dx").value),u=0;u<s.length;u++){var a=this.getGlyph(n,s,u),f=r/n.fontFace.unitsPerEm;e.translate(this.x,this.y),e.scale(f,-f);var l=e.lineWidth;e.lineWidth=e.lineWidth*n.fontFace.unitsPerEm/r,"italic"==i&&e.transform(1,0,.4,1,0,0),a.render(e),"italic"==i&&e.transform(1,0,-.4,1,0,0),e.lineWidth=l,e.scale(1/f,-1/f),e.translate(-this.x,-this.y),this.x+=r*(a.horizAdvX||n.horizAdvX)/n.fontFace.unitsPerEm,"undefined"==typeof o[u]||isNaN(o[u])||(this.x+=o[u])}}},this.getText=function(){},this.measureTextRecursive=function(e){for(var t=this.measureText(e),n=0;n<this.children.length;n++)t+=this.children[n].measureTextRecursive(e);return t},this.measureText=function(e){var n=this.parent.style("font-family").getDefinition();if(null!=n){var r=this.parent.style("font-size").numValueOrDefault(t.Font.Parse(t.ctx.font).fontSize),i=0,s=this.getText();n.isRTL&&(s=s.split("").reverse().join(""));for(var o=t.ToNumberArray(this.parent.attribute("dx").value),u=0;u<s.length;u++){var a=this.getGlyph(n,s,u);i+=(a.horizAdvX||n.horizAdvX)*r/n.fontFace.unitsPerEm,"undefined"==typeof o[u]||isNaN(o[u])||(i+=o[u])}return i}var f=t.compressSpaces(this.getText());if(!e.measureText)return 10*f.length;e.save(),this.setContext(e);var l=e.measureText(f).width;return e.restore(),l}},t.Element.TextElementBase.prototype=new t.Element.RenderedElementBase,t.Element.tspan=function(e){this.captureTextNodes=!0,this.base=t.Element.TextElementBase,this.base(e),this.text=e.nodeValue||e.text||"",this.getText=function(){return this.text}},t.Element.tspan.prototype=new t.Element.TextElementBase,t.Element.tref=function(e){this.base=t.Element.TextElementBase,this.base(e),this.getText=function(){var e=this.getHrefAttribute().getDefinition();return null!=e?e.children[0].getText():void 0}},t.Element.tref.prototype=new t.Element.TextElementBase,t.Element.a=function(e){this.base=t.Element.TextElementBase,this.base(e),this.hasText=!0;for(var n=0;n<e.childNodes.length;n++)3!=e.childNodes[n].nodeType&&(this.hasText=!1);this.text=this.hasText?e.childNodes[0].nodeValue:"",this.getText=function(){return this.text},this.baseRenderChildren=this.renderChildren,this.renderChildren=function(e){if(this.hasText){this.baseRenderChildren(e);var n=new t.Property("fontSize",t.Font.Parse(t.ctx.font).fontSize);t.Mouse.checkBoundingBox(this,new t.BoundingBox(this.x,this.y-n.toPixels("y"),this.x+this.measureText(e),this.y))}else{var r=new t.Element.g;r.children=this.children,r.parent=this,r.render(e)}},this.onclick=function(){window.open(this.getHrefAttribute().value)},this.onmousemove=function(){t.ctx.canvas.style.cursor="pointer"}},t.Element.a.prototype=new t.Element.TextElementBase,t.Element.image=function(e){this.base=t.Element.RenderedElementBase,this.base(e);var n=this.getHrefAttribute().value;if(""!=n){var r=n.match(/\.svg$/);if(t.Images.push(this),this.loaded=!1,r)this.img=t.ajax(n),this.loaded=!0;else{this.img=document.createElement("img"),1==t.opts.useCORS&&(this.img.crossOrigin="Anonymous");var i=this;this.img.onload=function(){i.loaded=!0},this.img.onerror=function(){t.log('ERROR: image "'+n+'" not found'),i.loaded=!0},this.img.src=n}this.renderChildren=function(e){var n=this.attribute("x").toPixels("x"),i=this.attribute("y").toPixels("y"),s=this.attribute("width").toPixels("x"),o=this.attribute("height").toPixels("y");0!=s&&0!=o&&(e.save(),r?e.drawSvg(this.img,n,i,s,o):(e.translate(n,i),t.AspectRatio(e,this.attribute("preserveAspectRatio").value,s,this.img.width,o,this.img.height,0,0),e.drawImage(this.img,0,0)),e.restore())},this.getBoundingBox=function(){var e=this.attribute("x").toPixels("x"),n=this.attribute("y").toPixels("y"),r=this.attribute("width").toPixels("x"),i=this.attribute("height").toPixels("y");return new t.BoundingBox(e,n,e+r,n+i)}}},t.Element.image.prototype=new t.Element.RenderedElementBase,t.Element.g=function(e){this.base=t.Element.RenderedElementBase,this.base(e),this.getBoundingBox=function(){for(var e=new t.BoundingBox,n=0;n<this.children.length;n++)e.addBoundingBox(this.children[n].getBoundingBox());return e}},t.Element.g.prototype=new t.Element.RenderedElementBase,t.Element.symbol=function(e){this.base=t.Element.RenderedElementBase,this.base(e),this.render=function(){}},t.Element.symbol.prototype=new t.Element.RenderedElementBase,t.Element.style=function(e){this.base=t.Element.ElementBase,this.base(e);for(var n="",r=0;r<e.childNodes.length;r++)n+=e.childNodes[r].nodeValue;n=n.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,""),n=t.compressSpaces(n);for(var i=n.split("}"),r=0;r<i.length;r++)if(""!=t.trim(i[r]))for(var s=i[r].split("{"),o=s[0].split(","),u=s[1].split(";"),a=0;a<o.length;a++){var f=t.trim(o[a]);if(""!=f){for(var l={},c=0;c<u.length;c++){var h=u[c].indexOf(":"),p=u[c].substr(0,h),d=u[c].substr(h+1,u[c].length-h);null!=p&&null!=d&&(l[t.trim(p)]=new t.Property(t.trim(p),t.trim(d)))}if(t.Styles[f]=l,"@font-face"==f)for(var v=l["font-family"].value.replace(/"/g,""),m=l.src.value.split(","),g=0;g<m.length;g++)if(m[g].indexOf('format("svg")')>0)for(var y=m[g].indexOf("url"),w=m[g].indexOf(")",y),E=m[g].substr(y+5,w-y-6),S=t.parseXml(t.ajax(E)),x=S.getElementsByTagName("font"),T=0;T<x.length;T++){var N=t.CreateElement(x[T]);t.Definitions[v]=N}}}},t.Element.style.prototype=new t.Element.ElementBase,t.Element.use=function(e){this.base=t.Element.RenderedElementBase,this.base(e),this.baseSetContext=this.setContext,this.setContext=function(e){this.baseSetContext(e),this.attribute("x").hasValue()&&e.translate(this.attribute("x").toPixels("x"),0),this.attribute("y").hasValue()&&e.translate(0,this.attribute("y").toPixels("y"))};var n=this.getHrefAttribute().getDefinition();this.path=function(e){null!=n&&n.path(e)},this.getBoundingBox=function(){return null!=n?n.getBoundingBox():void 0},this.renderChildren=function(e){if(null!=n){var r=n;"symbol"==n.type&&(r=new t.Element.svg,r.type="svg",r.attributes.viewBox=new t.Property("viewBox",n.attribute("viewBox").value),r.attributes.preserveAspectRatio=new t.Property("preserveAspectRatio",n.attribute("preserveAspectRatio").value),r.attributes.overflow=new t.Property("overflow",n.attribute("overflow").value),r.children=n.children),"svg"==r.type&&(this.attribute("width").hasValue()&&(r.attributes.width=new t.Property("width",this.attribute("width").value)),this.attribute("height").hasValue()&&(r.attributes.height=new t.Property("height",this.attribute("height").value)));var i=r.parent;r.parent=null,r.render(e),r.parent=i}}},t.Element.use.prototype=new t.Element.RenderedElementBase,t.Element.mask=function(e){this.base=t.Element.ElementBase,this.base(e),this.apply=function(e,n){var r=this.attribute("x").toPixels("x"),i=this.attribute("y").toPixels("y"),s=this.attribute("width").toPixels("x"),o=this.attribute("height").toPixels("y");if(0==s&&0==o){for(var u=new t.BoundingBox,a=0;a<this.children.length;a++)u.addBoundingBox(this.children[a].getBoundingBox());var r=Math.floor(u.x1),i=Math.floor(u.y1),s=Math.floor(u.width()),o=Math.floor(u.height())}var f=n.attribute("mask").value;n.attribute("mask").value="";var l=document.createElement("canvas");l.width=r+s,l.height=i+o;var c=l.getContext("2d");this.renderChildren(c);var h=document.createElement("canvas");h.width=r+s,h.height=i+o;var p=h.getContext("2d");n.render(p),p.globalCompositeOperation="destination-in",p.fillStyle=c.createPattern(l,"no-repeat"),p.fillRect(0,0,r+s,i+o),e.fillStyle=p.createPattern(h,"no-repeat"),e.fillRect(0,0,r+s,i+o),n.attribute("mask").value=f},this.render=function(){}},t.Element.mask.prototype=new t.Element.ElementBase,t.Element.clipPath=function(e){this.base=t.Element.ElementBase,this.base(e),this.apply=function(e){var n=CanvasRenderingContext2D.prototype.beginPath;CanvasRenderingContext2D.prototype.beginPath=function(){};var r=CanvasRenderingContext2D.prototype.closePath;CanvasRenderingContext2D.prototype.closePath=function(){},n.call(e);for(var i=0;i<this.children.length;i++){var s=this.children[i];if("undefined"!=typeof s.path){var o=null;s.attribute("transform").hasValue()&&(o=new t.Transform(s.attribute("transform").value),o.apply(e)),s.path(e),CanvasRenderingContext2D.prototype.closePath=r,o&&o.unapply(e)}}r.call(e),e.clip(),CanvasRenderingContext2D.prototype.beginPath=n,CanvasRenderingContext2D.prototype.closePath=r},this.render=function(){}},t.Element.clipPath.prototype=new t.Element.ElementBase,t.Element.filter=function(e){this.base=t.Element.ElementBase,this.base(e),this.apply=function(e,t){var n=t.getBoundingBox(),r=Math.floor(n.x1),i=Math.floor(n.y1),s=Math.floor(n.width()),o=Math.floor(n.height()),u=t.style("filter").value;t.style("filter").value="";for(var a=0,f=0,l=0;l<this.children.length;l++){var c=this.children[l].extraFilterDistance||0;a=Math.max(a,c),f=Math.max(f,c)}var h=document.createElement("canvas");h.width=s+2*a,h.height=o+2*f;var p=h.getContext("2d");p.translate(-r+a,-i+f),t.render(p);for(var l=0;l<this.children.length;l++)this.children[l].apply(p,0,0,s+2*a,o+2*f);e.drawImage(h,0,0,s+2*a,o+2*f,r-a,i-f,s+2*a,o+2*f),t.style("filter",!0).value=u},this.render=function(){}},t.Element.filter.prototype=new t.Element.ElementBase,t.Element.feMorphology=function(e){this.base=t.Element.ElementBase,this.base(e),this.apply=function(){}},t.Element.feMorphology.prototype=new t.Element.ElementBase,t.Element.feComposite=function(e){this.base=t.Element.ElementBase,this.base(e),this.apply=function(){}},t.Element.feComposite.prototype=new t.Element.ElementBase,t.Element.feColorMatrix=function(e){function n(e,t,n,r,i,s){return e[n*r*4+4*t+s]}function r(e,t,n,r,i,s,o){e[n*r*4+4*t+s]=o}function i(e,t){var n=s[e];return n*(0>n?t-255:t)}this.base=t.Element.ElementBase,this.base(e);var s=t.ToNumberArray(this.attribute("values").value);switch(this.attribute("type").valueOrDefault("matrix")){case"saturate":var o=s[0];s=[.213+.787*o,.715-.715*o,.072-.072*o,0,0,.213-.213*o,.715+.285*o,.072-.072*o,0,0,.213-.213*o,.715-.715*o,.072+.928*o,0,0,0,0,0,1,0,0,0,0,0,1];break;case"hueRotate":var u=s[0]*Math.PI/180,a=function(e,t,n){return e+Math.cos(u)*t+Math.sin(u)*n};s=[a(.213,.787,-.213),a(.715,-.715,-.715),a(.072,-.072,.928),0,0,a(.213,-.213,.143),a(.715,.285,.14),a(.072,-.072,-.283),0,0,a(.213,-.213,-.787),a(.715,-.715,.715),a(.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break;case"luminanceToAlpha":s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1]}this.apply=function(e,t,s,o,u){for(var a=e.getImageData(0,0,o,u),s=0;u>s;s++)for(var t=0;o>t;t++){var f=n(a.data,t,s,o,u,0),l=n(a.data,t,s,o,u,1),h=n(a.data,t,s,o,u,2),p=n(a.data,t,s,o,u,3);r(a.data,t,s,o,u,0,i(0,f)+i(1,l)+i(2,h)+i(3,p)+i(4,1)),r(a.data,t,s,o,u,1,i(5,f)+i(6,l)+i(7,h)+i(8,p)+i(9,1)),r(a.data,t,s,o,u,2,i(10,f)+i(11,l)+i(12,h)+i(13,p)+i(14,1)),r(a.data,t,s,o,u,3,i(15,f)+i(16,l)+i(17,h)+i(18,p)+i(19,1))}e.clearRect(0,0,o,u),e.putImageData(a,0,0)}},t.Element.feColorMatrix.prototype=new t.Element.ElementBase,t.Element.feGaussianBlur=function(e){this.base=t.Element.ElementBase,this.base(e),this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue()),this.extraFilterDistance=this.blurRadius,this.apply=function(e,n,r,i,s){return"undefined"==typeof stackBlurCanvasRGBA?(t.log("ERROR: StackBlur.js must be included for blur to work"),void 0):(e.canvas.id=t.UniqueId(),e.canvas.style.display="none",document.body.appendChild(e.canvas),stackBlurCanvasRGBA(e.canvas.id,n,r,i,s,this.blurRadius),document.body.removeChild(e.canvas),void 0)}},t.Element.feGaussianBlur.prototype=new t.Element.ElementBase,t.Element.title=function(){},t.Element.title.prototype=new t.Element.ElementBase,t.Element.desc=function(){},t.Element.desc.prototype=new t.Element.ElementBase,t.Element.MISSING=function(e){t.log("ERROR: Element '"+e.nodeName+"' not yet implemented.")},t.Element.MISSING.prototype=new t.Element.ElementBase,t.CreateElement=function(e){var n=e.nodeName.replace(/^[^:]+:/,"");n=n.replace(/\-/g,"");var r=null;return r="undefined"!=typeof t.Element[n]?new t.Element[n](e):new t.Element.MISSING(e),r.type=e.nodeName,r},t.load=function(e,n){t.loadXml(e,t.ajax(n))},t.loadXml=function(e,n){t.loadXmlDoc(e,t.parseXml(n))},t.loadXmlDoc=function(e,n){t.init(e);var r=function(t){for(var n=e.canvas;n;)t.x-=n.offsetLeft,t.y-=n.offsetTop,n=n.offsetParent;return window.scrollX&&(t.x+=window.scrollX),window.scrollY&&(t.y+=window.scrollY),t};1!=t.opts.ignoreMouse&&(e.canvas.onclick=function(e){var n=r(new t.Point(null!=e?e.clientX:event.clientX,null!=e?e.clientY:event.clientY));t.Mouse.onclick(n.x,n.y)},e.canvas.onmousemove=function(e){var n=r(new t.Point(null!=e?e.clientX:event.clientX,null!=e?e.clientY:event.clientY));t.Mouse.onmousemove(n.x,n.y)});var i=t.CreateElement(n.documentElement);i.root=!0;var s=!0,o=function(){t.ViewPort.Clear(),e.canvas.parentNode&&t.ViewPort.SetCurrent(e.canvas.parentNode.clientWidth,e.canvas.parentNode.clientHeight),1!=t.opts.ignoreDimensions&&(i.style("width").hasValue()&&(e.canvas.width=i.style("width").toPixels("x"),e.canvas.style.width=e.canvas.width+"px"),i.style("height").hasValue()&&(e.canvas.height=i.style("height").toPixels("y"),e.canvas.style.height=e.canvas.height+"px"));var r=e.canvas.clientWidth||e.canvas.width,o=e.canvas.clientHeight||e.canvas.height;if(1==t.opts.ignoreDimensions&&i.style("width").hasValue()&&i.style("height").hasValue()&&(r=i.style("width").toPixels("x"),o=i.style("height").toPixels("y")),t.ViewPort.SetCurrent(r,o),null!=t.opts.offsetX&&(i.attribute("x",!0).value=t.opts.offsetX),null!=t.opts.offsetY&&(i.attribute("y",!0).value=t.opts.offsetY),null!=t.opts.scaleWidth||null!=t.opts.scaleHeight){var u=null,l=null,h=t.ToNumberArray(i.attribute("viewBox").value);null!=t.opts.scaleWidth&&(i.attribute("width").hasValue()?u=i.attribute("width").toPixels("x")/t.opts.scaleWidth:isNaN(h[2])||(u=h[2]/t.opts.scaleWidth)),null!=t.opts.scaleHeight&&(i.attribute("height").hasValue()?l=i.attribute("height").toPixels("y")/t.opts.scaleHeight:isNaN(h[3])||(l=h[3]/t.opts.scaleHeight)),null==u&&(u=l),null==l&&(l=u),i.attribute("width",!0).value=t.opts.scaleWidth,i.attribute("height",!0).value=t.opts.scaleHeight,i.attribute("transform",!0).value+=" scale("+1/u+","+1/l+")"}1!=t.opts.ignoreClear&&e.clearRect(0,0,r,o),i.render(e),s&&(s=!1,"function"==typeof t.opts.renderCallback&&t.opts.renderCallback(n))},u=!0;t.ImagesLoaded()&&(u=!1,o()),t.intervalID=setInterval(function(){var e=!1;if(u&&t.ImagesLoaded()&&(u=!1,e=!0),1!=t.opts.ignoreMouse&&(e|=t.Mouse.hasEvents()),1!=t.opts.ignoreAnimation)for(var n=0;n<t.Animations.length;n++)e|=t.Animations[n].update(1e3/t.FRAMERATE);"function"==typeof t.opts.forceRedraw&&1==t.opts.forceRedraw()&&(e=!0),e&&(o(),t.Mouse.runEvents())},1e3/t.FRAMERATE)},t.stop=function(){t.intervalID&&clearInterval(t.intervalID)},t.Mouse=new function(){this.events=[],this.hasEvents=function(){return 0!=this.events.length},this.onclick=function(e,t){this.events.push({type:"onclick",x:e,y:t,run:function(e){e.onclick&&e.onclick()}})},this.onmousemove=function(e,t){this.events.push({type:"onmousemove",x:e,y:t,run:function(e){e.onmousemove&&e.onmousemove()}})},this.eventElements=[],this.checkPath=function(e,t){for(var n=0;n<this.events.length;n++){var r=this.events[n];t.isPointInPath&&t.isPointInPath(r.x,r.y)&&(this.eventElements[n]=e)}},this.checkBoundingBox=function(e,t){for(var n=0;n<this.events.length;n++){var r=this.events[n];t.isPointInBox(r.x,r.y)&&(this.eventElements[n]=e)}},this.runEvents=function(){t.ctx.canvas.style.cursor="";for(var e=0;e<this.events.length;e++)for(var n=this.events[e],r=this.eventElements[e];r;)n.run(r),r=r.parent;this.events=[],this.eventElements=[]}},t}this.canvg=function(t,n,r){if(null!=t||null!=n||null!=r){"string"==typeof t&&(t=document.getElementById(t)),null!=t.svg&&t.svg.stop();var i=e(r||{});(1!=t.childNodes.length||"OBJECT"!=t.childNodes[0].nodeName)&&(t.svg=i);var s=t.getContext("2d");"undefined"!=typeof n.documentElement?i.loadXmlDoc(s,n):"<"==n.substr(0,1)?i.loadXml(s,n):i.load(s,n)}else for(var o=document.querySelectorAll("svg"),u=0;u<o.length;u++){var f=o[u],l=document.createElement("canvas");l.width=f.clientWidth,l.height=f.clientHeight,f.parentNode.insertBefore(l,f),f.parentNode.removeChild(f);var c=document.createElement("div");c.appendChild(f),canvg(l,c.innerHTML)}}}(),"undefined"!=typeof CanvasRenderingContext2D&&(CanvasRenderingContext2D.prototype.drawSvg=function(e,t,n,r,i){canvg(this.canvas,e,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:t,offsetY:n,scaleWidth:r,scaleHeight:i})});var mul_table=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],shg_table=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];if(joint.dia.Paper.prototype.toDataURL=function(e,t){if("function"!=typeof this.toSVG)throw new Error("The joint.format.svg.js plugin must be loaded.");t=t||{};var n,r,i,s,o=t.padding||0;if(t.width&&t.height)n=t.width,r=t.height,o=Math.min(o,n/2-1,r/2-1),s=n-2*o,i=r-2*o;else{var u=this.viewport.getBoundingClientRect();s=u.width||1,i=u.height||1,n=s+2*o,r=i+2*o}var a,f=new Image;f.onload=function(){function u(){v=document.createElement("canvas"),v.width=n,v.height=r,p=v.getContext("2d"),p.fillStyle=t.backgroundColor||"white",p.fillRect(0,0,n,r)}function l(e){return e.replace(/\<image[^>]*>/g,function(e){var t=e.match(/href="([^"]*)"/)[1],n="data:image/svg+xml";if(t.substr(0,n.length)===n){var r=decodeURIComponent(t.substr(t.indexOf(",")+1));return r.substr(r.indexOf("<svg"))}return e})}var h,p,v;u();try{p.drawImage(f,o,o,s,i),h=v.toDataURL(t.type,t.quality),e(h)}catch(m){if("undefined"==typeof canvg)return console.error("Canvas tainted. Canvg library required.");u();var y={ignoreDimensions:!0,ignoreClear:!0,offsetX:o,offsetY:o,useCORS:!0};return canvg(v,a,_.extend({},y,{renderCallback:function(){try{h=v.toDataURL(t.type,t.quality),e(h)}catch(n){a=l(a),u(),canvg(v,a,_.extend({},y,{renderCallback:function(){h=v.toDataURL(t.type,t.quality),e(h)}}))}}})),void 0}},this.toSVG(function(e){a=e=e.replace('width="100%"','width="'+s+'"').replace('height="100%"','height="'+i+'"'),f.src="data:image/svg+xml,"+encodeURIComponent(e)},{convertImagesToDataUris:!0})},joint.dia.Paper.prototype.toPNG=function(e,t){t=t||{},t.type="image/png",this.toDataURL(e,t)},joint.dia.Paper.prototype.toJPEG=function(e,t){t=t||{},t.type="image/jpeg",this.toDataURL(e,t)},joint.dia.Paper.prototype.openAsPNG=function(e){var t="menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes",n=_.uniqueId("png_output"),r=window.open("",n,t);this.toPNG(function(e){r.document.write('<img src="'+e+'"/>')},_.extend({padding:10},e))},function(){function e(e,t){var n=V(this.svg),r=e.paddingLeft||e.padding,i=e.paddingRight||e.padding,s=e.paddingTop||e.padding,o=e.paddingBottom||e.padding,u=this.getContentBBox().moveAndExpand({x:-r,y:-s,width:r+i,height:s+o});t.attrs={width:n.attr("width"),height:n.attr("height"),viewBox:n.attr("viewBox")},t.scrollLeft=this.el.scrollLeft,t.scrollTop=this.el.scrollTop,n.attr({width:"100%",height:"100%",viewBox:[u.x,u.y,u.width,u.height].join(" ")}),this.$el.addClass("printarea").addClass(e.size),e.detachBody&&(t.$parent=this.$el.parent(),t.index=t.$parent.children().index(this.$el),t.$content=$(document.body).children().detach(),this.$el.appendTo(document.body))}function t(e,t){var n=V(this.svg),r=!!window.chrome&&!window.opera,i=navigator.userAgent.toLowerCase().indexOf("firefox")>-1;!r&&!i||t.attrs.viewBox||(n.node.removeAttributeNS(null,"viewBox"),delete t.attrs.viewBox),n.attr(t.attrs),this.$el.removeClass("printarea").removeClass(e.size),e.detachBody&&(t.$parent.children().length?t.$parent.children().eq(t.index).before(this.$el):this.$el.appendTo(t.$parent),t.$content.appendTo(document.body)),this.el.scrollLeft=t.scrollLeft,this.el.scrollTop=t.scrollTop}var n="onbeforeprint"in window;joint.dia.Paper.prototype.print=function(r){r=r||{},_.defaults(r,{size:"a4",padding:5,detachBody:!0});var i={},s=_.bind(e,this,r,i),o=_.bind(t,this,r,i);if(n?($(window).one("beforeprint",s),$(window).one("afterprint",o)):s(),window.print(),!n){var u=_.once(o);$(document).one("mouseover",u),_.delay(u,1e3)}}}(),"object"==typeof exports)var joint={com:{},util:require("../../../src/core").util},WebSocketServer=require("ws").Server,WebSocket=require("ws"),_=require("lodash"),url=require("url"),Backbone=require("backbone");joint.com=joint.com||{},joint.com.Channel=function(e){if(this.options=e,!this.options||!this.options.graph)throw new Error("Channel: missing a graph.");this.options.ttl=this.options.ttl||60,this.options.healthCheckInterval=this.options.healthCheckInterval||36e5,this.options.reconnectInterval=this.options.reconnectInterval||1e4,this._isClient=!!this.options.url,this._clients=[],this.messageQueue=[],this.id=this.options.id||(this._isClient?"c_":"s_")+joint.util.uuid(),this.state={},this.state[this.id]=0,this.sites={},this.sites[this.id]={socket:void 0,outgoing:[],ttl:this.options.ttl},this.initialize()},_.extend(joint.com.Channel.prototype,Backbone.Events),joint.com.Channel.prototype.initialize=function(){this.options.graph.on("all",this.onGraphChange.bind(this)),this._isClient?this.connectClient():this.options.port&&(this.server=new WebSocketServer({port:this.options.port}),this.server.on("connection",this.onConnection.bind(this))),this._isClient||(this._healthCheckInterval=setInterval(this.healthCheck.bind(this),this.options.healthCheckInterval))},joint.com.Channel.prototype.connectClient=function(){var e=this.options.url+"/?channelId="+this.id+"&state="+JSON.stringify(this.state)+(this.options.query?"&query="+JSON.stringify(this.options.query):"");this.options.debugLevel>0&&this.log("connectClient",e);var t=new WebSocket(e);t.onopen=this.onConnection.bind(this,t),t.onclose=this.onClose.bind(this,t)},joint.com.Channel.prototype.close=function(){this._reconnectTimeout&&clearTimeout(this._reconnectTimeout),this._healthCheckInterval&&clearInterval(this._healthCheckInterval),this._closed=!0,_.each(this.sites,function(e){e.socket&&e.socket.close()}),this.server&&this.server.close()},joint.com.Channel.prototype.healthCheck=function(){this.options.debugLevel>0&&this.log("healthCheck",_.object(_.keys(this.sites),_.pluck(this.sites,"ttl"))),_.each(this.sites,function(e,t){t!==this.id&&(e.socket&&1===e.socket.readyState?e.ttl=this.options.ttl:e.ttl-=1,e.ttl<=0&&(delete this.sites[t],delete this.state[t]))},this)},joint.com.Channel.prototype.onConnection=function(e){if(this._clients.push(e),this._isClient)this.sites[this.id].socket=e,e.onmessage=function(t){this.onMessage(e,t.data)}.bind(this);else{var t=url.parse(e.upgradeReq.url,!0),n=t.query.channelId;if(this.sites[n])this.sites[n].socket=e;else{this.debugLevel>1&&this.log("new_site",n),this.sites[n]={socket:e,outgoing:[],ttl:this.options.ttl},this.state[n]=0;var r={channelId:this.id,state:JSON.parse(JSON.stringify(this.state)),action:"graph",graph:this.options.graph.toJSON()};this.messageQueue.push({type:"op",data:r,source:this.id,target:[n]}),this.send()}e.on("message",this.onMessage.bind(this,e)),e.on("close",this.onClose.bind(this,e))}},joint.com.Channel.prototype.onClose=function(e){var t=this._clients.indexOf(e);-1!==t&&this._clients.splice(t,1),this._isClient&&!this._closed&&(this._reconnectTimeout&&clearTimeout(this._reconnectTimeout),this._reconnectTimeout=setTimeout(this.connectClient.bind(this),this.options.reconnectInterval)),this.trigger("close",e)},joint.com.Channel.prototype.onMessage=function(e,t){this.trigger("message:received",t),this.options.debugLevel>1&&this.log("message",t);try{t=JSON.parse(t)}catch(n){return console.error("Channel: message parsing failed.",n)}if("notification"==t.type)return this.trigger(t.data.event,t.data.data),this.sendNotification(t);var r=t.data;if(this._isClient){var i=this.sites[this.id];r=this.receive(i,this.id,r)}else{var s=this.sites[r.channelId];r=this.receive(s,r.channelId,r);var i=this.sites[this.id];r=this.receive(i,this.id,r)}this.state[r.channelId]="graph"===r.action?r.state[r.channelId]:(this.state[r.channelId]||0)+1,this.options.debugLevel>1&&this.log("new state",this.state),this.execute(r),_.each(this.sites,function(e,t){t!==this.id&&t!==r.channelId&&this.receive(e,t,r)},this),this._isClient||(t.op=r,this.messageQueue.push(t),this.broadcast(t)),this.trigger("message:processed",t)},joint.com.Channel.prototype.receive=function(e,t,n){if(!e)return n;this.options.debugLevel>1&&this.log("receive",t,n),this.options.debugLevel>1&&this.log("outgoing",e.outgoing),e.outgoing=_.filter(e.outgoing,function(e){return e.state[e.channelId]>=(n.state[e.channelId]||0)}),this.options.debugLevel>1&&this.log("outgoing.length",e.outgoing.length);for(var r=0;r<e.outgoing.length;r++){var i=e.outgoing[r],s=this.transform(n,i);n=s[0],e.outgoing[r]=s[1]}return n},joint.com.Channel.prototype.transform=function(e,t){return this.options.debugLevel>1&&this.log("transform",e,t),"change:target"===e.action&&"remove"===t.action&&e.cell.target.id===t.cell.id&&(e.cell.target={x:0,y:0}),"change:source"===e.action&&"remove"===t.action&&e.cell.source.id===t.cell.id&&(e.cell.source={x:0,y:0}),[e,t]},joint.com.Channel.prototype.execute=function(e){var t;switch(e.action){case"add":this.options.graph.addCell(e.cell,{remote:!0});break;case"remove":t=this.options.graph.getCell(e.cell.id),t&&t.remove({remote:!0,disconnectLinks:!0});break;case"graph":this.options.graph.fromJSON(e.graph);break;default:var n=e.action.substr("change:".length);t=this.options.graph.getCell(e.cell.id),t&&t.set(n,e.cell[n],{remote:!0})}},joint.com.Channel.prototype.broadcast=function(e){e.target=this._isClient?_.keys(this.sites):_.keys(_.omit(this.sites,this.id,e.source)),this.send()},joint.com.Channel.prototype.send=function(){if(!this._paused){for(var e=[],t=0;t<this.messageQueue.length;t++){var n=this.messageQueue[t];this.sendMessage(n)&&e.push(t)}e.forEach(_.bind(function(e){this.messageQueue.splice(e,1)},this))}},joint.com.Channel.prototype.sendMessage=function(e){this.debugLevel>1&&this.log("sendMessage",e);var t=[];return e.target.forEach(function(n,r){var i=this.sites[n];return i?(i.socket&&1===i.socket.readyState&&(this.debugLevel>1&&this.log("sendMessage",n,e),i.socket.send(JSON.stringify(e)),t.push(r)),void 0):t.push(r)},this),t.forEach(function(t){e.target.splice(t,1)}),e.target.length?!1:!0},joint.com.Channel.prototype.log=function(e){var t="Channel ["+this.id+"] "+e.toUpperCase()+": ";console.log.apply(console,[t].concat(_.rest(_.toArray(arguments))))},joint.com.Channel.prototype.pause=function(){this._paused=!0},joint.com.Channel.prototype.unpause=function(){this._paused=!1,this.send()},joint.com.Channel.prototype.notify=function(e,t){var n={type:"notification",source:this.id,data:{event:e,data:t}};this.sendNotification(n)},joint.com.Channel.prototype.sendNotification=function(e){e.target=this._isClient?_.keys(this.sites):_.keys(_.omit(this.sites,this.id,e.source)),this.sendMessage(e)},joint.com.Channel.prototype.onGraphChange=function(e,t,n,r){if(!r||!r.remote){var i="add"===e||"remove"===e||"change:"===e.substr(0,"change:".length);if(i){var s={channelId:this.id,state:JSON.parse(JSON.stringify(this.state)),action:e,cell:t.toJSON()},o={type:"op",data:s,source:this.id};this.options.debugLevel>1&&this.log("generate",o),this.messageQueue.push(o),this.broadcast(o),this.sites[this.id].outgoing.push(s),this.state[this.id]++}}},joint.com.ChannelHub=function(e){if(this.options=e,!this.options.port)throw new Error("ChannelHub: missing a port.");this.initialize()},_.extend(joint.com.ChannelHub.prototype,Backbone.Events),joint.com.ChannelHub.prototype.initialize=function(){this.server=new WebSocketServer({port:this.options.port}),this.server.on("connection",this.onConnection.bind(this))},joint.com.ChannelHub.prototype.onConnection=function(e){var t=url.parse(e.upgradeReq.url,!0),n={query:t.query};if(!this.router)throw new Error("ChannelHub: missing a router.");var r=this.router(n);r.onConnection(e)},joint.com.ChannelHub.prototype.route=function(e){this.router=e},joint.com.ChannelHub.prototype.close=function(){this.server.close()},"object"==typeof exports&&(module.exports.Channel=joint.com.Channel,module.exports.ChannelHub=joint.com.ChannelHub)